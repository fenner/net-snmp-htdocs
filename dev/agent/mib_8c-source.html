<!--#set var="section" value="development" -->
<!--#include virtual="/page-top.html" -->
<!-- CONTENT START -->
  <div class="navigation" id="top">
    <div class="tabs">
      <ul>
        <li><a href="index.html"><span>Main Page</span></a></li>

        <li><a href="pages.html"><span>Related Pages</span></a></li>

        <li><a href="modules.html"><span>Modules</span></a></li>

        <li><a href="annotated.html"><span>Data Structures</span></a></li>

        <li class="current"><a href="files.html"><span>Files</span></a></li>

        <li><a href="examples.html"><span>Examples</span></a></li>
      </ul>
    </div>

    <div class="tabs">
      <ul>
        <li><a href="files.html"><span>File List</span></a></li>

        <li><a href="globals.html"><span>Globals</span></a></li>
      </ul>
    </div>

    <h1>mib.c</h1>

    <div class="fragment">
      <pre class="fragment">
<a name="l00001" id="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002" id="l00002"></a>00002 <span class="comment"> * mib.c</span>
<a name="l00003" id="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004" id="l00004"></a>00004 <span class="comment"> * $Id$</span>
<a name="l00005" id="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006" id="l00006"></a>00006 <span class="comment"> * Update: 1998-07-17 &lt;jhy@gsu.edu&gt;</span>
<a name="l00007" id="l00007"></a>00007 <span class="comment"> * Added print_oid_report* functions.</span>
<a name="l00008" id="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009" id="l00009"></a>00009 <span class="comment"> */</span>
<a name="l00010" id="l00010"></a>00010 <span class=
"comment">/* Portions of this file are subject to the following copyrights.  See</span>
<a name="l00011" id="l00011"></a>00011 <span class=
"comment"> * the Net-SNMP's COPYING file for more details and other copyrights</span>
<a name="l00012" id="l00012"></a>00012 <span class="comment"> * that may apply:</span>
<a name="l00013" id="l00013"></a>00013 <span class="comment"> */</span>
<a name="l00014" id="l00014"></a>00014 <span class=
"comment">/**********************************************************************</span>
<a name="l00015" id="l00015"></a>00015 <span class=
"comment">        Copyright 1988, 1989, 1991, 1992 by Carnegie Mellon University</span>
<a name="l00016" id="l00016"></a>00016 
<a name="l00017" id="l00017"></a>00017 <span class="comment">                      All Rights Reserved</span>
<a name="l00018" id="l00018"></a>00018 
<a name="l00019" id="l00019"></a>00019 <span class=
"comment">Permission to use, copy, modify, and distribute this software and its</span>
<a name="l00020" id="l00020"></a>00020 <span class=
"comment">documentation for any purpose and without fee is hereby granted,</span>
<a name="l00021" id="l00021"></a>00021 <span class=
"comment">provided that the above copyright notice appear in all copies and that</span>
<a name="l00022" id="l00022"></a>00022 <span class=
"comment">both that copyright notice and this permission notice appear in</span>
<a name="l00023" id="l00023"></a>00023 <span class="comment">supporting documentation, and that the name of CMU not be</span>
<a name="l00024" id="l00024"></a>00024 <span class=
"comment">used in advertising or publicity pertaining to distribution of the</span>
<a name="l00025" id="l00025"></a>00025 <span class="comment">software without specific, written prior permission.</span>
<a name="l00026" id="l00026"></a>00026 
<a name="l00027" id="l00027"></a>00027 <span class=
"comment">CMU DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE, INCLUDING</span>
<a name="l00028" id="l00028"></a>00028 <span class=
"comment">ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS, IN NO EVENT SHALL</span>
<a name="l00029" id="l00029"></a>00029 <span class=
"comment">CMU BE LIABLE FOR ANY SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR</span>
<a name="l00030" id="l00030"></a>00030 <span class=
"comment">ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS,</span>
<a name="l00031" id="l00031"></a>00031 <span class=
"comment">WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION,</span>
<a name="l00032" id="l00032"></a>00032 <span class=
"comment">ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS</span>
<a name="l00033" id="l00033"></a>00033 <span class="comment">SOFTWARE.</span>
<a name="l00034" id="l00034"></a>00034 <span class=
"comment">******************************************************************/</span>
<a name="l00035" id="l00035"></a>00035 <span class="comment">/*</span>
<a name="l00036" id="l00036"></a>00036 <span class=
"comment"> * Copyright &copy; 2003 Sun Microsystems, Inc. All rights reserved.</span>
<a name="l00037" id="l00037"></a>00037 <span class=
"comment"> * Use is subject to license terms specified in the COPYING file</span>
<a name="l00038" id="l00038"></a>00038 <span class="comment"> * distributed with the Net-SNMP package.</span>
<a name="l00039" id="l00039"></a>00039 <span class="comment"> */</span>
<a name="l00040" id="l00040"></a>00040 <span class="preprocessor">#include &lt;net-snmp/net-snmp-config.h&gt;</span>
<a name="l00041" id="l00041"></a>00041 
<a name="l00042" id="l00042"></a>00042 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00043" id="l00043"></a>00043 <span class="preprocessor">#include &lt;ctype.h&gt;</span>
<a name="l00044" id="l00044"></a>00044 <span class="preprocessor">#include &lt;sys/types.h&gt;</span>
<a name="l00045" id="l00045"></a>00045 
<a name="l00046" id="l00046"></a>00046 <span class="preprocessor">#if HAVE_DIRENT_H</span>
<a name="l00047" id="l00047"></a>00047 <span class="preprocessor"># include &lt;dirent.h&gt;</span>
<a name="l00048" id="l00048"></a>00048 <span class="preprocessor"># define NAMLEN(dirent) strlen((dirent)-&gt;d_name)</span>
<a name="l00049" id="l00049"></a>00049 <span class="preprocessor">#else</span>
<a name="l00050" id="l00050"></a>00050 <span class="preprocessor"># define dirent direct</span>
<a name="l00051" id="l00051"></a>00051 <span class="preprocessor"># define NAMLEN(dirent) (dirent)-&gt;d_namlen</span>
<a name="l00052" id="l00052"></a>00052 <span class="preprocessor"># if HAVE_SYS_NDIR_H</span>
<a name="l00053" id="l00053"></a>00053 <span class="preprocessor">#  include &lt;sys/ndir.h&gt;</span>
<a name="l00054" id="l00054"></a>00054 <span class="preprocessor"># endif</span>
<a name="l00055" id="l00055"></a>00055 <span class="preprocessor"># if HAVE_SYS_DIR_H</span>
<a name="l00056" id="l00056"></a>00056 <span class="preprocessor">#  include &lt;sys/dir.h&gt;</span>
<a name="l00057" id="l00057"></a>00057 <span class="preprocessor"># endif</span>
<a name="l00058" id="l00058"></a>00058 <span class="preprocessor"># if HAVE_NDIR_H</span>
<a name="l00059" id="l00059"></a>00059 <span class="preprocessor">#  include &lt;ndir.h&gt;</span>
<a name="l00060" id="l00060"></a>00060 <span class="preprocessor"># endif</span>
<a name="l00061" id="l00061"></a>00061 <span class="preprocessor">#endif</span>
<a name="l00062" id="l00062"></a>00062 
<a name="l00063" id="l00063"></a>00063 <span class="preprocessor">#if HAVE_NETINET_IN_H</span>
<a name="l00064" id="l00064"></a>00064 <span class="preprocessor">#include &lt;netinet/in.h&gt;</span>
<a name="l00065" id="l00065"></a>00065 <span class="preprocessor">#endif</span>
<a name="l00066" id="l00066"></a>00066 <span class="preprocessor">#if TIME_WITH_SYS_TIME</span>
<a name="l00067" id="l00067"></a>00067 <span class="preprocessor"># ifdef WIN32</span>
<a name="l00068" id="l00068"></a>00068 <span class="preprocessor">#  include &lt;sys/timeb.h&gt;</span>
<a name="l00069" id="l00069"></a>00069 <span class="preprocessor"># else</span>
<a name="l00070" id="l00070"></a>00070 <span class="preprocessor">#  include &lt;sys/time.h&gt;</span>
<a name="l00071" id="l00071"></a>00071 <span class="preprocessor"># endif</span>
<a name="l00072" id="l00072"></a>00072 <span class="preprocessor"># include &lt;time.h&gt;</span>
<a name="l00073" id="l00073"></a>00073 <span class="preprocessor">#else</span>
<a name="l00074" id="l00074"></a>00074 <span class="preprocessor"># if HAVE_SYS_TIME_H</span>
<a name="l00075" id="l00075"></a>00075 <span class="preprocessor">#  include &lt;sys/time.h&gt;</span>
<a name="l00076" id="l00076"></a>00076 <span class="preprocessor"># else</span>
<a name="l00077" id="l00077"></a>00077 <span class="preprocessor">#  include &lt;time.h&gt;</span>
<a name="l00078" id="l00078"></a>00078 <span class="preprocessor"># endif</span>
<a name="l00079" id="l00079"></a>00079 <span class="preprocessor">#endif</span>
<a name="l00080" id="l00080"></a>00080 <span class="preprocessor">#if HAVE_STRING_H</span>
<a name="l00081" id="l00081"></a>00081 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00082" id="l00082"></a>00082 <span class="preprocessor">#else</span>
<a name="l00083" id="l00083"></a>00083 <span class="preprocessor">#include &lt;strings.h&gt;</span>
<a name="l00084" id="l00084"></a>00084 <span class="preprocessor">#endif</span>
<a name="l00085" id="l00085"></a>00085 <span class="preprocessor">#if HAVE_STDLIB_H</span>
<a name="l00086" id="l00086"></a>00086 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00087" id="l00087"></a>00087 <span class="preprocessor">#endif</span>
<a name="l00088" id="l00088"></a>00088 <span class="preprocessor">#if HAVE_SYS_SELECT_H</span>
<a name="l00089" id="l00089"></a>00089 <span class="preprocessor">#include &lt;sys/select.h&gt;</span>
<a name="l00090" id="l00090"></a>00090 <span class="preprocessor">#endif</span>
<a name="l00091" id="l00091"></a>00091 
<a name="l00092" id="l00092"></a>00092 <span class="preprocessor">#if HAVE_WINSOCK_H</span>
<a name="l00093" id="l00093"></a>00093 <span class="preprocessor">#include &lt;winsock.h&gt;</span>
<a name="l00094" id="l00094"></a>00094 <span class="preprocessor">#endif</span>
<a name="l00095" id="l00095"></a>00095 
<a name="l00096" id="l00096"></a>00096 <span class="preprocessor">#if HAVE_DMALLOC_H</span>
<a name="l00097" id="l00097"></a>00097 <span class="preprocessor">#include &lt;dmalloc.h&gt;</span>
<a name="l00098" id="l00098"></a>00098 <span class="preprocessor">#endif</span>
<a name="l00099" id="l00099"></a>00099 
<a name="l00100" id="l00100"></a>00100 <span class="preprocessor">#include &lt;net-snmp/types.h&gt;</span>
<a name="l00101" id="l00101"></a>00101 <span class="preprocessor">#include &lt;net-snmp/output_api.h&gt;</span>
<a name="l00102" id="l00102"></a>00102 <span class="preprocessor">#include &lt;net-snmp/config_api.h&gt;</span>
<a name="l00103" id="l00103"></a>00103 <span class="preprocessor">#include &lt;net-snmp/utilities.h&gt;</span>
<a name="l00104" id="l00104"></a>00104 
<a name="l00105" id="l00105"></a>00105 <span class="preprocessor">#include &lt;net-snmp/library/asn1.h&gt;</span>
<a name="l00106" id="l00106"></a>00106 <span class="preprocessor">#include &lt;net-snmp/library/snmp_api.h&gt;</span>
<a name="l00107" id="l00107"></a>00107 <span class="preprocessor">#include &lt;net-snmp/library/mib.h&gt;</span>
<a name="l00108" id="l00108"></a>00108 <span class="preprocessor">#include &lt;net-snmp/library/parse.h&gt;</span>
<a name="l00109" id="l00109"></a>00109 <span class="preprocessor">#include &lt;net-snmp/library/int64.h&gt;</span>
<a name="l00110" id="l00110"></a>00110 <span class="preprocessor">#include &lt;net-snmp/library/snmp_client.h&gt;</span>
<a name="l00111" id="l00111"></a>00111 
<a name="l00118" id="l00118"></a>00118 <span class="keyword">static</span> <span class=
"keywordtype">char</span>    *uptimeString(u_long, <span class="keywordtype">char</span> *, <span class=
"keywordtype">size_t</span>);
<a name="l00119" id="l00119"></a>00119 
<a name="l00120" id="l00120"></a>00120 <span class="keyword">static</span> <span class=
"keyword">struct </span>tree *_get_realloc_symbol(<span class="keyword">const</span> oid * objid, <span class=
"keywordtype">size_t</span> objidlen,
<a name="l00121" id="l00121"></a>00121                                         <span class="keyword">struct</span> tree *subtree,
<a name="l00122" id="l00122"></a>00122                                         u_char ** buf, <span class=
"keywordtype">size_t</span> * buf_len,
<a name="l00123" id="l00123"></a>00123                                         <span class="keywordtype">size_t</span> * out_len,
<a name="l00124" id="l00124"></a>00124                                         <span class=
"keywordtype">int</span> allow_realloc,
<a name="l00125" id="l00125"></a>00125                                         <span class=
"keywordtype">int</span> *buf_overflow,
<a name="l00126" id="l00126"></a>00126                                         <span class=
"keyword">struct</span> index_list *in_dices,
<a name="l00127" id="l00127"></a>00127                                         <span class=
"keywordtype">size_t</span> * end_of_known);
<a name="l00128" id="l00128"></a>00128 
<a name="l00129" id="l00129"></a>00129 <span class="keyword">static</span> <span class=
"keywordtype">int</span>      print_tree_node(u_char ** buf, <span class="keywordtype">size_t</span> * buf_len,
<a name="l00130" id="l00130"></a>00130                                 <span class=
"keywordtype">size_t</span> * out_len, <span class="keywordtype">int</span> allow_realloc,
<a name="l00131" id="l00131"></a>00131                                 <span class="keyword">struct</span> tree *tp, <span class=
"keywordtype">int</span> width);
<a name="l00132" id="l00132"></a>00132 <span class="keyword">static</span> <span class=
"keywordtype">void</span>     handle_mibdirs_conf(<span class="keyword">const</span> <span class=
"keywordtype">char</span> *token, <span class="keywordtype">char</span> *line);
<a name="l00133" id="l00133"></a>00133 <span class="keyword">static</span> <span class=
"keywordtype">void</span>     handle_mibs_conf(<span class="keyword">const</span> <span class=
"keywordtype">char</span> *token, <span class="keywordtype">char</span> *line);
<a name="l00134" id="l00134"></a>00134 <span class="keyword">static</span> <span class=
"keywordtype">void</span>     handle_mibfile_conf(<span class="keyword">const</span> <span class=
"keywordtype">char</span> *token, <span class="keywordtype">char</span> *line);
<a name="l00135" id="l00135"></a>00135 
<a name="l00136" id="l00136"></a>00136 <span class="keyword">static</span> <span class=
"keywordtype">void</span>     _oid_finish_printing(<span class="keyword">const</span> oid * objid, <span class=
"keywordtype">size_t</span> objidlen,
<a name="l00137" id="l00137"></a>00137                                      u_char ** buf, <span class=
"keywordtype">size_t</span> * buf_len,
<a name="l00138" id="l00138"></a>00138                                      <span class="keywordtype">size_t</span> * out_len,
<a name="l00139" id="l00139"></a>00139                                      <span class=
"keywordtype">int</span> allow_realloc, <span class="keywordtype">int</span> *buf_overflow);
<a name="l00140" id="l00140"></a>00140 
<a name="l00141" id="l00141"></a>00141 <span class="comment">/*</span>
<a name="l00142" id="l00142"></a>00142 <span class="comment"> * helper functions for get_module_node </span>
<a name="l00143" id="l00143"></a>00143 <span class="comment"> */</span>
<a name="l00144" id="l00144"></a>00144 <span class="keyword">static</span> <span class=
"keywordtype">int</span>      node_to_oid(<span class="keyword">struct</span> tree *, oid *, <span class=
"keywordtype">size_t</span> *);
<a name="l00145" id="l00145"></a>00145 <span class="preprocessor">#ifndef NETSNMP_DISABLE_MIB_LOADING</span>
<a name="l00146" id="l00146"></a>00146 <span class="keyword">static</span> <span class=
"keywordtype">int</span>      _add_strings_to_oid(<span class="keyword">struct</span> tree *, <span class=
"keywordtype">char</span> *,
<a name="l00147" id="l00147"></a>00147                                     oid *, <span class=
"keywordtype">size_t</span> *, <span class="keywordtype">size_t</span>);
<a name="l00148" id="l00148"></a>00148 <span class="preprocessor">#else</span>
<a name="l00149" id="l00149"></a>00149 <span class="keyword">static</span> <span class=
"keywordtype">int</span>      _add_strings_to_oid(<span class="keywordtype">void</span> *, <span class=
"keywordtype">char</span> *,
<a name="l00150" id="l00150"></a>00150                                     oid *, <span class=
"keywordtype">size_t</span> *, <span class="keywordtype">size_t</span>);
<a name="l00151" id="l00151"></a>00151 <span class="preprocessor">#endif </span><span class=
"comment">/* NETSNMP_DISABLE_MIB_LOADING */</span>
<a name="l00152" id="l00152"></a>00152 
<a name="l00153" id="l00153"></a>00153 <span class="preprocessor">#ifndef NETSNMP_DISABLE_MIB_LOADING</span>
<a name="l00154" id="l00154"></a>00154 <span class="keyword">extern</span> <span class="keyword">struct </span>tree *tree_head;
<a name="l00155" id="l00155"></a>00155 <span class="keyword">static</span> <span class="keyword">struct </span>tree *tree_top;
<a name="l00156" id="l00156"></a>00156 
<a name="l00157" id="l00157"></a>00157 <span class="keyword">struct </span>tree    *Mib;            <span class=
"comment">/* Backwards compatibility */</span>
<a name="l00158" id="l00158"></a>00158 <span class="preprocessor">#endif </span><span class=
"comment">/* NETSNMP_DISABLE_MIB_LOADING */</span>
<a name="l00159" id="l00159"></a>00159 
<a name="l00160" id="l00160"></a>00160 oid             RFC1213_MIB[] = { 1, 3, 6, 1, 2, 1 };
<a name="l00161" id="l00161"></a>00161 <span class="keyword">static</span> <span class=
"keywordtype">char</span>     Standard_Prefix[] = <span class="stringliteral">".1.3.6.1.2.1"</span>;
<a name="l00162" id="l00162"></a>00162 
<a name="l00163" id="l00163"></a>00163 <span class="comment">/*</span>
<a name="l00164" id="l00164"></a>00164 <span class=
"comment"> * Set default here as some uses of read_objid require valid pointer. </span>
<a name="l00165" id="l00165"></a>00165 <span class="comment"> */</span>
<a name="l00166" id="l00166"></a>00166 <span class="keyword">static</span> <span class=
"keywordtype">char</span>    *Prefix = &amp;Standard_Prefix[0];
<a name="l00167" id="l00167"></a>00167 <span class="keyword">typedef</span> <span class="keyword">struct </span>_PrefixList {
<a name="l00168" id="l00168"></a>00168     <span class="keyword">const</span> <span class="keywordtype">char</span>     *str;
<a name="l00169" id="l00169"></a>00169     <span class="keywordtype">int</span>             len;
<a name="l00170" id="l00170"></a>00170 }              *PrefixListPtr, PrefixList;
<a name="l00171" id="l00171"></a>00171 
<a name="l00172" id="l00172"></a>00172 <span class="comment">/*</span>
<a name="l00173" id="l00173"></a>00173 <span class="comment"> * Here are the prefix strings.</span>
<a name="l00174" id="l00174"></a>00174 <span class=
"comment"> * Note that the first one finds the value of Prefix or Standard_Prefix.</span>
<a name="l00175" id="l00175"></a>00175 <span class=
"comment"> * Any of these MAY start with period; all will NOT end with period.</span>
<a name="l00176" id="l00176"></a>00176 <span class=
"comment"> * Period is added where needed.  See use of Prefix in this module.</span>
<a name="l00177" id="l00177"></a>00177 <span class="comment"> */</span>
<a name="l00178" id="l00178"></a>00178 PrefixList      mib_prefixes[] = {
<a name="l00179" id="l00179"></a>00179     {&amp;Standard_Prefix[0]},      <span class=
"comment">/* placeholder for Prefix data */</span>
<a name="l00180" id="l00180"></a>00180     {<span class="stringliteral">".iso.org.dod.internet.mgmt.mib-2"</span>},
<a name="l00181" id="l00181"></a>00181     {<span class="stringliteral">".iso.org.dod.internet.experimental"</span>},
<a name="l00182" id="l00182"></a>00182     {<span class="stringliteral">".iso.org.dod.internet.private"</span>},
<a name="l00183" id="l00183"></a>00183     {<span class="stringliteral">".iso.org.dod.internet.snmpParties"</span>},
<a name="l00184" id="l00184"></a>00184     {<span class="stringliteral">".iso.org.dod.internet.snmpSecrets"</span>},
<a name="l00185" id="l00185"></a>00185     {NULL, 0}                   <span class="comment">/* end of list */</span>
<a name="l00186" id="l00186"></a>00186 };
<a name="l00187" id="l00187"></a>00187 
<a name="l00188" id="l00188"></a>00188 <span class="keyword">enum</span> inet_address_type {
<a name="l00189" id="l00189"></a>00189     IPV4 = 1,
<a name="l00190" id="l00190"></a>00190     IPV6 = 2,
<a name="l00191" id="l00191"></a>00191     IPV4Z = 3,
<a name="l00192" id="l00192"></a>00192     IPV6Z = 4,
<a name="l00193" id="l00193"></a>00193     DNS = 16
<a name="l00194" id="l00194"></a>00194 };
<a name="l00195" id="l00195"></a>00195 
<a name="l00196" id="l00196"></a>00196 
<a name="l00207" id="l00207"></a>00207 <span class="keyword">static</span> <span class="keywordtype">char</span>    *
<a name="l00208" id="l00208"></a>00208 uptimeString(u_long timeticks, <span class="keywordtype">char</span> *buf, <span class=
"keywordtype">size_t</span> buflen)
<a name="l00209" id="l00209"></a>00209 {
<a name="l00210" id="l00210"></a>00210     <span class=
"keywordtype">int</span>             centisecs, seconds, minutes, hours, days;
<a name="l00211" id="l00211"></a>00211 
<a name="l00212" id="l00212"></a>00212     <span class=
"keywordflow">if</span> (netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_NUMERIC_TIMETICKS)) {
<a name="l00213" id="l00213"></a>00213         snprintf(buf, buflen, <span class="stringliteral">"%lu"</span>, timeticks);
<a name="l00214" id="l00214"></a>00214         <span class="keywordflow">return</span> buf;
<a name="l00215" id="l00215"></a>00215     }
<a name="l00216" id="l00216"></a>00216 
<a name="l00217" id="l00217"></a>00217 
<a name="l00218" id="l00218"></a>00218     centisecs = timeticks % 100;
<a name="l00219" id="l00219"></a>00219     timeticks /= 100;
<a name="l00220" id="l00220"></a>00220     days = timeticks / (60 * 60 * 24);
<a name="l00221" id="l00221"></a>00221     timeticks %= (60 * 60 * 24);
<a name="l00222" id="l00222"></a>00222 
<a name="l00223" id="l00223"></a>00223     hours = timeticks / (60 * 60);
<a name="l00224" id="l00224"></a>00224     timeticks %= (60 * 60);
<a name="l00225" id="l00225"></a>00225 
<a name="l00226" id="l00226"></a>00226     minutes = timeticks / 60;
<a name="l00227" id="l00227"></a>00227     seconds = timeticks % 60;
<a name="l00228" id="l00228"></a>00228 
<a name="l00229" id="l00229"></a>00229     <span class=
"keywordflow">if</span> (netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICK_PRINT))
<a name="l00230" id="l00230"></a>00230         snprintf(buf, buflen, <span class="stringliteral">"%d:%d:%02d:%02d.%02d"</span>,
<a name="l00231" id="l00231"></a>00231                 days, hours, minutes, seconds, centisecs);
<a name="l00232" id="l00232"></a>00232     <span class="keywordflow">else</span> {
<a name="l00233" id="l00233"></a>00233         <span class="keywordflow">if</span> (days == 0) {
<a name="l00234" id="l00234"></a>00234             snprintf(buf, buflen, <span class="stringliteral">"%d:%02d:%02d.%02d"</span>,
<a name="l00235" id="l00235"></a>00235                     hours, minutes, seconds, centisecs);
<a name="l00236" id="l00236"></a>00236         } <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (days == 1) {
<a name="l00237" id="l00237"></a>00237             snprintf(buf, buflen, <span class=
"stringliteral">"%d day, %d:%02d:%02d.%02d"</span>,
<a name="l00238" id="l00238"></a>00238                     days, hours, minutes, seconds, centisecs);
<a name="l00239" id="l00239"></a>00239         } <span class="keywordflow">else</span> {
<a name="l00240" id="l00240"></a>00240             snprintf(buf, buflen, <span class=
"stringliteral">"%d days, %d:%02d:%02d.%02d"</span>,
<a name="l00241" id="l00241"></a>00241                     days, hours, minutes, seconds, centisecs);
<a name="l00242" id="l00242"></a>00242         }
<a name="l00243" id="l00243"></a>00243     }
<a name="l00244" id="l00244"></a>00244     <span class="keywordflow">return</span> buf;
<a name="l00245" id="l00245"></a>00245 }
<a name="l00246" id="l00246"></a>00246 
<a name="l00247" id="l00247"></a>00247 
<a name="l00248" id="l00248"></a>00248 
<a name="l00257" id="l00257"></a>00257 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00258" id="l00258"></a>00258 sprint_char(<span class="keywordtype">char</span> *buf, <span class=
"keyword">const</span> u_char ch)
<a name="l00259" id="l00259"></a>00259 {
<a name="l00260" id="l00260"></a>00260     <span class="keywordflow">if</span> (isprint(ch) || isspace(ch)) {
<a name="l00261" id="l00261"></a>00261         sprintf(buf, <span class="stringliteral">"%c"</span>, (<span class=
"keywordtype">int</span>) ch);
<a name="l00262" id="l00262"></a>00262     } <span class="keywordflow">else</span> {
<a name="l00263" id="l00263"></a>00263         sprintf(buf, <span class="stringliteral">"."</span>);
<a name="l00264" id="l00264"></a>00264     }
<a name="l00265" id="l00265"></a>00265 }
<a name="l00266" id="l00266"></a>00266 
<a name="l00267" id="l00267"></a>00267 
<a name="l00268" id="l00268"></a>00268 
<a name="l00288" id="l00288"></a>00288 <span class="keywordtype">int</span>
<a name="l00289" id="l00289"></a><a class="code" href=
"group__mib__utilities.html#ge65180cbf5514f84ddb0ea78b3ef8e1f">00289</a> <a class="code" href=
"group__mib__utilities.html#ge65180cbf5514f84ddb0ea78b3ef8e1f" title=
"Prints a hexadecimal string into a buffer.">_sprint_hexstring_line</a>(u_char ** buf, <span class=
"keywordtype">size_t</span> * buf_len, <span class="keywordtype">size_t</span> * out_len,
<a name="l00290" id="l00290"></a>00290                        <span class="keywordtype">int</span> allow_realloc, <span class=
"keyword">const</span> u_char * cp, <span class="keywordtype">size_t</span> line_len)
<a name="l00291" id="l00291"></a>00291 {
<a name="l00292" id="l00292"></a>00292     <span class="keyword">const</span> u_char   *tp;
<a name="l00293" id="l00293"></a>00293     <span class="keyword">const</span> u_char   *cp2 = cp;
<a name="l00294" id="l00294"></a>00294     <span class="keywordtype">size_t</span>          lenleft = line_len;
<a name="l00295" id="l00295"></a>00295 
<a name="l00296" id="l00296"></a>00296     <span class="comment">/*</span>
<a name="l00297" id="l00297"></a>00297 <span class="comment">     * Make sure there's enough room for the hex output....</span>
<a name="l00298" id="l00298"></a>00298 <span class="comment">     */</span>
<a name="l00299" id="l00299"></a>00299     <span class="keywordflow">while</span> ((*out_len + line_len*3+1) &gt;= *buf_len) {
<a name="l00300" id="l00300"></a>00300         <span class="keywordflow">if</span> (!(allow_realloc &amp;&amp; <a class="code"
href="group__util.html#g7b42d706225a788adcfeaad9b24717de" title=
"This function increase the size of the buffer pointed at by *buf, which is initially...">snmp_realloc</a>(buf, buf_len))) {
<a name="l00301" id="l00301"></a>00301             <span class="keywordflow">return</span> 0;
<a name="l00302" id="l00302"></a>00302         }
<a name="l00303" id="l00303"></a>00303     }
<a name="l00304" id="l00304"></a>00304 
<a name="l00305" id="l00305"></a>00305     <span class="comment">/*</span>
<a name="l00306" id="l00306"></a>00306 <span class="comment">     * .... and display the hex values themselves....</span>
<a name="l00307" id="l00307"></a>00307 <span class="comment">     */</span>
<a name="l00308" id="l00308"></a>00308     <span class="keywordflow">for</span> (; lenleft &gt;= 8; lenleft-=8) {
<a name="l00309" id="l00309"></a>00309         sprintf((<span class="keywordtype">char</span> *) (*buf + *out_len),
<a name="l00310" id="l00310"></a>00310                 <span class=
"stringliteral">"%02X %02X %02X %02X %02X %02X %02X %02X "</span>, cp[0], cp[1],
<a name="l00311" id="l00311"></a>00311                 cp[2], cp[3], cp[4], cp[5], cp[6], cp[7]);
<a name="l00312" id="l00312"></a>00312         *out_len += strlen((<span class="keywordtype">char</span> *) (*buf + *out_len));
<a name="l00313" id="l00313"></a>00313         cp       += 8;
<a name="l00314" id="l00314"></a>00314     }
<a name="l00315" id="l00315"></a>00315     <span class="keywordflow">for</span> (; lenleft &gt; 0; lenleft--) {
<a name="l00316" id="l00316"></a>00316         sprintf((<span class="keywordtype">char</span> *) (*buf + *out_len), <span class=
"stringliteral">"%02X "</span>, *cp++);
<a name="l00317" id="l00317"></a>00317         *out_len += strlen((<span class="keywordtype">char</span> *) (*buf + *out_len));
<a name="l00318" id="l00318"></a>00318     }
<a name="l00319" id="l00319"></a>00319 
<a name="l00320" id="l00320"></a>00320     <span class="comment">/*</span>
<a name="l00321" id="l00321"></a>00321 <span class=
"comment">     * .... plus (optionally) do the same for the ASCII equivalent.</span>
<a name="l00322" id="l00322"></a>00322 <span class="comment">     */</span>
<a name="l00323" id="l00323"></a>00323     <span class=
"keywordflow">if</span> (netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_PRINT_HEX_TEXT)) {
<a name="l00324" id="l00324"></a>00324         <span class="keywordflow">while</span> ((*out_len + line_len+5) &gt;= *buf_len) {
<a name="l00325" id="l00325"></a>00325             <span class="keywordflow">if</span> (!(allow_realloc &amp;&amp; <a class=
"code" href="group__util.html#g7b42d706225a788adcfeaad9b24717de" title=
"This function increase the size of the buffer pointed at by *buf, which is initially...">snmp_realloc</a>(buf, buf_len))) {
<a name="l00326" id="l00326"></a>00326                 <span class="keywordflow">return</span> 0;
<a name="l00327" id="l00327"></a>00327             }
<a name="l00328" id="l00328"></a>00328         }
<a name="l00329" id="l00329"></a>00329         sprintf((<span class="keywordtype">char</span> *) (*buf + *out_len), <span class=
"stringliteral">"  ["</span>);
<a name="l00330" id="l00330"></a>00330         *out_len += strlen((<span class="keywordtype">char</span> *) (*buf + *out_len));
<a name="l00331" id="l00331"></a>00331         <span class="keywordflow">for</span> (tp = cp2; tp &lt; cp; tp++) {
<a name="l00332" id="l00332"></a>00332             sprint_char((<span class="keywordtype">char</span> *) (*buf + *out_len), *tp);
<a name="l00333" id="l00333"></a>00333             (*out_len)++;
<a name="l00334" id="l00334"></a>00334         }
<a name="l00335" id="l00335"></a>00335         sprintf((<span class="keywordtype">char</span> *) (*buf + *out_len), <span class=
"stringliteral">"]"</span>);
<a name="l00336" id="l00336"></a>00336         *out_len += strlen((<span class="keywordtype">char</span> *) (*buf + *out_len));
<a name="l00337" id="l00337"></a>00337     }
<a name="l00338" id="l00338"></a>00338     <span class="keywordflow">return</span> 1;
<a name="l00339" id="l00339"></a>00339 }
<a name="l00340" id="l00340"></a>00340 
<a name="l00341" id="l00341"></a>00341 <span class="keywordtype">int</span>
<a name="l00342" id="l00342"></a>00342 sprint_realloc_hexstring(u_char ** buf, <span class=
"keywordtype">size_t</span> * buf_len, <span class="keywordtype">size_t</span> * out_len,
<a name="l00343" id="l00343"></a>00343                          <span class="keywordtype">int</span> allow_realloc, <span class=
"keyword">const</span> u_char * cp, <span class="keywordtype">size_t</span> len)
<a name="l00344" id="l00344"></a>00344 {
<a name="l00345" id="l00345"></a>00345     <span class=
"keywordtype">int</span> line_len = netsnmp_ds_get_int(NETSNMP_DS_LIBRARY_ID,
<a name="l00346" id="l00346"></a>00346                                       NETSNMP_DS_LIB_HEX_OUTPUT_LENGTH);
<a name="l00347" id="l00347"></a>00347     <span class="keywordflow">if</span> (!line_len)
<a name="l00348" id="l00348"></a>00348         line_len=len;
<a name="l00349" id="l00349"></a>00349 
<a name="l00350" id="l00350"></a>00350     <span class="keywordflow">for</span> (; (int)len &gt; line_len; len -= line_len) {
<a name="l00351" id="l00351"></a>00351         <span class="keywordflow">if</span>(!<a class="code" href=
"group__mib__utilities.html#ge65180cbf5514f84ddb0ea78b3ef8e1f" title=
"Prints a hexadecimal string into a buffer.">_sprint_hexstring_line</a>(buf, buf_len, out_len, allow_realloc, cp, line_len))
<a name="l00352" id="l00352"></a>00352             <span class="keywordflow">return</span> 0;
<a name="l00353" id="l00353"></a>00353         *(*buf + (*out_len)++) = <span class="charliteral">'\n'</span>;
<a name="l00354" id="l00354"></a>00354         *(*buf + *out_len) = 0;
<a name="l00355" id="l00355"></a>00355         cp += line_len;
<a name="l00356" id="l00356"></a>00356     }
<a name="l00357" id="l00357"></a>00357     <span class="keywordflow">if</span>(!<a class="code" href=
"group__mib__utilities.html#ge65180cbf5514f84ddb0ea78b3ef8e1f" title=
"Prints a hexadecimal string into a buffer.">_sprint_hexstring_line</a>(buf, buf_len, out_len, allow_realloc, cp, len))
<a name="l00358" id="l00358"></a>00358         <span class="keywordflow">return</span> 0;
<a name="l00359" id="l00359"></a>00359     *(*buf + *out_len) = 0;
<a name="l00360" id="l00360"></a>00360     <span class="keywordflow">return</span> 1;
<a name="l00361" id="l00361"></a>00361 }
<a name="l00362" id="l00362"></a>00362 
<a name="l00363" id="l00363"></a>00363 
<a name="l00364" id="l00364"></a>00364 
<a name="l00384" id="l00384"></a>00384 <span class="keywordtype">int</span>
<a name="l00385" id="l00385"></a><a class="code" href=
"group__mib__utilities.html#g7ff1971fc340b2789d48895086bf3230">00385</a> <a class="code" href=
"group__mib__utilities.html#g7ff1971fc340b2789d48895086bf3230" title=
"Prints an ascii string into a buffer.">sprint_realloc_asciistring</a>(u_char ** buf, <span class=
"keywordtype">size_t</span> * buf_len,
<a name="l00386" id="l00386"></a>00386                            <span class="keywordtype">size_t</span> * out_len, <span class=
"keywordtype">int</span> allow_realloc,
<a name="l00387" id="l00387"></a>00387                            <span class="keyword">const</span> u_char * cp, <span class=
"keywordtype">size_t</span> len)
<a name="l00388" id="l00388"></a>00388 {
<a name="l00389" id="l00389"></a>00389     <span class="keywordtype">int</span>             i;
<a name="l00390" id="l00390"></a>00390 
<a name="l00391" id="l00391"></a>00391     <span class="keywordflow">for</span> (i = 0; i &lt; (int) len; i++) {
<a name="l00392" id="l00392"></a>00392         <span class="keywordflow">if</span> (isprint(*cp) || isspace(*cp)) {
<a name="l00393" id="l00393"></a>00393             <span class="keywordflow">if</span> (*cp == <span class=
"charliteral">'\\'</span> || *cp == <span class="charliteral">'"'</span>) {
<a name="l00394" id="l00394"></a>00394                 <span class="keywordflow">if</span> ((*out_len &gt;= *buf_len) &amp;&amp;
<a name="l00395" id="l00395"></a>00395                     !(allow_realloc &amp;&amp; <a class="code" href=
"group__util.html#g7b42d706225a788adcfeaad9b24717de" title=
"This function increase the size of the buffer pointed at by *buf, which is initially...">snmp_realloc</a>(buf, buf_len))) {
<a name="l00396" id="l00396"></a>00396                     <span class="keywordflow">return</span> 0;
<a name="l00397" id="l00397"></a>00397                 }
<a name="l00398" id="l00398"></a>00398                 *(*buf + (*out_len)++) = <span class="charliteral">'\\'</span>;
<a name="l00399" id="l00399"></a>00399             }
<a name="l00400" id="l00400"></a>00400             <span class="keywordflow">if</span> ((*out_len &gt;= *buf_len) &amp;&amp;
<a name="l00401" id="l00401"></a>00401                 !(allow_realloc &amp;&amp; <a class="code" href=
"group__util.html#g7b42d706225a788adcfeaad9b24717de" title=
"This function increase the size of the buffer pointed at by *buf, which is initially...">snmp_realloc</a>(buf, buf_len))) {
<a name="l00402" id="l00402"></a>00402                 <span class="keywordflow">return</span> 0;
<a name="l00403" id="l00403"></a>00403             }
<a name="l00404" id="l00404"></a>00404             *(*buf + (*out_len)++) = *cp++;
<a name="l00405" id="l00405"></a>00405         } <span class="keywordflow">else</span> {
<a name="l00406" id="l00406"></a>00406             <span class="keywordflow">if</span> ((*out_len &gt;= *buf_len) &amp;&amp;
<a name="l00407" id="l00407"></a>00407                 !(allow_realloc &amp;&amp; <a class="code" href=
"group__util.html#g7b42d706225a788adcfeaad9b24717de" title=
"This function increase the size of the buffer pointed at by *buf, which is initially...">snmp_realloc</a>(buf, buf_len))) {
<a name="l00408" id="l00408"></a>00408                 <span class="keywordflow">return</span> 0;
<a name="l00409" id="l00409"></a>00409             }
<a name="l00410" id="l00410"></a>00410             *(*buf + (*out_len)++) = <span class="charliteral">'.'</span>;
<a name="l00411" id="l00411"></a>00411             cp++;
<a name="l00412" id="l00412"></a>00412         }
<a name="l00413" id="l00413"></a>00413     }
<a name="l00414" id="l00414"></a>00414     <span class="keywordflow">if</span> ((*out_len &gt;= *buf_len) &amp;&amp;
<a name="l00415" id="l00415"></a>00415         !(allow_realloc &amp;&amp; <a class="code" href=
"group__util.html#g7b42d706225a788adcfeaad9b24717de" title=
"This function increase the size of the buffer pointed at by *buf, which is initially...">snmp_realloc</a>(buf, buf_len))) {
<a name="l00416" id="l00416"></a>00416         <span class="keywordflow">return</span> 0;
<a name="l00417" id="l00417"></a>00417     }
<a name="l00418" id="l00418"></a>00418     *(*buf + *out_len) = <span class="charliteral">'\0'</span>;
<a name="l00419" id="l00419"></a>00419     <span class="keywordflow">return</span> 1;
<a name="l00420" id="l00420"></a>00420 }
<a name="l00421" id="l00421"></a>00421 
<a name="l00444" id="l00444"></a>00444 <span class="keywordtype">int</span>
<a name="l00445" id="l00445"></a><a class="code" href=
"group__mib__utilities.html#gbe71c710f2173fb85512d08c088ea12e">00445</a> <a class="code" href=
"group__mib__utilities.html#gbe71c710f2173fb85512d08c088ea12e" title=
"Prints an octet string into a buffer.">sprint_realloc_octet_string</a>(u_char ** buf, <span class=
"keywordtype">size_t</span> * buf_len,
<a name="l00446" id="l00446"></a>00446                             <span class=
"keywordtype">size_t</span> * out_len, <span class="keywordtype">int</span> allow_realloc,
<a name="l00447" id="l00447"></a>00447                             <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var,
<a name="l00448" id="l00448"></a>00448                             <span class="keyword">const</span> <span class=
"keyword">struct</span> enum_list *enums, <span class="keyword">const</span> <span class="keywordtype">char</span> *hint,
<a name="l00449" id="l00449"></a>00449                             <span class="keyword">const</span> <span class=
"keywordtype">char</span> *units)
<a name="l00450" id="l00450"></a>00450 {
<a name="l00451" id="l00451"></a>00451     <span class="keywordtype">size_t</span>          saved_out_len = *out_len;
<a name="l00452" id="l00452"></a>00452     <span class="keyword">const</span> <span class=
"keywordtype">char</span>     *saved_hint = hint;
<a name="l00453" id="l00453"></a>00453     <span class="keywordtype">int</span>             hex = 0, x = 0;
<a name="l00454" id="l00454"></a>00454     u_char         *cp;
<a name="l00455" id="l00455"></a>00455     <span class="keywordtype">int</span>             output_format, len_needed;
<a name="l00456" id="l00456"></a>00456 
<a name="l00457" id="l00457"></a>00457     <span class="keywordflow">if</span> ((var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a> != ASN_OCTET_STR) &amp;&amp; 
<a name="l00458" id="l00458"></a>00458         (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICKE_PRINT))) {
<a name="l00459" id="l00459"></a>00459         <span class="keyword">const</span> <span class=
"keywordtype">char</span>      str[] = <span class="stringliteral">"Wrong Type (should be OCTET STRING): "</span>;
<a name="l00460" id="l00460"></a>00460         <span class="keywordflow">if</span> (snmp_cstrcat
<a name="l00461" id="l00461"></a>00461             (buf, buf_len, out_len, allow_realloc, str)) {
<a name="l00462" id="l00462"></a>00462             <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#gabc12c361abdca75234c11dccb34871b" title=
"Universal print routine, prints a variable into a buffer according to the variable...">sprint_realloc_by_type</a>(buf, buf_len, out_len,
<a name="l00463" id="l00463"></a>00463                                           allow_realloc, var, NULL, NULL,
<a name="l00464" id="l00464"></a>00464                                           NULL);
<a name="l00465" id="l00465"></a>00465         } <span class="keywordflow">else</span> {
<a name="l00466" id="l00466"></a>00466             <span class="keywordflow">return</span> 0;
<a name="l00467" id="l00467"></a>00467         }
<a name="l00468" id="l00468"></a>00468     }
<a name="l00469" id="l00469"></a>00469 
<a name="l00470" id="l00470"></a>00470 
<a name="l00471" id="l00471"></a>00471     <span class="keywordflow">if</span> (hint) {
<a name="l00472" id="l00472"></a>00472         <span class="keywordtype">int</span>             repeat, width = 1;
<a name="l00473" id="l00473"></a>00473         <span class="keywordtype">long</span>            value;
<a name="l00474" id="l00474"></a>00474         <span class="keywordtype">char</span>            code = <span class=
"charliteral">'d'</span>, separ = 0, term = 0, ch, intbuf[16];
<a name="l00475" id="l00475"></a>00475         u_char         *ecp;
<a name="l00476" id="l00476"></a>00476 
<a name="l00477" id="l00477"></a>00477         <span class=
"keywordflow">if</span> (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICK_PRINT)) {
<a name="l00478" id="l00478"></a>00478             <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class="stringliteral">"STRING: "</span>)) {
<a name="l00479" id="l00479"></a>00479                 <span class="keywordflow">return</span> 0;
<a name="l00480" id="l00480"></a>00480             }
<a name="l00481" id="l00481"></a>00481         }
<a name="l00482" id="l00482"></a>00482         cp = var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.string;
<a name="l00483" id="l00483"></a>00483         ecp = cp + var-&gt;<a class="code" href=
"structvariable__list.html#17aaa6b445178fc39aba69642247d3e9" title="the length of the value to be copied into buf">val_len</a>;
<a name="l00484" id="l00484"></a>00484 
<a name="l00485" id="l00485"></a>00485         <span class="keywordflow">while</span> (cp &lt; ecp) {
<a name="l00486" id="l00486"></a>00486             repeat = 1;
<a name="l00487" id="l00487"></a>00487             <span class="keywordflow">if</span> (*hint) {
<a name="l00488" id="l00488"></a>00488                 <span class="keywordflow">if</span> (*hint == <span class=
"charliteral">'*'</span>) {
<a name="l00489" id="l00489"></a>00489                     repeat = *cp++;
<a name="l00490" id="l00490"></a>00490                     hint++;
<a name="l00491" id="l00491"></a>00491                 }
<a name="l00492" id="l00492"></a>00492                 width = 0;
<a name="l00493" id="l00493"></a>00493                 <span class="keywordflow">while</span> (<span class=
"charliteral">'0'</span> &lt;= *hint &amp;&amp; *hint &lt;= <span class="charliteral">'9'</span>)
<a name="l00494" id="l00494"></a>00494                     width = (width * 10) + (*hint++ - <span class=
"charliteral">'0'</span>);
<a name="l00495" id="l00495"></a>00495                 code = *hint++;
<a name="l00496" id="l00496"></a>00496                 <span class=
"keywordflow">if</span> ((ch = *hint) &amp;&amp; ch != <span class=
"charliteral">'*'</span> &amp;&amp; (ch &lt; '0' || ch &gt; <span class="charliteral">'9'</span>)
<a name="l00497" id="l00497"></a>00497                     &amp;&amp; (width != 0
<a name="l00498" id="l00498"></a>00498                         || (ch != <span class=
"charliteral">'x'</span> &amp;&amp; ch != <span class="charliteral">'d'</span> &amp;&amp; ch != <span class=
"charliteral">'o'</span>)))
<a name="l00499" id="l00499"></a>00499                     separ = *hint++;
<a name="l00500" id="l00500"></a>00500                 <span class="keywordflow">else</span>
<a name="l00501" id="l00501"></a>00501                     separ = 0;
<a name="l00502" id="l00502"></a>00502                 <span class=
"keywordflow">if</span> ((ch = *hint) &amp;&amp; ch != <span class=
"charliteral">'*'</span> &amp;&amp; (ch &lt; '0' || ch &gt; <span class="charliteral">'9'</span>)
<a name="l00503" id="l00503"></a>00503                     &amp;&amp; (width != 0
<a name="l00504" id="l00504"></a>00504                         || (ch != <span class=
"charliteral">'x'</span> &amp;&amp; ch != <span class="charliteral">'d'</span> &amp;&amp; ch != <span class=
"charliteral">'o'</span>)))
<a name="l00505" id="l00505"></a>00505                     term = *hint++;
<a name="l00506" id="l00506"></a>00506                 <span class="keywordflow">else</span>
<a name="l00507" id="l00507"></a>00507                     term = 0;
<a name="l00508" id="l00508"></a>00508                 <span class="keywordflow">if</span> (width == 0)  <span class=
"comment">/* Handle malformed hint strings */</span>
<a name="l00509" id="l00509"></a>00509                     width = 1;
<a name="l00510" id="l00510"></a>00510             }
<a name="l00511" id="l00511"></a>00511 
<a name="l00512" id="l00512"></a>00512             <span class="keywordflow">while</span> (repeat &amp;&amp; cp &lt; ecp) {
<a name="l00513" id="l00513"></a>00513                 value = 0;
<a name="l00514" id="l00514"></a>00514                 <span class="keywordflow">if</span> (code != <span class=
"charliteral">'a'</span> &amp;&amp; code != <span class="charliteral">'t'</span>) {
<a name="l00515" id="l00515"></a>00515                     <span class="keywordflow">for</span> (x = 0; x &lt; width; x++) {
<a name="l00516" id="l00516"></a>00516                         value = value * 256 + *cp++;
<a name="l00517" id="l00517"></a>00517                     }
<a name="l00518" id="l00518"></a>00518                 }
<a name="l00519" id="l00519"></a>00519                 <span class="keywordflow">switch</span> (code) {
<a name="l00520" id="l00520"></a>00520                 <span class="keywordflow">case</span> <span class=
"charliteral">'x'</span>:
<a name="l00521" id="l00521"></a>00521                     <span class=
"keywordflow">if</span> (netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID,
<a name="l00522" id="l00522"></a>00522                                                NETSNMP_DS_LIB_2DIGIT_HEX_OUTPUT)
<a name="l00523" id="l00523"></a>00523                                        &amp;&amp; value &lt; 16) {
<a name="l00524" id="l00524"></a>00524                         sprintf(intbuf, <span class="stringliteral">"0%lx"</span>, value);
<a name="l00525" id="l00525"></a>00525                     } <span class="keywordflow">else</span> {
<a name="l00526" id="l00526"></a>00526                         sprintf(intbuf, <span class="stringliteral">"%lx"</span>, value);
<a name="l00527" id="l00527"></a>00527                     }
<a name="l00528" id="l00528"></a>00528                     <span class="keywordflow">if</span> (!snmp_cstrcat
<a name="l00529" id="l00529"></a>00529                         (buf, buf_len, out_len, allow_realloc, intbuf)) {
<a name="l00530" id="l00530"></a>00530                         <span class="keywordflow">return</span> 0;
<a name="l00531" id="l00531"></a>00531                     }
<a name="l00532" id="l00532"></a>00532                     <span class="keywordflow">break</span>;
<a name="l00533" id="l00533"></a>00533                 <span class="keywordflow">case</span> <span class=
"charliteral">'d'</span>:
<a name="l00534" id="l00534"></a>00534                     sprintf(intbuf, <span class="stringliteral">"%ld"</span>, value);
<a name="l00535" id="l00535"></a>00535                     <span class="keywordflow">if</span> (!snmp_cstrcat
<a name="l00536" id="l00536"></a>00536                         (buf, buf_len, out_len, allow_realloc, intbuf)) {
<a name="l00537" id="l00537"></a>00537                         <span class="keywordflow">return</span> 0;
<a name="l00538" id="l00538"></a>00538                     }
<a name="l00539" id="l00539"></a>00539                     <span class="keywordflow">break</span>;
<a name="l00540" id="l00540"></a>00540                 <span class="keywordflow">case</span> <span class=
"charliteral">'o'</span>:
<a name="l00541" id="l00541"></a>00541                     sprintf(intbuf, <span class="stringliteral">"%lo"</span>, value);
<a name="l00542" id="l00542"></a>00542                     <span class="keywordflow">if</span> (!snmp_cstrcat
<a name="l00543" id="l00543"></a>00543                         (buf, buf_len, out_len, allow_realloc, intbuf)) {
<a name="l00544" id="l00544"></a>00544                         <span class="keywordflow">return</span> 0;
<a name="l00545" id="l00545"></a>00545                     }
<a name="l00546" id="l00546"></a>00546                     <span class="keywordflow">break</span>;
<a name="l00547" id="l00547"></a>00547                 <span class="keywordflow">case</span> <span class=
"charliteral">'t'</span>: <span class="comment">/* new in rfc 3411 */</span>
<a name="l00548" id="l00548"></a>00548                 <span class="keywordflow">case</span> <span class=
"charliteral">'a'</span>:
<a name="l00549" id="l00549"></a>00549                     <span class=
"comment">/* A string hint gives the max size - we may not need this much */</span>
<a name="l00550" id="l00550"></a>00550                     len_needed = <a class="code" href=
"group__util.html#gd1976dec11cfd62abaa4ecedad948f18" title="Computers the minimum of a and b.">SNMP_MIN</a>( width, ecp-cp );
<a name="l00551" id="l00551"></a>00551                     <span class=
"keywordflow">while</span> ((*out_len + len_needed + 1) &gt;= *buf_len) {
<a name="l00552" id="l00552"></a>00552                         <span class=
"keywordflow">if</span> (!(allow_realloc &amp;&amp; <a class="code" href="group__util.html#g7b42d706225a788adcfeaad9b24717de"
title=
"This function increase the size of the buffer pointed at by *buf, which is initially...">snmp_realloc</a>(buf, buf_len))) {
<a name="l00553" id="l00553"></a>00553                             <span class="keywordflow">return</span> 0;
<a name="l00554" id="l00554"></a>00554                         }
<a name="l00555" id="l00555"></a>00555                     }
<a name="l00556" id="l00556"></a>00556                     <span class=
"keywordflow">for</span> (x = 0; x &lt; width &amp;&amp; cp &lt; ecp; x++) {
<a name="l00557" id="l00557"></a>00557                         *(*buf + *out_len) = *cp++;
<a name="l00558" id="l00558"></a>00558                         (*out_len)++;
<a name="l00559" id="l00559"></a>00559                     }
<a name="l00560" id="l00560"></a>00560                     *(*buf + *out_len) = <span class="charliteral">'\0'</span>;
<a name="l00561" id="l00561"></a>00561                     <span class="keywordflow">break</span>;
<a name="l00562" id="l00562"></a>00562                 <span class="keywordflow">default</span>:
<a name="l00563" id="l00563"></a>00563                     *out_len = saved_out_len;
<a name="l00564" id="l00564"></a>00564                     <span class=
"keywordflow">if</span> (snmp_cstrcat(buf, buf_len, out_len, allow_realloc,
<a name="l00565" id="l00565"></a>00565                                      <span class=
"stringliteral">"(Bad hint ignored: "</span>)
<a name="l00566" id="l00566"></a>00566                         &amp;&amp; snmp_cstrcat(buf, buf_len, out_len,
<a name="l00567" id="l00567"></a>00567                                        allow_realloc, saved_hint)
<a name="l00568" id="l00568"></a>00568                         &amp;&amp; snmp_cstrcat(buf, buf_len, out_len,
<a name="l00569" id="l00569"></a>00569                                        allow_realloc, <span class=
"stringliteral">") "</span>)) {
<a name="l00570" id="l00570"></a>00570                         <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#gbe71c710f2173fb85512d08c088ea12e" title=
"Prints an octet string into a buffer.">sprint_realloc_octet_string</a>(buf, buf_len,
<a name="l00571" id="l00571"></a>00571                                                            out_len,
<a name="l00572" id="l00572"></a>00572                                                            allow_realloc,
<a name="l00573" id="l00573"></a>00573                                                            var, enums,
<a name="l00574" id="l00574"></a>00574                                                            NULL, NULL);
<a name="l00575" id="l00575"></a>00575                     } <span class="keywordflow">else</span> {
<a name="l00576" id="l00576"></a>00576                         <span class="keywordflow">return</span> 0;
<a name="l00577" id="l00577"></a>00577                     }
<a name="l00578" id="l00578"></a>00578                 }
<a name="l00579" id="l00579"></a>00579 
<a name="l00580" id="l00580"></a>00580                 <span class="keywordflow">if</span> (cp &lt; ecp &amp;&amp; separ) {
<a name="l00581" id="l00581"></a>00581                     <span class=
"keywordflow">while</span> ((*out_len + 1) &gt;= *buf_len) {
<a name="l00582" id="l00582"></a>00582                         <span class=
"keywordflow">if</span> (!(allow_realloc &amp;&amp; <a class="code" href="group__util.html#g7b42d706225a788adcfeaad9b24717de"
title=
"This function increase the size of the buffer pointed at by *buf, which is initially...">snmp_realloc</a>(buf, buf_len))) {
<a name="l00583" id="l00583"></a>00583                             <span class="keywordflow">return</span> 0;
<a name="l00584" id="l00584"></a>00584                         }
<a name="l00585" id="l00585"></a>00585                     }
<a name="l00586" id="l00586"></a>00586                     *(*buf + *out_len) = separ;
<a name="l00587" id="l00587"></a>00587                     (*out_len)++;
<a name="l00588" id="l00588"></a>00588                     *(*buf + *out_len) = <span class="charliteral">'\0'</span>;
<a name="l00589" id="l00589"></a>00589                 }
<a name="l00590" id="l00590"></a>00590                 repeat--;
<a name="l00591" id="l00591"></a>00591             }
<a name="l00592" id="l00592"></a>00592 
<a name="l00593" id="l00593"></a>00593             <span class="keywordflow">if</span> (term &amp;&amp; cp &lt; ecp) {
<a name="l00594" id="l00594"></a>00594                 <span class="keywordflow">while</span> ((*out_len + 1) &gt;= *buf_len) {
<a name="l00595" id="l00595"></a>00595                     <span class=
"keywordflow">if</span> (!(allow_realloc &amp;&amp; <a class="code" href="group__util.html#g7b42d706225a788adcfeaad9b24717de"
title=
"This function increase the size of the buffer pointed at by *buf, which is initially...">snmp_realloc</a>(buf, buf_len))) {
<a name="l00596" id="l00596"></a>00596                         <span class="keywordflow">return</span> 0;
<a name="l00597" id="l00597"></a>00597                     }
<a name="l00598" id="l00598"></a>00598                 }
<a name="l00599" id="l00599"></a>00599                 *(*buf + *out_len) = term;
<a name="l00600" id="l00600"></a>00600                 (*out_len)++;
<a name="l00601" id="l00601"></a>00601                 *(*buf + *out_len) = <span class="charliteral">'\0'</span>;
<a name="l00602" id="l00602"></a>00602             }
<a name="l00603" id="l00603"></a>00603         }
<a name="l00604" id="l00604"></a>00604 
<a name="l00605" id="l00605"></a>00605         <span class="keywordflow">if</span> (units) {
<a name="l00606" id="l00606"></a>00606             <span class="keywordflow">return</span> (snmp_cstrcat
<a name="l00607" id="l00607"></a>00607                     (buf, buf_len, out_len, allow_realloc, <span class=
"stringliteral">" "</span>)
<a name="l00608" id="l00608"></a>00608                     &amp;&amp; snmp_cstrcat(buf, buf_len, out_len, allow_realloc, units));
<a name="l00609" id="l00609"></a>00609         }
<a name="l00610" id="l00610"></a>00610         <span class="keywordflow">if</span> ((*out_len &gt;= *buf_len) &amp;&amp;
<a name="l00611" id="l00611"></a>00611             !(allow_realloc &amp;&amp; <a class="code" href=
"group__util.html#g7b42d706225a788adcfeaad9b24717de" title=
"This function increase the size of the buffer pointed at by *buf, which is initially...">snmp_realloc</a>(buf, buf_len))) {
<a name="l00612" id="l00612"></a>00612             <span class="keywordflow">return</span> 0;
<a name="l00613" id="l00613"></a>00613         }
<a name="l00614" id="l00614"></a>00614         *(*buf + *out_len) = <span class="charliteral">'\0'</span>;
<a name="l00615" id="l00615"></a>00615 
<a name="l00616" id="l00616"></a>00616         <span class="keywordflow">return</span> 1;
<a name="l00617" id="l00617"></a>00617     }
<a name="l00618" id="l00618"></a>00618 
<a name="l00619" id=
"l00619"></a>00619     output_format = netsnmp_ds_get_int(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_STRING_OUTPUT_FORMAT);
<a name="l00620" id="l00620"></a>00620     <span class="keywordflow">if</span> (0 == output_format) {
<a name="l00621" id="l00621"></a>00621         output_format = NETSNMP_STRING_OUTPUT_GUESS;
<a name="l00622" id="l00622"></a>00622     }
<a name="l00623" id="l00623"></a>00623     <span class="keywordflow">switch</span> (output_format) {
<a name="l00624" id="l00624"></a>00624     <span class="keywordflow">case</span> NETSNMP_STRING_OUTPUT_GUESS:
<a name="l00625" id="l00625"></a>00625         hex = 0;
<a name="l00626" id="l00626"></a>00626         <span class="keywordflow">for</span> (cp = var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title=
"value of variable">val</a>.string, x = 0; x &lt; (<span class="keywordtype">int</span>) var-&gt;<a class="code" href=
"structvariable__list.html#17aaa6b445178fc39aba69642247d3e9" title=
"the length of the value to be copied into buf">val_len</a>; x++, cp++) {
<a name="l00627" id="l00627"></a>00627             <span class="keywordflow">if</span> (!isprint(*cp) &amp;&amp; !isspace(*cp)) {
<a name="l00628" id="l00628"></a>00628                 hex = 1;
<a name="l00629" id="l00629"></a>00629             }
<a name="l00630" id="l00630"></a>00630         }
<a name="l00631" id="l00631"></a>00631         <span class="keywordflow">break</span>;
<a name="l00632" id="l00632"></a>00632 
<a name="l00633" id="l00633"></a>00633     <span class="keywordflow">case</span> NETSNMP_STRING_OUTPUT_ASCII:
<a name="l00634" id="l00634"></a>00634         hex = 0;
<a name="l00635" id="l00635"></a>00635         <span class="keywordflow">break</span>;
<a name="l00636" id="l00636"></a>00636 
<a name="l00637" id="l00637"></a>00637     <span class="keywordflow">case</span> NETSNMP_STRING_OUTPUT_HEX:
<a name="l00638" id="l00638"></a>00638         hex = 1;
<a name="l00639" id="l00639"></a>00639         <span class="keywordflow">break</span>;
<a name="l00640" id="l00640"></a>00640     }
<a name="l00641" id="l00641"></a>00641 
<a name="l00642" id="l00642"></a>00642     <span class="keywordflow">if</span> (var-&gt;<a class="code" href=
"structvariable__list.html#17aaa6b445178fc39aba69642247d3e9" title=
"the length of the value to be copied into buf">val_len</a> == 0) {
<a name="l00643" id="l00643"></a>00643         <span class=
"keywordflow">return</span> snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class="stringliteral">"\"\""</span>);
<a name="l00644" id="l00644"></a>00644     }
<a name="l00645" id="l00645"></a>00645 
<a name="l00646" id="l00646"></a>00646     <span class="keywordflow">if</span> (hex) {
<a name="l00647" id="l00647"></a>00647         <span class=
"keywordflow">if</span> (netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICK_PRINT)) {
<a name="l00648" id="l00648"></a>00648             <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class="stringliteral">"\""</span>)) {
<a name="l00649" id="l00649"></a>00649                 <span class="keywordflow">return</span> 0;
<a name="l00650" id="l00650"></a>00650             }
<a name="l00651" id="l00651"></a>00651         } <span class="keywordflow">else</span> {
<a name="l00652" id="l00652"></a>00652             <span class="keywordflow">if</span> (!snmp_cstrcat
<a name="l00653" id="l00653"></a>00653                 (buf, buf_len, out_len, allow_realloc, <span class=
"stringliteral">"Hex-STRING: "</span>)) {
<a name="l00654" id="l00654"></a>00654                 <span class="keywordflow">return</span> 0;
<a name="l00655" id="l00655"></a>00655             }
<a name="l00656" id="l00656"></a>00656         }
<a name="l00657" id="l00657"></a>00657 
<a name="l00658" id="l00658"></a>00658         <span class=
"keywordflow">if</span> (!sprint_realloc_hexstring(buf, buf_len, out_len, allow_realloc,
<a name="l00659" id="l00659"></a>00659                                       var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.string, var-&gt;<a class="code"
href="structvariable__list.html#17aaa6b445178fc39aba69642247d3e9" title=
"the length of the value to be copied into buf">val_len</a>)) {
<a name="l00660" id="l00660"></a>00660             <span class="keywordflow">return</span> 0;
<a name="l00661" id="l00661"></a>00661         }
<a name="l00662" id="l00662"></a>00662 
<a name="l00663" id="l00663"></a>00663         <span class=
"keywordflow">if</span> (netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICK_PRINT)) {
<a name="l00664" id="l00664"></a>00664             <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class="stringliteral">"\""</span>)) {
<a name="l00665" id="l00665"></a>00665                 <span class="keywordflow">return</span> 0;
<a name="l00666" id="l00666"></a>00666             }
<a name="l00667" id="l00667"></a>00667         }
<a name="l00668" id="l00668"></a>00668     } <span class="keywordflow">else</span> {
<a name="l00669" id="l00669"></a>00669         <span class=
"keywordflow">if</span> (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICK_PRINT)) {
<a name="l00670" id="l00670"></a>00670             <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc,
<a name="l00671" id="l00671"></a>00671                              <span class="stringliteral">"STRING: "</span>)) {
<a name="l00672" id="l00672"></a>00672                 <span class="keywordflow">return</span> 0;
<a name="l00673" id="l00673"></a>00673             }
<a name="l00674" id="l00674"></a>00674         }
<a name="l00675" id="l00675"></a>00675         <span class="keywordflow">if</span> (!snmp_cstrcat
<a name="l00676" id="l00676"></a>00676             (buf, buf_len, out_len, allow_realloc, <span class=
"stringliteral">"\""</span>)) {
<a name="l00677" id="l00677"></a>00677             <span class="keywordflow">return</span> 0;
<a name="l00678" id="l00678"></a>00678         }
<a name="l00679" id="l00679"></a>00679         <span class="keywordflow">if</span> (!<a class="code" href=
"group__mib__utilities.html#g7ff1971fc340b2789d48895086bf3230" title=
"Prints an ascii string into a buffer.">sprint_realloc_asciistring</a>
<a name="l00680" id="l00680"></a>00680             (buf, buf_len, out_len, allow_realloc, var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.string,
<a name="l00681" id="l00681"></a>00681              var-&gt;<a class="code" href=
"structvariable__list.html#17aaa6b445178fc39aba69642247d3e9" title=
"the length of the value to be copied into buf">val_len</a>)) {
<a name="l00682" id="l00682"></a>00682             <span class="keywordflow">return</span> 0;
<a name="l00683" id="l00683"></a>00683         }
<a name="l00684" id="l00684"></a>00684         <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class="stringliteral">"\""</span>)) {
<a name="l00685" id="l00685"></a>00685             <span class="keywordflow">return</span> 0;
<a name="l00686" id="l00686"></a>00686         }
<a name="l00687" id="l00687"></a>00687     }
<a name="l00688" id="l00688"></a>00688 
<a name="l00689" id="l00689"></a>00689     <span class="keywordflow">if</span> (units) {
<a name="l00690" id="l00690"></a>00690         <span class=
"keywordflow">return</span> (snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class="stringliteral">" "</span>)
<a name="l00691" id="l00691"></a>00691                 &amp;&amp; snmp_cstrcat(buf, buf_len, out_len, allow_realloc, units));
<a name="l00692" id="l00692"></a>00692     }
<a name="l00693" id="l00693"></a>00693     <span class="keywordflow">return</span> 1;
<a name="l00694" id="l00694"></a>00694 }
<a name="l00695" id="l00695"></a>00695 
<a name="l00696" id="l00696"></a>00696 <span class="preprocessor">#ifdef NETSNMP_WITH_OPAQUE_SPECIAL_TYPES</span>
<a name="l00697" id="l00697"></a>00697 
<a name="l00720" id="l00720"></a>00720 <span class="keywordtype">int</span>
<a name="l00721" id="l00721"></a>00721 sprint_realloc_float(u_char ** buf, <span class="keywordtype">size_t</span> * buf_len,
<a name="l00722" id="l00722"></a>00722                      <span class="keywordtype">size_t</span> * out_len, <span class=
"keywordtype">int</span> allow_realloc,
<a name="l00723" id="l00723"></a>00723                      <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var,
<a name="l00724" id="l00724"></a>00724                      <span class="keyword">const</span> <span class=
"keyword">struct</span> enum_list *enums,
<a name="l00725" id="l00725"></a>00725                      <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *units)
<a name="l00726" id="l00726"></a>00726 {
<a name="l00727" id="l00727"></a>00727     <span class="keywordflow">if</span> ((var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title=
"ASN type of variable.">type</a> != ASN_OPAQUE_FLOAT) &amp;&amp;
<a name="l00728" id="l00728"></a>00728         (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICKE_PRINT))) {
<a name="l00729" id="l00729"></a>00729         <span class=
"keywordflow">if</span> (snmp_cstrcat(buf, buf_len, out_len, allow_realloc, 
<a name="l00730" id="l00730"></a>00730                          <span class=
"stringliteral">"Wrong Type (should be Float): "</span>)) {
<a name="l00731" id="l00731"></a>00731             <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#gabc12c361abdca75234c11dccb34871b" title=
"Universal print routine, prints a variable into a buffer according to the variable...">sprint_realloc_by_type</a>(buf, buf_len, out_len,
<a name="l00732" id="l00732"></a>00732                                           allow_realloc, var, NULL, NULL,
<a name="l00733" id="l00733"></a>00733                                           NULL);
<a name="l00734" id="l00734"></a>00734         } <span class="keywordflow">else</span> {
<a name="l00735" id="l00735"></a>00735             <span class="keywordflow">return</span> 0;
<a name="l00736" id="l00736"></a>00736         }
<a name="l00737" id="l00737"></a>00737     }
<a name="l00738" id="l00738"></a>00738 
<a name="l00739" id="l00739"></a>00739     <span class=
"keywordflow">if</span> (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICK_PRINT)) {
<a name="l00740" id="l00740"></a>00740         <span class="keywordflow">if</span> (!snmp_cstrcat
<a name="l00741" id="l00741"></a>00741             (buf, buf_len, out_len, allow_realloc, <span class=
"stringliteral">"Opaque: Float: "</span>)) {
<a name="l00742" id="l00742"></a>00742             <span class="keywordflow">return</span> 0;
<a name="l00743" id="l00743"></a>00743         }
<a name="l00744" id="l00744"></a>00744     }
<a name="l00745" id="l00745"></a>00745 
<a name="l00746" id="l00746"></a>00746 
<a name="l00747" id="l00747"></a>00747     <span class="comment">/*</span>
<a name="l00748" id="l00748"></a>00748 <span class=
"comment">     * How much space needed for max. length float?  128 is overkill.  </span>
<a name="l00749" id="l00749"></a>00749 <span class="comment">     */</span>
<a name="l00750" id="l00750"></a>00750 
<a name="l00751" id="l00751"></a>00751     <span class="keywordflow">while</span> ((*out_len + 128 + 1) &gt;= *buf_len) {
<a name="l00752" id="l00752"></a>00752         <span class="keywordflow">if</span> (!(allow_realloc &amp;&amp; <a class="code"
href="group__util.html#g7b42d706225a788adcfeaad9b24717de" title=
"This function increase the size of the buffer pointed at by *buf, which is initially...">snmp_realloc</a>(buf, buf_len))) {
<a name="l00753" id="l00753"></a>00753             <span class="keywordflow">return</span> 0;
<a name="l00754" id="l00754"></a>00754         }
<a name="l00755" id="l00755"></a>00755     }
<a name="l00756" id="l00756"></a>00756 
<a name="l00757" id="l00757"></a>00757     sprintf((<span class="keywordtype">char</span> *) (*buf + *out_len), <span class=
"stringliteral">"%f"</span>, *var-&gt;<a class="code" href="structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title=
"value of variable">val</a>.floatVal);
<a name="l00758" id="l00758"></a>00758     *out_len += strlen((<span class="keywordtype">char</span> *) (*buf + *out_len));
<a name="l00759" id="l00759"></a>00759 
<a name="l00760" id="l00760"></a>00760     <span class="keywordflow">if</span> (units) {
<a name="l00761" id="l00761"></a>00761         <span class=
"keywordflow">return</span> (snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class="stringliteral">" "</span>)
<a name="l00762" id="l00762"></a>00762                 &amp;&amp; snmp_cstrcat(buf, buf_len, out_len, allow_realloc, units));
<a name="l00763" id="l00763"></a>00763     }
<a name="l00764" id="l00764"></a>00764     <span class="keywordflow">return</span> 1;
<a name="l00765" id="l00765"></a>00765 }
<a name="l00766" id="l00766"></a>00766 
<a name="l00767" id="l00767"></a>00767 
<a name="l00790" id="l00790"></a>00790 <span class="keywordtype">int</span>
<a name="l00791" id="l00791"></a>00791 sprint_realloc_double(u_char ** buf, <span class="keywordtype">size_t</span> * buf_len,
<a name="l00792" id="l00792"></a>00792                       <span class="keywordtype">size_t</span> * out_len, <span class=
"keywordtype">int</span> allow_realloc,
<a name="l00793" id="l00793"></a>00793                       <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var,
<a name="l00794" id="l00794"></a>00794                       <span class="keyword">const</span> <span class=
"keyword">struct</span> enum_list *enums,
<a name="l00795" id="l00795"></a>00795                       <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *units)
<a name="l00796" id="l00796"></a>00796 {
<a name="l00797" id="l00797"></a>00797     <span class="keywordflow">if</span> ((var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title=
"ASN type of variable.">type</a> != ASN_OPAQUE_DOUBLE) &amp;&amp; 
<a name="l00798" id="l00798"></a>00798         (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICKE_PRINT))) {
<a name="l00799" id="l00799"></a>00799         <span class="keywordflow">if</span> (snmp_cstrcat
<a name="l00800" id="l00800"></a>00800             (buf, buf_len, out_len, allow_realloc, 
<a name="l00801" id="l00801"></a>00801              <span class="stringliteral">"Wrong Type (should be Double): "</span>)) {
<a name="l00802" id="l00802"></a>00802             <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#gabc12c361abdca75234c11dccb34871b" title=
"Universal print routine, prints a variable into a buffer according to the variable...">sprint_realloc_by_type</a>(buf, buf_len, out_len,
<a name="l00803" id="l00803"></a>00803                                           allow_realloc, var, NULL, NULL,
<a name="l00804" id="l00804"></a>00804                                           NULL);
<a name="l00805" id="l00805"></a>00805         } <span class="keywordflow">else</span> {
<a name="l00806" id="l00806"></a>00806             <span class="keywordflow">return</span> 0;
<a name="l00807" id="l00807"></a>00807         }
<a name="l00808" id="l00808"></a>00808     }
<a name="l00809" id="l00809"></a>00809 
<a name="l00810" id="l00810"></a>00810     <span class=
"keywordflow">if</span> (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICK_PRINT)) {
<a name="l00811" id="l00811"></a>00811         <span class="keywordflow">if</span> (!snmp_cstrcat
<a name="l00812" id="l00812"></a>00812             (buf, buf_len, out_len, allow_realloc, <span class=
"stringliteral">"Opaque: Float: "</span>)) {
<a name="l00813" id="l00813"></a>00813             <span class="keywordflow">return</span> 0;
<a name="l00814" id="l00814"></a>00814         }
<a name="l00815" id="l00815"></a>00815     }
<a name="l00816" id="l00816"></a>00816 
<a name="l00817" id="l00817"></a>00817     <span class="comment">/*</span>
<a name="l00818" id="l00818"></a>00818 <span class=
"comment">     * How much space needed for max. length double?  128 is overkill.  </span>
<a name="l00819" id="l00819"></a>00819 <span class="comment">     */</span>
<a name="l00820" id="l00820"></a>00820 
<a name="l00821" id="l00821"></a>00821     <span class="keywordflow">while</span> ((*out_len + 128 + 1) &gt;= *buf_len) {
<a name="l00822" id="l00822"></a>00822         <span class="keywordflow">if</span> (!(allow_realloc &amp;&amp; <a class="code"
href="group__util.html#g7b42d706225a788adcfeaad9b24717de" title=
"This function increase the size of the buffer pointed at by *buf, which is initially...">snmp_realloc</a>(buf, buf_len))) {
<a name="l00823" id="l00823"></a>00823             <span class="keywordflow">return</span> 0;
<a name="l00824" id="l00824"></a>00824         }
<a name="l00825" id="l00825"></a>00825     }
<a name="l00826" id="l00826"></a>00826 
<a name="l00827" id="l00827"></a>00827     sprintf((<span class="keywordtype">char</span> *) (*buf + *out_len), <span class=
"stringliteral">"%f"</span>, *var-&gt;<a class="code" href="structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title=
"value of variable">val</a>.doubleVal);
<a name="l00828" id="l00828"></a>00828     *out_len += strlen((<span class="keywordtype">char</span> *) (*buf + *out_len));
<a name="l00829" id="l00829"></a>00829 
<a name="l00830" id="l00830"></a>00830     <span class="keywordflow">if</span> (units) {
<a name="l00831" id="l00831"></a>00831         <span class="keywordflow">return</span> (snmp_cstrcat
<a name="l00832" id="l00832"></a>00832                 (buf, buf_len, out_len, allow_realloc, <span class=
"stringliteral">" "</span>)
<a name="l00833" id="l00833"></a>00833                 &amp;&amp; snmp_cstrcat(buf, buf_len, out_len, allow_realloc, units));
<a name="l00834" id="l00834"></a>00834     }
<a name="l00835" id="l00835"></a>00835     <span class="keywordflow">return</span> 1;
<a name="l00836" id="l00836"></a>00836 }
<a name="l00837" id="l00837"></a>00837 
<a name="l00838" id="l00838"></a>00838 <span class="preprocessor">#endif                          </span><span class=
"comment">/* NETSNMP_WITH_OPAQUE_SPECIAL_TYPES */</span>
<a name="l00839" id="l00839"></a>00839 
<a name="l00840" id="l00840"></a>00840 
<a name="l00863" id="l00863"></a>00863 <span class="keywordtype">int</span>
<a name="l00864" id="l00864"></a><a class="code" href=
"group__mib__utilities.html#g911270821df5b87de7a97dc5deb8f485">00864</a> <a class="code" href=
"group__mib__utilities.html#g911270821df5b87de7a97dc5deb8f485" title=
"Prints a counter into a buffer.">sprint_realloc_counter64</a>(u_char ** buf, <span class=
"keywordtype">size_t</span> * buf_len, <span class="keywordtype">size_t</span> * out_len,
<a name="l00865" id="l00865"></a>00865                          <span class="keywordtype">int</span> allow_realloc,
<a name="l00866" id="l00866"></a>00866                          <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var,
<a name="l00867" id="l00867"></a>00867                          <span class="keyword">const</span> <span class=
"keyword">struct</span> enum_list *enums,
<a name="l00868" id="l00868"></a>00868                          <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *units)
<a name="l00869" id="l00869"></a>00869 {
<a name="l00870" id="l00870"></a>00870     <span class="keywordtype">char</span>            a64buf[I64CHARSZ + 1];
<a name="l00871" id="l00871"></a>00871 
<a name="l00872" id="l00872"></a>00872     <span class="keywordflow">if</span> ((var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a> != ASN_COUNTER64
<a name="l00873" id="l00873"></a>00873 #ifdef NETSNMP_WITH_OPAQUE_SPECIAL_TYPES
<a name="l00874" id="l00874"></a>00874         &amp;&amp; var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a> != ASN_OPAQUE_COUNTER64
<a name="l00875" id="l00875"></a>00875         &amp;&amp; var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title=
"ASN type of variable.">type</a> != ASN_OPAQUE_I64 &amp;&amp; var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a> != ASN_OPAQUE_U64
<a name="l00876" id="l00876"></a>00876 #endif
<a name="l00877" id=
"l00877"></a>00877         ) &amp;&amp; (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICKE_PRINT))) {
<a name="l00878" id="l00878"></a>00878         <span class=
"keywordflow">if</span> (snmp_cstrcat(buf, buf_len, out_len, allow_realloc, 
<a name="l00879" id="l00879"></a>00879                         <span class=
"stringliteral">"Wrong Type (should be Counter64): "</span>)) {
<a name="l00880" id="l00880"></a>00880             <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#gabc12c361abdca75234c11dccb34871b" title=
"Universal print routine, prints a variable into a buffer according to the variable...">sprint_realloc_by_type</a>(buf, buf_len, out_len,
<a name="l00881" id="l00881"></a>00881                                           allow_realloc, var, NULL, NULL,
<a name="l00882" id="l00882"></a>00882                                           NULL);
<a name="l00883" id="l00883"></a>00883         } <span class="keywordflow">else</span> {
<a name="l00884" id="l00884"></a>00884             <span class="keywordflow">return</span> 0;
<a name="l00885" id="l00885"></a>00885         }
<a name="l00886" id="l00886"></a>00886     }
<a name="l00887" id="l00887"></a>00887 
<a name="l00888" id="l00888"></a>00888     <span class=
"keywordflow">if</span> (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICK_PRINT)) {
<a name="l00889" id="l00889"></a>00889 <span class="preprocessor">#ifdef NETSNMP_WITH_OPAQUE_SPECIAL_TYPES</span>
<a name="l00890" id="l00890"></a>00890         <span class="keywordflow">if</span> (var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a> != ASN_COUNTER64) {
<a name="l00891" id="l00891"></a>00891             <span class="keywordflow">if</span> (!snmp_cstrcat
<a name="l00892" id="l00892"></a>00892                 (buf, buf_len, out_len, allow_realloc, <span class=
"stringliteral">"Opaque: "</span>)) {
<a name="l00893" id="l00893"></a>00893                 <span class="keywordflow">return</span> 0;
<a name="l00894" id="l00894"></a>00894             }
<a name="l00895" id="l00895"></a>00895         }
<a name="l00896" id="l00896"></a>00896 <span class="preprocessor">#endif</span>
<a name="l00897" id="l00897"></a>00897 <span class="preprocessor">#ifdef NETSNMP_WITH_OPAQUE_SPECIAL_TYPES</span>
<a name="l00898" id="l00898"></a>00898         <span class="keywordflow">switch</span> (var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a>) {
<a name="l00899" id="l00899"></a>00899         <span class="keywordflow">case</span> ASN_OPAQUE_U64:
<a name="l00900" id="l00900"></a>00900             <span class="keywordflow">if</span> (!snmp_cstrcat
<a name="l00901" id="l00901"></a>00901                 (buf, buf_len, out_len, allow_realloc, <span class=
"stringliteral">"UInt64: "</span>)) {
<a name="l00902" id="l00902"></a>00902                 <span class="keywordflow">return</span> 0;
<a name="l00903" id="l00903"></a>00903             }
<a name="l00904" id="l00904"></a>00904             <span class="keywordflow">break</span>;
<a name="l00905" id="l00905"></a>00905         <span class="keywordflow">case</span> ASN_OPAQUE_I64:
<a name="l00906" id="l00906"></a>00906             <span class="keywordflow">if</span> (!snmp_cstrcat
<a name="l00907" id="l00907"></a>00907                 (buf, buf_len, out_len, allow_realloc, <span class=
"stringliteral">"Int64: "</span>)) {
<a name="l00908" id="l00908"></a>00908                 <span class="keywordflow">return</span> 0;
<a name="l00909" id="l00909"></a>00909             }
<a name="l00910" id="l00910"></a>00910             <span class="keywordflow">break</span>;
<a name="l00911" id="l00911"></a>00911         <span class="keywordflow">case</span> ASN_COUNTER64:
<a name="l00912" id="l00912"></a>00912         <span class="keywordflow">case</span> ASN_OPAQUE_COUNTER64:
<a name="l00913" id="l00913"></a>00913 <span class="preprocessor">#endif</span>
<a name="l00914" id="l00914"></a>00914             <span class="keywordflow">if</span> (!snmp_cstrcat
<a name="l00915" id="l00915"></a>00915                 (buf, buf_len, out_len, allow_realloc, <span class=
"stringliteral">"Counter64: "</span>)) {
<a name="l00916" id="l00916"></a>00916                 <span class="keywordflow">return</span> 0;
<a name="l00917" id="l00917"></a>00917             }
<a name="l00918" id="l00918"></a>00918 <span class="preprocessor">#ifdef NETSNMP_WITH_OPAQUE_SPECIAL_TYPES</span>
<a name="l00919" id="l00919"></a>00919         }
<a name="l00920" id="l00920"></a>00920 <span class="preprocessor">#endif</span>
<a name="l00921" id="l00921"></a>00921     }
<a name="l00922" id="l00922"></a>00922 <span class="preprocessor">#ifdef NETSNMP_WITH_OPAQUE_SPECIAL_TYPES</span>
<a name="l00923" id="l00923"></a>00923     <span class="keywordflow">if</span> (var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a> == ASN_OPAQUE_I64) {
<a name="l00924" id="l00924"></a>00924         printI64(a64buf, var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.counter64);
<a name="l00925" id="l00925"></a>00925         <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, a64buf)) {
<a name="l00926" id="l00926"></a>00926             <span class="keywordflow">return</span> 0;
<a name="l00927" id="l00927"></a>00927         }
<a name="l00928" id="l00928"></a>00928     } <span class="keywordflow">else</span> {
<a name="l00929" id="l00929"></a>00929 <span class="preprocessor">#endif</span>
<a name="l00930" id="l00930"></a>00930         printU64(a64buf, var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.counter64);
<a name="l00931" id="l00931"></a>00931         <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, a64buf)) {
<a name="l00932" id="l00932"></a>00932             <span class="keywordflow">return</span> 0;
<a name="l00933" id="l00933"></a>00933         }
<a name="l00934" id="l00934"></a>00934 <span class="preprocessor">#ifdef NETSNMP_WITH_OPAQUE_SPECIAL_TYPES</span>
<a name="l00935" id="l00935"></a>00935     }
<a name="l00936" id="l00936"></a>00936 <span class="preprocessor">#endif</span>
<a name="l00937" id="l00937"></a>00937 
<a name="l00938" id="l00938"></a>00938     <span class="keywordflow">if</span> (units) {
<a name="l00939" id="l00939"></a>00939         <span class=
"keywordflow">return</span> (snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class="stringliteral">" "</span>)
<a name="l00940" id="l00940"></a>00940                 &amp;&amp; snmp_cstrcat(buf, buf_len, out_len, allow_realloc, units));
<a name="l00941" id="l00941"></a>00941     }
<a name="l00942" id="l00942"></a>00942     <span class="keywordflow">return</span> 1;
<a name="l00943" id="l00943"></a>00943 }
<a name="l00944" id="l00944"></a>00944 
<a name="l00945" id="l00945"></a>00945 
<a name="l00966" id="l00966"></a>00966 <span class="keywordtype">int</span>
<a name="l00967" id="l00967"></a><a class="code" href=
"group__mib__utilities.html#g0e42660c74b91d68e088b53e41ba6658">00967</a> <a class="code" href=
"group__mib__utilities.html#g0e42660c74b91d68e088b53e41ba6658" title=
"Prints an object identifier into a buffer.">sprint_realloc_opaque</a>(u_char ** buf, <span class=
"keywordtype">size_t</span> * buf_len,
<a name="l00968" id="l00968"></a>00968                       <span class="keywordtype">size_t</span> * out_len, <span class=
"keywordtype">int</span> allow_realloc,
<a name="l00969" id="l00969"></a>00969                       <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var,
<a name="l00970" id="l00970"></a>00970                       <span class="keyword">const</span> <span class=
"keyword">struct</span> enum_list *enums,
<a name="l00971" id="l00971"></a>00971                       <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *units)
<a name="l00972" id="l00972"></a>00972 {
<a name="l00973" id="l00973"></a>00973     <span class="keywordflow">if</span> ((var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a> != ASN_OPAQUE
<a name="l00974" id="l00974"></a>00974 #ifdef NETSNMP_WITH_OPAQUE_SPECIAL_TYPES
<a name="l00975" id="l00975"></a>00975         &amp;&amp; var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a> != ASN_OPAQUE_COUNTER64
<a name="l00976" id="l00976"></a>00976         &amp;&amp; var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a> != ASN_OPAQUE_U64
<a name="l00977" id="l00977"></a>00977         &amp;&amp; var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a> != ASN_OPAQUE_I64
<a name="l00978" id="l00978"></a>00978         &amp;&amp; var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title=
"ASN type of variable.">type</a> != ASN_OPAQUE_FLOAT &amp;&amp; var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a> != ASN_OPAQUE_DOUBLE
<a name="l00979" id="l00979"></a>00979 #endif                          <span class=
"comment">/* NETSNMP_WITH_OPAQUE_SPECIAL_TYPES */</span>
<a name="l00980" id=
"l00980"></a>00980         ) &amp;&amp; (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICKE_PRINT))) {
<a name="l00981" id="l00981"></a>00981         <span class=
"keywordflow">if</span> (snmp_cstrcat(buf, buf_len, out_len, allow_realloc, 
<a name="l00982" id="l00982"></a>00982                          <span class=
"stringliteral">"Wrong Type (should be Opaque): "</span>)) {
<a name="l00983" id="l00983"></a>00983             <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#gabc12c361abdca75234c11dccb34871b" title=
"Universal print routine, prints a variable into a buffer according to the variable...">sprint_realloc_by_type</a>(buf, buf_len, out_len,
<a name="l00984" id="l00984"></a>00984                                           allow_realloc, var, NULL, NULL,
<a name="l00985" id="l00985"></a>00985                                           NULL);
<a name="l00986" id="l00986"></a>00986         } <span class="keywordflow">else</span> {
<a name="l00987" id="l00987"></a>00987             <span class="keywordflow">return</span> 0;
<a name="l00988" id="l00988"></a>00988         }
<a name="l00989" id="l00989"></a>00989     }
<a name="l00990" id="l00990"></a>00990 <span class="preprocessor">#ifdef NETSNMP_WITH_OPAQUE_SPECIAL_TYPES</span>
<a name="l00991" id="l00991"></a>00991     <span class="keywordflow">switch</span> (var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a>) {
<a name="l00992" id="l00992"></a>00992     <span class="keywordflow">case</span> ASN_OPAQUE_COUNTER64:
<a name="l00993" id="l00993"></a>00993     <span class="keywordflow">case</span> ASN_OPAQUE_U64:
<a name="l00994" id="l00994"></a>00994     <span class="keywordflow">case</span> ASN_OPAQUE_I64:
<a name="l00995" id="l00995"></a>00995         <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#g911270821df5b87de7a97dc5deb8f485" title=
"Prints a counter into a buffer.">sprint_realloc_counter64</a>(buf, buf_len, out_len,
<a name="l00996" id="l00996"></a>00996                                         allow_realloc, var, enums, hint,
<a name="l00997" id="l00997"></a>00997                                         units);
<a name="l00998" id="l00998"></a>00998         <span class="keywordflow">break</span>;
<a name="l00999" id="l00999"></a>00999 
<a name="l01000" id="l01000"></a>01000     <span class="keywordflow">case</span> ASN_OPAQUE_FLOAT:
<a name="l01001" id="l01001"></a>01001         <span class=
"keywordflow">return</span> sprint_realloc_float(buf, buf_len, out_len, allow_realloc,
<a name="l01002" id="l01002"></a>01002                                     var, enums, hint, units);
<a name="l01003" id="l01003"></a>01003         <span class="keywordflow">break</span>;
<a name="l01004" id="l01004"></a>01004 
<a name="l01005" id="l01005"></a>01005     <span class="keywordflow">case</span> ASN_OPAQUE_DOUBLE:
<a name="l01006" id="l01006"></a>01006         <span class=
"keywordflow">return</span> sprint_realloc_double(buf, buf_len, out_len, allow_realloc,
<a name="l01007" id="l01007"></a>01007                                      var, enums, hint, units);
<a name="l01008" id="l01008"></a>01008         <span class="keywordflow">break</span>;
<a name="l01009" id="l01009"></a>01009 
<a name="l01010" id="l01010"></a>01010     <span class="keywordflow">case</span> ASN_OPAQUE:
<a name="l01011" id="l01011"></a>01011 <span class="preprocessor">#endif</span>
<a name="l01012" id="l01012"></a>01012         <span class=
"keywordflow">if</span> (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICK_PRINT)) {
<a name="l01013" id="l01013"></a>01013             u_char          str[] = <span class="stringliteral">"OPAQUE: "</span>;
<a name="l01014" id="l01014"></a>01014             <span class=
"keywordflow">if</span> (!snmp_strcat(buf, buf_len, out_len, allow_realloc, str)) {
<a name="l01015" id="l01015"></a>01015                 <span class="keywordflow">return</span> 0;
<a name="l01016" id="l01016"></a>01016             }
<a name="l01017" id="l01017"></a>01017         }
<a name="l01018" id="l01018"></a>01018         <span class=
"keywordflow">if</span> (!sprint_realloc_hexstring(buf, buf_len, out_len, allow_realloc,
<a name="l01019" id="l01019"></a>01019                                       var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.string, var-&gt;<a class="code"
href="structvariable__list.html#17aaa6b445178fc39aba69642247d3e9" title=
"the length of the value to be copied into buf">val_len</a>)) {
<a name="l01020" id="l01020"></a>01020             <span class="keywordflow">return</span> 0;
<a name="l01021" id="l01021"></a>01021         }
<a name="l01022" id="l01022"></a>01022 <span class="preprocessor">#ifdef NETSNMP_WITH_OPAQUE_SPECIAL_TYPES</span>
<a name="l01023" id="l01023"></a>01023     }
<a name="l01024" id="l01024"></a>01024 <span class="preprocessor">#endif</span>
<a name="l01025" id="l01025"></a>01025     <span class="keywordflow">if</span> (units) {
<a name="l01026" id="l01026"></a>01026         <span class="keywordflow">return</span> (snmp_strcat
<a name="l01027" id="l01027"></a>01027                 (buf, buf_len, out_len, allow_realloc,
<a name="l01028" id="l01028"></a>01028                  (<span class="keyword">const</span> u_char *) <span class=
"stringliteral">" "</span>)
<a name="l01029" id="l01029"></a>01029                 &amp;&amp; snmp_strcat(buf, buf_len, out_len, allow_realloc,
<a name="l01030" id="l01030"></a>01030                                (<span class="keyword">const</span> u_char *) units));
<a name="l01031" id="l01031"></a>01031     }
<a name="l01032" id="l01032"></a>01032     <span class="keywordflow">return</span> 1;
<a name="l01033" id="l01033"></a>01033 }
<a name="l01034" id="l01034"></a>01034 
<a name="l01035" id="l01035"></a>01035 
<a name="l01056" id="l01056"></a>01056 <span class="keywordtype">int</span>
<a name="l01057" id="l01057"></a><a class="code" href=
"group__mib__utilities.html#g58c583005d5df719f3866ff0f06ec800">01057</a> <a class="code" href=
"group__mib__utilities.html#g58c583005d5df719f3866ff0f06ec800" title=
"Prints an object identifier into a buffer.">sprint_realloc_object_identifier</a>(u_char ** buf, <span class=
"keywordtype">size_t</span> * buf_len,
<a name="l01058" id="l01058"></a>01058                                  <span class=
"keywordtype">size_t</span> * out_len, <span class="keywordtype">int</span> allow_realloc,
<a name="l01059" id="l01059"></a>01059                                  <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var,
<a name="l01060" id="l01060"></a>01060                                  <span class="keyword">const</span> <span class=
"keyword">struct</span> enum_list *enums,
<a name="l01061" id="l01061"></a>01061                                  <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *units)
<a name="l01062" id="l01062"></a>01062 {
<a name="l01063" id="l01063"></a>01063     <span class="keywordtype">int</span>             buf_overflow = 0;
<a name="l01064" id="l01064"></a>01064 
<a name="l01065" id="l01065"></a>01065     <span class="keywordflow">if</span> ((var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a> != ASN_OBJECT_ID) &amp;&amp;
<a name="l01066" id="l01066"></a>01066         (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICKE_PRINT))) {
<a name="l01067" id="l01067"></a>01067         u_char          str[] =
<a name="l01068" id="l01068"></a>01068             <span class=
"stringliteral">"Wrong Type (should be OBJECT IDENTIFIER): "</span>;
<a name="l01069" id="l01069"></a>01069         <span class=
"keywordflow">if</span> (snmp_strcat(buf, buf_len, out_len, allow_realloc, str)) {
<a name="l01070" id="l01070"></a>01070             <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#gabc12c361abdca75234c11dccb34871b" title=
"Universal print routine, prints a variable into a buffer according to the variable...">sprint_realloc_by_type</a>(buf, buf_len, out_len,
<a name="l01071" id="l01071"></a>01071                                           allow_realloc, var, NULL, NULL,
<a name="l01072" id="l01072"></a>01072                                           NULL);
<a name="l01073" id="l01073"></a>01073         } <span class="keywordflow">else</span> {
<a name="l01074" id="l01074"></a>01074             <span class="keywordflow">return</span> 0;
<a name="l01075" id="l01075"></a>01075         }
<a name="l01076" id="l01076"></a>01076     }
<a name="l01077" id="l01077"></a>01077 
<a name="l01078" id="l01078"></a>01078     <span class=
"keywordflow">if</span> (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICK_PRINT)) {
<a name="l01079" id="l01079"></a>01079         u_char          str[] = <span class="stringliteral">"OID: "</span>;
<a name="l01080" id="l01080"></a>01080         <span class=
"keywordflow">if</span> (!snmp_strcat(buf, buf_len, out_len, allow_realloc, str)) {
<a name="l01081" id="l01081"></a>01081             <span class="keywordflow">return</span> 0;
<a name="l01082" id="l01082"></a>01082         }
<a name="l01083" id="l01083"></a>01083     }
<a name="l01084" id="l01084"></a>01084 
<a name="l01085" id="l01085"></a>01085     netsnmp_sprint_realloc_objid_tree(buf, buf_len, out_len, allow_realloc,
<a name="l01086" id="l01086"></a>01086                                       &amp;buf_overflow,
<a name="l01087" id="l01087"></a>01087                                       (oid *) (var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.objid),
<a name="l01088" id="l01088"></a>01088                                       var-&gt;<a class="code" href=
"structvariable__list.html#17aaa6b445178fc39aba69642247d3e9" title=
"the length of the value to be copied into buf">val_len</a> / <span class="keyword">sizeof</span>(oid));
<a name="l01089" id="l01089"></a>01089 
<a name="l01090" id="l01090"></a>01090     <span class="keywordflow">if</span> (buf_overflow) {
<a name="l01091" id="l01091"></a>01091         <span class="keywordflow">return</span> 0;
<a name="l01092" id="l01092"></a>01092     }
<a name="l01093" id="l01093"></a>01093 
<a name="l01094" id="l01094"></a>01094     <span class="keywordflow">if</span> (units) {
<a name="l01095" id="l01095"></a>01095         <span class="keywordflow">return</span> (snmp_strcat
<a name="l01096" id="l01096"></a>01096                 (buf, buf_len, out_len, allow_realloc,
<a name="l01097" id="l01097"></a>01097                  (<span class="keyword">const</span> u_char *) <span class=
"stringliteral">" "</span>)
<a name="l01098" id="l01098"></a>01098                 &amp;&amp; snmp_strcat(buf, buf_len, out_len, allow_realloc,
<a name="l01099" id="l01099"></a>01099                                (<span class="keyword">const</span> u_char *) units));
<a name="l01100" id="l01100"></a>01100     }
<a name="l01101" id="l01101"></a>01101     <span class="keywordflow">return</span> 1;
<a name="l01102" id="l01102"></a>01102 }
<a name="l01103" id="l01103"></a>01103 
<a name="l01104" id="l01104"></a>01104 
<a name="l01105" id="l01105"></a>01105 
<a name="l01126" id="l01126"></a>01126 <span class="keywordtype">int</span>
<a name="l01127" id="l01127"></a><a class="code" href=
"group__mib__utilities.html#gd53723cfb568c73dc3b7af48985f96d2">01127</a> <a class="code" href=
"group__mib__utilities.html#gd53723cfb568c73dc3b7af48985f96d2" title=
"Prints a timetick variable into a buffer.">sprint_realloc_timeticks</a>(u_char ** buf, <span class=
"keywordtype">size_t</span> * buf_len, <span class="keywordtype">size_t</span> * out_len,
<a name="l01128" id="l01128"></a>01128                          <span class="keywordtype">int</span> allow_realloc,
<a name="l01129" id="l01129"></a>01129                          <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var,
<a name="l01130" id="l01130"></a>01130                          <span class="keyword">const</span> <span class=
"keyword">struct</span> enum_list *enums,
<a name="l01131" id="l01131"></a>01131                          <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *units)
<a name="l01132" id="l01132"></a>01132 {
<a name="l01133" id="l01133"></a>01133     <span class="keywordtype">char</span>            timebuf[40];
<a name="l01134" id="l01134"></a>01134 
<a name="l01135" id="l01135"></a>01135     <span class="keywordflow">if</span> ((var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a> != ASN_TIMETICKS) &amp;&amp; 
<a name="l01136" id="l01136"></a>01136         (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICKE_PRINT))) {
<a name="l01137" id="l01137"></a>01137         u_char          str[] = <span class=
"stringliteral">"Wrong Type (should be Timeticks): "</span>;
<a name="l01138" id="l01138"></a>01138         <span class=
"keywordflow">if</span> (snmp_strcat(buf, buf_len, out_len, allow_realloc, str)) {
<a name="l01139" id="l01139"></a>01139             <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#gabc12c361abdca75234c11dccb34871b" title=
"Universal print routine, prints a variable into a buffer according to the variable...">sprint_realloc_by_type</a>(buf, buf_len, out_len,
<a name="l01140" id="l01140"></a>01140                                           allow_realloc, var, NULL, NULL,
<a name="l01141" id="l01141"></a>01141                                           NULL);
<a name="l01142" id="l01142"></a>01142         } <span class="keywordflow">else</span> {
<a name="l01143" id="l01143"></a>01143             <span class="keywordflow">return</span> 0;
<a name="l01144" id="l01144"></a>01144         }
<a name="l01145" id="l01145"></a>01145     }
<a name="l01146" id="l01146"></a>01146 
<a name="l01147" id="l01147"></a>01147     <span class=
"keywordflow">if</span> (netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_NUMERIC_TIMETICKS)) {
<a name="l01148" id="l01148"></a>01148         <span class="keywordtype">char</span>            str[16];
<a name="l01149" id="l01149"></a>01149         sprintf(str, <span class=
"stringliteral">"%lu"</span>, *(u_long *) var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.integer);
<a name="l01150" id="l01150"></a>01150         <span class="keywordflow">if</span> (!snmp_strcat
<a name="l01151" id="l01151"></a>01151             (buf, buf_len, out_len, allow_realloc, (<span class=
"keyword">const</span> u_char *) str)) {
<a name="l01152" id="l01152"></a>01152             <span class="keywordflow">return</span> 0;
<a name="l01153" id="l01153"></a>01153         }
<a name="l01154" id="l01154"></a>01154         <span class="keywordflow">return</span> 1;
<a name="l01155" id="l01155"></a>01155     }
<a name="l01156" id="l01156"></a>01156     <span class=
"keywordflow">if</span> (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICK_PRINT)) {
<a name="l01157" id="l01157"></a>01157         <span class="keywordtype">char</span>            str[32];
<a name="l01158" id="l01158"></a>01158         sprintf(str, <span class=
"stringliteral">"Timeticks: (%lu) "</span>, *(u_long *) var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.integer);
<a name="l01159" id="l01159"></a>01159         <span class="keywordflow">if</span> (!snmp_strcat
<a name="l01160" id="l01160"></a>01160             (buf, buf_len, out_len, allow_realloc, (<span class=
"keyword">const</span> u_char *) str)) {
<a name="l01161" id="l01161"></a>01161             <span class="keywordflow">return</span> 0;
<a name="l01162" id="l01162"></a>01162         }
<a name="l01163" id="l01163"></a>01163     }
<a name="l01164" id="l01164"></a>01164     uptimeString(*(u_long *) (var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.integer), timebuf, <span class=
"keyword">sizeof</span>(timebuf));
<a name="l01165" id="l01165"></a>01165     <span class="keywordflow">if</span> (!snmp_strcat
<a name="l01166" id="l01166"></a>01166         (buf, buf_len, out_len, allow_realloc, (<span class=
"keyword">const</span> u_char *) timebuf)) {
<a name="l01167" id="l01167"></a>01167         <span class="keywordflow">return</span> 0;
<a name="l01168" id="l01168"></a>01168     }
<a name="l01169" id="l01169"></a>01169     <span class="keywordflow">if</span> (units) {
<a name="l01170" id="l01170"></a>01170         <span class="keywordflow">return</span> (snmp_strcat
<a name="l01171" id="l01171"></a>01171                 (buf, buf_len, out_len, allow_realloc,
<a name="l01172" id="l01172"></a>01172                  (<span class="keyword">const</span> u_char *) <span class=
"stringliteral">" "</span>)
<a name="l01173" id="l01173"></a>01173                 &amp;&amp; snmp_strcat(buf, buf_len, out_len, allow_realloc,
<a name="l01174" id="l01174"></a>01174                                (<span class="keyword">const</span> u_char *) units));
<a name="l01175" id="l01175"></a>01175     }
<a name="l01176" id="l01176"></a>01176     <span class="keywordflow">return</span> 1;
<a name="l01177" id="l01177"></a>01177 }
<a name="l01178" id="l01178"></a>01178 
<a name="l01179" id="l01179"></a>01179 
<a name="l01200" id="l01200"></a>01200 <span class="keywordtype">int</span>
<a name="l01201" id="l01201"></a><a class="code" href=
"group__mib__utilities.html#g810f08416e69b816e28c33ed3c447e95">01201</a> <a class="code" href=
"group__mib__utilities.html#g810f08416e69b816e28c33ed3c447e95" title=
"Prints an integer according to the hint into a buffer.">sprint_realloc_hinted_integer</a>(u_char ** buf, <span class=
"keywordtype">size_t</span> * buf_len,
<a name="l01202" id="l01202"></a>01202                               <span class=
"keywordtype">size_t</span> * out_len, <span class="keywordtype">int</span> allow_realloc,
<a name="l01203" id="l01203"></a>01203                               <span class="keywordtype">long</span> val, <span class=
"keyword">const</span> <span class="keywordtype">char</span> decimaltype,
<a name="l01204" id="l01204"></a>01204                               <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *units)
<a name="l01205" id="l01205"></a>01205 {
<a name="l01206" id="l01206"></a>01206     <span class="keywordtype">char</span>            fmt[10] = <span class=
"stringliteral">"%l@"</span>, tmp[256];
<a name="l01207" id="l01207"></a>01207     <span class="keywordtype">int</span>             shift, len;
<a name="l01208" id="l01208"></a>01208 
<a name="l01209" id="l01209"></a>01209     <span class="keywordflow">if</span> (hint[1] == <span class=
"charliteral">'-'</span>) {
<a name="l01210" id="l01210"></a>01210         shift = atoi(hint + 2);
<a name="l01211" id="l01211"></a>01211     } <span class="keywordflow">else</span> {
<a name="l01212" id="l01212"></a>01212         shift = 0;
<a name="l01213" id="l01213"></a>01213     }
<a name="l01214" id="l01214"></a>01214 
<a name="l01215" id="l01215"></a>01215     <span class="keywordflow">if</span> (hint[0] == <span class=
"charliteral">'d'</span>) {
<a name="l01216" id="l01216"></a>01216         <span class="comment">/*</span>
<a name="l01217" id="l01217"></a>01217 <span class="comment">         * We might *actually* want a 'u' here.  </span>
<a name="l01218" id="l01218"></a>01218 <span class="comment">         */</span>
<a name="l01219" id="l01219"></a>01219         fmt[2] = decimaltype;
<a name="l01220" id="l01220"></a>01220     } <span class="keywordflow">else</span> {
<a name="l01221" id="l01221"></a>01221         <span class="comment">/*</span>
<a name="l01222" id="l01222"></a>01222 <span class="comment">         * DISPLAY-HINT character is 'b', 'o', or 'x'.  </span>
<a name="l01223" id="l01223"></a>01223 <span class="comment">         */</span>
<a name="l01224" id="l01224"></a>01224         fmt[2] = hint[0];
<a name="l01225" id="l01225"></a>01225     }
<a name="l01226" id="l01226"></a>01226 
<a name="l01227" id="l01227"></a>01227     sprintf(tmp, fmt, val);
<a name="l01228" id="l01228"></a>01228     <span class="keywordflow">if</span> (shift != 0) {
<a name="l01229" id="l01229"></a>01229         len = strlen(tmp);
<a name="l01230" id="l01230"></a>01230         <span class="keywordflow">if</span> (shift &lt;= len) {
<a name="l01231" id="l01231"></a>01231             tmp[len + 1] = 0;
<a name="l01232" id="l01232"></a>01232             <span class="keywordflow">while</span> (shift--) {
<a name="l01233" id="l01233"></a>01233                 tmp[len] = tmp[len - 1];
<a name="l01234" id="l01234"></a>01234                 len--;
<a name="l01235" id="l01235"></a>01235             }
<a name="l01236" id="l01236"></a>01236             tmp[len] = <span class="charliteral">'.'</span>;
<a name="l01237" id="l01237"></a>01237         } <span class="keywordflow">else</span> {
<a name="l01238" id="l01238"></a>01238             tmp[shift + 1] = 0;
<a name="l01239" id="l01239"></a>01239             <span class="keywordflow">while</span> (shift) {
<a name="l01240" id="l01240"></a>01240                 <span class="keywordflow">if</span> (len-- &gt; 0) {
<a name="l01241" id="l01241"></a>01241                     tmp[shift] = tmp[len];
<a name="l01242" id="l01242"></a>01242                 } <span class="keywordflow">else</span> {
<a name="l01243" id="l01243"></a>01243                     tmp[shift] = <span class="charliteral">'0'</span>;
<a name="l01244" id="l01244"></a>01244                 }
<a name="l01245" id="l01245"></a>01245                 shift--;
<a name="l01246" id="l01246"></a>01246             }
<a name="l01247" id="l01247"></a>01247             tmp[0] = <span class="charliteral">'.'</span>;
<a name="l01248" id="l01248"></a>01248         }
<a name="l01249" id="l01249"></a>01249     }
<a name="l01250" id="l01250"></a>01250     <span class=
"keywordflow">return</span> snmp_strcat(buf, buf_len, out_len, allow_realloc, (u_char *)tmp);
<a name="l01251" id="l01251"></a>01251 }
<a name="l01252" id="l01252"></a>01252 
<a name="l01253" id="l01253"></a>01253 
<a name="l01274" id="l01274"></a>01274 <span class="keywordtype">int</span>
<a name="l01275" id="l01275"></a><a class="code" href=
"group__mib__utilities.html#g97e7b0a5f5da3d51d9ae32a89f901390">01275</a> <a class="code" href=
"group__mib__utilities.html#g97e7b0a5f5da3d51d9ae32a89f901390" title=
"Prints an integer into a buffer.">sprint_realloc_integer</a>(u_char ** buf, <span class=
"keywordtype">size_t</span> * buf_len, <span class="keywordtype">size_t</span> * out_len,
<a name="l01276" id="l01276"></a>01276                        <span class="keywordtype">int</span> allow_realloc,
<a name="l01277" id="l01277"></a>01277                        <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var,
<a name="l01278" id="l01278"></a>01278                        <span class="keyword">const</span> <span class=
"keyword">struct</span> enum_list *enums,
<a name="l01279" id="l01279"></a>01279                        <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *units)
<a name="l01280" id="l01280"></a>01280 {
<a name="l01281" id="l01281"></a>01281     <span class="keywordtype">char</span>           *enum_string = NULL;
<a name="l01282" id="l01282"></a>01282 
<a name="l01283" id="l01283"></a>01283     <span class="keywordflow">if</span> ((var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a> != ASN_INTEGER) &amp;&amp; 
<a name="l01284" id="l01284"></a>01284         (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICKE_PRINT))) {
<a name="l01285" id="l01285"></a>01285         u_char          str[] = <span class=
"stringliteral">"Wrong Type (should be INTEGER): "</span>;
<a name="l01286" id="l01286"></a>01286         <span class=
"keywordflow">if</span> (snmp_strcat(buf, buf_len, out_len, allow_realloc, str)) {
<a name="l01287" id="l01287"></a>01287             <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#gabc12c361abdca75234c11dccb34871b" title=
"Universal print routine, prints a variable into a buffer according to the variable...">sprint_realloc_by_type</a>(buf, buf_len, out_len,
<a name="l01288" id="l01288"></a>01288                                           allow_realloc, var, NULL, NULL,
<a name="l01289" id="l01289"></a>01289                                           NULL);
<a name="l01290" id="l01290"></a>01290         } <span class="keywordflow">else</span> {
<a name="l01291" id="l01291"></a>01291             <span class="keywordflow">return</span> 0;
<a name="l01292" id="l01292"></a>01292         }
<a name="l01293" id="l01293"></a>01293     }
<a name="l01294" id="l01294"></a>01294     <span class="keywordflow">for</span> (; enums; enums = enums-&gt;next) {
<a name="l01295" id="l01295"></a>01295         <span class="keywordflow">if</span> (enums-&gt;value == *var-&gt;<a class="code"
href="structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.integer) {
<a name="l01296" id="l01296"></a>01296             enum_string = enums-&gt;label;
<a name="l01297" id="l01297"></a>01297             <span class="keywordflow">break</span>;
<a name="l01298" id="l01298"></a>01298         }
<a name="l01299" id="l01299"></a>01299     }
<a name="l01300" id="l01300"></a>01300 
<a name="l01301" id="l01301"></a>01301     <span class=
"keywordflow">if</span> (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICK_PRINT)) {
<a name="l01302" id="l01302"></a>01302         <span class=
"keywordflow">if</span> (!snmp_strcat(buf, buf_len, out_len, allow_realloc,
<a name="l01303" id="l01303"></a>01303                          (<span class="keyword">const</span> u_char *) <span class=
"stringliteral">"INTEGER: "</span>)) {
<a name="l01304" id="l01304"></a>01304             <span class="keywordflow">return</span> 0;
<a name="l01305" id="l01305"></a>01305         }
<a name="l01306" id="l01306"></a>01306     }
<a name="l01307" id="l01307"></a>01307 
<a name="l01308" id="l01308"></a>01308     <span class="keywordflow">if</span> (enum_string == NULL ||
<a name="l01309" id=
"l01309"></a>01309         netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_PRINT_NUMERIC_ENUM)) {
<a name="l01310" id="l01310"></a>01310         <span class="keywordflow">if</span> (hint) {
<a name="l01311" id="l01311"></a>01311             <span class="keywordflow">if</span> (!(<a class="code" href=
"group__mib__utilities.html#g810f08416e69b816e28c33ed3c447e95" title=
"Prints an integer according to the hint into a buffer.">sprint_realloc_hinted_integer</a>(buf, buf_len, out_len,
<a name="l01312" id="l01312"></a>01312                                                 allow_realloc,
<a name="l01313" id="l01313"></a>01313                                                 *var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.integer, <span class=
"charliteral">'d'</span>,
<a name="l01314" id="l01314"></a>01314                                                 hint, units))) {
<a name="l01315" id="l01315"></a>01315                 <span class="keywordflow">return</span> 0;
<a name="l01316" id="l01316"></a>01316             }
<a name="l01317" id="l01317"></a>01317         } <span class="keywordflow">else</span> {
<a name="l01318" id="l01318"></a>01318             <span class="keywordtype">char</span>            str[16];
<a name="l01319" id="l01319"></a>01319             sprintf(str, <span class="stringliteral">"%ld"</span>, *var-&gt;<a class=
"code" href="structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.integer);
<a name="l01320" id="l01320"></a>01320             <span class="keywordflow">if</span> (!snmp_strcat
<a name="l01321" id="l01321"></a>01321                 (buf, buf_len, out_len, allow_realloc,
<a name="l01322" id="l01322"></a>01322                  (<span class="keyword">const</span> u_char *) str)) {
<a name="l01323" id="l01323"></a>01323                 <span class="keywordflow">return</span> 0;
<a name="l01324" id="l01324"></a>01324             }
<a name="l01325" id="l01325"></a>01325         }
<a name="l01326" id="l01326"></a>01326     } <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICK_PRINT)) {
<a name="l01327" id="l01327"></a>01327         <span class="keywordflow">if</span> (!snmp_strcat
<a name="l01328" id="l01328"></a>01328             (buf, buf_len, out_len, allow_realloc,
<a name="l01329" id="l01329"></a>01329              (<span class="keyword">const</span> u_char *) enum_string)) {
<a name="l01330" id="l01330"></a>01330             <span class="keywordflow">return</span> 0;
<a name="l01331" id="l01331"></a>01331         }
<a name="l01332" id="l01332"></a>01332     } <span class="keywordflow">else</span> {
<a name="l01333" id="l01333"></a>01333         <span class="keywordtype">char</span>            str[16];
<a name="l01334" id="l01334"></a>01334         sprintf(str, <span class="stringliteral">"(%ld)"</span>, *var-&gt;<a class="code"
href="structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.integer);
<a name="l01335" id="l01335"></a>01335         <span class="keywordflow">if</span> (!snmp_strcat
<a name="l01336" id="l01336"></a>01336             (buf, buf_len, out_len, allow_realloc,
<a name="l01337" id="l01337"></a>01337              (<span class="keyword">const</span> u_char *) enum_string)) {
<a name="l01338" id="l01338"></a>01338             <span class="keywordflow">return</span> 0;
<a name="l01339" id="l01339"></a>01339         }
<a name="l01340" id="l01340"></a>01340         <span class="keywordflow">if</span> (!snmp_strcat
<a name="l01341" id="l01341"></a>01341             (buf, buf_len, out_len, allow_realloc, (<span class=
"keyword">const</span> u_char *) str)) {
<a name="l01342" id="l01342"></a>01342             <span class="keywordflow">return</span> 0;
<a name="l01343" id="l01343"></a>01343         }
<a name="l01344" id="l01344"></a>01344     }
<a name="l01345" id="l01345"></a>01345 
<a name="l01346" id="l01346"></a>01346     <span class="keywordflow">if</span> (units) {
<a name="l01347" id="l01347"></a>01347         <span class="keywordflow">return</span> (snmp_strcat
<a name="l01348" id="l01348"></a>01348                 (buf, buf_len, out_len, allow_realloc,
<a name="l01349" id="l01349"></a>01349                  (<span class="keyword">const</span> u_char *) <span class=
"stringliteral">" "</span>)
<a name="l01350" id="l01350"></a>01350                 &amp;&amp; snmp_strcat(buf, buf_len, out_len, allow_realloc,
<a name="l01351" id="l01351"></a>01351                                (<span class="keyword">const</span> u_char *) units));
<a name="l01352" id="l01352"></a>01352     }
<a name="l01353" id="l01353"></a>01353     <span class="keywordflow">return</span> 1;
<a name="l01354" id="l01354"></a>01354 }
<a name="l01355" id="l01355"></a>01355 
<a name="l01356" id="l01356"></a>01356 
<a name="l01377" id="l01377"></a>01377 <span class="keywordtype">int</span>
<a name="l01378" id="l01378"></a><a class="code" href=
"group__mib__utilities.html#gccef8ad447c854b262acdf0c8f135084">01378</a> <a class="code" href=
"group__mib__utilities.html#gccef8ad447c854b262acdf0c8f135084" title=
"Prints an unsigned integer into a buffer.">sprint_realloc_uinteger</a>(u_char ** buf, <span class=
"keywordtype">size_t</span> * buf_len, <span class="keywordtype">size_t</span> * out_len,
<a name="l01379" id="l01379"></a>01379                         <span class="keywordtype">int</span> allow_realloc,
<a name="l01380" id="l01380"></a>01380                         <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var,
<a name="l01381" id="l01381"></a>01381                         <span class="keyword">const</span> <span class=
"keyword">struct</span> enum_list *enums,
<a name="l01382" id="l01382"></a>01382                         <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *units)
<a name="l01383" id="l01383"></a>01383 {
<a name="l01384" id="l01384"></a>01384     <span class="keywordtype">char</span>           *enum_string = NULL;
<a name="l01385" id="l01385"></a>01385 
<a name="l01386" id="l01386"></a>01386     <span class="keywordflow">if</span> ((var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a> != ASN_UINTEGER) &amp;&amp; 
<a name="l01387" id="l01387"></a>01387         (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICKE_PRINT))) {
<a name="l01388" id="l01388"></a>01388         u_char          str[] = <span class=
"stringliteral">"Wrong Type (should be UInteger32): "</span>;
<a name="l01389" id="l01389"></a>01389         <span class=
"keywordflow">if</span> (snmp_strcat(buf, buf_len, out_len, allow_realloc, str)) {
<a name="l01390" id="l01390"></a>01390             <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#gabc12c361abdca75234c11dccb34871b" title=
"Universal print routine, prints a variable into a buffer according to the variable...">sprint_realloc_by_type</a>(buf, buf_len, out_len,
<a name="l01391" id="l01391"></a>01391                                           allow_realloc, var, NULL, NULL,
<a name="l01392" id="l01392"></a>01392                                           NULL);
<a name="l01393" id="l01393"></a>01393         } <span class="keywordflow">else</span> {
<a name="l01394" id="l01394"></a>01394             <span class="keywordflow">return</span> 0;
<a name="l01395" id="l01395"></a>01395         }
<a name="l01396" id="l01396"></a>01396     }
<a name="l01397" id="l01397"></a>01397 
<a name="l01398" id="l01398"></a>01398     <span class="keywordflow">for</span> (; enums; enums = enums-&gt;next) {
<a name="l01399" id="l01399"></a>01399         <span class="keywordflow">if</span> (enums-&gt;value == *var-&gt;<a class="code"
href="structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.integer) {
<a name="l01400" id="l01400"></a>01400             enum_string = enums-&gt;label;
<a name="l01401" id="l01401"></a>01401             <span class="keywordflow">break</span>;
<a name="l01402" id="l01402"></a>01402         }
<a name="l01403" id="l01403"></a>01403     }
<a name="l01404" id="l01404"></a>01404 
<a name="l01405" id="l01405"></a>01405     <span class="keywordflow">if</span> (enum_string == NULL ||
<a name="l01406" id=
"l01406"></a>01406         netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_PRINT_NUMERIC_ENUM)) {
<a name="l01407" id="l01407"></a>01407         <span class="keywordflow">if</span> (hint) {
<a name="l01408" id="l01408"></a>01408             <span class="keywordflow">if</span> (!(<a class="code" href=
"group__mib__utilities.html#g810f08416e69b816e28c33ed3c447e95" title=
"Prints an integer according to the hint into a buffer.">sprint_realloc_hinted_integer</a>(buf, buf_len, out_len,
<a name="l01409" id="l01409"></a>01409                                                 allow_realloc,
<a name="l01410" id="l01410"></a>01410                                                 *var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.integer, <span class=
"charliteral">'u'</span>,
<a name="l01411" id="l01411"></a>01411                                                 hint, units))) {
<a name="l01412" id="l01412"></a>01412                 <span class="keywordflow">return</span> 0;
<a name="l01413" id="l01413"></a>01413             }
<a name="l01414" id="l01414"></a>01414         } <span class="keywordflow">else</span> {
<a name="l01415" id="l01415"></a>01415             <span class="keywordtype">char</span>            str[16];
<a name="l01416" id="l01416"></a>01416             sprintf(str, <span class="stringliteral">"%lu"</span>, *var-&gt;<a class=
"code" href="structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.integer);
<a name="l01417" id="l01417"></a>01417             <span class="keywordflow">if</span> (!snmp_strcat
<a name="l01418" id="l01418"></a>01418                 (buf, buf_len, out_len, allow_realloc,
<a name="l01419" id="l01419"></a>01419                  (<span class="keyword">const</span> u_char *) str)) {
<a name="l01420" id="l01420"></a>01420                 <span class="keywordflow">return</span> 0;
<a name="l01421" id="l01421"></a>01421             }
<a name="l01422" id="l01422"></a>01422         }
<a name="l01423" id="l01423"></a>01423     } <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICK_PRINT)) {
<a name="l01424" id="l01424"></a>01424         <span class="keywordflow">if</span> (!snmp_strcat
<a name="l01425" id="l01425"></a>01425             (buf, buf_len, out_len, allow_realloc,
<a name="l01426" id="l01426"></a>01426              (<span class="keyword">const</span> u_char *) enum_string)) {
<a name="l01427" id="l01427"></a>01427             <span class="keywordflow">return</span> 0;
<a name="l01428" id="l01428"></a>01428         }
<a name="l01429" id="l01429"></a>01429     } <span class="keywordflow">else</span> {
<a name="l01430" id="l01430"></a>01430         <span class="keywordtype">char</span>            str[16];
<a name="l01431" id="l01431"></a>01431         sprintf(str, <span class="stringliteral">"(%lu)"</span>, *var-&gt;<a class="code"
href="structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.integer);
<a name="l01432" id="l01432"></a>01432         <span class="keywordflow">if</span> (!snmp_strcat
<a name="l01433" id="l01433"></a>01433             (buf, buf_len, out_len, allow_realloc,
<a name="l01434" id="l01434"></a>01434              (<span class="keyword">const</span> u_char *) enum_string)) {
<a name="l01435" id="l01435"></a>01435             <span class="keywordflow">return</span> 0;
<a name="l01436" id="l01436"></a>01436         }
<a name="l01437" id="l01437"></a>01437         <span class="keywordflow">if</span> (!snmp_strcat
<a name="l01438" id="l01438"></a>01438             (buf, buf_len, out_len, allow_realloc, (<span class=
"keyword">const</span> u_char *) str)) {
<a name="l01439" id="l01439"></a>01439             <span class="keywordflow">return</span> 0;
<a name="l01440" id="l01440"></a>01440         }
<a name="l01441" id="l01441"></a>01441     }
<a name="l01442" id="l01442"></a>01442 
<a name="l01443" id="l01443"></a>01443     <span class="keywordflow">if</span> (units) {
<a name="l01444" id="l01444"></a>01444         <span class="keywordflow">return</span> (snmp_strcat
<a name="l01445" id="l01445"></a>01445                 (buf, buf_len, out_len, allow_realloc,
<a name="l01446" id="l01446"></a>01446                  (<span class="keyword">const</span> u_char *) <span class=
"stringliteral">" "</span>)
<a name="l01447" id="l01447"></a>01447                 &amp;&amp; snmp_strcat(buf, buf_len, out_len, allow_realloc,
<a name="l01448" id="l01448"></a>01448                                (<span class="keyword">const</span> u_char *) units));
<a name="l01449" id="l01449"></a>01449     }
<a name="l01450" id="l01450"></a>01450     <span class="keywordflow">return</span> 1;
<a name="l01451" id="l01451"></a>01451 }
<a name="l01452" id="l01452"></a>01452 
<a name="l01453" id="l01453"></a>01453 
<a name="l01474" id="l01474"></a>01474 <span class="keywordtype">int</span>
<a name="l01475" id="l01475"></a><a class="code" href=
"group__mib__utilities.html#gfe1758bc15693fc502e648c05f5c83f3">01475</a> <a class="code" href=
"group__mib__utilities.html#gfe1758bc15693fc502e648c05f5c83f3" title=
"Prints a gauge value into a buffer.">sprint_realloc_gauge</a>(u_char ** buf, <span class=
"keywordtype">size_t</span> * buf_len, <span class="keywordtype">size_t</span> * out_len,
<a name="l01476" id="l01476"></a>01476                      <span class="keywordtype">int</span> allow_realloc,
<a name="l01477" id="l01477"></a>01477                      <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var,
<a name="l01478" id="l01478"></a>01478                      <span class="keyword">const</span> <span class=
"keyword">struct</span> enum_list *enums,
<a name="l01479" id="l01479"></a>01479                      <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *units)
<a name="l01480" id="l01480"></a>01480 {
<a name="l01481" id="l01481"></a>01481     <span class="keywordtype">char</span>            tmp[32];
<a name="l01482" id="l01482"></a>01482 
<a name="l01483" id="l01483"></a>01483     <span class="keywordflow">if</span> ((var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a> != ASN_GAUGE) &amp;&amp; 
<a name="l01484" id="l01484"></a>01484         (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICKE_PRINT))) {
<a name="l01485" id="l01485"></a>01485         u_char          str[] =
<a name="l01486" id="l01486"></a>01486             <span class=
"stringliteral">"Wrong Type (should be Gauge32 or Unsigned32): "</span>;
<a name="l01487" id="l01487"></a>01487         <span class=
"keywordflow">if</span> (snmp_strcat(buf, buf_len, out_len, allow_realloc, str)) {
<a name="l01488" id="l01488"></a>01488             <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#gabc12c361abdca75234c11dccb34871b" title=
"Universal print routine, prints a variable into a buffer according to the variable...">sprint_realloc_by_type</a>(buf, buf_len, out_len,
<a name="l01489" id="l01489"></a>01489                                           allow_realloc, var, NULL, NULL,
<a name="l01490" id="l01490"></a>01490                                           NULL);
<a name="l01491" id="l01491"></a>01491         } <span class="keywordflow">else</span> {
<a name="l01492" id="l01492"></a>01492             <span class="keywordflow">return</span> 0;
<a name="l01493" id="l01493"></a>01493         }
<a name="l01494" id="l01494"></a>01494     }
<a name="l01495" id="l01495"></a>01495 
<a name="l01496" id="l01496"></a>01496     <span class=
"keywordflow">if</span> (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICK_PRINT)) {
<a name="l01497" id="l01497"></a>01497         u_char          str[] = <span class="stringliteral">"Gauge32: "</span>;
<a name="l01498" id="l01498"></a>01498         <span class=
"keywordflow">if</span> (!snmp_strcat(buf, buf_len, out_len, allow_realloc, str)) {
<a name="l01499" id="l01499"></a>01499             <span class="keywordflow">return</span> 0;
<a name="l01500" id="l01500"></a>01500         }
<a name="l01501" id="l01501"></a>01501     }
<a name="l01502" id="l01502"></a>01502     <span class="keywordflow">if</span> (hint) {
<a name="l01503" id="l01503"></a>01503         <span class="keywordflow">if</span> (!<a class="code" href=
"group__mib__utilities.html#g810f08416e69b816e28c33ed3c447e95" title=
"Prints an integer according to the hint into a buffer.">sprint_realloc_hinted_integer</a>(buf, buf_len, out_len,
<a name="l01504" id="l01504"></a>01504                                            allow_realloc,
<a name="l01505" id="l01505"></a>01505                                            *var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.integer, <span class=
"charliteral">'u'</span>, hint,
<a name="l01506" id="l01506"></a>01506                                            units)) {
<a name="l01507" id="l01507"></a>01507             <span class="keywordflow">return</span> 0;
<a name="l01508" id="l01508"></a>01508         }
<a name="l01509" id="l01509"></a>01509     } <span class="keywordflow">else</span> {
<a name="l01510" id="l01510"></a>01510         sprintf(tmp, <span class="stringliteral">"%lu"</span>, *var-&gt;<a class="code"
href="structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.integer);
<a name="l01511" id="l01511"></a>01511         <span class="keywordflow">if</span> (!snmp_strcat
<a name="l01512" id="l01512"></a>01512             (buf, buf_len, out_len, allow_realloc, (<span class=
"keyword">const</span> u_char *) tmp)) {
<a name="l01513" id="l01513"></a>01513             <span class="keywordflow">return</span> 0;
<a name="l01514" id="l01514"></a>01514         }
<a name="l01515" id="l01515"></a>01515     }
<a name="l01516" id="l01516"></a>01516     <span class="keywordflow">if</span> (units) {
<a name="l01517" id="l01517"></a>01517         <span class="keywordflow">return</span> (snmp_strcat
<a name="l01518" id="l01518"></a>01518                 (buf, buf_len, out_len, allow_realloc,
<a name="l01519" id="l01519"></a>01519                  (<span class="keyword">const</span> u_char *) <span class=
"stringliteral">" "</span>)
<a name="l01520" id="l01520"></a>01520                 &amp;&amp; snmp_strcat(buf, buf_len, out_len, allow_realloc,
<a name="l01521" id="l01521"></a>01521                                (<span class="keyword">const</span> u_char *) units));
<a name="l01522" id="l01522"></a>01522     }
<a name="l01523" id="l01523"></a>01523     <span class="keywordflow">return</span> 1;
<a name="l01524" id="l01524"></a>01524 }
<a name="l01525" id="l01525"></a>01525 
<a name="l01526" id="l01526"></a>01526 
<a name="l01547" id="l01547"></a>01547 <span class="keywordtype">int</span>
<a name="l01548" id="l01548"></a><a class="code" href=
"group__mib__utilities.html#gac841b689bafe52506f128201d57c51b">01548</a> <a class="code" href=
"group__mib__utilities.html#gac841b689bafe52506f128201d57c51b" title=
"Prints a counter value into a buffer.">sprint_realloc_counter</a>(u_char ** buf, <span class=
"keywordtype">size_t</span> * buf_len, <span class="keywordtype">size_t</span> * out_len,
<a name="l01549" id="l01549"></a>01549                        <span class="keywordtype">int</span> allow_realloc,
<a name="l01550" id="l01550"></a>01550                        <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var,
<a name="l01551" id="l01551"></a>01551                        <span class="keyword">const</span> <span class=
"keyword">struct</span> enum_list *enums,
<a name="l01552" id="l01552"></a>01552                        <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *units)
<a name="l01553" id="l01553"></a>01553 {
<a name="l01554" id="l01554"></a>01554     <span class="keywordtype">char</span>            tmp[32];
<a name="l01555" id="l01555"></a>01555 
<a name="l01556" id="l01556"></a>01556     <span class="keywordflow">if</span> ((var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a> != ASN_COUNTER) &amp;&amp; 
<a name="l01557" id="l01557"></a>01557         (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICKE_PRINT))) {
<a name="l01558" id="l01558"></a>01558         u_char          str[] = <span class=
"stringliteral">"Wrong Type (should be Counter32): "</span>;
<a name="l01559" id="l01559"></a>01559         <span class=
"keywordflow">if</span> (snmp_strcat(buf, buf_len, out_len, allow_realloc, str)) {
<a name="l01560" id="l01560"></a>01560             <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#gabc12c361abdca75234c11dccb34871b" title=
"Universal print routine, prints a variable into a buffer according to the variable...">sprint_realloc_by_type</a>(buf, buf_len, out_len,
<a name="l01561" id="l01561"></a>01561                                           allow_realloc, var, NULL, NULL,
<a name="l01562" id="l01562"></a>01562                                           NULL);
<a name="l01563" id="l01563"></a>01563         } <span class="keywordflow">else</span> {
<a name="l01564" id="l01564"></a>01564             <span class="keywordflow">return</span> 0;
<a name="l01565" id="l01565"></a>01565         }
<a name="l01566" id="l01566"></a>01566     }
<a name="l01567" id="l01567"></a>01567 
<a name="l01568" id="l01568"></a>01568     <span class=
"keywordflow">if</span> (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICK_PRINT)) {
<a name="l01569" id="l01569"></a>01569         u_char          str[] = <span class="stringliteral">"Counter32: "</span>;
<a name="l01570" id="l01570"></a>01570         <span class=
"keywordflow">if</span> (!snmp_strcat(buf, buf_len, out_len, allow_realloc, str)) {
<a name="l01571" id="l01571"></a>01571             <span class="keywordflow">return</span> 0;
<a name="l01572" id="l01572"></a>01572         }
<a name="l01573" id="l01573"></a>01573     }
<a name="l01574" id="l01574"></a>01574     sprintf(tmp, <span class="stringliteral">"%lu"</span>, *var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.integer);
<a name="l01575" id="l01575"></a>01575     <span class="keywordflow">if</span> (!snmp_strcat
<a name="l01576" id="l01576"></a>01576         (buf, buf_len, out_len, allow_realloc, (<span class=
"keyword">const</span> u_char *) tmp)) {
<a name="l01577" id="l01577"></a>01577         <span class="keywordflow">return</span> 0;
<a name="l01578" id="l01578"></a>01578     }
<a name="l01579" id="l01579"></a>01579     <span class="keywordflow">if</span> (units) {
<a name="l01580" id="l01580"></a>01580         <span class="keywordflow">return</span> (snmp_strcat
<a name="l01581" id="l01581"></a>01581                 (buf, buf_len, out_len, allow_realloc,
<a name="l01582" id="l01582"></a>01582                  (<span class="keyword">const</span> u_char *) <span class=
"stringliteral">" "</span>)
<a name="l01583" id="l01583"></a>01583                 &amp;&amp; snmp_strcat(buf, buf_len, out_len, allow_realloc,
<a name="l01584" id="l01584"></a>01584                                (<span class="keyword">const</span> u_char *) units));
<a name="l01585" id="l01585"></a>01585     }
<a name="l01586" id="l01586"></a>01586     <span class="keywordflow">return</span> 1;
<a name="l01587" id="l01587"></a>01587 }
<a name="l01588" id="l01588"></a>01588 
<a name="l01589" id="l01589"></a>01589 
<a name="l01610" id="l01610"></a>01610 <span class="keywordtype">int</span>
<a name="l01611" id="l01611"></a><a class="code" href=
"group__mib__utilities.html#gb83236b9b61e69a06d1dc022eb3fb549">01611</a> <a class="code" href=
"group__mib__utilities.html#gb83236b9b61e69a06d1dc022eb3fb549" title=
"Prints a network address into a buffer.">sprint_realloc_networkaddress</a>(u_char ** buf, <span class=
"keywordtype">size_t</span> * buf_len,
<a name="l01612" id="l01612"></a>01612                               <span class=
"keywordtype">size_t</span> * out_len, <span class="keywordtype">int</span> allow_realloc,
<a name="l01613" id="l01613"></a>01613                               <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var,
<a name="l01614" id="l01614"></a>01614                               <span class="keyword">const</span> <span class=
"keyword">struct</span> enum_list *enums, <span class="keyword">const</span> <span class="keywordtype">char</span> *hint,
<a name="l01615" id="l01615"></a>01615                               <span class="keyword">const</span> <span class=
"keywordtype">char</span> *units)
<a name="l01616" id="l01616"></a>01616 {
<a name="l01617" id="l01617"></a>01617     <span class="keywordtype">size_t</span>          i;
<a name="l01618" id="l01618"></a>01618 
<a name="l01619" id="l01619"></a>01619     <span class="keywordflow">if</span> ((var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a> != ASN_IPADDRESS) &amp;&amp; 
<a name="l01620" id="l01620"></a>01620         (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICKE_PRINT))) {
<a name="l01621" id="l01621"></a>01621         u_char          str[] = <span class=
"stringliteral">"Wrong Type (should be NetworkAddress): "</span>;
<a name="l01622" id="l01622"></a>01622         <span class=
"keywordflow">if</span> (snmp_strcat(buf, buf_len, out_len, allow_realloc, str)) {
<a name="l01623" id="l01623"></a>01623             <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#gabc12c361abdca75234c11dccb34871b" title=
"Universal print routine, prints a variable into a buffer according to the variable...">sprint_realloc_by_type</a>(buf, buf_len, out_len,
<a name="l01624" id="l01624"></a>01624                                           allow_realloc, var, NULL, NULL,
<a name="l01625" id="l01625"></a>01625                                           NULL);
<a name="l01626" id="l01626"></a>01626         } <span class="keywordflow">else</span> {
<a name="l01627" id="l01627"></a>01627             <span class="keywordflow">return</span> 0;
<a name="l01628" id="l01628"></a>01628         }
<a name="l01629" id="l01629"></a>01629     }
<a name="l01630" id="l01630"></a>01630 
<a name="l01631" id="l01631"></a>01631     <span class=
"keywordflow">if</span> (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICK_PRINT)) {
<a name="l01632" id="l01632"></a>01632         u_char          str[] = <span class="stringliteral">"Network Address: "</span>;
<a name="l01633" id="l01633"></a>01633         <span class=
"keywordflow">if</span> (!snmp_strcat(buf, buf_len, out_len, allow_realloc, str)) {
<a name="l01634" id="l01634"></a>01634             <span class="keywordflow">return</span> 0;
<a name="l01635" id="l01635"></a>01635         }
<a name="l01636" id="l01636"></a>01636     }
<a name="l01637" id="l01637"></a>01637 
<a name="l01638" id="l01638"></a>01638     <span class="keywordflow">while</span> ((*out_len + (var-&gt;<a class="code" href=
"structvariable__list.html#17aaa6b445178fc39aba69642247d3e9" title=
"the length of the value to be copied into buf">val_len</a> * 3) + 2) &gt;= *buf_len) {
<a name="l01639" id="l01639"></a>01639         <span class="keywordflow">if</span> (!(allow_realloc &amp;&amp; <a class="code"
href="group__util.html#g7b42d706225a788adcfeaad9b24717de" title=
"This function increase the size of the buffer pointed at by *buf, which is initially...">snmp_realloc</a>(buf, buf_len))) {
<a name="l01640" id="l01640"></a>01640             <span class="keywordflow">return</span> 0;
<a name="l01641" id="l01641"></a>01641         }
<a name="l01642" id="l01642"></a>01642     }
<a name="l01643" id="l01643"></a>01643 
<a name="l01644" id="l01644"></a>01644     <span class="keywordflow">for</span> (i = 0; i &lt; var-&gt;<a class="code" href=
"structvariable__list.html#17aaa6b445178fc39aba69642247d3e9" title=
"the length of the value to be copied into buf">val_len</a>; i++) {
<a name="l01645" id="l01645"></a>01645         sprintf((<span class="keywordtype">char</span> *) (*buf + *out_len), <span class=
"stringliteral">"%02X"</span>, var-&gt;<a class="code" href="structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title=
"value of variable">val</a>.string[i]);
<a name="l01646" id="l01646"></a>01646         *out_len += 2;
<a name="l01647" id="l01647"></a>01647         <span class="keywordflow">if</span> (i &lt; var-&gt;val_len - 1) {
<a name="l01648" id="l01648"></a>01648             *(*buf + *out_len) = <span class="charliteral">':'</span>;
<a name="l01649" id="l01649"></a>01649             (*out_len)++;
<a name="l01650" id="l01650"></a>01650         }
<a name="l01651" id="l01651"></a>01651     }
<a name="l01652" id="l01652"></a>01652     <span class="keywordflow">return</span> 1;
<a name="l01653" id="l01653"></a>01653 }
<a name="l01654" id="l01654"></a>01654 
<a name="l01655" id="l01655"></a>01655 
<a name="l01676" id="l01676"></a>01676 <span class="keywordtype">int</span>
<a name="l01677" id="l01677"></a><a class="code" href=
"group__mib__utilities.html#gb65bcc37615acd994e02c08ece83a96f">01677</a> <a class="code" href=
"group__mib__utilities.html#gb65bcc37615acd994e02c08ece83a96f" title=
"Prints an ip-address into a buffer.">sprint_realloc_ipaddress</a>(u_char ** buf, <span class=
"keywordtype">size_t</span> * buf_len, <span class="keywordtype">size_t</span> * out_len,
<a name="l01678" id="l01678"></a>01678                          <span class="keywordtype">int</span> allow_realloc,
<a name="l01679" id="l01679"></a>01679                          <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var,
<a name="l01680" id="l01680"></a>01680                          <span class="keyword">const</span> <span class=
"keyword">struct</span> enum_list *enums,
<a name="l01681" id="l01681"></a>01681                          <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *units)
<a name="l01682" id="l01682"></a>01682 {
<a name="l01683" id="l01683"></a>01683     u_char         *ip = var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.string;
<a name="l01684" id="l01684"></a>01684 
<a name="l01685" id="l01685"></a>01685     <span class="keywordflow">if</span> ((var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a> != ASN_IPADDRESS) &amp;&amp; 
<a name="l01686" id="l01686"></a>01686         (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICKE_PRINT))) {
<a name="l01687" id="l01687"></a>01687         u_char          str[] = <span class=
"stringliteral">"Wrong Type (should be IpAddress): "</span>;
<a name="l01688" id="l01688"></a>01688         <span class=
"keywordflow">if</span> (snmp_strcat(buf, buf_len, out_len, allow_realloc, str)) {
<a name="l01689" id="l01689"></a>01689             <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#gabc12c361abdca75234c11dccb34871b" title=
"Universal print routine, prints a variable into a buffer according to the variable...">sprint_realloc_by_type</a>(buf, buf_len, out_len,
<a name="l01690" id="l01690"></a>01690                                           allow_realloc, var, NULL, NULL,
<a name="l01691" id="l01691"></a>01691                                           NULL);
<a name="l01692" id="l01692"></a>01692         } <span class="keywordflow">else</span> {
<a name="l01693" id="l01693"></a>01693             <span class="keywordflow">return</span> 0;
<a name="l01694" id="l01694"></a>01694         }
<a name="l01695" id="l01695"></a>01695     }
<a name="l01696" id="l01696"></a>01696 
<a name="l01697" id="l01697"></a>01697     <span class=
"keywordflow">if</span> (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICK_PRINT)) {
<a name="l01698" id="l01698"></a>01698         u_char          str[] = <span class="stringliteral">"IpAddress: "</span>;
<a name="l01699" id="l01699"></a>01699         <span class=
"keywordflow">if</span> (!snmp_strcat(buf, buf_len, out_len, allow_realloc, str)) {
<a name="l01700" id="l01700"></a>01700             <span class="keywordflow">return</span> 0;
<a name="l01701" id="l01701"></a>01701         }
<a name="l01702" id="l01702"></a>01702     }
<a name="l01703" id="l01703"></a>01703     <span class="keywordflow">while</span> ((*out_len + 17) &gt;= *buf_len) {
<a name="l01704" id="l01704"></a>01704         <span class="keywordflow">if</span> (!(allow_realloc &amp;&amp; <a class="code"
href="group__util.html#g7b42d706225a788adcfeaad9b24717de" title=
"This function increase the size of the buffer pointed at by *buf, which is initially...">snmp_realloc</a>(buf, buf_len))) {
<a name="l01705" id="l01705"></a>01705             <span class="keywordflow">return</span> 0;
<a name="l01706" id="l01706"></a>01706         }
<a name="l01707" id="l01707"></a>01707     }
<a name="l01708" id="l01708"></a>01708     <span class="keywordflow">if</span> (ip)
<a name="l01709" id="l01709"></a>01709         sprintf((<span class="keywordtype">char</span> *) (*buf + *out_len), <span class=
"stringliteral">"%d.%d.%d.%d"</span>,
<a name="l01710" id="l01710"></a>01710                                             ip[0], ip[1], ip[2], ip[3]);
<a name="l01711" id="l01711"></a>01711     *out_len += strlen((<span class="keywordtype">char</span> *) (*buf + *out_len));
<a name="l01712" id="l01712"></a>01712     <span class="keywordflow">return</span> 1;
<a name="l01713" id="l01713"></a>01713 }
<a name="l01714" id="l01714"></a>01714 
<a name="l01715" id="l01715"></a>01715 
<a name="l01736" id="l01736"></a>01736 <span class="keywordtype">int</span>
<a name="l01737" id="l01737"></a><a class="code" href=
"group__mib__utilities.html#ga78ab15d7af7e907e57da5b42dbce9e4">01737</a> <a class="code" href=
"group__mib__utilities.html#ga78ab15d7af7e907e57da5b42dbce9e4" title=
"Prints a null value into a buffer.">sprint_realloc_null</a>(u_char ** buf, <span class=
"keywordtype">size_t</span> * buf_len, <span class="keywordtype">size_t</span> * out_len,
<a name="l01738" id="l01738"></a>01738                     <span class="keywordtype">int</span> allow_realloc,
<a name="l01739" id="l01739"></a>01739                     <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var,
<a name="l01740" id="l01740"></a>01740                     <span class="keyword">const</span> <span class=
"keyword">struct</span> enum_list *enums,
<a name="l01741" id="l01741"></a>01741                     <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *units)
<a name="l01742" id="l01742"></a>01742 {
<a name="l01743" id="l01743"></a>01743     <span class="keywordflow">if</span> ((var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a> != ASN_NULL) &amp;&amp; 
<a name="l01744" id="l01744"></a>01744         (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICKE_PRINT))) {
<a name="l01745" id="l01745"></a>01745         u_char          str[] = <span class=
"stringliteral">"Wrong Type (should be NULL): "</span>;
<a name="l01746" id="l01746"></a>01746         <span class=
"keywordflow">if</span> (snmp_strcat(buf, buf_len, out_len, allow_realloc, str)) {
<a name="l01747" id="l01747"></a>01747             <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#gabc12c361abdca75234c11dccb34871b" title=
"Universal print routine, prints a variable into a buffer according to the variable...">sprint_realloc_by_type</a>(buf, buf_len, out_len,
<a name="l01748" id="l01748"></a>01748                                           allow_realloc, var, NULL, NULL,
<a name="l01749" id="l01749"></a>01749                                           NULL);
<a name="l01750" id="l01750"></a>01750         } <span class="keywordflow">else</span> {
<a name="l01751" id="l01751"></a>01751             <span class="keywordflow">return</span> 0;
<a name="l01752" id="l01752"></a>01752         }
<a name="l01753" id="l01753"></a>01753     } <span class="keywordflow">else</span> {
<a name="l01754" id="l01754"></a>01754         u_char          str[] = <span class="stringliteral">"NULL"</span>;
<a name="l01755" id="l01755"></a>01755         <span class=
"keywordflow">return</span> snmp_strcat(buf, buf_len, out_len, allow_realloc, str);
<a name="l01756" id="l01756"></a>01756     }
<a name="l01757" id="l01757"></a>01757 }
<a name="l01758" id="l01758"></a>01758 
<a name="l01759" id="l01759"></a>01759 
<a name="l01780" id="l01780"></a>01780 <span class="keywordtype">int</span>
<a name="l01781" id="l01781"></a><a class="code" href=
"group__mib__utilities.html#gfe6d528aa10dfac467956837ffa7c3ba">01781</a> <a class="code" href=
"group__mib__utilities.html#gfe6d528aa10dfac467956837ffa7c3ba" title=
"Prints a bit string into a buffer.">sprint_realloc_bitstring</a>(u_char ** buf, <span class=
"keywordtype">size_t</span> * buf_len, <span class="keywordtype">size_t</span> * out_len,
<a name="l01782" id="l01782"></a>01782                          <span class="keywordtype">int</span> allow_realloc,
<a name="l01783" id="l01783"></a>01783                          <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var,
<a name="l01784" id="l01784"></a>01784                          <span class="keyword">const</span> <span class=
"keyword">struct</span> enum_list *enums,
<a name="l01785" id="l01785"></a>01785                          <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *units)
<a name="l01786" id="l01786"></a>01786 {
<a name="l01787" id="l01787"></a>01787     <span class="keywordtype">int</span>             len, bit;
<a name="l01788" id="l01788"></a>01788     u_char         *cp;
<a name="l01789" id="l01789"></a>01789     <span class="keywordtype">char</span>           *enum_string;
<a name="l01790" id="l01790"></a>01790 
<a name="l01791" id="l01791"></a>01791     <span class="keywordflow">if</span> ((var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title=
"ASN type of variable.">type</a> != ASN_BIT_STR &amp;&amp; var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a> != ASN_OCTET_STR) &amp;&amp;
<a name="l01792" id="l01792"></a>01792         (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICKE_PRINT))) {
<a name="l01793" id="l01793"></a>01793         u_char          str[] = <span class=
"stringliteral">"Wrong Type (should be BITS): "</span>;
<a name="l01794" id="l01794"></a>01794         <span class=
"keywordflow">if</span> (snmp_strcat(buf, buf_len, out_len, allow_realloc, str)) {
<a name="l01795" id="l01795"></a>01795             <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#gabc12c361abdca75234c11dccb34871b" title=
"Universal print routine, prints a variable into a buffer according to the variable...">sprint_realloc_by_type</a>(buf, buf_len, out_len,
<a name="l01796" id="l01796"></a>01796                                           allow_realloc, var, NULL, NULL,
<a name="l01797" id="l01797"></a>01797                                           NULL);
<a name="l01798" id="l01798"></a>01798         } <span class="keywordflow">else</span> {
<a name="l01799" id="l01799"></a>01799             <span class="keywordflow">return</span> 0;
<a name="l01800" id="l01800"></a>01800         }
<a name="l01801" id="l01801"></a>01801     }
<a name="l01802" id="l01802"></a>01802 
<a name="l01803" id="l01803"></a>01803     <span class=
"keywordflow">if</span> (netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICK_PRINT)) {
<a name="l01804" id="l01804"></a>01804         u_char          str[] = <span class="stringliteral">"\""</span>;
<a name="l01805" id="l01805"></a>01805         <span class=
"keywordflow">if</span> (!snmp_strcat(buf, buf_len, out_len, allow_realloc, str)) {
<a name="l01806" id="l01806"></a>01806             <span class="keywordflow">return</span> 0;
<a name="l01807" id="l01807"></a>01807         }
<a name="l01808" id="l01808"></a>01808     } <span class="keywordflow">else</span> {
<a name="l01809" id="l01809"></a>01809         u_char          str[] = <span class="stringliteral">"BITS: "</span>;
<a name="l01810" id="l01810"></a>01810         <span class=
"keywordflow">if</span> (!snmp_strcat(buf, buf_len, out_len, allow_realloc, str)) {
<a name="l01811" id="l01811"></a>01811             <span class="keywordflow">return</span> 0;
<a name="l01812" id="l01812"></a>01812         }
<a name="l01813" id="l01813"></a>01813     }
<a name="l01814" id="l01814"></a>01814     <span class=
"keywordflow">if</span> (!sprint_realloc_hexstring(buf, buf_len, out_len, allow_realloc,
<a name="l01815" id="l01815"></a>01815                                   var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.bitstring, var-&gt;<a class="code"
href="structvariable__list.html#17aaa6b445178fc39aba69642247d3e9" title=
"the length of the value to be copied into buf">val_len</a>)) {
<a name="l01816" id="l01816"></a>01816         <span class="keywordflow">return</span> 0;
<a name="l01817" id="l01817"></a>01817     }
<a name="l01818" id="l01818"></a>01818 
<a name="l01819" id="l01819"></a>01819     <span class=
"keywordflow">if</span> (netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICK_PRINT)) {
<a name="l01820" id="l01820"></a>01820         u_char          str[] = <span class="stringliteral">"\""</span>;
<a name="l01821" id="l01821"></a>01821         <span class=
"keywordflow">if</span> (!snmp_strcat(buf, buf_len, out_len, allow_realloc, str)) {
<a name="l01822" id="l01822"></a>01822             <span class="keywordflow">return</span> 0;
<a name="l01823" id="l01823"></a>01823         }
<a name="l01824" id="l01824"></a>01824     } <span class="keywordflow">else</span> {
<a name="l01825" id="l01825"></a>01825         cp = var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.bitstring;
<a name="l01826" id="l01826"></a>01826         <span class="keywordflow">for</span> (len = 0; len &lt; (int) var-&gt;<a class=
"code" href="structvariable__list.html#17aaa6b445178fc39aba69642247d3e9" title=
"the length of the value to be copied into buf">val_len</a>; len++) {
<a name="l01827" id="l01827"></a>01827             <span class="keywordflow">for</span> (bit = 0; bit &lt; 8; bit++) {
<a name="l01828" id="l01828"></a>01828                 <span class="keywordflow">if</span> (*cp &amp; (0x80 &gt;&gt; bit)) {
<a name="l01829" id="l01829"></a>01829                     enum_string = NULL;
<a name="l01830" id="l01830"></a>01830                     <span class=
"keywordflow">for</span> (; enums; enums = enums-&gt;next) {
<a name="l01831" id="l01831"></a>01831                         <span class=
"keywordflow">if</span> (enums-&gt;value == (len * 8) + bit) {
<a name="l01832" id="l01832"></a>01832                             enum_string = enums-&gt;label;
<a name="l01833" id="l01833"></a>01833                             <span class="keywordflow">break</span>;
<a name="l01834" id="l01834"></a>01834                         }
<a name="l01835" id="l01835"></a>01835                     }
<a name="l01836" id="l01836"></a>01836                     <span class="keywordflow">if</span> (enum_string == NULL ||
<a name="l01837" id="l01837"></a>01837                         netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID,
<a name="l01838" id="l01838"></a>01838                                        NETSNMP_DS_LIB_PRINT_NUMERIC_ENUM)) {
<a name="l01839" id="l01839"></a>01839                         <span class="keywordtype">char</span>            str[16];
<a name="l01840" id="l01840"></a>01840                         sprintf(str, <span class=
"stringliteral">"%d "</span>, (len * 8) + bit);
<a name="l01841" id="l01841"></a>01841                         <span class="keywordflow">if</span> (!snmp_strcat
<a name="l01842" id="l01842"></a>01842                             (buf, buf_len, out_len, allow_realloc,
<a name="l01843" id="l01843"></a>01843                              (<span class="keyword">const</span> u_char *) str)) {
<a name="l01844" id="l01844"></a>01844                             <span class="keywordflow">return</span> 0;
<a name="l01845" id="l01845"></a>01845                         }
<a name="l01846" id="l01846"></a>01846                     } <span class="keywordflow">else</span> {
<a name="l01847" id="l01847"></a>01847                         <span class="keywordtype">char</span>            str[16];
<a name="l01848" id="l01848"></a>01848                         sprintf(str, <span class=
"stringliteral">"(%d) "</span>, (len * 8) + bit);
<a name="l01849" id="l01849"></a>01849                         <span class="keywordflow">if</span> (!snmp_strcat
<a name="l01850" id="l01850"></a>01850                             (buf, buf_len, out_len, allow_realloc,
<a name="l01851" id="l01851"></a>01851                              (<span class="keyword">const</span> u_char *) enum_string)) {
<a name="l01852" id="l01852"></a>01852                             <span class="keywordflow">return</span> 0;
<a name="l01853" id="l01853"></a>01853                         }
<a name="l01854" id="l01854"></a>01854                         <span class="keywordflow">if</span> (!snmp_strcat
<a name="l01855" id="l01855"></a>01855                             (buf, buf_len, out_len, allow_realloc,
<a name="l01856" id="l01856"></a>01856                              (<span class="keyword">const</span> u_char *) str)) {
<a name="l01857" id="l01857"></a>01857                             <span class="keywordflow">return</span> 0;
<a name="l01858" id="l01858"></a>01858                         }
<a name="l01859" id="l01859"></a>01859                     }
<a name="l01860" id="l01860"></a>01860                 }
<a name="l01861" id="l01861"></a>01861             }
<a name="l01862" id="l01862"></a>01862             cp++;
<a name="l01863" id="l01863"></a>01863         }
<a name="l01864" id="l01864"></a>01864     }
<a name="l01865" id="l01865"></a>01865     <span class="keywordflow">return</span> 1;
<a name="l01866" id="l01866"></a>01866 }
<a name="l01867" id="l01867"></a>01867 
<a name="l01868" id="l01868"></a>01868 <span class="keywordtype">int</span>
<a name="l01869" id="l01869"></a>01869 sprint_realloc_nsapaddress(u_char ** buf, <span class=
"keywordtype">size_t</span> * buf_len,
<a name="l01870" id="l01870"></a>01870                            <span class="keywordtype">size_t</span> * out_len, <span class=
"keywordtype">int</span> allow_realloc,
<a name="l01871" id="l01871"></a>01871                            <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var,
<a name="l01872" id="l01872"></a>01872                            <span class="keyword">const</span> <span class=
"keyword">struct</span> enum_list *enums, <span class="keyword">const</span> <span class="keywordtype">char</span> *hint,
<a name="l01873" id="l01873"></a>01873                            <span class="keyword">const</span> <span class=
"keywordtype">char</span> *units)
<a name="l01874" id="l01874"></a>01874 {
<a name="l01875" id="l01875"></a>01875     <span class="keywordflow">if</span> ((var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a> != ASN_NSAP) &amp;&amp; 
<a name="l01876" id="l01876"></a>01876         (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICKE_PRINT))) {
<a name="l01877" id="l01877"></a>01877         u_char          str[] = <span class=
"stringliteral">"Wrong Type (should be NsapAddress): "</span>;
<a name="l01878" id="l01878"></a>01878         <span class=
"keywordflow">if</span> (snmp_strcat(buf, buf_len, out_len, allow_realloc, str)) {
<a name="l01879" id="l01879"></a>01879             <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#gabc12c361abdca75234c11dccb34871b" title=
"Universal print routine, prints a variable into a buffer according to the variable...">sprint_realloc_by_type</a>(buf, buf_len, out_len,
<a name="l01880" id="l01880"></a>01880                                           allow_realloc, var, NULL, NULL,
<a name="l01881" id="l01881"></a>01881                                           NULL);
<a name="l01882" id="l01882"></a>01882         } <span class="keywordflow">else</span> {
<a name="l01883" id="l01883"></a>01883             <span class="keywordflow">return</span> 0;
<a name="l01884" id="l01884"></a>01884         }
<a name="l01885" id="l01885"></a>01885     }
<a name="l01886" id="l01886"></a>01886 
<a name="l01887" id="l01887"></a>01887     <span class=
"keywordflow">if</span> (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICK_PRINT)) {
<a name="l01888" id="l01888"></a>01888         u_char          str[] = <span class="stringliteral">"NsapAddress: "</span>;
<a name="l01889" id="l01889"></a>01889         <span class=
"keywordflow">if</span> (!snmp_strcat(buf, buf_len, out_len, allow_realloc, str)) {
<a name="l01890" id="l01890"></a>01890             <span class="keywordflow">return</span> 0;
<a name="l01891" id="l01891"></a>01891         }
<a name="l01892" id="l01892"></a>01892     }
<a name="l01893" id="l01893"></a>01893 
<a name="l01894" id="l01894"></a>01894     <span class=
"keywordflow">return</span> sprint_realloc_hexstring(buf, buf_len, out_len, allow_realloc,
<a name="l01895" id="l01895"></a>01895                                     var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.string, var-&gt;<a class="code"
href="structvariable__list.html#17aaa6b445178fc39aba69642247d3e9" title=
"the length of the value to be copied into buf">val_len</a>);
<a name="l01896" id="l01896"></a>01896 }
<a name="l01897" id="l01897"></a>01897 
<a name="l01898" id="l01898"></a>01898 
<a name="l01919" id="l01919"></a>01919 <span class="keywordtype">int</span>
<a name="l01920" id="l01920"></a><a class="code" href=
"group__mib__utilities.html#g7ac6acaf3e0df6e8e99c225a6e8067d3">01920</a> <a class="code" href=
"group__mib__utilities.html#g7ac6acaf3e0df6e8e99c225a6e8067d3" title=
"Fallback routine for a bad type, prints &amp;quot;Variable has bad type&amp;quot; into a...">sprint_realloc_badtype</a>(u_char ** buf, <span class="keywordtype">size_t</span> * buf_len, <span class="keywordtype">size_t</span> * out_len,
<a name="l01921" id="l01921"></a>01921                        <span class="keywordtype">int</span> allow_realloc,
<a name="l01922" id="l01922"></a>01922                        <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var,
<a name="l01923" id="l01923"></a>01923                        <span class="keyword">const</span> <span class=
"keyword">struct</span> enum_list *enums,
<a name="l01924" id="l01924"></a>01924                        <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *units)
<a name="l01925" id="l01925"></a>01925 {
<a name="l01926" id="l01926"></a>01926     u_char          str[] = <span class="stringliteral">"Variable has bad type"</span>;
<a name="l01927" id="l01927"></a>01927 
<a name="l01928" id="l01928"></a>01928     <span class=
"keywordflow">return</span> snmp_strcat(buf, buf_len, out_len, allow_realloc, str);
<a name="l01929" id="l01929"></a>01929 }
<a name="l01930" id="l01930"></a>01930 
<a name="l01931" id="l01931"></a>01931 
<a name="l01932" id="l01932"></a>01932 
<a name="l01954" id="l01954"></a>01954 <span class="keywordtype">int</span>
<a name="l01955" id="l01955"></a><a class="code" href=
"group__mib__utilities.html#gabc12c361abdca75234c11dccb34871b">01955</a> <a class="code" href=
"group__mib__utilities.html#gabc12c361abdca75234c11dccb34871b" title=
"Universal print routine, prints a variable into a buffer according to the variable...">sprint_realloc_by_type</a>(u_char ** buf, <span class="keywordtype">size_t</span> * buf_len, <span class="keywordtype">size_t</span> * out_len,
<a name="l01956" id="l01956"></a>01956                        <span class="keywordtype">int</span> allow_realloc,
<a name="l01957" id="l01957"></a>01957                        <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var,
<a name="l01958" id="l01958"></a>01958                        <span class="keyword">const</span> <span class=
"keyword">struct</span> enum_list *enums,
<a name="l01959" id="l01959"></a>01959                        <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *units)
<a name="l01960" id="l01960"></a>01960 {
<a name="l01961" id="l01961"></a>01961     DEBUGMSGTL((<span class="stringliteral">"output"</span>, <span class=
"stringliteral">"sprint_by_type, type %d\n"</span>, var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a>));
<a name="l01962" id="l01962"></a>01962 
<a name="l01963" id="l01963"></a>01963     <span class="keywordflow">switch</span> (var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a>) {
<a name="l01964" id="l01964"></a>01964     <span class="keywordflow">case</span> ASN_INTEGER:
<a name="l01965" id="l01965"></a>01965         <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#g97e7b0a5f5da3d51d9ae32a89f901390" title=
"Prints an integer into a buffer.">sprint_realloc_integer</a>(buf, buf_len, out_len, allow_realloc,
<a name="l01966" id="l01966"></a>01966                                       var, enums, hint, units);
<a name="l01967" id="l01967"></a>01967     <span class="keywordflow">case</span> ASN_OCTET_STR:
<a name="l01968" id="l01968"></a>01968         <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#gbe71c710f2173fb85512d08c088ea12e" title=
"Prints an octet string into a buffer.">sprint_realloc_octet_string</a>(buf, buf_len, out_len,
<a name="l01969" id="l01969"></a>01969                                            allow_realloc, var, enums, hint,
<a name="l01970" id="l01970"></a>01970                                            units);
<a name="l01971" id="l01971"></a>01971     <span class="keywordflow">case</span> ASN_BIT_STR:
<a name="l01972" id="l01972"></a>01972         <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#gfe6d528aa10dfac467956837ffa7c3ba" title=
"Prints a bit string into a buffer.">sprint_realloc_bitstring</a>(buf, buf_len, out_len,
<a name="l01973" id="l01973"></a>01973                                         allow_realloc, var, enums, hint,
<a name="l01974" id="l01974"></a>01974                                         units);
<a name="l01975" id="l01975"></a>01975     <span class="keywordflow">case</span> ASN_OPAQUE:
<a name="l01976" id="l01976"></a>01976         <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#g0e42660c74b91d68e088b53e41ba6658" title=
"Prints an object identifier into a buffer.">sprint_realloc_opaque</a>(buf, buf_len, out_len, allow_realloc,
<a name="l01977" id="l01977"></a>01977                                      var, enums, hint, units);
<a name="l01978" id="l01978"></a>01978     <span class="keywordflow">case</span> ASN_OBJECT_ID:
<a name="l01979" id="l01979"></a>01979         <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#g58c583005d5df719f3866ff0f06ec800" title=
"Prints an object identifier into a buffer.">sprint_realloc_object_identifier</a>(buf, buf_len, out_len,
<a name="l01980" id="l01980"></a>01980                                                 allow_realloc, var, enums,
<a name="l01981" id="l01981"></a>01981                                                 hint, units);
<a name="l01982" id="l01982"></a>01982     <span class="keywordflow">case</span> ASN_TIMETICKS:
<a name="l01983" id="l01983"></a>01983         <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#gd53723cfb568c73dc3b7af48985f96d2" title=
"Prints a timetick variable into a buffer.">sprint_realloc_timeticks</a>(buf, buf_len, out_len,
<a name="l01984" id="l01984"></a>01984                                         allow_realloc, var, enums, hint,
<a name="l01985" id="l01985"></a>01985                                         units);
<a name="l01986" id="l01986"></a>01986     <span class="keywordflow">case</span> ASN_GAUGE:
<a name="l01987" id="l01987"></a>01987         <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#gfe1758bc15693fc502e648c05f5c83f3" title=
"Prints a gauge value into a buffer.">sprint_realloc_gauge</a>(buf, buf_len, out_len, allow_realloc,
<a name="l01988" id="l01988"></a>01988                                     var, enums, hint, units);
<a name="l01989" id="l01989"></a>01989     <span class="keywordflow">case</span> ASN_COUNTER:
<a name="l01990" id="l01990"></a>01990         <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#gac841b689bafe52506f128201d57c51b" title=
"Prints a counter value into a buffer.">sprint_realloc_counter</a>(buf, buf_len, out_len, allow_realloc,
<a name="l01991" id="l01991"></a>01991                                       var, enums, hint, units);
<a name="l01992" id="l01992"></a>01992     <span class="keywordflow">case</span> ASN_IPADDRESS:
<a name="l01993" id="l01993"></a>01993         <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#gb65bcc37615acd994e02c08ece83a96f" title=
"Prints an ip-address into a buffer.">sprint_realloc_ipaddress</a>(buf, buf_len, out_len,
<a name="l01994" id="l01994"></a>01994                                         allow_realloc, var, enums, hint,
<a name="l01995" id="l01995"></a>01995                                         units);
<a name="l01996" id="l01996"></a>01996     <span class="keywordflow">case</span> ASN_NULL:
<a name="l01997" id="l01997"></a>01997         <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#ga78ab15d7af7e907e57da5b42dbce9e4" title=
"Prints a null value into a buffer.">sprint_realloc_null</a>(buf, buf_len, out_len, allow_realloc,
<a name="l01998" id="l01998"></a>01998                                    var, enums, hint, units);
<a name="l01999" id="l01999"></a>01999     <span class="keywordflow">case</span> ASN_UINTEGER:
<a name="l02000" id="l02000"></a>02000         <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#gccef8ad447c854b262acdf0c8f135084" title=
"Prints an unsigned integer into a buffer.">sprint_realloc_uinteger</a>(buf, buf_len, out_len,
<a name="l02001" id="l02001"></a>02001                                        allow_realloc, var, enums, hint,
<a name="l02002" id="l02002"></a>02002                                        units);
<a name="l02003" id="l02003"></a>02003     <span class="keywordflow">case</span> ASN_COUNTER64:
<a name="l02004" id="l02004"></a>02004 <span class="preprocessor">#ifdef NETSNMP_WITH_OPAQUE_SPECIAL_TYPES</span>
<a name="l02005" id="l02005"></a>02005     <span class="keywordflow">case</span> ASN_OPAQUE_U64:
<a name="l02006" id="l02006"></a>02006     <span class="keywordflow">case</span> ASN_OPAQUE_I64:
<a name="l02007" id="l02007"></a>02007     <span class="keywordflow">case</span> ASN_OPAQUE_COUNTER64:
<a name="l02008" id="l02008"></a>02008 <span class="preprocessor">#endif                          </span><span class=
"comment">/* NETSNMP_WITH_OPAQUE_SPECIAL_TYPES */</span>
<a name="l02009" id="l02009"></a>02009         <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#g911270821df5b87de7a97dc5deb8f485" title=
"Prints a counter into a buffer.">sprint_realloc_counter64</a>(buf, buf_len, out_len,
<a name="l02010" id="l02010"></a>02010                                         allow_realloc, var, enums, hint,
<a name="l02011" id="l02011"></a>02011                                         units);
<a name="l02012" id="l02012"></a>02012 <span class="preprocessor">#ifdef NETSNMP_WITH_OPAQUE_SPECIAL_TYPES</span>
<a name="l02013" id="l02013"></a>02013     <span class="keywordflow">case</span> ASN_OPAQUE_FLOAT:
<a name="l02014" id="l02014"></a>02014         <span class=
"keywordflow">return</span> sprint_realloc_float(buf, buf_len, out_len, allow_realloc,
<a name="l02015" id="l02015"></a>02015                                     var, enums, hint, units);
<a name="l02016" id="l02016"></a>02016     <span class="keywordflow">case</span> ASN_OPAQUE_DOUBLE:
<a name="l02017" id="l02017"></a>02017         <span class=
"keywordflow">return</span> sprint_realloc_double(buf, buf_len, out_len, allow_realloc,
<a name="l02018" id="l02018"></a>02018                                      var, enums, hint, units);
<a name="l02019" id="l02019"></a>02019 <span class="preprocessor">#endif                          </span><span class=
"comment">/* NETSNMP_WITH_OPAQUE_SPECIAL_TYPES */</span>
<a name="l02020" id="l02020"></a>02020     <span class="keywordflow">default</span>:
<a name="l02021" id="l02021"></a>02021         DEBUGMSGTL((<span class="stringliteral">"sprint_by_type"</span>, <span class=
"stringliteral">"bad type: %d\n"</span>, var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a>));
<a name="l02022" id="l02022"></a>02022         <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#g7ac6acaf3e0df6e8e99c225a6e8067d3" title=
"Fallback routine for a bad type, prints &amp;quot;Variable has bad type&amp;quot; into a...">sprint_realloc_badtype</a>(buf, buf_len, out_len, allow_realloc,
<a name="l02023" id="l02023"></a>02023                                       var, enums, hint, units);
<a name="l02024" id="l02024"></a>02024     }
<a name="l02025" id="l02025"></a>02025 }
<a name="l02026" id="l02026"></a>02026 
<a name="l02027" id="l02027"></a>02027 
<a name="l02028" id="l02028"></a>02028 <span class="preprocessor">#ifndef NETSNMP_DISABLE_MIB_LOADING</span>
<a name="l02029" id="l02029"></a>02029 
<a name="l02034" id="l02034"></a>02034 <span class="keyword">struct </span>tree    *
<a name="l02035" id="l02035"></a><a class="code" href=
"group__mib__utilities.html#g5830964581bdd9a3d10e9c626c275a07">02035</a> <a class="code" href=
"group__mib__utilities.html#g5830964581bdd9a3d10e9c626c275a07" title="Retrieves the tree head.">get_tree_head</a>(<span class=
"keywordtype">void</span>)
<a name="l02036" id="l02036"></a>02036 {
<a name="l02037" id="l02037"></a>02037     <span class="keywordflow">return</span> (tree_head);
<a name="l02038" id="l02038"></a>02038 }
<a name="l02039" id="l02039"></a>02039 
<a name="l02040" id="l02040"></a>02040 <span class="keyword">static</span> <span class=
"keywordtype">char</span>    *confmibdir = NULL;
<a name="l02041" id="l02041"></a>02041 <span class="keyword">static</span> <span class=
"keywordtype">char</span>    *confmibs = NULL;
<a name="l02042" id="l02042"></a>02042 
<a name="l02043" id="l02043"></a>02043 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l02044" id="l02044"></a>02044 handle_mibdirs_conf(<span class="keyword">const</span> <span class=
"keywordtype">char</span> *token, <span class="keywordtype">char</span> *line)
<a name="l02045" id="l02045"></a>02045 {
<a name="l02046" id="l02046"></a>02046     <span class="keywordtype">char</span>           *ctmp;
<a name="l02047" id="l02047"></a>02047 
<a name="l02048" id="l02048"></a>02048     <span class="keywordflow">if</span> (confmibdir) {
<a name="l02049" id="l02049"></a>02049         <span class="keywordflow">if</span> ((*line == <span class=
"charliteral">'+'</span>) || (*line == <span class="charliteral">'-'</span>)) {
<a name="l02050" id="l02050"></a>02050             ctmp = (<span class=
"keywordtype">char</span> *) malloc(strlen(confmibdir) + strlen(line) + 2);
<a name="l02051" id="l02051"></a>02051             <span class="keywordflow">if</span> (!ctmp) {
<a name="l02052" id="l02052"></a>02052                 DEBUGMSGTL((<span class="stringliteral">"read_config:initmib"</span>,
<a name="l02053" id="l02053"></a>02053                             <span class=
"stringliteral">"mibdir conf malloc failed"</span>));
<a name="l02054" id="l02054"></a>02054                 <span class="keywordflow">return</span>;
<a name="l02055" id="l02055"></a>02055             }
<a name="l02056" id="l02056"></a>02056             <span class="keywordflow">if</span>(*line++ == <span class=
"charliteral">'+'</span>)
<a name="l02057" id="l02057"></a>02057                 sprintf(ctmp, <span class=
"stringliteral">"%s%c%s"</span>, confmibdir, ENV_SEPARATOR_CHAR, line);
<a name="l02058" id="l02058"></a>02058             <span class="keywordflow">else</span>
<a name="l02059" id="l02059"></a>02059                 sprintf(ctmp, <span class=
"stringliteral">"%s%c%s"</span>, line, ENV_SEPARATOR_CHAR, confmibdir);
<a name="l02060" id="l02060"></a>02060         } <span class="keywordflow">else</span> {
<a name="l02061" id="l02061"></a>02061             ctmp = strdup(line);
<a name="l02062" id="l02062"></a>02062             <span class="keywordflow">if</span> (!ctmp) {
<a name="l02063" id="l02063"></a>02063                 DEBUGMSGTL((<span class=
"stringliteral">"read_config:initmib"</span>, <span class="stringliteral">"mibs conf malloc failed"</span>));
<a name="l02064" id="l02064"></a>02064                 <span class="keywordflow">return</span>;
<a name="l02065" id="l02065"></a>02065             }
<a name="l02066" id="l02066"></a>02066         }
<a name="l02067" id="l02067"></a>02067         <a class="code" href="group__util.html#g951e93edb6f0ea941e26155e3f8912a6" title=
"Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(confmibdir);
<a name="l02068" id="l02068"></a>02068     } <span class="keywordflow">else</span> {
<a name="l02069" id="l02069"></a>02069         ctmp = strdup(line);
<a name="l02070" id="l02070"></a>02070         <span class="keywordflow">if</span> (!ctmp) {
<a name="l02071" id="l02071"></a>02071             DEBUGMSGTL((<span class=
"stringliteral">"read_config:initmib"</span>, <span class="stringliteral">"mibs conf malloc failed"</span>));
<a name="l02072" id="l02072"></a>02072             <span class="keywordflow">return</span>;
<a name="l02073" id="l02073"></a>02073         }
<a name="l02074" id="l02074"></a>02074     }
<a name="l02075" id="l02075"></a>02075     confmibdir = ctmp;
<a name="l02076" id="l02076"></a>02076     DEBUGMSGTL((<span class="stringliteral">"read_config:initmib"</span>, <span class=
"stringliteral">"using mibdirs: %s\n"</span>, confmibdir));
<a name="l02077" id="l02077"></a>02077 }
<a name="l02078" id="l02078"></a>02078 
<a name="l02079" id="l02079"></a>02079 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l02080" id="l02080"></a>02080 handle_mibs_conf(<span class="keyword">const</span> <span class=
"keywordtype">char</span> *token, <span class="keywordtype">char</span> *line)
<a name="l02081" id="l02081"></a>02081 {
<a name="l02082" id="l02082"></a>02082     <span class="keywordtype">char</span>           *ctmp;
<a name="l02083" id="l02083"></a>02083 
<a name="l02084" id="l02084"></a>02084     <span class="keywordflow">if</span> (confmibs) {
<a name="l02085" id="l02085"></a>02085         <span class="keywordflow">if</span> ((*line == <span class=
"charliteral">'+'</span>) || (*line == <span class="charliteral">'-'</span>)) {
<a name="l02086" id="l02086"></a>02086             ctmp = (<span class=
"keywordtype">char</span> *) malloc(strlen(confmibs) + strlen(line) + 2);
<a name="l02087" id="l02087"></a>02087             <span class="keywordflow">if</span> (!ctmp) {
<a name="l02088" id="l02088"></a>02088                 DEBUGMSGTL((<span class=
"stringliteral">"read_config:initmib"</span>, <span class="stringliteral">"mibs conf malloc failed"</span>));
<a name="l02089" id="l02089"></a>02089                 <span class="keywordflow">return</span>;
<a name="l02090" id="l02090"></a>02090             }
<a name="l02091" id="l02091"></a>02091             <span class="keywordflow">if</span>(*line++ == <span class=
"charliteral">'+'</span>)
<a name="l02092" id="l02092"></a>02092                 sprintf(ctmp, <span class=
"stringliteral">"%s%c%s"</span>, confmibs, ENV_SEPARATOR_CHAR, line);
<a name="l02093" id="l02093"></a>02093             <span class="keywordflow">else</span>
<a name="l02094" id="l02094"></a>02094                 sprintf(ctmp, <span class=
"stringliteral">"%s%c%s"</span>, line, ENV_SEPARATOR_CHAR, confmibdir);
<a name="l02095" id="l02095"></a>02095         } <span class="keywordflow">else</span> {
<a name="l02096" id="l02096"></a>02096             ctmp = strdup(line);
<a name="l02097" id="l02097"></a>02097             <span class="keywordflow">if</span> (!ctmp) {
<a name="l02098" id="l02098"></a>02098                 DEBUGMSGTL((<span class=
"stringliteral">"read_config:initmib"</span>, <span class="stringliteral">"mibs conf malloc failed"</span>));
<a name="l02099" id="l02099"></a>02099                 <span class="keywordflow">return</span>;
<a name="l02100" id="l02100"></a>02100             }
<a name="l02101" id="l02101"></a>02101         }
<a name="l02102" id="l02102"></a>02102         <a class="code" href="group__util.html#g951e93edb6f0ea941e26155e3f8912a6" title=
"Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(confmibs);
<a name="l02103" id="l02103"></a>02103     } <span class="keywordflow">else</span> {
<a name="l02104" id="l02104"></a>02104         ctmp = strdup(line);
<a name="l02105" id="l02105"></a>02105         <span class="keywordflow">if</span> (!ctmp) {
<a name="l02106" id="l02106"></a>02106             DEBUGMSGTL((<span class=
"stringliteral">"read_config:initmib"</span>, <span class="stringliteral">"mibs conf malloc failed"</span>));
<a name="l02107" id="l02107"></a>02107             <span class="keywordflow">return</span>;
<a name="l02108" id="l02108"></a>02108         }
<a name="l02109" id="l02109"></a>02109     }
<a name="l02110" id="l02110"></a>02110     confmibs = ctmp;
<a name="l02111" id="l02111"></a>02111     DEBUGMSGTL((<span class="stringliteral">"read_config:initmib"</span>, <span class=
"stringliteral">"using mibs: %s\n"</span>, confmibs));
<a name="l02112" id="l02112"></a>02112 }
<a name="l02113" id="l02113"></a>02113 
<a name="l02114" id="l02114"></a>02114 
<a name="l02115" id="l02115"></a>02115 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l02116" id="l02116"></a>02116 handle_mibfile_conf(<span class="keyword">const</span> <span class=
"keywordtype">char</span> *token, <span class="keywordtype">char</span> *line)
<a name="l02117" id="l02117"></a>02117 {
<a name="l02118" id="l02118"></a>02118     DEBUGMSGTL((<span class="stringliteral">"read_config:initmib"</span>, <span class=
"stringliteral">"reading mibfile: %s\n"</span>, line));
<a name="l02119" id="l02119"></a>02119     read_mib(line);
<a name="l02120" id="l02120"></a>02120 }
<a name="l02121" id="l02121"></a>02121 <span class="preprocessor">#endif</span>
<a name="l02122" id="l02122"></a>02122 
<a name="l02123" id="l02123"></a>02123 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l02124" id="l02124"></a>02124 handle_print_numeric(<span class="keyword">const</span> <span class=
"keywordtype">char</span> *token, <span class="keywordtype">char</span> *line)
<a name="l02125" id="l02125"></a>02125 {
<a name="l02126" id="l02126"></a>02126     <span class="keyword">const</span> <span class="keywordtype">char</span> *value;
<a name="l02127" id="l02127"></a>02127     <span class="keywordtype">char</span>       *st;
<a name="l02128" id="l02128"></a>02128 
<a name="l02129" id="l02129"></a>02129     value = strtok_r(line, <span class="stringliteral">" \t\n"</span>, &amp;st);
<a name="l02130" id="l02130"></a>02130     <span class="keywordflow">if</span> (value &amp;&amp; (
<a name="l02131" id="l02131"></a>02131             (strcasecmp(value, <span class="stringliteral">"yes"</span>)  == 0) || 
<a name="l02132" id="l02132"></a>02132             (strcasecmp(value, <span class="stringliteral">"true"</span>) == 0) ||
<a name="l02133" id="l02133"></a>02133             (*value == <span class="charliteral">'1'</span>) )) {
<a name="l02134" id="l02134"></a>02134 
<a name="l02135" id="l02135"></a>02135         netsnmp_ds_set_int(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_OID_OUTPUT_FORMAT,
<a name="l02136" id="l02136"></a>02136                                                   NETSNMP_OID_OUTPUT_NUMERIC);
<a name="l02137" id="l02137"></a>02137     }
<a name="l02138" id="l02138"></a>02138 }
<a name="l02139" id="l02139"></a>02139 
<a name="l02140" id="l02140"></a>02140 <span class="keywordtype">char</span>           *
<a name="l02141" id="l02141"></a>02141 snmp_out_toggle_options(<span class="keywordtype">char</span> *options)
<a name="l02142" id="l02142"></a>02142 {
<a name="l02143" id="l02143"></a>02143     <span class="keywordflow">while</span> (*options) {
<a name="l02144" id="l02144"></a>02144         <span class="keywordflow">switch</span> (*options++) {
<a name="l02145" id="l02145"></a>02145         <span class="keywordflow">case</span> <span class="charliteral">'0'</span>:
<a name="l02146" id="l02146"></a>02146             netsnmp_ds_toggle_boolean(NETSNMP_DS_LIBRARY_ID,
<a name="l02147" id="l02147"></a>02147                                       NETSNMP_DS_LIB_2DIGIT_HEX_OUTPUT);
<a name="l02148" id="l02148"></a>02148             <span class="keywordflow">break</span>;
<a name="l02149" id="l02149"></a>02149         <span class="keywordflow">case</span> <span class="charliteral">'a'</span>:
<a name="l02150" id="l02150"></a>02150             netsnmp_ds_set_int(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_STRING_OUTPUT_FORMAT,
<a name="l02151" id="l02151"></a>02151                                                       NETSNMP_STRING_OUTPUT_ASCII);
<a name="l02152" id="l02152"></a>02152             <span class="keywordflow">break</span>;
<a name="l02153" id="l02153"></a>02153         <span class="keywordflow">case</span> <span class="charliteral">'b'</span>:
<a name="l02154" id=
"l02154"></a>02154             netsnmp_ds_toggle_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_DONT_BREAKDOWN_OIDS);
<a name="l02155" id="l02155"></a>02155             <span class="keywordflow">break</span>;
<a name="l02156" id="l02156"></a>02156         <span class="keywordflow">case</span> <span class="charliteral">'e'</span>:
<a name="l02157" id=
"l02157"></a>02157             netsnmp_ds_toggle_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_PRINT_NUMERIC_ENUM);
<a name="l02158" id="l02158"></a>02158             <span class="keywordflow">break</span>;
<a name="l02159" id="l02159"></a>02159         <span class="keywordflow">case</span> <span class="charliteral">'E'</span>:
<a name="l02160" id=
"l02160"></a>02160             netsnmp_ds_toggle_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_ESCAPE_QUOTES);
<a name="l02161" id="l02161"></a>02161             <span class="keywordflow">break</span>;
<a name="l02162" id="l02162"></a>02162         <span class="keywordflow">case</span> <span class="charliteral">'f'</span>:
<a name="l02163" id="l02163"></a>02163             netsnmp_ds_set_int(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_OID_OUTPUT_FORMAT,
<a name="l02164" id="l02164"></a>02164                                                       NETSNMP_OID_OUTPUT_FULL);
<a name="l02165" id="l02165"></a>02165             <span class="keywordflow">break</span>;
<a name="l02166" id="l02166"></a>02166         <span class="keywordflow">case</span> <span class="charliteral">'n'</span>:
<a name="l02167" id="l02167"></a>02167             netsnmp_ds_set_int(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_OID_OUTPUT_FORMAT,
<a name="l02168" id="l02168"></a>02168                                                       NETSNMP_OID_OUTPUT_NUMERIC);
<a name="l02169" id="l02169"></a>02169             <span class="keywordflow">break</span>;
<a name="l02170" id="l02170"></a>02170         <span class="keywordflow">case</span> <span class="charliteral">'q'</span>:
<a name="l02171" id="l02171"></a>02171             netsnmp_ds_toggle_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICK_PRINT);
<a name="l02172" id="l02172"></a>02172             <span class="keywordflow">break</span>;
<a name="l02173" id="l02173"></a>02173         <span class="keywordflow">case</span> <span class="charliteral">'Q'</span>:
<a name="l02174" id="l02174"></a>02174             <a class="code" href=
"group__default__store.html#g1281eefe7d7f516e41f711d9289e1a06" title=
"Stores &amp;quot;true&amp;quot; or &amp;quot;false&amp;quot; given an int value for value into netsnmp_ds_booleans[s...">netsnmp_ds_set_boolean</a>(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICKE_PRINT, 1);
<a name="l02175" id="l02175"></a>02175             netsnmp_ds_toggle_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICK_PRINT);
<a name="l02176" id="l02176"></a>02176             <span class="keywordflow">break</span>;
<a name="l02177" id="l02177"></a>02177         <span class="keywordflow">case</span> <span class="charliteral">'s'</span>:
<a name="l02178" id="l02178"></a>02178             netsnmp_ds_set_int(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_OID_OUTPUT_FORMAT,
<a name="l02179" id="l02179"></a>02179                                                       NETSNMP_OID_OUTPUT_SUFFIX);
<a name="l02180" id="l02180"></a>02180             <span class="keywordflow">break</span>;
<a name="l02181" id="l02181"></a>02181         <span class="keywordflow">case</span> <span class="charliteral">'S'</span>:
<a name="l02182" id="l02182"></a>02182             netsnmp_ds_set_int(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_OID_OUTPUT_FORMAT,
<a name="l02183" id="l02183"></a>02183                                                       NETSNMP_OID_OUTPUT_MODULE);
<a name="l02184" id="l02184"></a>02184             <span class="keywordflow">break</span>;
<a name="l02185" id="l02185"></a>02185         <span class="keywordflow">case</span> <span class="charliteral">'t'</span>:
<a name="l02186" id=
"l02186"></a>02186             netsnmp_ds_toggle_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_NUMERIC_TIMETICKS);
<a name="l02187" id="l02187"></a>02187             <span class="keywordflow">break</span>;
<a name="l02188" id="l02188"></a>02188         <span class="keywordflow">case</span> <span class="charliteral">'T'</span>:
<a name="l02189" id=
"l02189"></a>02189             netsnmp_ds_toggle_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_PRINT_HEX_TEXT);
<a name="l02190" id="l02190"></a>02190             <span class="keywordflow">break</span>;
<a name="l02191" id="l02191"></a>02191         <span class="keywordflow">case</span> <span class="charliteral">'u'</span>:
<a name="l02192" id="l02192"></a>02192             netsnmp_ds_set_int(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_OID_OUTPUT_FORMAT,
<a name="l02193" id="l02193"></a>02193                                                       NETSNMP_OID_OUTPUT_UCD);
<a name="l02194" id="l02194"></a>02194             <span class="keywordflow">break</span>;
<a name="l02195" id="l02195"></a>02195         <span class="keywordflow">case</span> <span class="charliteral">'U'</span>:
<a name="l02196" id=
"l02196"></a>02196             netsnmp_ds_toggle_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_DONT_PRINT_UNITS);
<a name="l02197" id="l02197"></a>02197             <span class="keywordflow">break</span>;
<a name="l02198" id="l02198"></a>02198         <span class="keywordflow">case</span> <span class="charliteral">'v'</span>:
<a name="l02199" id=
"l02199"></a>02199             netsnmp_ds_toggle_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_PRINT_BARE_VALUE);
<a name="l02200" id="l02200"></a>02200             <span class="keywordflow">break</span>;
<a name="l02201" id="l02201"></a>02201         <span class="keywordflow">case</span> <span class="charliteral">'x'</span>:
<a name="l02202" id="l02202"></a>02202             netsnmp_ds_set_int(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_STRING_OUTPUT_FORMAT,
<a name="l02203" id="l02203"></a>02203                                                       NETSNMP_STRING_OUTPUT_HEX);
<a name="l02204" id="l02204"></a>02204             <span class="keywordflow">break</span>;
<a name="l02205" id="l02205"></a>02205         <span class="keywordflow">case</span> <span class="charliteral">'X'</span>:
<a name="l02206" id=
"l02206"></a>02206             netsnmp_ds_toggle_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_EXTENDED_INDEX);
<a name="l02207" id="l02207"></a>02207             <span class="keywordflow">break</span>;
<a name="l02208" id="l02208"></a>02208         <span class="keywordflow">default</span>:
<a name="l02209" id="l02209"></a>02209             <span class="keywordflow">return</span> options - 1;
<a name="l02210" id="l02210"></a>02210         }
<a name="l02211" id="l02211"></a>02211     }
<a name="l02212" id="l02212"></a>02212     <span class="keywordflow">return</span> NULL;
<a name="l02213" id="l02213"></a>02213 }
<a name="l02214" id="l02214"></a>02214 
<a name="l02215" id="l02215"></a>02215 <span class="keywordtype">void</span>
<a name="l02216" id="l02216"></a>02216 snmp_out_toggle_options_usage(<span class="keyword">const</span> <span class=
"keywordtype">char</span> *lead, FILE * outf)
<a name="l02217" id="l02217"></a>02217 {
<a name="l02218" id="l02218"></a>02218     fprintf(outf, <span class=
"stringliteral">"%s0:  print leading 0 for single-digit hex characters\n"</span>, lead);
<a name="l02219" id="l02219"></a>02219     fprintf(outf, <span class=
"stringliteral">"%sa:  print all strings in ascii format\n"</span>, lead);
<a name="l02220" id="l02220"></a>02220     fprintf(outf, <span class=
"stringliteral">"%sb:  do not break OID indexes down\n"</span>, lead);
<a name="l02221" id="l02221"></a>02221     fprintf(outf, <span class=
"stringliteral">"%se:  print enums numerically\n"</span>, lead);
<a name="l02222" id="l02222"></a>02222     fprintf(outf, <span class=
"stringliteral">"%sE:  escape quotes in string indices\n"</span>, lead);
<a name="l02223" id="l02223"></a>02223     fprintf(outf, <span class=
"stringliteral">"%sf:  print full OIDs on output\n"</span>, lead);
<a name="l02224" id="l02224"></a>02224     fprintf(outf, <span class=
"stringliteral">"%sn:  print OIDs numerically\n"</span>, lead);
<a name="l02225" id="l02225"></a>02225     fprintf(outf, <span class=
"stringliteral">"%sq:  quick print for easier parsing\n"</span>, lead);
<a name="l02226" id="l02226"></a>02226     fprintf(outf, <span class=
"stringliteral">"%sQ:  quick print with equal-signs\n"</span>, lead);    <span class="comment">/* @@JDW */</span>
<a name="l02227" id="l02227"></a>02227     fprintf(outf, <span class=
"stringliteral">"%ss:  print only last symbolic element of OID\n"</span>, lead);
<a name="l02228" id="l02228"></a>02228     fprintf(outf, <span class=
"stringliteral">"%sS:  print MIB module-id plus last element\n"</span>, lead);
<a name="l02229" id="l02229"></a>02229     fprintf(outf, <span class=
"stringliteral">"%st:  print timeticks unparsed as numeric integers\n"</span>,
<a name="l02230" id="l02230"></a>02230             lead);
<a name="l02231" id="l02231"></a>02231     fprintf(outf,
<a name="l02232" id="l02232"></a>02232             <span class=
"stringliteral">"%sT:  print human-readable text along with hex strings\n"</span>,
<a name="l02233" id="l02233"></a>02233             lead);
<a name="l02234" id="l02234"></a>02234     fprintf(outf, <span class=
"stringliteral">"%su:  print OIDs using UCD-style prefix suppression\n"</span>,
<a name="l02235" id="l02235"></a>02235             lead);
<a name="l02236" id="l02236"></a>02236     fprintf(outf, <span class="stringliteral">"%sU:  don't print units\n"</span>, lead);
<a name="l02237" id="l02237"></a>02237     fprintf(outf, <span class=
"stringliteral">"%sv:  print values only (not OID = value)\n"</span>, lead);
<a name="l02238" id="l02238"></a>02238     fprintf(outf, <span class=
"stringliteral">"%sx:  print all strings in hex format\n"</span>, lead);
<a name="l02239" id="l02239"></a>02239     fprintf(outf, <span class=
"stringliteral">"%sX:  extended index format\n"</span>, lead);
<a name="l02240" id="l02240"></a>02240 }
<a name="l02241" id="l02241"></a>02241 
<a name="l02242" id="l02242"></a>02242 <span class="keywordtype">char</span> *
<a name="l02243" id="l02243"></a>02243 snmp_in_options(<span class="keywordtype">char</span> *optarg, <span class=
"keywordtype">int</span> argc, <span class="keywordtype">char</span> *<span class="keyword">const</span> *argv)
<a name="l02244" id="l02244"></a>02244 {
<a name="l02245" id="l02245"></a>02245     <span class="keywordtype">char</span> *cp;
<a name="l02246" id="l02246"></a>02246 
<a name="l02247" id="l02247"></a>02247     <span class="keywordflow">for</span> (cp = optarg; *cp; cp++) {
<a name="l02248" id="l02248"></a>02248         <span class="keywordflow">switch</span> (*cp) {
<a name="l02249" id="l02249"></a>02249         <span class="keywordflow">case</span> <span class="charliteral">'b'</span>:
<a name="l02250" id="l02250"></a>02250             netsnmp_ds_toggle_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_REGEX_ACCESS);
<a name="l02251" id="l02251"></a>02251             <span class="keywordflow">break</span>;
<a name="l02252" id="l02252"></a>02252         <span class="keywordflow">case</span> <span class="charliteral">'R'</span>:
<a name="l02253" id=
"l02253"></a>02253             netsnmp_ds_toggle_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_RANDOM_ACCESS);
<a name="l02254" id="l02254"></a>02254             <span class="keywordflow">break</span>;
<a name="l02255" id="l02255"></a>02255         <span class="keywordflow">case</span> <span class="charliteral">'r'</span>:
<a name="l02256" id=
"l02256"></a>02256             netsnmp_ds_toggle_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_DONT_CHECK_RANGE);
<a name="l02257" id="l02257"></a>02257             <span class="keywordflow">break</span>;
<a name="l02258" id="l02258"></a>02258         <span class="keywordflow">case</span> <span class="charliteral">'h'</span>:
<a name="l02259" id=
"l02259"></a>02259             netsnmp_ds_toggle_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_NO_DISPLAY_HINT);
<a name="l02260" id="l02260"></a>02260             <span class="keywordflow">break</span>;
<a name="l02261" id="l02261"></a>02261         <span class="keywordflow">case</span> <span class="charliteral">'u'</span>:
<a name="l02262" id=
"l02262"></a>02262             netsnmp_ds_toggle_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_READ_UCD_STYLE_OID);
<a name="l02263" id="l02263"></a>02263             <span class="keywordflow">break</span>;
<a name="l02264" id="l02264"></a>02264         <span class="keywordflow">case</span> <span class="charliteral">'s'</span>:
<a name="l02265" id="l02265"></a>02265             <span class="comment">/* What if argc/argv are null ? */</span>
<a name="l02266" id="l02266"></a>02266             <span class="keywordflow">if</span> (!*(++cp))
<a name="l02267" id="l02267"></a>02267                 cp = argv[optind++];
<a name="l02268" id="l02268"></a>02268             netsnmp_ds_set_string(NETSNMP_DS_LIBRARY_ID,
<a name="l02269" id="l02269"></a>02269                                   NETSNMP_DS_LIB_OIDSUFFIX,
<a name="l02270" id="l02270"></a>02270                                   cp);
<a name="l02271" id="l02271"></a>02271             <span class="keywordflow">return</span> NULL;
<a name="l02272" id="l02272"></a>02272 
<a name="l02273" id="l02273"></a>02273         <span class="keywordflow">case</span> <span class="charliteral">'S'</span>:
<a name="l02274" id="l02274"></a>02274             <span class="comment">/* What if argc/argv are null ? */</span>
<a name="l02275" id="l02275"></a>02275             <span class="keywordflow">if</span> (!*(++cp))
<a name="l02276" id="l02276"></a>02276                 cp = argv[optind++];
<a name="l02277" id="l02277"></a>02277             netsnmp_ds_set_string(NETSNMP_DS_LIBRARY_ID,
<a name="l02278" id="l02278"></a>02278                                   NETSNMP_DS_LIB_OIDPREFIX,
<a name="l02279" id="l02279"></a>02279                                   cp);
<a name="l02280" id="l02280"></a>02280             <span class="keywordflow">return</span> NULL;
<a name="l02281" id="l02281"></a>02281 
<a name="l02282" id="l02282"></a>02282         <span class="keywordflow">default</span>:
<a name="l02283" id="l02283"></a>02283            <span class="comment">/*</span>
<a name="l02284" id="l02284"></a>02284 <span class="comment">            *  Here?  Or in snmp_parse_args?</span>
<a name="l02285" id="l02285"></a>02285 <span class=
"comment">            snmp_log(LOG_ERR, "Unknown input option passed to -I: %c.\n", *cp);</span>
<a name="l02286" id="l02286"></a>02286 <span class="comment">            */</span>
<a name="l02287" id="l02287"></a>02287             <span class="keywordflow">return</span> cp;
<a name="l02288" id="l02288"></a>02288         }
<a name="l02289" id="l02289"></a>02289     }
<a name="l02290" id="l02290"></a>02290     <span class="keywordflow">return</span> NULL;
<a name="l02291" id="l02291"></a>02291 }
<a name="l02292" id="l02292"></a>02292 
<a name="l02293" id="l02293"></a>02293 <span class="keywordtype">char</span>           *
<a name="l02294" id="l02294"></a>02294 snmp_in_toggle_options(<span class="keywordtype">char</span> *options)
<a name="l02295" id="l02295"></a>02295 {
<a name="l02296" id="l02296"></a>02296     <span class="keywordflow">return</span> snmp_in_options( options, 0, NULL );
<a name="l02297" id="l02297"></a>02297 }
<a name="l02298" id="l02298"></a>02298 
<a name="l02299" id="l02299"></a>02299 
<a name="l02307" id="l02307"></a>02307 <span class="keywordtype">void</span>
<a name="l02308" id="l02308"></a><a class="code" href=
"group__mib__utilities.html#g13ca3f3244082039f1bd93a477fc0e97">02308</a> <a class="code" href=
"group__mib__utilities.html#g13ca3f3244082039f1bd93a477fc0e97" title=
"Prints out a help usage for the in* toggle options.">snmp_in_toggle_options_usage</a>(<span class=
"keyword">const</span> <span class="keywordtype">char</span> *lead, FILE * outf)
<a name="l02309" id="l02309"></a>02309 {
<a name="l02310" id="l02310"></a>02310     fprintf(outf, <span class=
"stringliteral">"%sb:  do best/regex matching to find a MIB node\n"</span>, lead);
<a name="l02311" id="l02311"></a>02311     fprintf(outf, <span class=
"stringliteral">"%sh:  don't apply DISPLAY-HINTs\n"</span>, lead);
<a name="l02312" id="l02312"></a>02312     fprintf(outf, <span class=
"stringliteral">"%sr:  do not check values for range/type legality\n"</span>, lead);
<a name="l02313" id="l02313"></a>02313     fprintf(outf, <span class=
"stringliteral">"%sR:  do random access to OID labels\n"</span>, lead);
<a name="l02314" id="l02314"></a>02314     fprintf(outf,
<a name="l02315" id="l02315"></a>02315             <span class=
"stringliteral">"%su:  top-level OIDs must have '.' prefix (UCD-style)\n"</span>, lead);
<a name="l02316" id="l02316"></a>02316     fprintf(outf,
<a name="l02317" id="l02317"></a>02317             <span class=
"stringliteral">"%ss SUFFIX:  Append all textual OIDs with SUFFIX before parsing\n"</span>,
<a name="l02318" id="l02318"></a>02318             lead);
<a name="l02319" id="l02319"></a>02319     fprintf(outf,
<a name="l02320" id="l02320"></a>02320             <span class=
"stringliteral">"%sS PREFIX:  Prepend all textual OIDs with PREFIX before parsing\n"</span>,
<a name="l02321" id="l02321"></a>02321             lead);
<a name="l02322" id="l02322"></a>02322 }
<a name="l02323" id="l02323"></a>02323 
<a name="l02324" id="l02324"></a>02324 <span class="comment">/***</span>
<a name="l02325" id="l02325"></a>02325 <span class="comment"> *</span>
<a name="l02326" id="l02326"></a>02326 <span class="comment"> */</span> 
<a name="l02327" id="l02327"></a>02327 <span class="keywordtype">void</span>
<a name="l02328" id="l02328"></a>02328 register_mib_handlers(<span class="keywordtype">void</span>)
<a name="l02329" id="l02329"></a>02329 {
<a name="l02330" id="l02330"></a>02330 <span class="preprocessor">#ifndef NETSNMP_DISABLE_MIB_LOADING</span>
<a name="l02331" id="l02331"></a>02331     register_prenetsnmp_mib_handler(<span class=
"stringliteral">"snmp"</span>, <span class="stringliteral">"mibdirs"</span>,
<a name="l02332" id="l02332"></a>02332                                     handle_mibdirs_conf, NULL,
<a name="l02333" id="l02333"></a>02333                                     <span class=
"stringliteral">"[mib-dirs|+mib-dirs|-mib-dirs]"</span>);
<a name="l02334" id="l02334"></a>02334     register_prenetsnmp_mib_handler(<span class=
"stringliteral">"snmp"</span>, <span class="stringliteral">"mibs"</span>,
<a name="l02335" id="l02335"></a>02335                                     handle_mibs_conf, NULL,
<a name="l02336" id="l02336"></a>02336                                     <span class=
"stringliteral">"[mib-tokens|+mib-tokens]"</span>);
<a name="l02337" id="l02337"></a>02337     <a class="code" href="group__read__config.html#g9a3e481d8eb7d3ef08efa25b9a186c3b"
title=
"register_config_handler registers handlers for certain tokens specified in certain...">register_config_handler</a>(<span class=
"stringliteral">"snmp"</span>, <span class="stringliteral">"mibfile"</span>,
<a name="l02338" id="l02338"></a>02338                             handle_mibfile_conf, NULL, <span class=
"stringliteral">"mibfile-to-read"</span>);
<a name="l02339" id="l02339"></a>02339     <span class="comment">/*</span>
<a name="l02340" id="l02340"></a>02340 <span class=
"comment">     * register the snmp.conf configuration handlers for default</span>
<a name="l02341" id="l02341"></a>02341 <span class="comment">     * parsing behaviour </span>
<a name="l02342" id="l02342"></a>02342 <span class="comment">     */</span>
<a name="l02343" id="l02343"></a>02343 
<a name="l02344" id="l02344"></a>02344     netsnmp_ds_register_premib(ASN_BOOLEAN, <span class=
"stringliteral">"snmp"</span>, <span class="stringliteral">"showMibErrors"</span>,
<a name="l02345" id="l02345"></a>02345                        NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_MIB_ERRORS);
<a name="l02346" id="l02346"></a>02346     netsnmp_ds_register_premib(ASN_BOOLEAN, <span class=
"stringliteral">"snmp"</span>, <span class="stringliteral">"commentToEOL"</span>,     <span class=
"comment">/* Describes actual behaviour */</span>
<a name="l02347" id="l02347"></a>02347                        NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_MIB_COMMENT_TERM);
<a name="l02348" id="l02348"></a>02348     netsnmp_ds_register_premib(ASN_BOOLEAN, <span class=
"stringliteral">"snmp"</span>, <span class="stringliteral">"strictCommentTerm"</span>,    <span class=
"comment">/* Backward compatibility */</span>
<a name="l02349" id="l02349"></a>02349                        NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_MIB_COMMENT_TERM);
<a name="l02350" id="l02350"></a>02350     netsnmp_ds_register_premib(ASN_BOOLEAN, <span class=
"stringliteral">"snmp"</span>, <span class="stringliteral">"mibAllowUnderline"</span>,
<a name="l02351" id="l02351"></a>02351                        NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_MIB_PARSE_LABEL);
<a name="l02352" id="l02352"></a>02352     netsnmp_ds_register_premib(ASN_INTEGER, <span class=
"stringliteral">"snmp"</span>, <span class="stringliteral">"mibWarningLevel"</span>,
<a name="l02353" id="l02353"></a>02353                        NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_MIB_WARNINGS);
<a name="l02354" id="l02354"></a>02354     netsnmp_ds_register_premib(ASN_BOOLEAN, <span class=
"stringliteral">"snmp"</span>, <span class="stringliteral">"mibReplaceWithLatest"</span>,
<a name="l02355" id="l02355"></a>02355                        NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_MIB_REPLACE);
<a name="l02356" id="l02356"></a>02356 <span class="preprocessor">#endif</span>
<a name="l02357" id="l02357"></a>02357 
<a name="l02358" id="l02358"></a>02358     netsnmp_ds_register_premib(ASN_BOOLEAN, <span class=
"stringliteral">"snmp"</span>, <span class="stringliteral">"printNumericEnums"</span>,
<a name="l02359" id="l02359"></a>02359                        NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_PRINT_NUMERIC_ENUM);
<a name="l02360" id="l02360"></a>02360     register_prenetsnmp_mib_handler(<span class=
"stringliteral">"snmp"</span>, <span class="stringliteral">"printNumericOids"</span>,
<a name="l02361" id="l02361"></a>02361                        handle_print_numeric, NULL, <span class=
"stringliteral">"(1|yes|true|0|no|false)"</span>);
<a name="l02362" id="l02362"></a>02362     netsnmp_ds_register_premib(ASN_BOOLEAN, <span class=
"stringliteral">"snmp"</span>, <span class="stringliteral">"escapeQuotes"</span>,
<a name="l02363" id="l02363"></a>02363                        NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_ESCAPE_QUOTES);
<a name="l02364" id="l02364"></a>02364     netsnmp_ds_register_premib(ASN_BOOLEAN, <span class=
"stringliteral">"snmp"</span>, <span class="stringliteral">"dontBreakdownOids"</span>,
<a name="l02365" id="l02365"></a>02365                        NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_DONT_BREAKDOWN_OIDS);
<a name="l02366" id="l02366"></a>02366     netsnmp_ds_register_premib(ASN_BOOLEAN, <span class=
"stringliteral">"snmp"</span>, <span class="stringliteral">"quickPrinting"</span>,
<a name="l02367" id="l02367"></a>02367                        NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICK_PRINT);
<a name="l02368" id="l02368"></a>02368     netsnmp_ds_register_premib(ASN_BOOLEAN, <span class=
"stringliteral">"snmp"</span>, <span class="stringliteral">"numericTimeticks"</span>,
<a name="l02369" id="l02369"></a>02369                        NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_NUMERIC_TIMETICKS);
<a name="l02370" id="l02370"></a>02370     netsnmp_ds_register_premib(ASN_INTEGER, <span class=
"stringliteral">"snmp"</span>, <span class="stringliteral">"oidOutputFormat"</span>,
<a name="l02371" id="l02371"></a>02371                        NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_OID_OUTPUT_FORMAT);
<a name="l02372" id="l02372"></a>02372     netsnmp_ds_register_premib(ASN_INTEGER, <span class=
"stringliteral">"snmp"</span>, <span class="stringliteral">"suffixPrinting"</span>,
<a name="l02373" id="l02373"></a>02373                        NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_OID_OUTPUT_FORMAT);
<a name="l02374" id="l02374"></a>02374     netsnmp_ds_register_premib(ASN_BOOLEAN, <span class=
"stringliteral">"snmp"</span>, <span class="stringliteral">"extendedIndex"</span>,
<a name="l02375" id="l02375"></a>02375                        NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_EXTENDED_INDEX);
<a name="l02376" id="l02376"></a>02376     netsnmp_ds_register_premib(ASN_BOOLEAN, <span class=
"stringliteral">"snmp"</span>, <span class="stringliteral">"printHexText"</span>,
<a name="l02377" id="l02377"></a>02377                        NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_PRINT_HEX_TEXT);
<a name="l02378" id="l02378"></a>02378     netsnmp_ds_register_premib(ASN_BOOLEAN, <span class=
"stringliteral">"snmp"</span>, <span class="stringliteral">"printValueOnly"</span>,
<a name="l02379" id="l02379"></a>02379                        NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_PRINT_BARE_VALUE);
<a name="l02380" id="l02380"></a>02380     netsnmp_ds_register_premib(ASN_BOOLEAN, <span class=
"stringliteral">"snmp"</span>, <span class="stringliteral">"dontPrintUnits"</span>,
<a name="l02381" id="l02381"></a>02381                        NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_DONT_PRINT_UNITS);
<a name="l02382" id="l02382"></a>02382     netsnmp_ds_register_premib(ASN_INTEGER, <span class=
"stringliteral">"snmp"</span>, <span class="stringliteral">"hexOutputLength"</span>,
<a name="l02383" id="l02383"></a>02383                        NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_HEX_OUTPUT_LENGTH);
<a name="l02384" id="l02384"></a>02384 }
<a name="l02385" id="l02385"></a>02385 
<a name="l02386" id="l02386"></a>02386 <span class="preprocessor">#ifndef NETSNMP_DISABLE_MIB_LOADING</span>
<a name="l02387" id="l02387"></a>02387 <span class="comment">/*</span>
<a name="l02388" id="l02388"></a>02388 <span class="comment"> * function : netsnmp_set_mib_directory</span>
<a name="l02389" id="l02389"></a>02389 <span class=
"comment"> *            - This function sets the string of the directories</span>
<a name="l02390" id="l02390"></a>02390 <span class=
"comment"> *              from which the MIB modules will be searched or</span>
<a name="l02391" id="l02391"></a>02391 <span class="comment"> *              loaded.</span>
<a name="l02392" id="l02392"></a>02392 <span class="comment"> * arguments: const char *dir, which are the directories</span>
<a name="l02393" id="l02393"></a>02393 <span class=
"comment"> *              from which the MIB modules will be searched or</span>
<a name="l02394" id="l02394"></a>02394 <span class="comment"> *              loaded.</span>
<a name="l02395" id="l02395"></a>02395 <span class="comment"> * returns  : -</span>
<a name="l02396" id="l02396"></a>02396 <span class="comment"> */</span>
<a name="l02397" id="l02397"></a>02397 <span class="keywordtype">void</span>
<a name="l02398" id="l02398"></a><a class="code" href=
"group__mib__utilities.html#g19de60dd547c6e8decfc13d56270d285">02398</a> <a class="code" href=
"group__mib__utilities.html#g19de60dd547c6e8decfc13d56270d285">netsnmp_set_mib_directory</a>(<span class=
"keyword">const</span> <span class="keywordtype">char</span> *dir)
<a name="l02399" id="l02399"></a>02399 {
<a name="l02400" id="l02400"></a>02400     <span class="keyword">const</span> <span class="keywordtype">char</span> *newdir;
<a name="l02401" id="l02401"></a>02401     <span class="keywordtype">char</span> *olddir, *tmpdir = NULL;
<a name="l02402" id="l02402"></a>02402 
<a name="l02403" id="l02403"></a>02403     DEBUGTRACE;
<a name="l02404" id="l02404"></a>02404     <span class="keywordflow">if</span> (NULL == dir) {
<a name="l02405" id="l02405"></a>02405         <span class="keywordflow">return</span>;
<a name="l02406" id="l02406"></a>02406     }
<a name="l02407" id="l02407"></a>02407     
<a name="l02408" id="l02408"></a>02408     olddir = netsnmp_ds_get_string(NETSNMP_DS_LIBRARY_ID,
<a name="l02409" id="l02409"></a>02409                                    NETSNMP_DS_LIB_MIBDIRS);
<a name="l02410" id="l02410"></a>02410     <span class="keywordflow">if</span> (olddir) {
<a name="l02411" id="l02411"></a>02411         <span class="keywordflow">if</span> ((*dir == <span class=
"charliteral">'+'</span>) || (*dir == <span class="charliteral">'-'</span>)) {
<a name="l02413" id="l02413"></a>02413             tmpdir = (<span class=
"keywordtype">char</span> *)malloc(strlen(dir) + strlen(olddir) + 2);
<a name="l02414" id="l02414"></a>02414             <span class="keywordflow">if</span> (!tmpdir) {
<a name="l02415" id="l02415"></a>02415                 DEBUGMSGTL((<span class=
"stringliteral">"read_config:initmib"</span>, <span class="stringliteral">"set mibdir malloc failed"</span>));
<a name="l02416" id="l02416"></a>02416                 <span class="keywordflow">return</span>;
<a name="l02417" id="l02417"></a>02417             }
<a name="l02418" id="l02418"></a>02418             <span class="keywordflow">if</span> (*dir++ == <span class=
"charliteral">'+'</span>)
<a name="l02419" id="l02419"></a>02419                 sprintf(tmpdir, <span class=
"stringliteral">"%s%c%s"</span>, olddir, ENV_SEPARATOR_CHAR, dir);
<a name="l02420" id="l02420"></a>02420             <span class="keywordflow">else</span>
<a name="l02421" id="l02421"></a>02421                 sprintf(tmpdir, <span class=
"stringliteral">"%s%c%s"</span>, dir, ENV_SEPARATOR_CHAR, olddir);
<a name="l02422" id="l02422"></a>02422             newdir = tmpdir;
<a name="l02423" id="l02423"></a>02423         } <span class="keywordflow">else</span> {
<a name="l02424" id="l02424"></a>02424             newdir = dir;
<a name="l02425" id="l02425"></a>02425         }
<a name="l02426" id="l02426"></a>02426     } <span class="keywordflow">else</span> {
<a name="l02428" id="l02428"></a>02428         newdir = ((*dir == <span class="charliteral">'+'</span>) ? ++dir : dir);
<a name="l02429" id="l02429"></a>02429     }
<a name="l02430" id="l02430"></a>02430     netsnmp_ds_set_string(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_MIBDIRS,
<a name="l02431" id="l02431"></a>02431                           newdir);
<a name="l02432" id="l02432"></a>02432 
<a name="l02434" id="l02434"></a>02434     <span class="keywordflow">if</span> (tmpdir == newdir) {
<a name="l02435" id="l02435"></a>02435         <a class="code" href="group__util.html#g951e93edb6f0ea941e26155e3f8912a6" title=
"Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(tmpdir);
<a name="l02436" id="l02436"></a>02436     }
<a name="l02437" id="l02437"></a>02437 }
<a name="l02438" id="l02438"></a>02438 
<a name="l02439" id="l02439"></a>02439 <span class="comment">/*</span>
<a name="l02440" id="l02440"></a>02440 <span class="comment"> * function : netsnmp_get_mib_directory</span>
<a name="l02441" id="l02441"></a>02441 <span class=
"comment"> *            - This function returns a string of the directories</span>
<a name="l02442" id="l02442"></a>02442 <span class=
"comment"> *              from which the MIB modules will be searched or</span>
<a name="l02443" id="l02443"></a>02443 <span class="comment"> *              loaded.</span>
<a name="l02444" id="l02444"></a>02444 <span class=
"comment"> *              If the value still does not exists, it will be made</span>
<a name="l02445" id="l02445"></a>02445 <span class=
"comment"> *              from the evironment variable 'MIBDIRS' and/or the</span>
<a name="l02446" id="l02446"></a>02446 <span class="comment"> *              default.</span>
<a name="l02447" id="l02447"></a>02447 <span class="comment"> * arguments: -</span>
<a name="l02448" id="l02448"></a>02448 <span class=
"comment"> * returns  : char * of the directories in which the MIB modules</span>
<a name="l02449" id="l02449"></a>02449 <span class="comment"> *            will be searched/loaded.</span>
<a name="l02450" id="l02450"></a>02450 <span class="comment"> */</span>
<a name="l02451" id="l02451"></a>02451 
<a name="l02452" id="l02452"></a>02452 <span class="keywordtype">char</span> *
<a name="l02453" id="l02453"></a><a class="code" href=
"group__mib__utilities.html#g139a824603d7ffb3dd2ff44612c2d6d2">02453</a> <a class="code" href=
"group__mib__utilities.html#g139a824603d7ffb3dd2ff44612c2d6d2">netsnmp_get_mib_directory</a>(<span class=
"keywordtype">void</span>)
<a name="l02454" id="l02454"></a>02454 {
<a name="l02455" id="l02455"></a>02455     <span class="keywordtype">char</span> *dir;
<a name="l02456" id="l02456"></a>02456 
<a name="l02457" id="l02457"></a>02457     DEBUGTRACE;
<a name="l02458" id="l02458"></a>02458     dir = netsnmp_ds_get_string(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_MIBDIRS);
<a name="l02459" id="l02459"></a>02459     <span class="keywordflow">if</span> (dir == NULL) {
<a name="l02460" id="l02460"></a>02460         DEBUGMSGTL((<span class="stringliteral">"get_mib_directory"</span>, <span class=
"stringliteral">"no mib directories set\n"</span>));
<a name="l02461" id="l02461"></a>02461 
<a name="l02463" id="l02463"></a>02463         dir = <a class="code" href="group__util.html#g1816d1ce1e701fcbce27b20159433313"
title="Non Windows: Returns a pointer to the desired environment variable or NULL if the...">netsnmp_getenv</a>(<span class=
"stringliteral">"MIBDIRS"</span>);
<a name="l02464" id="l02464"></a>02464         <span class="keywordflow">if</span> (dir == NULL) {
<a name="l02465" id="l02465"></a>02465             DEBUGMSGTL((<span class=
"stringliteral">"get_mib_directory"</span>, <span class="stringliteral">"no mib directories set by environment\n"</span>));
<a name="l02467" id="l02467"></a>02467             <span class="keywordflow">if</span> (confmibdir == NULL) {
<a name="l02468" id="l02468"></a>02468                 DEBUGMSGTL((<span class=
"stringliteral">"get_mib_directory"</span>, <span class="stringliteral">"no mib directories set by config\n"</span>));
<a name="l02469" id="l02469"></a>02469                 <a class="code" href=
"group__mib__utilities.html#g19de60dd547c6e8decfc13d56270d285">netsnmp_set_mib_directory</a>(NETSNMP_DEFAULT_MIBDIRS);
<a name="l02470" id="l02470"></a>02470             }
<a name="l02471" id="l02471"></a>02471             <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> ((*confmibdir == <span class="charliteral">'+'</span>) || (*confmibdir == <span class=
"charliteral">'-'</span>)) {
<a name="l02472" id="l02472"></a>02472                 DEBUGMSGTL((<span class=
"stringliteral">"get_mib_directory"</span>, <span class="stringliteral">"mib directories set by config (but added)\n"</span>));
<a name="l02473" id="l02473"></a>02473                 <a class="code" href=
"group__mib__utilities.html#g19de60dd547c6e8decfc13d56270d285">netsnmp_set_mib_directory</a>(NETSNMP_DEFAULT_MIBDIRS);
<a name="l02474" id="l02474"></a>02474                 <a class="code" href=
"group__mib__utilities.html#g19de60dd547c6e8decfc13d56270d285">netsnmp_set_mib_directory</a>(confmibdir);
<a name="l02475" id="l02475"></a>02475             }
<a name="l02476" id="l02476"></a>02476             <span class="keywordflow">else</span> {
<a name="l02477" id="l02477"></a>02477                 DEBUGMSGTL((<span class=
"stringliteral">"get_mib_directory"</span>, <span class="stringliteral">"mib directories set by config\n"</span>));
<a name="l02478" id="l02478"></a>02478                 <a class="code" href=
"group__mib__utilities.html#g19de60dd547c6e8decfc13d56270d285">netsnmp_set_mib_directory</a>(confmibdir);
<a name="l02479" id="l02479"></a>02479             }
<a name="l02480" id="l02480"></a>02480         } <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> ((*dir == <span class="charliteral">'+'</span>) || (*dir == <span class="charliteral">'-'</span>)) {
<a name="l02481" id="l02481"></a>02481             DEBUGMSGTL((<span class=
"stringliteral">"get_mib_directory"</span>, <span class=
"stringliteral">"mib directories set by environment (but added)\n"</span>));
<a name="l02482" id="l02482"></a>02482             <a class="code" href=
"group__mib__utilities.html#g19de60dd547c6e8decfc13d56270d285">netsnmp_set_mib_directory</a>(NETSNMP_DEFAULT_MIBDIRS);
<a name="l02483" id="l02483"></a>02483             <a class="code" href=
"group__mib__utilities.html#g19de60dd547c6e8decfc13d56270d285">netsnmp_set_mib_directory</a>(dir);
<a name="l02484" id="l02484"></a>02484         } <span class="keywordflow">else</span> {
<a name="l02485" id="l02485"></a>02485             DEBUGMSGTL((<span class=
"stringliteral">"get_mib_directory"</span>, <span class="stringliteral">"mib directories set by environment\n"</span>));
<a name="l02486" id="l02486"></a>02486             <a class="code" href=
"group__mib__utilities.html#g19de60dd547c6e8decfc13d56270d285">netsnmp_set_mib_directory</a>(dir);
<a name="l02487" id="l02487"></a>02487         }
<a name="l02488" id="l02488"></a>02488         dir = netsnmp_ds_get_string(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_MIBDIRS);
<a name="l02489" id="l02489"></a>02489     }
<a name="l02490" id="l02490"></a>02490     DEBUGMSGTL((<span class="stringliteral">"get_mib_directory"</span>, <span class=
"stringliteral">"mib directories set '%s'\n"</span>, dir));
<a name="l02491" id="l02491"></a>02491     <span class="keywordflow">return</span>(dir);
<a name="l02492" id="l02492"></a>02492 }
<a name="l02493" id="l02493"></a>02493 
<a name="l02494" id="l02494"></a>02494 <span class="comment">/*</span>
<a name="l02495" id="l02495"></a>02495 <span class="comment"> * function : netsnmp_fixup_mib_directory</span>
<a name="l02496" id="l02496"></a>02496 <span class="comment"> * arguments: -</span>
<a name="l02497" id="l02497"></a>02497 <span class="comment"> * returns  : -</span>
<a name="l02498" id="l02498"></a>02498 <span class="comment"> */</span>
<a name="l02499" id="l02499"></a>02499 <span class="keywordtype">void</span>
<a name="l02500" id="l02500"></a><a class="code" href=
"group__mib__utilities.html#g68a70a3a149e744096183954dc6adcdd">02500</a> <a class="code" href=
"group__mib__utilities.html#g68a70a3a149e744096183954dc6adcdd">netsnmp_fixup_mib_directory</a>(<span class=
"keywordtype">void</span>)
<a name="l02501" id="l02501"></a>02501 {
<a name="l02502" id="l02502"></a>02502     <span class="keywordtype">char</span> *homepath = <a class="code" href=
"group__util.html#g1816d1ce1e701fcbce27b20159433313" title=
"Non Windows: Returns a pointer to the desired environment variable or NULL if the...">netsnmp_getenv</a>(<span class=
"stringliteral">"HOME"</span>);
<a name="l02503" id="l02503"></a>02503     <span class="keywordtype">char</span> *mibpath = <a class="code" href=
"group__mib__utilities.html#g139a824603d7ffb3dd2ff44612c2d6d2">netsnmp_get_mib_directory</a>();
<a name="l02504" id="l02504"></a>02504     <span class="keywordtype">char</span> *oldmibpath = NULL;
<a name="l02505" id="l02505"></a>02505     <span class="keywordtype">char</span> *ptr_home;
<a name="l02506" id="l02506"></a>02506     <span class="keywordtype">char</span> *new_mibpath;
<a name="l02507" id="l02507"></a>02507 
<a name="l02508" id="l02508"></a>02508     DEBUGTRACE;
<a name="l02509" id="l02509"></a>02509     <span class="keywordflow">if</span> (homepath &amp;&amp; mibpath) {
<a name="l02510" id="l02510"></a>02510         DEBUGMSGTL((<span class="stringliteral">"fixup_mib_directory"</span>, <span class=
"stringliteral">"mib directories '%s'\n"</span>, mibpath));
<a name="l02511" id="l02511"></a>02511         <span class="keywordflow">while</span> ((ptr_home = strstr(mibpath, <span class=
"stringliteral">"$HOME"</span>))) {
<a name="l02512" id="l02512"></a>02512             new_mibpath = (<span class=
"keywordtype">char</span> *)malloc(strlen(mibpath) - strlen(<span class="stringliteral">"$HOME"</span>) +
<a name="l02513" id="l02513"></a>02513                                          strlen(homepath)+1);
<a name="l02514" id="l02514"></a>02514             <span class="keywordflow">if</span> (new_mibpath) {
<a name="l02515" id="l02515"></a>02515                 *ptr_home = 0; <span class=
"comment">/* null out the spot where we stop copying */</span>
<a name="l02516" id="l02516"></a>02516                 sprintf(new_mibpath, <span class=
"stringliteral">"%s%s%s"</span>, mibpath, homepath,
<a name="l02517" id="l02517"></a>02517                         ptr_home + strlen(<span class="stringliteral">"$HOME"</span>));
<a name="l02519" id="l02519"></a>02519                 mibpath = new_mibpath;
<a name="l02520" id="l02520"></a>02520                 <span class="keywordflow">if</span> (oldmibpath != NULL) {
<a name="l02521" id="l02521"></a>02521                     <a class="code" href=
"group__util.html#g951e93edb6f0ea941e26155e3f8912a6" title=
"Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(oldmibpath);
<a name="l02522" id="l02522"></a>02522                 }
<a name="l02523" id="l02523"></a>02523                 oldmibpath = new_mibpath;
<a name="l02524" id="l02524"></a>02524             } <span class="keywordflow">else</span> {
<a name="l02525" id="l02525"></a>02525                 <span class="keywordflow">break</span>;
<a name="l02526" id="l02526"></a>02526             }
<a name="l02527" id="l02527"></a>02527         }
<a name="l02528" id="l02528"></a>02528 
<a name="l02529" id="l02529"></a>02529         <a class="code" href=
"group__mib__utilities.html#g19de60dd547c6e8decfc13d56270d285">netsnmp_set_mib_directory</a>(mibpath);
<a name="l02530" id="l02530"></a>02530         
<a name="l02531" id="l02531"></a>02531         <span class="comment">/*  The above copies the mibpath for us, so...  */</span>
<a name="l02532" id="l02532"></a>02532 
<a name="l02533" id="l02533"></a>02533         <span class="keywordflow">if</span> (oldmibpath != NULL) {
<a name="l02534" id="l02534"></a>02534             <a class="code" href="group__util.html#g951e93edb6f0ea941e26155e3f8912a6"
title="Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(oldmibpath);
<a name="l02535" id="l02535"></a>02535         }
<a name="l02536" id="l02536"></a>02536 
<a name="l02537" id="l02537"></a>02537     }
<a name="l02538" id="l02538"></a>02538 
<a name="l02539" id="l02539"></a>02539 }
<a name="l02540" id="l02540"></a>02540 
<a name="l02546" id="l02546"></a>02546 <span class="keywordtype">void</span>
<a name="l02547" id="l02547"></a><a class="code" href=
"group__mib__utilities.html#ge4976578d871e017d0deffd30afff243">02547</a> <a class="code" href=
"group__mib__utilities.html#ge4976578d871e017d0deffd30afff243" title=
"Initialises the mib reader.">netsnmp_init_mib</a>(<span class="keywordtype">void</span>)
<a name="l02548" id="l02548"></a>02548 {
<a name="l02549" id="l02549"></a>02549     <span class="keyword">const</span> <span class="keywordtype">char</span>     *prefix;
<a name="l02550" id="l02550"></a>02550     <span class="keywordtype">char</span>           *env_var, *entry;
<a name="l02551" id="l02551"></a>02551     PrefixListPtr   pp = &amp;mib_prefixes[0];
<a name="l02552" id="l02552"></a>02552     <span class="keywordtype">char</span>           *st = NULL;
<a name="l02553" id="l02553"></a>02553 
<a name="l02554" id="l02554"></a>02554     <span class="keywordflow">if</span> (Mib)
<a name="l02555" id="l02555"></a>02555         <span class="keywordflow">return</span>;
<a name="l02556" id="l02556"></a>02556     netsnmp_init_mib_internals();
<a name="l02557" id="l02557"></a>02557 
<a name="l02558" id="l02558"></a>02558     <span class="comment">/*</span>
<a name="l02559" id="l02559"></a>02559 <span class="comment">     * Initialise the MIB directory/ies </span>
<a name="l02560" id="l02560"></a>02560 <span class="comment">     */</span>
<a name="l02561" id="l02561"></a>02561     <a class="code" href=
"group__mib__utilities.html#g68a70a3a149e744096183954dc6adcdd">netsnmp_fixup_mib_directory</a>();
<a name="l02562" id="l02562"></a>02562     env_var = strdup(<a class="code" href=
"group__mib__utilities.html#g139a824603d7ffb3dd2ff44612c2d6d2">netsnmp_get_mib_directory</a>());
<a name="l02563" id="l02563"></a>02563     netsnmp_mibindex_load();
<a name="l02564" id="l02564"></a>02564 
<a name="l02565" id="l02565"></a>02565     DEBUGMSGTL((<span class="stringliteral">"init_mib"</span>,
<a name="l02566" id="l02566"></a>02566                 <span class=
"stringliteral">"Seen MIBDIRS: Looking in '%s' for mib dirs ...\n"</span>,
<a name="l02567" id="l02567"></a>02567                 env_var));
<a name="l02568" id="l02568"></a>02568 
<a name="l02569" id="l02569"></a>02569     entry = strtok_r(env_var, ENV_SEPARATOR, &amp;st);
<a name="l02570" id="l02570"></a>02570     <span class="keywordflow">while</span> (entry) {
<a name="l02571" id="l02571"></a>02571         add_mibdir(entry);
<a name="l02572" id="l02572"></a>02572         entry = strtok_r(NULL, ENV_SEPARATOR, &amp;st);
<a name="l02573" id="l02573"></a>02573     }
<a name="l02574" id="l02574"></a>02574     <a class="code" href="group__util.html#g951e93edb6f0ea941e26155e3f8912a6" title=
"Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(env_var);
<a name="l02575" id="l02575"></a>02575 
<a name="l02576" id="l02576"></a>02576     env_var = <a class="code" href="group__util.html#g1816d1ce1e701fcbce27b20159433313"
title="Non Windows: Returns a pointer to the desired environment variable or NULL if the...">netsnmp_getenv</a>(<span class=
"stringliteral">"MIBFILES"</span>);
<a name="l02577" id="l02577"></a>02577     <span class="keywordflow">if</span> (env_var != NULL) {
<a name="l02578" id="l02578"></a>02578         <span class="keywordflow">if</span> (*env_var == <span class=
"charliteral">'+'</span>)
<a name="l02579" id="l02579"></a>02579             entry = strtok_r(env_var+1, ENV_SEPARATOR, &amp;st);
<a name="l02580" id="l02580"></a>02580         <span class="keywordflow">else</span>
<a name="l02581" id="l02581"></a>02581             entry = strtok_r(env_var, ENV_SEPARATOR, &amp;st);
<a name="l02582" id="l02582"></a>02582         <span class="keywordflow">while</span> (entry) {
<a name="l02583" id="l02583"></a>02583             add_mibfile(entry, NULL, NULL);
<a name="l02584" id="l02584"></a>02584             entry = strtok_r(NULL, ENV_SEPARATOR, &amp;st);
<a name="l02585" id="l02585"></a>02585         }
<a name="l02586" id="l02586"></a>02586     }
<a name="l02587" id="l02587"></a>02587 
<a name="l02588" id="l02588"></a>02588     netsnmp_init_mib_internals();
<a name="l02589" id="l02589"></a>02589 
<a name="l02590" id="l02590"></a>02590     <span class="comment">/*</span>
<a name="l02591" id="l02591"></a>02591 <span class="comment">     * Read in any modules or mibs requested </span>
<a name="l02592" id="l02592"></a>02592 <span class="comment">     */</span>
<a name="l02593" id="l02593"></a>02593 
<a name="l02594" id="l02594"></a>02594     env_var = <a class="code" href="group__util.html#g1816d1ce1e701fcbce27b20159433313"
title="Non Windows: Returns a pointer to the desired environment variable or NULL if the...">netsnmp_getenv</a>(<span class=
"stringliteral">"MIBS"</span>);
<a name="l02595" id="l02595"></a>02595     <span class="keywordflow">if</span> (env_var == NULL) {
<a name="l02596" id="l02596"></a>02596         <span class="keywordflow">if</span> (confmibs != NULL)
<a name="l02597" id="l02597"></a>02597             env_var = strdup(confmibs);
<a name="l02598" id="l02598"></a>02598         <span class="keywordflow">else</span>
<a name="l02599" id="l02599"></a>02599             env_var = strdup(NETSNMP_DEFAULT_MIBS);
<a name="l02600" id="l02600"></a>02600     } <span class="keywordflow">else</span> {
<a name="l02601" id="l02601"></a>02601         env_var = strdup(env_var);
<a name="l02602" id="l02602"></a>02602     }
<a name="l02603" id="l02603"></a>02603     <span class="keywordflow">if</span> (env_var &amp;&amp; ((*env_var == <span class=
"charliteral">'+'</span>) || (*env_var == <span class="charliteral">'-'</span>))) {
<a name="l02604" id="l02604"></a>02604         entry =
<a name="l02605" id="l02605"></a>02605             (<span class=
"keywordtype">char</span> *) malloc(strlen(NETSNMP_DEFAULT_MIBS) + strlen(env_var) + 2);
<a name="l02606" id="l02606"></a>02606         <span class="keywordflow">if</span> (!entry) {
<a name="l02607" id="l02607"></a>02607             DEBUGMSGTL((<span class="stringliteral">"init_mib"</span>, <span class=
"stringliteral">"env mibs malloc failed"</span>));
<a name="l02608" id="l02608"></a>02608             <a class="code" href="group__util.html#g951e93edb6f0ea941e26155e3f8912a6"
title="Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(env_var);
<a name="l02609" id="l02609"></a>02609             <span class="keywordflow">return</span>;
<a name="l02610" id="l02610"></a>02610         } <span class="keywordflow">else</span> {
<a name="l02611" id="l02611"></a>02611             <span class="keywordflow">if</span> (*env_var == <span class=
"charliteral">'+'</span>)
<a name="l02612" id="l02612"></a>02612                 sprintf(entry, <span class=
"stringliteral">"%s%c%s"</span>, NETSNMP_DEFAULT_MIBS, ENV_SEPARATOR_CHAR,
<a name="l02613" id="l02613"></a>02613                         env_var+1);
<a name="l02614" id="l02614"></a>02614             <span class="keywordflow">else</span>
<a name="l02615" id="l02615"></a>02615                 sprintf(entry, <span class=
"stringliteral">"%s%c%s"</span>, env_var+1, ENV_SEPARATOR_CHAR,
<a name="l02616" id="l02616"></a>02616                         NETSNMP_DEFAULT_MIBS );
<a name="l02617" id="l02617"></a>02617         }
<a name="l02618" id="l02618"></a>02618         <a class="code" href="group__util.html#g951e93edb6f0ea941e26155e3f8912a6" title=
"Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(env_var);
<a name="l02619" id="l02619"></a>02619         env_var = entry;
<a name="l02620" id="l02620"></a>02620     }
<a name="l02621" id="l02621"></a>02621 
<a name="l02622" id="l02622"></a>02622     DEBUGMSGTL((<span class="stringliteral">"init_mib"</span>,
<a name="l02623" id="l02623"></a>02623                 <span class=
"stringliteral">"Seen MIBS: Looking in '%s' for mib files ...\n"</span>,
<a name="l02624" id="l02624"></a>02624                 env_var));
<a name="l02625" id="l02625"></a>02625     entry = strtok_r(env_var, ENV_SEPARATOR, &amp;st);
<a name="l02626" id="l02626"></a>02626     <span class="keywordflow">while</span> (entry) {
<a name="l02627" id="l02627"></a>02627         <span class="keywordflow">if</span> (strcasecmp(entry, DEBUG_ALWAYS_TOKEN) == 0) {
<a name="l02628" id="l02628"></a>02628             read_all_mibs();
<a name="l02629" id="l02629"></a>02629         } <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (strstr(entry, <span class="stringliteral">"/"</span>) != NULL) {
<a name="l02630" id="l02630"></a>02630             read_mib(entry);
<a name="l02631" id="l02631"></a>02631         } <span class="keywordflow">else</span> {
<a name="l02632" id="l02632"></a>02632             netsnmp_read_module(entry);
<a name="l02633" id="l02633"></a>02633         }
<a name="l02634" id="l02634"></a>02634         entry = strtok_r(NULL, ENV_SEPARATOR, &amp;st);
<a name="l02635" id="l02635"></a>02635     }
<a name="l02636" id="l02636"></a>02636     adopt_orphans();
<a name="l02637" id="l02637"></a>02637     <a class="code" href="group__util.html#g951e93edb6f0ea941e26155e3f8912a6" title=
"Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(env_var);
<a name="l02638" id="l02638"></a>02638 
<a name="l02639" id="l02639"></a>02639     env_var = <a class="code" href="group__util.html#g1816d1ce1e701fcbce27b20159433313"
title="Non Windows: Returns a pointer to the desired environment variable or NULL if the...">netsnmp_getenv</a>(<span class=
"stringliteral">"MIBFILES"</span>);
<a name="l02640" id="l02640"></a>02640     <span class="keywordflow">if</span> (env_var != NULL) {
<a name="l02641" id="l02641"></a>02641         <span class="keywordflow">if</span> ((*env_var == <span class=
"charliteral">'+'</span>) || (*env_var == <span class="charliteral">'-'</span>)) {
<a name="l02642" id="l02642"></a>02642 <span class="preprocessor">#ifdef NETSNMP_DEFAULT_MIBFILES</span>
<a name="l02643" id="l02643"></a>02643             entry =
<a name="l02644" id="l02644"></a>02644                 (<span class=
"keywordtype">char</span> *) malloc(strlen(NETSNMP_DEFAULT_MIBFILES) +
<a name="l02645" id="l02645"></a>02645                                 strlen(env_var) + 2);
<a name="l02646" id="l02646"></a>02646             <span class="keywordflow">if</span> (!entry) {
<a name="l02647" id="l02647"></a>02647                 DEBUGMSGTL((<span class="stringliteral">"init_mib"</span>, <span class=
"stringliteral">"env mibfiles malloc failed"</span>));
<a name="l02648" id="l02648"></a>02648             } <span class="keywordflow">else</span> {
<a name="l02649" id="l02649"></a>02649                 <span class="keywordflow">if</span> (*env_var++ == <span class=
"charliteral">'+'</span>)
<a name="l02650" id="l02650"></a>02650                     sprintf(entry, <span class=
"stringliteral">"%s%c%s"</span>, NETSNMP_DEFAULT_MIBFILES, ENV_SEPARATOR_CHAR,
<a name="l02651" id="l02651"></a>02651                             env_var );
<a name="l02652" id="l02652"></a>02652                 <span class="keywordflow">else</span>
<a name="l02653" id="l02653"></a>02653                     sprintf(entry, <span class=
"stringliteral">"%s%c%s"</span>, env_var, ENV_SEPARATOR_CHAR,
<a name="l02654" id="l02654"></a>02654                             NETSNMP_DEFAULT_MIBFILES );
<a name="l02655" id="l02655"></a>02655             }
<a name="l02656" id="l02656"></a>02656             <a class="code" href="group__util.html#g951e93edb6f0ea941e26155e3f8912a6"
title="Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(env_var);
<a name="l02657" id="l02657"></a>02657             env_var = entry;
<a name="l02658" id="l02658"></a>02658 <span class="preprocessor">#else</span>
<a name="l02659" id="l02659"></a>02659             env_var = strdup(env_var + 1);
<a name="l02660" id="l02660"></a>02660 <span class="preprocessor">#endif</span>
<a name="l02661" id="l02661"></a>02661         } <span class="keywordflow">else</span> {
<a name="l02662" id="l02662"></a>02662             env_var = strdup(env_var);
<a name="l02663" id="l02663"></a>02663         }
<a name="l02664" id="l02664"></a>02664     } <span class="keywordflow">else</span> {
<a name="l02665" id="l02665"></a>02665 <span class="preprocessor">#ifdef NETSNMP_DEFAULT_MIBFILES</span>
<a name="l02666" id="l02666"></a>02666         env_var = strdup(NETSNMP_DEFAULT_MIBFILES);
<a name="l02667" id="l02667"></a>02667 <span class="preprocessor">#endif</span>
<a name="l02668" id="l02668"></a>02668     }
<a name="l02669" id="l02669"></a>02669 
<a name="l02670" id="l02670"></a>02670     <span class="keywordflow">if</span> (env_var != NULL) {
<a name="l02671" id="l02671"></a>02671         DEBUGMSGTL((<span class="stringliteral">"init_mib"</span>,
<a name="l02672" id="l02672"></a>02672                     <span class=
"stringliteral">"Seen MIBFILES: Looking in '%s' for mib files ...\n"</span>,
<a name="l02673" id="l02673"></a>02673                     env_var));
<a name="l02674" id="l02674"></a>02674         entry = strtok_r(env_var, ENV_SEPARATOR, &amp;st);
<a name="l02675" id="l02675"></a>02675         <span class="keywordflow">while</span> (entry) {
<a name="l02676" id="l02676"></a>02676             read_mib(entry);
<a name="l02677" id="l02677"></a>02677             entry = strtok_r(NULL, ENV_SEPARATOR, &amp;st);
<a name="l02678" id="l02678"></a>02678         }
<a name="l02679" id="l02679"></a>02679         <a class="code" href="group__util.html#g951e93edb6f0ea941e26155e3f8912a6" title=
"Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(env_var);
<a name="l02680" id="l02680"></a>02680     }
<a name="l02681" id="l02681"></a>02681 
<a name="l02682" id="l02682"></a>02682     prefix = <a class="code" href="group__util.html#g1816d1ce1e701fcbce27b20159433313"
title="Non Windows: Returns a pointer to the desired environment variable or NULL if the...">netsnmp_getenv</a>(<span class=
"stringliteral">"PREFIX"</span>);
<a name="l02683" id="l02683"></a>02683 
<a name="l02684" id="l02684"></a>02684     <span class="keywordflow">if</span> (!prefix)
<a name="l02685" id="l02685"></a>02685         prefix = Standard_Prefix;
<a name="l02686" id="l02686"></a>02686 
<a name="l02687" id="l02687"></a>02687     Prefix = (<span class="keywordtype">char</span> *) malloc(strlen(prefix) + 2);
<a name="l02688" id="l02688"></a>02688     <span class="keywordflow">if</span> (!Prefix)
<a name="l02689" id="l02689"></a>02689         DEBUGMSGTL((<span class="stringliteral">"init_mib"</span>, <span class=
"stringliteral">"Prefix malloc failed"</span>));
<a name="l02690" id="l02690"></a>02690     <span class="keywordflow">else</span>
<a name="l02691" id="l02691"></a>02691         strcpy(Prefix, prefix);
<a name="l02692" id="l02692"></a>02692 
<a name="l02693" id="l02693"></a>02693     DEBUGMSGTL((<span class="stringliteral">"init_mib"</span>,
<a name="l02694" id="l02694"></a>02694                 <span class=
"stringliteral">"Seen PREFIX: Looking in '%s' for prefix ...\n"</span>, Prefix));
<a name="l02695" id="l02695"></a>02695 
<a name="l02696" id="l02696"></a>02696     <span class="comment">/*</span>
<a name="l02697" id="l02697"></a>02697 <span class="comment">     * remove trailing dot </span>
<a name="l02698" id="l02698"></a>02698 <span class="comment">     */</span>
<a name="l02699" id="l02699"></a>02699     <span class="keywordflow">if</span> (Prefix) {
<a name="l02700" id="l02700"></a>02700         env_var = &amp;Prefix[strlen(Prefix) - 1];
<a name="l02701" id="l02701"></a>02701         <span class="keywordflow">if</span> (*env_var == <span class=
"charliteral">'.'</span>)
<a name="l02702" id="l02702"></a>02702             *env_var = <span class="charliteral">'\0'</span>;
<a name="l02703" id="l02703"></a>02703     }
<a name="l02704" id="l02704"></a>02704 
<a name="l02705" id="l02705"></a>02705     pp-&gt;str = Prefix;           <span class=
"comment">/* fixup first mib_prefix entry */</span>
<a name="l02706" id="l02706"></a>02706     <span class="comment">/*</span>
<a name="l02707" id="l02707"></a>02707 <span class=
"comment">     * now that the list of prefixes is built, save each string length. </span>
<a name="l02708" id="l02708"></a>02708 <span class="comment">     */</span>
<a name="l02709" id="l02709"></a>02709     <span class="keywordflow">while</span> (pp-&gt;str) {
<a name="l02710" id="l02710"></a>02710         pp-&gt;len = strlen(pp-&gt;str);
<a name="l02711" id="l02711"></a>02711         pp++;
<a name="l02712" id="l02712"></a>02712     }
<a name="l02713" id="l02713"></a>02713 
<a name="l02714" id="l02714"></a>02714     Mib = tree_head;            <span class="comment">/* Backwards compatibility */</span>
<a name="l02715" id="l02715"></a>02715     tree_top = (<span class="keyword">struct </span>tree *) calloc(1, <span class=
"keyword">sizeof</span>(<span class="keyword">struct</span> tree));
<a name="l02716" id="l02716"></a>02716     <span class="comment">/*</span>
<a name="l02717" id="l02717"></a>02717 <span class="comment">     * XX error check ? </span>
<a name="l02718" id="l02718"></a>02718 <span class="comment">     */</span>
<a name="l02719" id="l02719"></a>02719     <span class="keywordflow">if</span> (tree_top) {
<a name="l02720" id="l02720"></a>02720         tree_top-&gt;label = strdup(<span class="stringliteral">"(top)"</span>);
<a name="l02721" id="l02721"></a>02721         tree_top-&gt;child_list = tree_head;
<a name="l02722" id="l02722"></a>02722     }
<a name="l02723" id="l02723"></a>02723 }
<a name="l02724" id="l02724"></a>02724 
<a name="l02725" id="l02725"></a>02725 <span class="preprocessor">#ifndef NETSNMP_NO_LEGACY_DEFINITIONS</span>
<a name="l02726" id="l02726"></a>02726 <span class="keywordtype">void</span>
<a name="l02727" id="l02727"></a>02727 init_mib(<span class="keywordtype">void</span>)
<a name="l02728" id="l02728"></a>02728 {
<a name="l02729" id="l02729"></a>02729     <a class="code" href="group__mib__utilities.html#ge4976578d871e017d0deffd30afff243"
title="Initialises the mib reader.">netsnmp_init_mib</a>();
<a name="l02730" id="l02730"></a>02730 }
<a name="l02731" id="l02731"></a>02731 <span class="preprocessor">#endif</span>
<a name="l02732" id="l02732"></a>02732 
<a name="l02733" id="l02733"></a>02733 
<a name="l02734" id="l02734"></a>02734 <span class="comment">/*</span>
<a name="l02735" id="l02735"></a>02735 <span class="comment"> * Handle MIB indexes centrally</span>
<a name="l02736" id="l02736"></a>02736 <span class="comment"> */</span>
<a name="l02737" id="l02737"></a>02737 <span class="keyword">static</span> <span class=
"keywordtype">int</span> _mibindex     = 0;   <span class="comment">/* Last index in use */</span>
<a name="l02738" id="l02738"></a>02738 <span class="keyword">static</span> <span class=
"keywordtype">int</span> _mibindex_max = 0;   <span class="comment">/* Size of index array */</span>
<a name="l02739" id="l02739"></a>02739 <span class="keywordtype">char</span>     **_mibindexes   = NULL;
<a name="l02740" id="l02740"></a>02740 
<a name="l02741" id="l02741"></a>02741 <span class="keywordtype">int</span> _mibindex_add( <span class=
"keyword">const</span> <span class="keywordtype">char</span> *dirname, <span class="keywordtype">int</span> i );
<a name="l02742" id="l02742"></a>02742 <span class="keywordtype">void</span>
<a name="l02743" id="l02743"></a>02743 netsnmp_mibindex_load( <span class="keywordtype">void</span> )
<a name="l02744" id="l02744"></a>02744 {
<a name="l02745" id="l02745"></a>02745     DIR *dir;
<a name="l02746" id="l02746"></a>02746     <span class="keyword">struct </span>dirent *file;
<a name="l02747" id="l02747"></a>02747     FILE *fp;
<a name="l02748" id="l02748"></a>02748     <span class="keywordtype">char</span> tmpbuf[ 300];
<a name="l02749" id="l02749"></a>02749     <span class="keywordtype">char</span> tmpbuf2[300];
<a name="l02750" id="l02750"></a>02750     <span class="keywordtype">int</span>  i;
<a name="l02751" id="l02751"></a>02751     <span class="keywordtype">char</span> *cp;
<a name="l02752" id="l02752"></a>02752 
<a name="l02753" id="l02753"></a>02753     <span class="comment">/*</span>
<a name="l02754" id="l02754"></a>02754 <span class="comment">     * Open the MIB index directory, or create it (empty)</span>
<a name="l02755" id="l02755"></a>02755 <span class="comment">     */</span>
<a name="l02756" id="l02756"></a>02756     snprintf( tmpbuf, <span class="keyword">sizeof</span>(tmpbuf), <span class=
"stringliteral">"%s/mib_indexes"</span>,
<a name="l02757" id="l02757"></a>02757               get_persistent_directory());
<a name="l02758" id="l02758"></a>02758     tmpbuf[<span class="keyword">sizeof</span>(tmpbuf)-1] = 0;
<a name="l02759" id="l02759"></a>02759     dir = opendir( tmpbuf );
<a name="l02760" id="l02760"></a>02760     <span class="keywordflow">if</span> ( dir == NULL ) {
<a name="l02761" id="l02761"></a>02761         DEBUGMSGTL((<span class="stringliteral">"mibindex"</span>, <span class=
"stringliteral">"load: (new)\n"</span>));
<a name="l02762" id="l02762"></a>02762         mkdirhier( tmpbuf, NETSNMP_AGENT_DIRECTORY_MODE, 0);
<a name="l02763" id="l02763"></a>02763         <span class="keywordflow">return</span>;
<a name="l02764" id="l02764"></a>02764     }
<a name="l02765" id="l02765"></a>02765 
<a name="l02766" id="l02766"></a>02766     <span class="comment">/*</span>
<a name="l02767" id="l02767"></a>02767 <span class="comment">     * Create a list of which directory each file refers to</span>
<a name="l02768" id="l02768"></a>02768 <span class="comment">     */</span>
<a name="l02769" id="l02769"></a>02769     <span class="keywordflow">while</span> ((file = readdir( dir ))) {
<a name="l02770" id="l02770"></a>02770         <span class="keywordflow">if</span> ( !isdigit(file-&gt;d_name[0]))
<a name="l02771" id="l02771"></a>02771             <span class="keywordflow">continue</span>;
<a name="l02772" id="l02772"></a>02772         i = atoi( file-&gt;d_name );
<a name="l02773" id="l02773"></a>02773 
<a name="l02774" id="l02774"></a>02774         snprintf( tmpbuf, <span class="keyword">sizeof</span>(tmpbuf), <span class=
"stringliteral">"%s/mib_indexes/%d"</span>,
<a name="l02775" id="l02775"></a>02775               get_persistent_directory(), i );
<a name="l02776" id="l02776"></a>02776         tmpbuf[<span class="keyword">sizeof</span>(tmpbuf)-1] = 0;
<a name="l02777" id="l02777"></a>02777         fp = fopen( tmpbuf, <span class="stringliteral">"r"</span> );
<a name="l02778" id="l02778"></a>02778         cp = fgets( tmpbuf2, <span class="keyword">sizeof</span>(tmpbuf2), fp );
<a name="l02779" id="l02779"></a>02779         <span class="keywordflow">if</span> ( !cp ) {
<a name="l02780" id="l02780"></a>02780             DEBUGMSGTL((<span class="stringliteral">"mibindex"</span>, <span class=
"stringliteral">"Empty MIB index (%d)\n"</span>, i));
<a name="l02781" id="l02781"></a>02781             fclose(fp);
<a name="l02782" id="l02782"></a>02782             <span class="keywordflow">continue</span>;
<a name="l02783" id="l02783"></a>02783         }
<a name="l02784" id="l02784"></a>02784         tmpbuf2[strlen(tmpbuf2)-1] = 0;
<a name="l02785" id="l02785"></a>02785         DEBUGMSGTL((<span class="stringliteral">"mibindex"</span>, <span class=
"stringliteral">"load: (%d) %s\n"</span>, i, tmpbuf2));
<a name="l02786" id="l02786"></a>02786         (void)_mibindex_add( tmpbuf2+4, i );  <span class=
"comment">/* Skip 'DIR ' */</span>
<a name="l02787" id="l02787"></a>02787         fclose( fp );
<a name="l02788" id="l02788"></a>02788     }
<a name="l02789" id="l02789"></a>02789     closedir( dir );
<a name="l02790" id="l02790"></a>02790 }
<a name="l02791" id="l02791"></a>02791 
<a name="l02792" id="l02792"></a>02792 <span class="keywordtype">char</span> *
<a name="l02793" id="l02793"></a>02793 netsnmp_mibindex_lookup( <span class="keyword">const</span> <span class=
"keywordtype">char</span> *dirname )
<a name="l02794" id="l02794"></a>02794 {
<a name="l02795" id="l02795"></a>02795     <span class="keywordtype">int</span> i;
<a name="l02796" id="l02796"></a>02796     <span class="keyword">static</span> <span class="keywordtype">char</span> tmpbuf[300];
<a name="l02797" id="l02797"></a>02797 
<a name="l02798" id="l02798"></a>02798     <span class="keywordflow">for</span> (i=0; i&lt;_mibindex; i++) {
<a name="l02799" id="l02799"></a>02799         <span class="keywordflow">if</span> ( _mibindexes[i] &amp;&amp;
<a name="l02800" id="l02800"></a>02800              strcmp( _mibindexes[i], dirname ) == 0) {
<a name="l02801" id="l02801"></a>02801              snprintf(tmpbuf, <span class="keyword">sizeof</span>(tmpbuf), <span class=
"stringliteral">"%s/mib_indexes/%d"</span>,
<a name="l02802" id="l02802"></a>02802                       get_persistent_directory(), i);
<a name="l02803" id="l02803"></a>02803              tmpbuf[<span class="keyword">sizeof</span>(tmpbuf)-1] = 0;
<a name="l02804" id="l02804"></a>02804              DEBUGMSGTL((<span class="stringliteral">"mibindex"</span>, <span class=
"stringliteral">"lookup: %s (%d) %s\n"</span>, dirname, i, tmpbuf ));
<a name="l02805" id="l02805"></a>02805              <span class="keywordflow">return</span> tmpbuf;
<a name="l02806" id="l02806"></a>02806         }
<a name="l02807" id="l02807"></a>02807     }
<a name="l02808" id="l02808"></a>02808     DEBUGMSGTL((<span class="stringliteral">"mibindex"</span>, <span class=
"stringliteral">"lookup: (none)\n"</span>));
<a name="l02809" id="l02809"></a>02809     <span class="keywordflow">return</span> NULL;
<a name="l02810" id="l02810"></a>02810 }
<a name="l02811" id="l02811"></a>02811 
<a name="l02812" id="l02812"></a>02812 <span class="keywordtype">int</span>
<a name="l02813" id="l02813"></a>02813 _mibindex_add( <span class="keyword">const</span> <span class=
"keywordtype">char</span> *dirname, <span class="keywordtype">int</span> i )
<a name="l02814" id="l02814"></a>02814 {
<a name="l02815" id="l02815"></a>02815     <span class="keywordtype">char</span> **cpp;
<a name="l02816" id="l02816"></a>02816 
<a name="l02817" id="l02817"></a>02817     DEBUGMSGTL((<span class="stringliteral">"mibindex"</span>, <span class=
"stringliteral">"add: %s (%d)\n"</span>, dirname, i ));
<a name="l02818" id="l02818"></a>02818     <span class="keywordflow">if</span> ( i == -1 )
<a name="l02819" id="l02819"></a>02819         i = _mibindex++;
<a name="l02820" id="l02820"></a>02820     <span class="keywordflow">if</span> ( i &gt;= _mibindex_max ) {
<a name="l02821" id="l02821"></a>02821         <span class="comment">/*</span>
<a name="l02822" id="l02822"></a>02822 <span class="comment">         * If the index array is full (or non-exitent)</span>
<a name="l02823" id="l02823"></a>02823 <span class="comment">         *   then expand (or create) it</span>
<a name="l02824" id="l02824"></a>02824 <span class="comment">         */</span>
<a name="l02825" id="l02825"></a>02825         cpp = (<span class="keywordtype">char</span> **)malloc( (10+i) * <span class=
"keyword">sizeof</span>(<span class="keywordtype">char</span>*));
<a name="l02826" id="l02826"></a>02826         <span class="keywordflow">if</span> ( _mibindexes ) {
<a name="l02827" id="l02827"></a>02827             memcpy( cpp, _mibindexes, _mibindex * <span class=
"keyword">sizeof</span>(<span class="keywordtype">char</span>*));
<a name="l02828" id="l02828"></a>02828             free(_mibindexes);
<a name="l02829" id="l02829"></a>02829         }
<a name="l02830" id="l02830"></a>02830         _mibindexes   = cpp;
<a name="l02831" id="l02831"></a>02831         _mibindex_max = i+10;
<a name="l02832" id="l02832"></a>02832     }
<a name="l02833" id="l02833"></a>02833     DEBUGMSGTL((<span class="stringliteral">"mibindex"</span>, <span class=
"stringliteral">"add: %d/%d/%d\n"</span>, i, _mibindex, _mibindex_max ));
<a name="l02834" id="l02834"></a>02834 
<a name="l02835" id="l02835"></a>02835     _mibindexes[ i ] = strdup( dirname );
<a name="l02836" id="l02836"></a>02836     <span class="keywordflow">if</span> ( i &gt;= _mibindex )
<a name="l02837" id="l02837"></a>02837         _mibindex = i+1;
<a name="l02838" id="l02838"></a>02838 
<a name="l02839" id="l02839"></a>02839     <span class="keywordflow">return</span> i;
<a name="l02840" id="l02840"></a>02840 }
<a name="l02841" id="l02841"></a>02841     
<a name="l02842" id="l02842"></a>02842 FILE *
<a name="l02843" id="l02843"></a>02843 netsnmp_mibindex_new( <span class="keyword">const</span> <span class=
"keywordtype">char</span> *dirname )
<a name="l02844" id="l02844"></a>02844 {
<a name="l02845" id="l02845"></a>02845     FILE *fp;
<a name="l02846" id="l02846"></a>02846     <span class="keywordtype">char</span>  tmpbuf[300];
<a name="l02847" id="l02847"></a>02847     <span class="keywordtype">char</span> *cp;
<a name="l02848" id="l02848"></a>02848     <span class="keywordtype">int</span>   i;
<a name="l02849" id="l02849"></a>02849 
<a name="l02850" id="l02850"></a>02850     cp = netsnmp_mibindex_lookup( dirname );
<a name="l02851" id="l02851"></a>02851     <span class="keywordflow">if</span> (!cp) {
<a name="l02852" id="l02852"></a>02852         i  = _mibindex_add( dirname, -1 );
<a name="l02853" id="l02853"></a>02853         snprintf( tmpbuf, <span class="keyword">sizeof</span>(tmpbuf), <span class=
"stringliteral">"%s/mib_indexes/%d"</span>,
<a name="l02854" id="l02854"></a>02854                   get_persistent_directory(), i );
<a name="l02855" id="l02855"></a>02855         tmpbuf[<span class="keyword">sizeof</span>(tmpbuf)-1] = 0;
<a name="l02856" id="l02856"></a>02856         cp = tmpbuf;
<a name="l02857" id="l02857"></a>02857     }
<a name="l02858" id="l02858"></a>02858     DEBUGMSGTL((<span class="stringliteral">"mibindex"</span>, <span class=
"stringliteral">"new: %s (%s)\n"</span>, dirname, cp ));
<a name="l02859" id="l02859"></a>02859     fp = fopen( cp, <span class="stringliteral">"w"</span> );
<a name="l02860" id="l02860"></a>02860     <span class="keywordflow">if</span> (fp)
<a name="l02861" id="l02861"></a>02861         fprintf( fp, <span class="stringliteral">"DIR %s\n"</span>, dirname );
<a name="l02862" id="l02862"></a>02862     <span class="keywordflow">return</span> fp;
<a name="l02863" id="l02863"></a>02863 }
<a name="l02864" id="l02864"></a>02864 
<a name="l02865" id="l02865"></a>02865 
<a name="l02869" id="l02869"></a>02869 <span class="keywordtype">void</span>
<a name="l02870" id="l02870"></a><a class="code" href=
"group__mib__utilities.html#g547cc885aaf7bab97893eef9d0c40486">02870</a> <a class="code" href=
"group__mib__utilities.html#g547cc885aaf7bab97893eef9d0c40486" title="Unloads all mibs.">shutdown_mib</a>(<span class=
"keywordtype">void</span>)
<a name="l02871" id="l02871"></a>02871 {
<a name="l02872" id="l02872"></a>02872     unload_all_mibs();
<a name="l02873" id="l02873"></a>02873     <span class="keywordflow">if</span> (tree_top) {
<a name="l02874" id="l02874"></a>02874         <span class="keywordflow">if</span> (tree_top-&gt;label)
<a name="l02875" id="l02875"></a>02875             <a class="code" href="group__util.html#g951e93edb6f0ea941e26155e3f8912a6"
title="Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(tree_top-&gt;label);
<a name="l02876" id="l02876"></a>02876         <a class="code" href="group__util.html#g951e93edb6f0ea941e26155e3f8912a6" title=
"Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(tree_top);
<a name="l02877" id="l02877"></a>02877         tree_top = NULL;
<a name="l02878" id="l02878"></a>02878     }
<a name="l02879" id="l02879"></a>02879     tree_head = NULL;
<a name="l02880" id="l02880"></a>02880     Mib = NULL;
<a name="l02881" id="l02881"></a>02881     <span class="keywordflow">if</span> (_mibindexes) {
<a name="l02882" id="l02882"></a>02882         <span class="keywordtype">int</span> i;
<a name="l02883" id="l02883"></a>02883         <span class="keywordflow">for</span> (i = 0; i &lt; _mibindex; ++i)
<a name="l02884" id="l02884"></a>02884             <a class="code" href="group__util.html#g951e93edb6f0ea941e26155e3f8912a6"
title="Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(_mibindexes[i]);
<a name="l02885" id="l02885"></a>02885         free(_mibindexes);
<a name="l02886" id="l02886"></a>02886         _mibindex = 0;
<a name="l02887" id="l02887"></a>02887         _mibindex_max = 0;
<a name="l02888" id="l02888"></a>02888         _mibindexes = NULL;
<a name="l02889" id="l02889"></a>02889     }
<a name="l02890" id="l02890"></a>02890     <span class=
"keywordflow">if</span> (Prefix != NULL &amp;&amp; Prefix != &amp;Standard_Prefix[0])
<a name="l02891" id="l02891"></a>02891         <a class="code" href="group__util.html#g951e93edb6f0ea941e26155e3f8912a6" title=
"Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(Prefix);
<a name="l02892" id="l02892"></a>02892     <span class="keywordflow">if</span> (Prefix)
<a name="l02893" id="l02893"></a>02893         Prefix = NULL;
<a name="l02894" id="l02894"></a>02894     <a class="code" href="group__util.html#g951e93edb6f0ea941e26155e3f8912a6" title=
"Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(confmibs);
<a name="l02895" id="l02895"></a>02895     <a class="code" href="group__util.html#g951e93edb6f0ea941e26155e3f8912a6" title=
"Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(confmibdir);
<a name="l02896" id="l02896"></a>02896 }
<a name="l02897" id="l02897"></a>02897 
<a name="l02903" id="l02903"></a>02903 <span class="keywordtype">void</span>
<a name="l02904" id="l02904"></a><a class="code" href=
"group__mib__utilities.html#g7b129eb1cbb37274d4acb14fbc45c004">02904</a> <a class="code" href=
"group__mib__utilities.html#g7b129eb1cbb37274d4acb14fbc45c004" title="Prints the MIBs to the file fp.">print_mib</a>(FILE * fp)
<a name="l02905" id="l02905"></a>02905 {
<a name="l02906" id="l02906"></a>02906     print_subtree(fp, tree_head, 0);
<a name="l02907" id="l02907"></a>02907 }
<a name="l02908" id="l02908"></a>02908 
<a name="l02909" id="l02909"></a>02909 <span class="keywordtype">void</span>
<a name="l02910" id="l02910"></a>02910 print_ascii_dump(FILE * fp)
<a name="l02911" id="l02911"></a>02911 {
<a name="l02912" id="l02912"></a>02912     fprintf(fp, <span class="stringliteral">"dump DEFINITIONS ::= BEGIN\n"</span>);
<a name="l02913" id="l02913"></a>02913     print_ascii_dump_tree(fp, tree_head, 0);
<a name="l02914" id="l02914"></a>02914     fprintf(fp, <span class="stringliteral">"END\n"</span>);
<a name="l02915" id="l02915"></a>02915 }
<a name="l02916" id="l02916"></a>02916 
<a name="l02917" id="l02917"></a>02917 
<a name="l02924" id="l02924"></a>02924 <span class="keywordtype">void</span>
<a name="l02925" id="l02925"></a><a class="code" href=
"group__mib__utilities.html#g55465148bf9a11dc0cdce43f359649ae">02925</a> <a class="code" href=
"group__mib__utilities.html#g55465148bf9a11dc0cdce43f359649ae" title=
"Set&amp;#39;s the printing function printomat in a subtree according it&amp;#39;s type.">set_function</a>(<span class=
"keyword">struct</span> tree *subtree)
<a name="l02926" id="l02926"></a>02926 {
<a name="l02927" id="l02927"></a>02927     subtree-&gt;printer = NULL;
<a name="l02928" id="l02928"></a>02928     <span class="keywordflow">switch</span> (subtree-&gt;type) {
<a name="l02929" id="l02929"></a>02929     <span class="keywordflow">case</span> TYPE_OBJID:
<a name="l02930" id="l02930"></a>02930         subtree-&gt;printomat = <a class="code" href=
"group__mib__utilities.html#g58c583005d5df719f3866ff0f06ec800" title=
"Prints an object identifier into a buffer.">sprint_realloc_object_identifier</a>;
<a name="l02931" id="l02931"></a>02931         <span class="keywordflow">break</span>;
<a name="l02932" id="l02932"></a>02932     <span class="keywordflow">case</span> TYPE_OCTETSTR:
<a name="l02933" id="l02933"></a>02933         subtree-&gt;printomat = <a class="code" href=
"group__mib__utilities.html#gbe71c710f2173fb85512d08c088ea12e" title=
"Prints an octet string into a buffer.">sprint_realloc_octet_string</a>;
<a name="l02934" id="l02934"></a>02934         <span class="keywordflow">break</span>;
<a name="l02935" id="l02935"></a>02935     <span class="keywordflow">case</span> TYPE_INTEGER:
<a name="l02936" id="l02936"></a>02936         subtree-&gt;printomat = <a class="code" href=
"group__mib__utilities.html#g97e7b0a5f5da3d51d9ae32a89f901390" title=
"Prints an integer into a buffer.">sprint_realloc_integer</a>;
<a name="l02937" id="l02937"></a>02937         <span class="keywordflow">break</span>;
<a name="l02938" id="l02938"></a>02938     <span class="keywordflow">case</span> TYPE_INTEGER32:
<a name="l02939" id="l02939"></a>02939         subtree-&gt;printomat = <a class="code" href=
"group__mib__utilities.html#g97e7b0a5f5da3d51d9ae32a89f901390" title=
"Prints an integer into a buffer.">sprint_realloc_integer</a>;
<a name="l02940" id="l02940"></a>02940         <span class="keywordflow">break</span>;
<a name="l02941" id="l02941"></a>02941     <span class="keywordflow">case</span> TYPE_NETADDR:
<a name="l02942" id="l02942"></a>02942         subtree-&gt;printomat = <a class="code" href=
"group__mib__utilities.html#gb83236b9b61e69a06d1dc022eb3fb549" title=
"Prints a network address into a buffer.">sprint_realloc_networkaddress</a>;
<a name="l02943" id="l02943"></a>02943         <span class="keywordflow">break</span>;
<a name="l02944" id="l02944"></a>02944     <span class="keywordflow">case</span> TYPE_IPADDR:
<a name="l02945" id="l02945"></a>02945         subtree-&gt;printomat = <a class="code" href=
"group__mib__utilities.html#gb65bcc37615acd994e02c08ece83a96f" title=
"Prints an ip-address into a buffer.">sprint_realloc_ipaddress</a>;
<a name="l02946" id="l02946"></a>02946         <span class="keywordflow">break</span>;
<a name="l02947" id="l02947"></a>02947     <span class="keywordflow">case</span> TYPE_COUNTER:
<a name="l02948" id="l02948"></a>02948         subtree-&gt;printomat = <a class="code" href=
"group__mib__utilities.html#gac841b689bafe52506f128201d57c51b" title=
"Prints a counter value into a buffer.">sprint_realloc_counter</a>;
<a name="l02949" id="l02949"></a>02949         <span class="keywordflow">break</span>;
<a name="l02950" id="l02950"></a>02950     <span class="keywordflow">case</span> TYPE_GAUGE:
<a name="l02951" id="l02951"></a>02951         subtree-&gt;printomat = <a class="code" href=
"group__mib__utilities.html#gfe1758bc15693fc502e648c05f5c83f3" title=
"Prints a gauge value into a buffer.">sprint_realloc_gauge</a>;
<a name="l02952" id="l02952"></a>02952         <span class="keywordflow">break</span>;
<a name="l02953" id="l02953"></a>02953     <span class="keywordflow">case</span> TYPE_TIMETICKS:
<a name="l02954" id="l02954"></a>02954         subtree-&gt;printomat = <a class="code" href=
"group__mib__utilities.html#gd53723cfb568c73dc3b7af48985f96d2" title=
"Prints a timetick variable into a buffer.">sprint_realloc_timeticks</a>;
<a name="l02955" id="l02955"></a>02955         <span class="keywordflow">break</span>;
<a name="l02956" id="l02956"></a>02956     <span class="keywordflow">case</span> TYPE_OPAQUE:
<a name="l02957" id="l02957"></a>02957         subtree-&gt;printomat = <a class="code" href=
"group__mib__utilities.html#g0e42660c74b91d68e088b53e41ba6658" title=
"Prints an object identifier into a buffer.">sprint_realloc_opaque</a>;
<a name="l02958" id="l02958"></a>02958         <span class="keywordflow">break</span>;
<a name="l02959" id="l02959"></a>02959     <span class="keywordflow">case</span> TYPE_NULL:
<a name="l02960" id="l02960"></a>02960         subtree-&gt;printomat = <a class="code" href=
"group__mib__utilities.html#ga78ab15d7af7e907e57da5b42dbce9e4" title=
"Prints a null value into a buffer.">sprint_realloc_null</a>;
<a name="l02961" id="l02961"></a>02961         <span class="keywordflow">break</span>;
<a name="l02962" id="l02962"></a>02962     <span class="keywordflow">case</span> TYPE_BITSTRING:
<a name="l02963" id="l02963"></a>02963         subtree-&gt;printomat = <a class="code" href=
"group__mib__utilities.html#gfe6d528aa10dfac467956837ffa7c3ba" title=
"Prints a bit string into a buffer.">sprint_realloc_bitstring</a>;
<a name="l02964" id="l02964"></a>02964         <span class="keywordflow">break</span>;
<a name="l02965" id="l02965"></a>02965     <span class="keywordflow">case</span> TYPE_NSAPADDRESS:
<a name="l02966" id="l02966"></a>02966         subtree-&gt;printomat = sprint_realloc_nsapaddress;
<a name="l02967" id="l02967"></a>02967         <span class="keywordflow">break</span>;
<a name="l02968" id="l02968"></a>02968     <span class="keywordflow">case</span> TYPE_COUNTER64:
<a name="l02969" id="l02969"></a>02969         subtree-&gt;printomat = <a class="code" href=
"group__mib__utilities.html#g911270821df5b87de7a97dc5deb8f485" title=
"Prints a counter into a buffer.">sprint_realloc_counter64</a>;
<a name="l02970" id="l02970"></a>02970         <span class="keywordflow">break</span>;
<a name="l02971" id="l02971"></a>02971     <span class="keywordflow">case</span> TYPE_UINTEGER:
<a name="l02972" id="l02972"></a>02972         subtree-&gt;printomat = <a class="code" href=
"group__mib__utilities.html#gccef8ad447c854b262acdf0c8f135084" title=
"Prints an unsigned integer into a buffer.">sprint_realloc_uinteger</a>;
<a name="l02973" id="l02973"></a>02973         <span class="keywordflow">break</span>;
<a name="l02974" id="l02974"></a>02974     <span class="keywordflow">case</span> TYPE_UNSIGNED32:
<a name="l02975" id="l02975"></a>02975         subtree-&gt;printomat = <a class="code" href=
"group__mib__utilities.html#gfe1758bc15693fc502e648c05f5c83f3" title=
"Prints a gauge value into a buffer.">sprint_realloc_gauge</a>;
<a name="l02976" id="l02976"></a>02976         <span class="keywordflow">break</span>;
<a name="l02977" id="l02977"></a>02977     <span class="keywordflow">case</span> TYPE_OTHER:
<a name="l02978" id="l02978"></a>02978     <span class="keywordflow">default</span>:
<a name="l02979" id="l02979"></a>02979         subtree-&gt;printomat = <a class="code" href=
"group__mib__utilities.html#gabc12c361abdca75234c11dccb34871b" title=
"Universal print routine, prints a variable into a buffer according to the variable...">sprint_realloc_by_type</a>;
<a name="l02980" id="l02980"></a>02980         <span class="keywordflow">break</span>;
<a name="l02981" id="l02981"></a>02981     }
<a name="l02982" id="l02982"></a>02982 }
<a name="l02983" id="l02983"></a>02983 
<a name="l02984" id="l02984"></a>02984 <span class="preprocessor">#endif </span><span class=
"comment">/* NETSNMP_DISABLE_MIB_LOADING */</span>
<a name="l02985" id="l02985"></a>02985 
<a name="l03001" id="l03001"></a>03001 <span class="keywordtype">int</span>
<a name="l03002" id="l03002"></a><a class="code" href=
"group__mib__utilities.html#g1e4e5be57e55313a6c2bd2aabc065966">03002</a> <a class="code" href=
"group__mib__utilities.html#g1e4e5be57e55313a6c2bd2aabc065966" title=
"Reads an object identifier from an input string into internal OID form.">read_objid</a>(<span class=
"keyword">const</span> <span class="keywordtype">char</span> *input, oid * output, <span class=
"keywordtype">size_t</span> * out_len)
<a name="l03003" id="l03003"></a>03003 {                               <span class=
"comment">/* number of subid's in "output" */</span>
<a name="l03004" id="l03004"></a>03004 <span class="preprocessor">#ifndef NETSNMP_DISABLE_MIB_LOADING</span>
<a name="l03005" id="l03005"></a>03005     <span class="keyword">struct </span>tree    *root = tree_top;
<a name="l03006" id="l03006"></a>03006 <span class="preprocessor">#endif </span><span class=
"comment">/* NETSNMP_DISABLE_MIB_LOADING */</span>
<a name="l03007" id="l03007"></a>03007     <span class="keywordtype">char</span>            buf[SPRINT_MAX_LEN];
<a name="l03008" id="l03008"></a>03008     <span class="keywordtype">int</span>             ret, max_out_len;
<a name="l03009" id="l03009"></a>03009     <span class="keywordtype">char</span>           *name, ch;
<a name="l03010" id="l03010"></a>03010     <span class="keyword">const</span> <span class="keywordtype">char</span>     *cp;
<a name="l03011" id="l03011"></a>03011 
<a name="l03012" id="l03012"></a>03012     cp = input;
<a name="l03013" id="l03013"></a>03013     <span class="keywordflow">while</span> ((ch = *cp)) {
<a name="l03014" id="l03014"></a>03014         <span class="keywordflow">if</span> ((<span class=
"charliteral">'0'</span> &lt;= ch &amp;&amp; ch &lt;= <span class="charliteral">'9'</span>)
<a name="l03015" id="l03015"></a>03015             || (<span class=
"charliteral">'a'</span> &lt;= ch &amp;&amp; ch &lt;= <span class="charliteral">'z'</span>)
<a name="l03016" id="l03016"></a>03016             || (<span class=
"charliteral">'A'</span> &lt;= ch &amp;&amp; ch &lt;= <span class="charliteral">'Z'</span>)
<a name="l03017" id="l03017"></a>03017             || ch == <span class="charliteral">'-'</span>)
<a name="l03018" id="l03018"></a>03018             cp++;
<a name="l03019" id="l03019"></a>03019         <span class="keywordflow">else</span>
<a name="l03020" id="l03020"></a>03020             <span class="keywordflow">break</span>;
<a name="l03021" id="l03021"></a>03021     }
<a name="l03022" id="l03022"></a>03022 <span class="preprocessor">#ifndef NETSNMP_DISABLE_MIB_LOADING</span>
<a name="l03023" id="l03023"></a>03023     <span class="keywordflow">if</span> (ch == <span class="charliteral">':'</span>)
<a name="l03024" id="l03024"></a>03024         <span class="keywordflow">return</span> get_node(input, output, out_len);
<a name="l03025" id="l03025"></a>03025 <span class="preprocessor">#endif </span><span class=
"comment">/* NETSNMP_DISABLE_MIB_LOADING */</span>
<a name="l03026" id="l03026"></a>03026 
<a name="l03027" id="l03027"></a>03027     <span class="keywordflow">if</span> (*input == <span class="charliteral">'.'</span>)
<a name="l03028" id="l03028"></a>03028         input++;
<a name="l03029" id="l03029"></a>03029 <span class="preprocessor">#ifndef NETSNMP_DISABLE_MIB_LOADING</span>
<a name="l03030" id="l03030"></a>03030     <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_READ_UCD_STYLE_OID)) {
<a name="l03031" id="l03031"></a>03031         <span class="comment">/*</span>
<a name="l03032" id="l03032"></a>03032 <span class="comment">         * get past leading '.', append '.' to Prefix. </span>
<a name="l03033" id="l03033"></a>03033 <span class="comment">         */</span>
<a name="l03034" id="l03034"></a>03034         <span class="keywordflow">if</span> (*Prefix == <span class=
"charliteral">'.'</span>)
<a name="l03035" id="l03035"></a>03035             strncpy(buf, Prefix + 1, <span class="keyword">sizeof</span>(buf)-1);
<a name="l03036" id="l03036"></a>03036         <span class="keywordflow">else</span>
<a name="l03037" id="l03037"></a>03037             strncpy(buf, Prefix, <span class="keyword">sizeof</span>(buf)-1);
<a name="l03038" id="l03038"></a>03038         buf[ <span class="keyword">sizeof</span>(buf)-1 ] = 0;
<a name="l03039" id="l03039"></a>03039         strcat(buf, <span class="stringliteral">"."</span>);
<a name="l03040" id="l03040"></a>03040         buf[ <span class="keyword">sizeof</span>(buf)-1 ] = 0;
<a name="l03041" id="l03041"></a>03041         strncat(buf, input, <span class="keyword">sizeof</span>(buf)-strlen(buf));
<a name="l03042" id="l03042"></a>03042         buf[ <span class="keyword">sizeof</span>(buf)-1 ] = 0;
<a name="l03043" id="l03043"></a>03043         input = buf;
<a name="l03044" id="l03044"></a>03044     }
<a name="l03045" id="l03045"></a>03045 <span class="preprocessor">#endif </span><span class=
"comment">/* NETSNMP_DISABLE_MIB_LOADING */</span>
<a name="l03046" id="l03046"></a>03046 
<a name="l03047" id="l03047"></a>03047 <span class="preprocessor">#ifndef NETSNMP_DISABLE_MIB_LOADING</span>
<a name="l03048" id="l03048"></a>03048     <span class="keywordflow">if</span> ((root == NULL) &amp;&amp; (tree_head != NULL)) {
<a name="l03049" id="l03049"></a>03049         root = tree_head;
<a name="l03050" id="l03050"></a>03050     }
<a name="l03051" id="l03051"></a>03051     <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (root == NULL) {
<a name="l03052" id="l03052"></a>03052         SET_SNMP_ERROR(SNMPERR_NOMIB);
<a name="l03053" id="l03053"></a>03053         *out_len = 0;
<a name="l03054" id="l03054"></a>03054         <span class="keywordflow">return</span> 0;
<a name="l03055" id="l03055"></a>03055     }
<a name="l03056" id="l03056"></a>03056 <span class="preprocessor">#endif </span><span class=
"comment">/* NETSNMP_DISABLE_MIB_LOADING */</span>
<a name="l03057" id="l03057"></a>03057     name = strdup(input);
<a name="l03058" id="l03058"></a>03058     max_out_len = *out_len;
<a name="l03059" id="l03059"></a>03059     *out_len = 0;
<a name="l03060" id="l03060"></a>03060 <span class="preprocessor">#ifndef NETSNMP_DISABLE_MIB_LOADING</span>
<a name="l03061" id="l03061"></a>03061     <span class="keywordflow">if</span> ((ret =
<a name="l03062" id="l03062"></a>03062          _add_strings_to_oid(root, name, output, out_len,
<a name="l03063" id="l03063"></a>03063                              max_out_len)) &lt;= 0)
<a name="l03064" id="l03064"></a>03064 <span class="preprocessor">#else</span>
<a name="l03065" id="l03065"></a>03065     <span class="keywordflow">if</span> ((ret =
<a name="l03066" id="l03066"></a>03066          _add_strings_to_oid(NULL, name, output, out_len,
<a name="l03067" id="l03067"></a>03067                              max_out_len)) &lt;= 0)
<a name="l03068" id="l03068"></a>03068 <span class="preprocessor">#endif </span><span class=
"comment">/* NETSNMP_DISABLE_MIB_LOADING */</span>
<a name="l03069" id="l03069"></a>03069     {
<a name="l03070" id="l03070"></a>03070         <span class="keywordflow">if</span> (ret == 0)
<a name="l03071" id="l03071"></a>03071             ret = SNMPERR_UNKNOWN_OBJID;
<a name="l03072" id="l03072"></a>03072         SET_SNMP_ERROR(ret);
<a name="l03073" id="l03073"></a>03073         <a class="code" href="group__util.html#g951e93edb6f0ea941e26155e3f8912a6" title=
"Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(name);
<a name="l03074" id="l03074"></a>03074         <span class="keywordflow">return</span> 0;
<a name="l03075" id="l03075"></a>03075     }
<a name="l03076" id="l03076"></a>03076     <a class="code" href="group__util.html#g951e93edb6f0ea941e26155e3f8912a6" title=
"Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(name);
<a name="l03077" id="l03077"></a>03077 
<a name="l03078" id="l03078"></a>03078     <span class="keywordflow">return</span> 1;
<a name="l03079" id="l03079"></a>03079 }
<a name="l03080" id="l03080"></a>03080 
<a name="l03084" id="l03084"></a>03084 <span class="keywordtype">void</span>
<a name="l03085" id="l03085"></a>03085 netsnmp_sprint_realloc_objid(u_char ** buf, <span class=
"keywordtype">size_t</span> * buf_len,
<a name="l03086" id="l03086"></a>03086                              <span class=
"keywordtype">size_t</span> * out_len, <span class="keywordtype">int</span> allow_realloc,
<a name="l03087" id="l03087"></a>03087                              <span class="keywordtype">int</span> *buf_overflow,
<a name="l03088" id="l03088"></a>03088                              <span class="keyword">const</span> oid * objid, <span class=
"keywordtype">size_t</span> objidlen)
<a name="l03089" id="l03089"></a>03089 {
<a name="l03090" id="l03090"></a>03090     u_char         *tbuf = NULL, *cp = NULL;
<a name="l03091" id="l03091"></a>03091     <span class="keywordtype">size_t</span>          tbuf_len = 256, tout_len = 0;
<a name="l03092" id="l03092"></a>03092     <span class="keywordtype">int</span>             tbuf_overflow = 0;
<a name="l03093" id="l03093"></a>03093     <span class="keywordtype">int</span>             output_format;
<a name="l03094" id="l03094"></a>03094 
<a name="l03095" id="l03095"></a>03095     <span class=
"keywordflow">if</span> ((tbuf = (u_char *) calloc(tbuf_len, 1)) == NULL) {
<a name="l03096" id="l03096"></a>03096         tbuf_overflow = 1;
<a name="l03097" id="l03097"></a>03097     } <span class="keywordflow">else</span> {
<a name="l03098" id="l03098"></a>03098         *tbuf = <span class="charliteral">'.'</span>;
<a name="l03099" id="l03099"></a>03099         tout_len = 1;
<a name="l03100" id="l03100"></a>03100     }
<a name="l03101" id="l03101"></a>03101 
<a name="l03102" id="l03102"></a>03102     _oid_finish_printing(objid, objidlen,
<a name="l03103" id="l03103"></a>03103                          &amp;tbuf, &amp;tbuf_len, &amp;tout_len,
<a name="l03104" id="l03104"></a>03104                          allow_realloc, &amp;tbuf_overflow);
<a name="l03105" id="l03105"></a>03105 
<a name="l03106" id="l03106"></a>03106     <span class="keywordflow">if</span> (tbuf_overflow) {
<a name="l03107" id="l03107"></a>03107         <span class="keywordflow">if</span> (!*buf_overflow) {
<a name="l03108" id="l03108"></a>03108             snmp_strcat(buf, buf_len, out_len, allow_realloc, tbuf);
<a name="l03109" id="l03109"></a>03109             *buf_overflow = 1;
<a name="l03110" id="l03110"></a>03110         }
<a name="l03111" id="l03111"></a>03111         <a class="code" href="group__util.html#g951e93edb6f0ea941e26155e3f8912a6" title=
"Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(tbuf);
<a name="l03112" id="l03112"></a>03112         <span class="keywordflow">return</span>;
<a name="l03113" id="l03113"></a>03113     }
<a name="l03114" id="l03114"></a>03114 
<a name="l03115" id=
"l03115"></a>03115     output_format = netsnmp_ds_get_int(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_OID_OUTPUT_FORMAT);
<a name="l03116" id="l03116"></a>03116     <span class="keywordflow">if</span> (0 == output_format) {
<a name="l03117" id="l03117"></a>03117         output_format = NETSNMP_OID_OUTPUT_NUMERIC;
<a name="l03118" id="l03118"></a>03118     }
<a name="l03119" id="l03119"></a>03119     <span class="keywordflow">switch</span> (output_format) {
<a name="l03120" id="l03120"></a>03120     <span class="keywordflow">case</span> NETSNMP_OID_OUTPUT_FULL:
<a name="l03121" id="l03121"></a>03121     <span class="keywordflow">case</span> NETSNMP_OID_OUTPUT_NUMERIC:
<a name="l03122" id="l03122"></a>03122     <span class="keywordflow">case</span> NETSNMP_OID_OUTPUT_SUFFIX:
<a name="l03123" id="l03123"></a>03123     <span class="keywordflow">case</span> NETSNMP_OID_OUTPUT_MODULE:
<a name="l03124" id="l03124"></a>03124         cp = tbuf;
<a name="l03125" id="l03125"></a>03125         <span class="keywordflow">break</span>;
<a name="l03126" id="l03126"></a>03126 
<a name="l03127" id="l03127"></a>03127     <span class="keywordflow">case</span> NETSNMP_OID_OUTPUT_NONE:
<a name="l03128" id="l03128"></a>03128     <span class="keywordflow">default</span>:
<a name="l03129" id="l03129"></a>03129         cp = NULL;
<a name="l03130" id="l03130"></a>03130     }
<a name="l03131" id="l03131"></a>03131 
<a name="l03132" id="l03132"></a>03132     <span class="keywordflow">if</span> (!*buf_overflow &amp;&amp;
<a name="l03133" id="l03133"></a>03133         !snmp_strcat(buf, buf_len, out_len, allow_realloc, cp)) {
<a name="l03134" id="l03134"></a>03134         *buf_overflow = 1;
<a name="l03135" id="l03135"></a>03135     }
<a name="l03136" id="l03136"></a>03136     <a class="code" href="group__util.html#g951e93edb6f0ea941e26155e3f8912a6" title=
"Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(tbuf);
<a name="l03137" id="l03137"></a>03137 }
<a name="l03138" id="l03138"></a>03138 
<a name="l03142" id="l03142"></a>03142 <span class="preprocessor">#ifdef NETSNMP_DISABLE_MIB_LOADING</span>
<a name="l03143" id="l03143"></a>03143 <span class="keywordtype">void</span>
<a name="l03144" id="l03144"></a>03144 netsnmp_sprint_realloc_objid_tree(u_char ** buf, <span class=
"keywordtype">size_t</span> * buf_len,
<a name="l03145" id="l03145"></a>03145                                   <span class=
"keywordtype">size_t</span> * out_len, <span class="keywordtype">int</span> allow_realloc,
<a name="l03146" id="l03146"></a>03146                                   <span class="keywordtype">int</span> *buf_overflow,
<a name="l03147" id="l03147"></a>03147                                   <span class=
"keyword">const</span> oid * objid, <span class="keywordtype">size_t</span> objidlen)
<a name="l03148" id="l03148"></a>03148 {
<a name="l03149" id="l03149"></a>03149     netsnmp_sprint_realloc_objid(buf, buf_len, out_len, allow_realloc,
<a name="l03150" id="l03150"></a>03150                                  buf_overflow, objid, objidlen);
<a name="l03151" id="l03151"></a>03151 }
<a name="l03152" id="l03152"></a>03152 <span class="preprocessor">#else</span>
<a name="l03153" id="l03153"></a>03153 <span class="keyword">struct </span>tree    *
<a name="l03154" id="l03154"></a>03154 netsnmp_sprint_realloc_objid_tree(u_char ** buf, <span class=
"keywordtype">size_t</span> * buf_len,
<a name="l03155" id="l03155"></a>03155                                   <span class=
"keywordtype">size_t</span> * out_len, <span class="keywordtype">int</span> allow_realloc,
<a name="l03156" id="l03156"></a>03156                                   <span class="keywordtype">int</span> *buf_overflow,
<a name="l03157" id="l03157"></a>03157                                   <span class=
"keyword">const</span> oid * objid, <span class="keywordtype">size_t</span> objidlen)
<a name="l03158" id="l03158"></a>03158 {
<a name="l03159" id="l03159"></a>03159     u_char         *tbuf = NULL, *cp = NULL;
<a name="l03160" id="l03160"></a>03160     <span class="keywordtype">size_t</span>          tbuf_len = 512, tout_len = 0;
<a name="l03161" id="l03161"></a>03161     <span class="keyword">struct </span>tree    *subtree = tree_head;
<a name="l03162" id="l03162"></a>03162     <span class="keywordtype">size_t</span>          midpoint_offset = 0;
<a name="l03163" id="l03163"></a>03163     <span class="keywordtype">int</span>             tbuf_overflow = 0;
<a name="l03164" id="l03164"></a>03164     <span class="keywordtype">int</span>             output_format;
<a name="l03165" id="l03165"></a>03165 
<a name="l03166" id="l03166"></a>03166     <span class=
"keywordflow">if</span> ((tbuf = (u_char *) calloc(tbuf_len, 1)) == NULL) {
<a name="l03167" id="l03167"></a>03167         tbuf_overflow = 1;
<a name="l03168" id="l03168"></a>03168     } <span class="keywordflow">else</span> {
<a name="l03169" id="l03169"></a>03169         *tbuf = <span class="charliteral">'.'</span>;
<a name="l03170" id="l03170"></a>03170         tout_len = 1;
<a name="l03171" id="l03171"></a>03171     }
<a name="l03172" id="l03172"></a>03172 
<a name="l03173" id="l03173"></a>03173     subtree = _get_realloc_symbol(objid, objidlen, subtree,
<a name="l03174" id="l03174"></a>03174                                   &amp;tbuf, &amp;tbuf_len, &amp;tout_len,
<a name="l03175" id="l03175"></a>03175                                   allow_realloc, &amp;tbuf_overflow, NULL,
<a name="l03176" id="l03176"></a>03176                                   &amp;midpoint_offset);
<a name="l03177" id="l03177"></a>03177 
<a name="l03178" id="l03178"></a>03178     <span class="keywordflow">if</span> (tbuf_overflow) {
<a name="l03179" id="l03179"></a>03179         <span class="keywordflow">if</span> (!*buf_overflow) {
<a name="l03180" id="l03180"></a>03180             snmp_strcat(buf, buf_len, out_len, allow_realloc, tbuf);
<a name="l03181" id="l03181"></a>03181             *buf_overflow = 1;
<a name="l03182" id="l03182"></a>03182         }
<a name="l03183" id="l03183"></a>03183         <a class="code" href="group__util.html#g951e93edb6f0ea941e26155e3f8912a6" title=
"Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(tbuf);
<a name="l03184" id="l03184"></a>03184         <span class="keywordflow">return</span> subtree;
<a name="l03185" id="l03185"></a>03185     }
<a name="l03186" id="l03186"></a>03186 
<a name="l03187" id=
"l03187"></a>03187     output_format = netsnmp_ds_get_int(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_OID_OUTPUT_FORMAT);
<a name="l03188" id="l03188"></a>03188     <span class="keywordflow">if</span> (0 == output_format) {
<a name="l03189" id="l03189"></a>03189         output_format = NETSNMP_OID_OUTPUT_MODULE;
<a name="l03190" id="l03190"></a>03190     }
<a name="l03191" id="l03191"></a>03191     <span class="keywordflow">switch</span> (output_format) {
<a name="l03192" id="l03192"></a>03192     <span class="keywordflow">case</span> NETSNMP_OID_OUTPUT_FULL:
<a name="l03193" id="l03193"></a>03193     <span class="keywordflow">case</span> NETSNMP_OID_OUTPUT_NUMERIC:
<a name="l03194" id="l03194"></a>03194         cp = tbuf;
<a name="l03195" id="l03195"></a>03195         <span class="keywordflow">break</span>;
<a name="l03196" id="l03196"></a>03196 
<a name="l03197" id="l03197"></a>03197     <span class="keywordflow">case</span> NETSNMP_OID_OUTPUT_SUFFIX:
<a name="l03198" id="l03198"></a>03198     <span class="keywordflow">case</span> NETSNMP_OID_OUTPUT_MODULE:
<a name="l03199" id="l03199"></a>03199         <span class="keywordflow">for</span> (cp = tbuf; *cp; cp++);
<a name="l03200" id="l03200"></a>03200 
<a name="l03201" id="l03201"></a>03201         <span class="keywordflow">if</span> (midpoint_offset != 0) {
<a name="l03202" id="l03202"></a>03202             cp = tbuf + midpoint_offset - 2;    <span class=
"comment">/*  beyond the '.'  */</span>
<a name="l03203" id="l03203"></a>03203         } <span class="keywordflow">else</span> {
<a name="l03204" id="l03204"></a>03204             <span class="keywordflow">while</span> (cp &gt;= tbuf) {
<a name="l03205" id="l03205"></a>03205                 <span class="keywordflow">if</span> (isalpha(*cp)) {
<a name="l03206" id="l03206"></a>03206                     <span class="keywordflow">break</span>;
<a name="l03207" id="l03207"></a>03207                 }
<a name="l03208" id="l03208"></a>03208                 cp--;
<a name="l03209" id="l03209"></a>03209             }
<a name="l03210" id="l03210"></a>03210         }
<a name="l03211" id="l03211"></a>03211 
<a name="l03212" id="l03212"></a>03212         <span class="keywordflow">while</span> (cp &gt;= tbuf) {
<a name="l03213" id="l03213"></a>03213             <span class="keywordflow">if</span> (*cp == <span class=
"charliteral">'.'</span>) {
<a name="l03214" id="l03214"></a>03214                 <span class="keywordflow">break</span>;
<a name="l03215" id="l03215"></a>03215             }
<a name="l03216" id="l03216"></a>03216             cp--;
<a name="l03217" id="l03217"></a>03217         }
<a name="l03218" id="l03218"></a>03218 
<a name="l03219" id="l03219"></a>03219         cp++;
<a name="l03220" id="l03220"></a>03220 
<a name="l03221" id="l03221"></a>03221         <span class="keywordflow">if</span> ((NETSNMP_OID_OUTPUT_MODULE == output_format)
<a name="l03222" id="l03222"></a>03222             &amp;&amp; cp &gt; tbuf) {
<a name="l03223" id="l03223"></a>03223             <span class="keywordtype">char</span>            modbuf[256] = { 0 }, *mod =
<a name="l03224" id="l03224"></a>03224                 module_name(subtree-&gt;modid, modbuf);
<a name="l03225" id="l03225"></a>03225 
<a name="l03226" id="l03226"></a>03226             <span class="comment">/*</span>
<a name="l03227" id="l03227"></a>03227 <span class=
"comment">             * Don't add the module ID if it's just numeric (i.e. we couldn't look</span>
<a name="l03228" id="l03228"></a>03228 <span class="comment">             * it up properly.  </span>
<a name="l03229" id="l03229"></a>03229 <span class="comment">             */</span>
<a name="l03230" id="l03230"></a>03230 
<a name="l03231" id="l03231"></a>03231             <span class=
"keywordflow">if</span> (!*buf_overflow &amp;&amp; modbuf[0] != <span class="charliteral">'#'</span>) {
<a name="l03232" id="l03232"></a>03232                 <span class="keywordflow">if</span> (!snmp_strcat
<a name="l03233" id="l03233"></a>03233                     (buf, buf_len, out_len, allow_realloc,
<a name="l03234" id="l03234"></a>03234                      (<span class="keyword">const</span> u_char *) mod)
<a name="l03235" id="l03235"></a>03235                     || !snmp_strcat(buf, buf_len, out_len, allow_realloc,
<a name="l03236" id="l03236"></a>03236                                     (<span class=
"keyword">const</span> u_char *) <span class="stringliteral">"::"</span>)) {
<a name="l03237" id="l03237"></a>03237                     *buf_overflow = 1;
<a name="l03238" id="l03238"></a>03238                 }
<a name="l03239" id="l03239"></a>03239             }
<a name="l03240" id="l03240"></a>03240         }
<a name="l03241" id="l03241"></a>03241         <span class="keywordflow">break</span>;
<a name="l03242" id="l03242"></a>03242 
<a name="l03243" id="l03243"></a>03243     <span class="keywordflow">case</span> NETSNMP_OID_OUTPUT_UCD:
<a name="l03244" id="l03244"></a>03244     {
<a name="l03245" id="l03245"></a>03245         PrefixListPtr   pp = &amp;mib_prefixes[0];
<a name="l03246" id="l03246"></a>03246         <span class="keywordtype">size_t</span>          ilen, tlen;
<a name="l03247" id="l03247"></a>03247         <span class="keyword">const</span> <span class=
"keywordtype">char</span>     *testcp;
<a name="l03248" id="l03248"></a>03248 
<a name="l03249" id="l03249"></a>03249         cp = tbuf;
<a name="l03250" id="l03250"></a>03250         tlen = strlen((<span class="keywordtype">char</span> *) tbuf);
<a name="l03251" id="l03251"></a>03251 
<a name="l03252" id="l03252"></a>03252         <span class="keywordflow">while</span> (pp-&gt;str) {
<a name="l03253" id="l03253"></a>03253             ilen = pp-&gt;len;
<a name="l03254" id="l03254"></a>03254             testcp = pp-&gt;str;
<a name="l03255" id="l03255"></a>03255 
<a name="l03256" id="l03256"></a>03256             <span class=
"keywordflow">if</span> ((tlen &gt; ilen) &amp;&amp; memcmp(tbuf, testcp, ilen) == 0) {
<a name="l03257" id="l03257"></a>03257                 cp += (ilen + 1);
<a name="l03258" id="l03258"></a>03258                 <span class="keywordflow">break</span>;
<a name="l03259" id="l03259"></a>03259             }
<a name="l03260" id="l03260"></a>03260             pp++;
<a name="l03261" id="l03261"></a>03261         }
<a name="l03262" id="l03262"></a>03262         <span class="keywordflow">break</span>;
<a name="l03263" id="l03263"></a>03263     }
<a name="l03264" id="l03264"></a>03264 
<a name="l03265" id="l03265"></a>03265     <span class="keywordflow">case</span> NETSNMP_OID_OUTPUT_NONE:
<a name="l03266" id="l03266"></a>03266     <span class="keywordflow">default</span>:
<a name="l03267" id="l03267"></a>03267         cp = NULL;
<a name="l03268" id="l03268"></a>03268     }
<a name="l03269" id="l03269"></a>03269 
<a name="l03270" id="l03270"></a>03270     <span class="keywordflow">if</span> (!*buf_overflow &amp;&amp;
<a name="l03271" id="l03271"></a>03271         !snmp_strcat(buf, buf_len, out_len, allow_realloc, cp)) {
<a name="l03272" id="l03272"></a>03272         *buf_overflow = 1;
<a name="l03273" id="l03273"></a>03273     }
<a name="l03274" id="l03274"></a>03274     <a class="code" href="group__util.html#g951e93edb6f0ea941e26155e3f8912a6" title=
"Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(tbuf);
<a name="l03275" id="l03275"></a>03275     <span class="keywordflow">return</span> subtree;
<a name="l03276" id="l03276"></a>03276 }
<a name="l03277" id="l03277"></a>03277 <span class="preprocessor">#endif </span><span class=
"comment">/* NETSNMP_DISABLE_MIB_LOADING */</span>
<a name="l03278" id="l03278"></a>03278 
<a name="l03279" id="l03279"></a>03279 <span class="keywordtype">int</span>
<a name="l03280" id="l03280"></a>03280 sprint_realloc_objid(u_char ** buf, <span class="keywordtype">size_t</span> * buf_len,
<a name="l03281" id="l03281"></a>03281                      <span class="keywordtype">size_t</span> * out_len, <span class=
"keywordtype">int</span> allow_realloc,
<a name="l03282" id="l03282"></a>03282                      <span class="keyword">const</span> oid * objid, <span class=
"keywordtype">size_t</span> objidlen)
<a name="l03283" id="l03283"></a>03283 {
<a name="l03284" id="l03284"></a>03284     <span class="keywordtype">int</span>             buf_overflow = 0;
<a name="l03285" id="l03285"></a>03285 
<a name="l03286" id="l03286"></a>03286     netsnmp_sprint_realloc_objid_tree(buf, buf_len, out_len, allow_realloc,
<a name="l03287" id="l03287"></a>03287                                       &amp;buf_overflow, objid, objidlen);
<a name="l03288" id="l03288"></a>03288     <span class="keywordflow">return</span> !buf_overflow;
<a name="l03289" id="l03289"></a>03289 }
<a name="l03290" id="l03290"></a>03290 
<a name="l03291" id="l03291"></a>03291 <span class="keywordtype">int</span>
<a name="l03292" id="l03292"></a>03292 snprint_objid(<span class="keywordtype">char</span> *buf, <span class=
"keywordtype">size_t</span> buf_len,
<a name="l03293" id="l03293"></a>03293               <span class="keyword">const</span> oid * objid, <span class=
"keywordtype">size_t</span> objidlen)
<a name="l03294" id="l03294"></a>03294 {
<a name="l03295" id="l03295"></a>03295     <span class="keywordtype">size_t</span>          out_len = 0;
<a name="l03296" id="l03296"></a>03296 
<a name="l03297" id="l03297"></a>03297     <span class=
"keywordflow">if</span> (sprint_realloc_objid((u_char **) &amp; buf, &amp;buf_len, &amp;out_len, 0,
<a name="l03298" id="l03298"></a>03298                              objid, objidlen)) {
<a name="l03299" id="l03299"></a>03299         <span class="keywordflow">return</span> (<span class=
"keywordtype">int</span>) out_len;
<a name="l03300" id="l03300"></a>03300     } <span class="keywordflow">else</span> {
<a name="l03301" id="l03301"></a>03301         <span class="keywordflow">return</span> -1;
<a name="l03302" id="l03302"></a>03302     }
<a name="l03303" id="l03303"></a>03303 }
<a name="l03304" id="l03304"></a>03304 
<a name="l03311" id="l03311"></a>03311 <span class="keywordtype">void</span>
<a name="l03312" id="l03312"></a><a class="code" href=
"group__mib__utilities.html#gd14430381d06c229a4fb13ca94bdca66">03312</a> <a class="code" href=
"group__mib__utilities.html#gd14430381d06c229a4fb13ca94bdca66" title="Prints an oid to stdout.">print_objid</a>(<span class=
"keyword">const</span> oid * objid, <span class="keywordtype">size_t</span> objidlen)
<a name="l03313" id="l03313"></a>03313 {                               <span class=
"comment">/* number of subidentifiers */</span>
<a name="l03314" id="l03314"></a>03314     <a class="code" href="group__mib__utilities.html#g736eaa6bfa15535aff702a2ae14f3727"
title="Prints an oid to a file descriptor.">fprint_objid</a>(stdout, objid, objidlen);
<a name="l03315" id="l03315"></a>03315 }
<a name="l03316" id="l03316"></a>03316 
<a name="l03317" id="l03317"></a>03317 
<a name="l03325" id="l03325"></a>03325 <span class="keywordtype">void</span>
<a name="l03326" id="l03326"></a><a class="code" href=
"group__mib__utilities.html#g736eaa6bfa15535aff702a2ae14f3727">03326</a> <a class="code" href=
"group__mib__utilities.html#g736eaa6bfa15535aff702a2ae14f3727" title=
"Prints an oid to a file descriptor.">fprint_objid</a>(FILE * f, <span class="keyword">const</span> oid * objid, <span class=
"keywordtype">size_t</span> objidlen)
<a name="l03327" id="l03327"></a>03327 {                               <span class=
"comment">/* number of subidentifiers */</span>
<a name="l03328" id="l03328"></a>03328     u_char         *buf = NULL;
<a name="l03329" id="l03329"></a>03329     <span class="keywordtype">size_t</span>          buf_len = 256, out_len = 0;
<a name="l03330" id="l03330"></a>03330     <span class="keywordtype">int</span>             buf_overflow = 0;
<a name="l03331" id="l03331"></a>03331 
<a name="l03332" id="l03332"></a>03332     <span class="keywordflow">if</span> ((buf = (u_char *) calloc(buf_len, 1)) == NULL) {
<a name="l03333" id="l03333"></a>03333         fprintf(f, <span class="stringliteral">"[TRUNCATED]\n"</span>);
<a name="l03334" id="l03334"></a>03334         <span class="keywordflow">return</span>;
<a name="l03335" id="l03335"></a>03335     } <span class="keywordflow">else</span> {
<a name="l03336" id="l03336"></a>03336         netsnmp_sprint_realloc_objid_tree(&amp;buf, &amp;buf_len, &amp;out_len, 1,
<a name="l03337" id="l03337"></a>03337                                           &amp;buf_overflow, objid, objidlen);
<a name="l03338" id="l03338"></a>03338         <span class="keywordflow">if</span> (buf_overflow) {
<a name="l03339" id="l03339"></a>03339             fprintf(f, <span class="stringliteral">"%s [TRUNCATED]\n"</span>, buf);
<a name="l03340" id="l03340"></a>03340         } <span class="keywordflow">else</span> {
<a name="l03341" id="l03341"></a>03341             fprintf(f, <span class="stringliteral">"%s\n"</span>, buf);
<a name="l03342" id="l03342"></a>03342         }
<a name="l03343" id="l03343"></a>03343     }
<a name="l03344" id="l03344"></a>03344 
<a name="l03345" id="l03345"></a>03345     <a class="code" href="group__util.html#g951e93edb6f0ea941e26155e3f8912a6" title=
"Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(buf);
<a name="l03346" id="l03346"></a>03346 }
<a name="l03347" id="l03347"></a>03347 
<a name="l03348" id="l03348"></a>03348 <span class="keywordtype">int</span>
<a name="l03349" id="l03349"></a>03349 sprint_realloc_variable(u_char ** buf, <span class="keywordtype">size_t</span> * buf_len,
<a name="l03350" id="l03350"></a>03350                         <span class="keywordtype">size_t</span> * out_len, <span class=
"keywordtype">int</span> allow_realloc,
<a name="l03351" id="l03351"></a>03351                         <span class="keyword">const</span> oid * objid, <span class=
"keywordtype">size_t</span> objidlen,
<a name="l03352" id="l03352"></a>03352                         <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * variable)
<a name="l03353" id="l03353"></a>03353 {
<a name="l03354" id="l03354"></a>03354     <span class="keywordtype">int</span>             buf_overflow = 0;
<a name="l03355" id="l03355"></a>03355 
<a name="l03356" id="l03356"></a>03356 <span class="preprocessor">#ifndef NETSNMP_DISABLE_MIB_LOADING</span>
<a name="l03357" id="l03357"></a>03357     <span class="keyword">struct </span>tree    *subtree = tree_head;
<a name="l03358" id="l03358"></a>03358 
<a name="l03359" id="l03359"></a>03359     subtree =
<a name="l03360" id="l03360"></a>03360 <span class="preprocessor">#endif </span><span class=
"comment">/* NETSNMP_DISABLE_MIB_LOADING */</span>
<a name="l03361" id="l03361"></a>03361         netsnmp_sprint_realloc_objid_tree(buf, buf_len, out_len,
<a name="l03362" id="l03362"></a>03362                                           allow_realloc, &amp;buf_overflow,
<a name="l03363" id="l03363"></a>03363                                           objid, objidlen);
<a name="l03364" id="l03364"></a>03364 
<a name="l03365" id="l03365"></a>03365     <span class="keywordflow">if</span> (buf_overflow) {
<a name="l03366" id="l03366"></a>03366         <span class="keywordflow">return</span> 0;
<a name="l03367" id="l03367"></a>03367     }
<a name="l03368" id="l03368"></a>03368     <span class=
"keywordflow">if</span> (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_PRINT_BARE_VALUE)) {
<a name="l03369" id="l03369"></a>03369         <span class=
"keywordflow">if</span> (netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICKE_PRINT)) {
<a name="l03370" id="l03370"></a>03370             <span class="keywordflow">if</span> (!snmp_strcat
<a name="l03371" id="l03371"></a>03371                 (buf, buf_len, out_len, allow_realloc,
<a name="l03372" id="l03372"></a>03372                  (<span class="keyword">const</span> u_char *) <span class=
"stringliteral">" = "</span>)) {
<a name="l03373" id="l03373"></a>03373                 <span class="keywordflow">return</span> 0;
<a name="l03374" id="l03374"></a>03374             }
<a name="l03375" id="l03375"></a>03375         } <span class="keywordflow">else</span> {
<a name="l03376" id="l03376"></a>03376             <span class=
"keywordflow">if</span> (netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_QUICK_PRINT)) {
<a name="l03377" id="l03377"></a>03377                 <span class="keywordflow">if</span> (!snmp_strcat
<a name="l03378" id="l03378"></a>03378                     (buf, buf_len, out_len, allow_realloc,
<a name="l03379" id="l03379"></a>03379                      (<span class="keyword">const</span> u_char *) <span class=
"stringliteral">" "</span>)) {
<a name="l03380" id="l03380"></a>03380                     <span class="keywordflow">return</span> 0;
<a name="l03381" id="l03381"></a>03381                 }
<a name="l03382" id="l03382"></a>03382             } <span class="keywordflow">else</span> {
<a name="l03383" id="l03383"></a>03383                 <span class="keywordflow">if</span> (!snmp_strcat
<a name="l03384" id="l03384"></a>03384                     (buf, buf_len, out_len, allow_realloc,
<a name="l03385" id="l03385"></a>03385                      (<span class="keyword">const</span> u_char *) <span class=
"stringliteral">" = "</span>)) {
<a name="l03386" id="l03386"></a>03386                     <span class="keywordflow">return</span> 0;
<a name="l03387" id="l03387"></a>03387                 }
<a name="l03388" id="l03388"></a>03388             }                   <span class=
"comment">/* end if-else NETSNMP_DS_LIB_QUICK_PRINT */</span>
<a name="l03389" id="l03389"></a>03389         }                       <span class=
"comment">/* end if-else NETSNMP_DS_LIB_QUICKE_PRINT */</span>
<a name="l03390" id="l03390"></a>03390     } <span class="keywordflow">else</span> {
<a name="l03391" id="l03391"></a>03391         *out_len = 0;
<a name="l03392" id="l03392"></a>03392     }
<a name="l03393" id="l03393"></a>03393 
<a name="l03394" id="l03394"></a>03394     <span class="keywordflow">if</span> (variable-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a> == SNMP_NOSUCHOBJECT) {
<a name="l03395" id="l03395"></a>03395         <span class=
"keywordflow">return</span> snmp_strcat(buf, buf_len, out_len, allow_realloc,
<a name="l03396" id="l03396"></a>03396                            (<span class="keyword">const</span> u_char *)
<a name="l03397" id="l03397"></a>03397                            <span class=
"stringliteral">"No Such Object available on this agent at this OID"</span>);
<a name="l03398" id="l03398"></a>03398     } <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (variable-&gt;<a class="code" href="structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title=
"ASN type of variable.">type</a> == SNMP_NOSUCHINSTANCE) {
<a name="l03399" id="l03399"></a>03399         <span class=
"keywordflow">return</span> snmp_strcat(buf, buf_len, out_len, allow_realloc,
<a name="l03400" id="l03400"></a>03400                            (<span class="keyword">const</span> u_char *)
<a name="l03401" id="l03401"></a>03401                            <span class=
"stringliteral">"No Such Instance currently exists at this OID"</span>);
<a name="l03402" id="l03402"></a>03402     } <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (variable-&gt;<a class="code" href="structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title=
"ASN type of variable.">type</a> == SNMP_ENDOFMIBVIEW) {
<a name="l03403" id="l03403"></a>03403         <span class=
"keywordflow">return</span> snmp_strcat(buf, buf_len, out_len, allow_realloc,
<a name="l03404" id="l03404"></a>03404                            (<span class="keyword">const</span> u_char *)
<a name="l03405" id="l03405"></a>03405                            <span class=
"stringliteral">"No more variables left in this MIB View (It is past the end of the MIB tree)"</span>);
<a name="l03406" id="l03406"></a>03406 <span class="preprocessor">#ifndef NETSNMP_DISABLE_MIB_LOADING</span>
<a name="l03407" id="l03407"></a>03407     } <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (subtree) {
<a name="l03408" id="l03408"></a>03408         <span class="keyword">const</span> <span class=
"keywordtype">char</span> *units = NULL;
<a name="l03409" id="l03409"></a>03409         <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint = NULL;
<a name="l03410" id="l03410"></a>03410         <span class=
"keywordflow">if</span> (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID,
<a name="l03411" id="l03411"></a>03411                                     NETSNMP_DS_LIB_DONT_PRINT_UNITS)) {
<a name="l03412" id="l03412"></a>03412             units = subtree-&gt;units;
<a name="l03413" id="l03413"></a>03413         }
<a name="l03414" id="l03414"></a>03414 
<a name="l03415" id="l03415"></a>03415                 <span class=
"keywordflow">if</span> (!netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID,
<a name="l03416" id="l03416"></a>03416                                     NETSNMP_DS_LIB_NO_DISPLAY_HINT)) {
<a name="l03417" id="l03417"></a>03417                         hint = subtree-&gt;hint;
<a name="l03418" id="l03418"></a>03418         }
<a name="l03419" id="l03419"></a>03419 
<a name="l03420" id="l03420"></a>03420         <span class="keywordflow">if</span> (subtree-&gt;printomat) {
<a name="l03421" id="l03421"></a>03421             <span class=
"keywordflow">return</span> (*subtree-&gt;printomat) (buf, buf_len, out_len,
<a name="l03422" id="l03422"></a>03422                                           allow_realloc, variable,
<a name="l03423" id="l03423"></a>03423                                           subtree-&gt;enums, hint,
<a name="l03424" id="l03424"></a>03424                                           units);
<a name="l03425" id="l03425"></a>03425         } <span class="keywordflow">else</span> {
<a name="l03426" id="l03426"></a>03426             <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#gabc12c361abdca75234c11dccb34871b" title=
"Universal print routine, prints a variable into a buffer according to the variable...">sprint_realloc_by_type</a>(buf, buf_len, out_len,
<a name="l03427" id="l03427"></a>03427                                           allow_realloc, variable,
<a name="l03428" id="l03428"></a>03428                                           subtree-&gt;enums, hint,
<a name="l03429" id="l03429"></a>03429                                           units);
<a name="l03430" id="l03430"></a>03430         }
<a name="l03431" id="l03431"></a>03431 <span class="preprocessor">#endif </span><span class=
"comment">/* NETSNMP_DISABLE_MIB_LOADING */</span>
<a name="l03432" id="l03432"></a>03432     } <span class="keywordflow">else</span> {
<a name="l03433" id="l03433"></a>03433         <span class="comment">/*</span>
<a name="l03434" id="l03434"></a>03434 <span class="comment">         * Handle rare case where tree is empty.  </span>
<a name="l03435" id="l03435"></a>03435 <span class="comment">         */</span>
<a name="l03436" id="l03436"></a>03436         <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#gabc12c361abdca75234c11dccb34871b" title=
"Universal print routine, prints a variable into a buffer according to the variable...">sprint_realloc_by_type</a>(buf, buf_len, out_len, allow_realloc,
<a name="l03437" id="l03437"></a>03437                                       variable, NULL, NULL, NULL);
<a name="l03438" id="l03438"></a>03438     }
<a name="l03439" id="l03439"></a>03439 }
<a name="l03440" id="l03440"></a>03440 
<a name="l03441" id="l03441"></a>03441 <span class="keywordtype">int</span>
<a name="l03442" id="l03442"></a>03442 snprint_variable(<span class="keywordtype">char</span> *buf, <span class=
"keywordtype">size_t</span> buf_len,
<a name="l03443" id="l03443"></a>03443                  <span class="keyword">const</span> oid * objid, <span class=
"keywordtype">size_t</span> objidlen,
<a name="l03444" id="l03444"></a>03444                  <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * variable)
<a name="l03445" id="l03445"></a>03445 {
<a name="l03446" id="l03446"></a>03446     <span class="keywordtype">size_t</span>          out_len = 0;
<a name="l03447" id="l03447"></a>03447 
<a name="l03448" id="l03448"></a>03448     <span class=
"keywordflow">if</span> (sprint_realloc_variable((u_char **) &amp; buf, &amp;buf_len, &amp;out_len, 0,
<a name="l03449" id="l03449"></a>03449                                 objid, objidlen, variable)) {
<a name="l03450" id="l03450"></a>03450         <span class="keywordflow">return</span> (<span class=
"keywordtype">int</span>) out_len;
<a name="l03451" id="l03451"></a>03451     } <span class="keywordflow">else</span> {
<a name="l03452" id="l03452"></a>03452         <span class="keywordflow">return</span> -1;
<a name="l03453" id="l03453"></a>03453     }
<a name="l03454" id="l03454"></a>03454 }
<a name="l03455" id="l03455"></a>03455 
<a name="l03463" id="l03463"></a>03463 <span class="keywordtype">void</span>
<a name="l03464" id="l03464"></a><a class="code" href=
"group__mib__utilities.html#g61cb98397be40630427b08b5e2789a81">03464</a> <a class="code" href=
"group__mib__utilities.html#g61cb98397be40630427b08b5e2789a81" title=
"Prints a variable to stdout.">print_variable</a>(<span class="keyword">const</span> oid * objid,
<a name="l03465" id="l03465"></a>03465                <span class="keywordtype">size_t</span> objidlen, <span class=
"keyword">const</span> <a class="code" href="structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * variable)
<a name="l03466" id="l03466"></a>03466 {
<a name="l03467" id="l03467"></a>03467     <a class="code" href="group__mib__utilities.html#g747e79ef3ce1805ca46b47005893a8f8"
title="Prints a variable to a file descriptor.">fprint_variable</a>(stdout, objid, objidlen, variable);
<a name="l03468" id="l03468"></a>03468 }
<a name="l03469" id="l03469"></a>03469 
<a name="l03470" id="l03470"></a>03470 
<a name="l03479" id="l03479"></a>03479 <span class="keywordtype">void</span>
<a name="l03480" id="l03480"></a><a class="code" href=
"group__mib__utilities.html#g747e79ef3ce1805ca46b47005893a8f8">03480</a> <a class="code" href=
"group__mib__utilities.html#g747e79ef3ce1805ca46b47005893a8f8" title=
"Prints a variable to a file descriptor.">fprint_variable</a>(FILE * f,
<a name="l03481" id="l03481"></a>03481                 <span class="keyword">const</span> oid * objid,
<a name="l03482" id="l03482"></a>03482                 <span class="keywordtype">size_t</span> objidlen, <span class=
"keyword">const</span> <a class="code" href="structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * variable)
<a name="l03483" id="l03483"></a>03483 {
<a name="l03484" id="l03484"></a>03484     u_char         *buf = NULL;
<a name="l03485" id="l03485"></a>03485     <span class="keywordtype">size_t</span>          buf_len = 256, out_len = 0;
<a name="l03486" id="l03486"></a>03486 
<a name="l03487" id="l03487"></a>03487     <span class="keywordflow">if</span> ((buf = (u_char *) calloc(buf_len, 1)) == NULL) {
<a name="l03488" id="l03488"></a>03488         fprintf(f, <span class="stringliteral">"[TRUNCATED]\n"</span>);
<a name="l03489" id="l03489"></a>03489         <span class="keywordflow">return</span>;
<a name="l03490" id="l03490"></a>03490     } <span class="keywordflow">else</span> {
<a name="l03491" id="l03491"></a>03491         <span class=
"keywordflow">if</span> (sprint_realloc_variable(&amp;buf, &amp;buf_len, &amp;out_len, 1,
<a name="l03492" id="l03492"></a>03492                                     objid, objidlen, variable)) {
<a name="l03493" id="l03493"></a>03493             fprintf(f, <span class="stringliteral">"%s\n"</span>, buf);
<a name="l03494" id="l03494"></a>03494         } <span class="keywordflow">else</span> {
<a name="l03495" id="l03495"></a>03495             fprintf(f, <span class="stringliteral">"%s [TRUNCATED]\n"</span>, buf);
<a name="l03496" id="l03496"></a>03496         }
<a name="l03497" id="l03497"></a>03497     }
<a name="l03498" id="l03498"></a>03498 
<a name="l03499" id="l03499"></a>03499     <a class="code" href="group__util.html#g951e93edb6f0ea941e26155e3f8912a6" title=
"Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(buf);
<a name="l03500" id="l03500"></a>03500 }
<a name="l03501" id="l03501"></a>03501 
<a name="l03502" id="l03502"></a>03502 <span class="keywordtype">int</span>
<a name="l03503" id="l03503"></a>03503 sprint_realloc_value(u_char ** buf, <span class="keywordtype">size_t</span> * buf_len,
<a name="l03504" id="l03504"></a>03504                      <span class="keywordtype">size_t</span> * out_len, <span class=
"keywordtype">int</span> allow_realloc,
<a name="l03505" id="l03505"></a>03505                      <span class="keyword">const</span> oid * objid, <span class=
"keywordtype">size_t</span> objidlen,
<a name="l03506" id="l03506"></a>03506                      <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * variable)
<a name="l03507" id="l03507"></a>03507 {
<a name="l03508" id="l03508"></a>03508     <span class="keywordflow">if</span> (variable-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a> == SNMP_NOSUCHOBJECT) {
<a name="l03509" id="l03509"></a>03509         <span class=
"keywordflow">return</span> snmp_strcat(buf, buf_len, out_len, allow_realloc,
<a name="l03510" id="l03510"></a>03510                            (<span class="keyword">const</span> u_char *)
<a name="l03511" id="l03511"></a>03511                            <span class=
"stringliteral">"No Such Object available on this agent at this OID"</span>);
<a name="l03512" id="l03512"></a>03512     } <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (variable-&gt;<a class="code" href="structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title=
"ASN type of variable.">type</a> == SNMP_NOSUCHINSTANCE) {
<a name="l03513" id="l03513"></a>03513         <span class=
"keywordflow">return</span> snmp_strcat(buf, buf_len, out_len, allow_realloc,
<a name="l03514" id="l03514"></a>03514                            (<span class="keyword">const</span> u_char *)
<a name="l03515" id="l03515"></a>03515                            <span class=
"stringliteral">"No Such Instance currently exists at this OID"</span>);
<a name="l03516" id="l03516"></a>03516     } <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (variable-&gt;<a class="code" href="structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title=
"ASN type of variable.">type</a> == SNMP_ENDOFMIBVIEW) {
<a name="l03517" id="l03517"></a>03517         <span class=
"keywordflow">return</span> snmp_strcat(buf, buf_len, out_len, allow_realloc,
<a name="l03518" id="l03518"></a>03518                            (<span class="keyword">const</span> u_char *)
<a name="l03519" id="l03519"></a>03519                            <span class=
"stringliteral">"No more variables left in this MIB View (It is past the end of the MIB tree)"</span>);
<a name="l03520" id="l03520"></a>03520     } <span class="keywordflow">else</span> {
<a name="l03521" id="l03521"></a>03521 <span class="preprocessor">#ifndef NETSNMP_DISABLE_MIB_LOADING</span>
<a name="l03522" id="l03522"></a>03522         <span class="keyword">const</span> <span class=
"keywordtype">char</span> *units = NULL;
<a name="l03523" id="l03523"></a>03523         <span class="keyword">struct </span>tree *subtree = tree_head;
<a name="l03524" id="l03524"></a>03524         subtree = get_tree(objid, objidlen, subtree);
<a name="l03525" id="l03525"></a>03525         <span class=
"keywordflow">if</span> (subtree &amp;&amp; !netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID,
<a name="l03526" id="l03526"></a>03526                                             NETSNMP_DS_LIB_DONT_PRINT_UNITS)) {
<a name="l03527" id="l03527"></a>03527             units = subtree-&gt;units;
<a name="l03528" id="l03528"></a>03528         }
<a name="l03529" id="l03529"></a>03529         <span class="keywordflow">if</span> (subtree) {
<a name="l03530" id="l03530"></a>03530             <span class="keywordflow">if</span>(subtree-&gt;printomat) {
<a name="l03531" id="l03531"></a>03531                 <span class=
"keywordflow">return</span> (*subtree-&gt;printomat) (buf, buf_len, out_len,
<a name="l03532" id="l03532"></a>03532                                               allow_realloc, variable,
<a name="l03533" id="l03533"></a>03533                                               subtree-&gt;enums, subtree-&gt;hint,
<a name="l03534" id="l03534"></a>03534                                               units);
<a name="l03535" id="l03535"></a>03535             } <span class="keywordflow">else</span> {
<a name="l03536" id="l03536"></a>03536                 <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#gabc12c361abdca75234c11dccb34871b" title=
"Universal print routine, prints a variable into a buffer according to the variable...">sprint_realloc_by_type</a>(buf, buf_len, out_len,
<a name="l03537" id="l03537"></a>03537                                               allow_realloc, variable,
<a name="l03538" id="l03538"></a>03538                                               subtree-&gt;enums, subtree-&gt;hint,
<a name="l03539" id="l03539"></a>03539                                               units);
<a name="l03540" id="l03540"></a>03540             }
<a name="l03541" id="l03541"></a>03541         }
<a name="l03542" id="l03542"></a>03542 <span class="preprocessor">#endif </span><span class=
"comment">/* NETSNMP_DISABLE_MIB_LOADING */</span>
<a name="l03543" id="l03543"></a>03543         <span class="keywordflow">return</span> <a class="code" href=
"group__mib__utilities.html#gabc12c361abdca75234c11dccb34871b" title=
"Universal print routine, prints a variable into a buffer according to the variable...">sprint_realloc_by_type</a>(buf, buf_len, out_len,
<a name="l03544" id="l03544"></a>03544                                       allow_realloc, variable,
<a name="l03545" id="l03545"></a>03545                                       NULL, NULL, NULL);
<a name="l03546" id="l03546"></a>03546     }
<a name="l03547" id="l03547"></a>03547 }
<a name="l03548" id="l03548"></a>03548 
<a name="l03549" id="l03549"></a>03549 <span class="keywordtype">int</span>
<a name="l03550" id="l03550"></a>03550 snprint_value(<span class="keywordtype">char</span> *buf, <span class=
"keywordtype">size_t</span> buf_len,
<a name="l03551" id="l03551"></a>03551               <span class="keyword">const</span> oid * objid, <span class=
"keywordtype">size_t</span> objidlen,
<a name="l03552" id="l03552"></a>03552               <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * variable)
<a name="l03553" id="l03553"></a>03553 {
<a name="l03554" id="l03554"></a>03554     <span class="keywordtype">size_t</span>          out_len = 0;
<a name="l03555" id="l03555"></a>03555 
<a name="l03556" id="l03556"></a>03556     <span class=
"keywordflow">if</span> (sprint_realloc_value((u_char **) &amp; buf, &amp;buf_len, &amp;out_len, 0,
<a name="l03557" id="l03557"></a>03557                              objid, objidlen, variable)) {
<a name="l03558" id="l03558"></a>03558         <span class="keywordflow">return</span> (<span class=
"keywordtype">int</span>) out_len;
<a name="l03559" id="l03559"></a>03559     } <span class="keywordflow">else</span> {
<a name="l03560" id="l03560"></a>03560         <span class="keywordflow">return</span> -1;
<a name="l03561" id="l03561"></a>03561     }
<a name="l03562" id="l03562"></a>03562 }
<a name="l03563" id="l03563"></a>03563 
<a name="l03564" id="l03564"></a>03564 <span class="keywordtype">void</span>
<a name="l03565" id="l03565"></a>03565 print_value(<span class="keyword">const</span> oid * objid,
<a name="l03566" id="l03566"></a>03566             <span class="keywordtype">size_t</span> objidlen, <span class=
"keyword">const</span> <a class="code" href="structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * variable)
<a name="l03567" id="l03567"></a>03567 {
<a name="l03568" id="l03568"></a>03568     fprint_value(stdout, objid, objidlen, variable);
<a name="l03569" id="l03569"></a>03569 }
<a name="l03570" id="l03570"></a>03570 
<a name="l03571" id="l03571"></a>03571 <span class="keywordtype">void</span>
<a name="l03572" id="l03572"></a>03572 fprint_value(FILE * f,
<a name="l03573" id="l03573"></a>03573              <span class="keyword">const</span> oid * objid,
<a name="l03574" id="l03574"></a>03574              <span class="keywordtype">size_t</span> objidlen, <span class=
"keyword">const</span> <a class="code" href="structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * variable)
<a name="l03575" id="l03575"></a>03575 {
<a name="l03576" id="l03576"></a>03576     u_char         *buf = NULL;
<a name="l03577" id="l03577"></a>03577     <span class="keywordtype">size_t</span>          buf_len = 256, out_len = 0;
<a name="l03578" id="l03578"></a>03578 
<a name="l03579" id="l03579"></a>03579     <span class="keywordflow">if</span> ((buf = (u_char *) calloc(buf_len, 1)) == NULL) {
<a name="l03580" id="l03580"></a>03580         fprintf(f, <span class="stringliteral">"[TRUNCATED]\n"</span>);
<a name="l03581" id="l03581"></a>03581         <span class="keywordflow">return</span>;
<a name="l03582" id="l03582"></a>03582     } <span class="keywordflow">else</span> {
<a name="l03583" id="l03583"></a>03583         <span class=
"keywordflow">if</span> (sprint_realloc_value(&amp;buf, &amp;buf_len, &amp;out_len, 1,
<a name="l03584" id="l03584"></a>03584                                  objid, objidlen, variable)) {
<a name="l03585" id="l03585"></a>03585             fprintf(f, <span class="stringliteral">"%s\n"</span>, buf);
<a name="l03586" id="l03586"></a>03586         } <span class="keywordflow">else</span> {
<a name="l03587" id="l03587"></a>03587             fprintf(f, <span class="stringliteral">"%s [TRUNCATED]\n"</span>, buf);
<a name="l03588" id="l03588"></a>03588         }
<a name="l03589" id="l03589"></a>03589     }
<a name="l03590" id="l03590"></a>03590 
<a name="l03591" id="l03591"></a>03591     <a class="code" href="group__util.html#g951e93edb6f0ea941e26155e3f8912a6" title=
"Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(buf);
<a name="l03592" id="l03592"></a>03592 }
<a name="l03593" id="l03593"></a>03593 
<a name="l03594" id="l03594"></a>03594 
<a name="l03602" id="l03602"></a>03602 <span class="keywordtype">int</span>
<a name="l03603" id="l03603"></a><a class="code" href=
"group__mib__utilities.html#g0d3a6feb3852ee6f6901f442ff9900cf">03603</a> <a class="code" href=
"group__mib__utilities.html#g0d3a6feb3852ee6f6901f442ff9900cf" title=
"Takes the value in VAR and turns it into an OID segment in var-&amp;gt;name.">build_oid_segment</a>(<a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var)
<a name="l03604" id="l03604"></a>03604 {
<a name="l03605" id="l03605"></a>03605     <span class="keywordtype">int</span>             i;
<a name="l03606" id="l03606"></a>03606 
<a name="l03607" id="l03607"></a>03607     <span class="keywordflow">if</span> (var-&gt;<a class="code" href=
"structvariable__list.html#7b5bdda01921550d24ea53033ce76146" title=
"Object identifier of variable.">name</a> &amp;&amp; var-&gt;<a class="code" href=
"structvariable__list.html#7b5bdda01921550d24ea53033ce76146" title="Object identifier of variable.">name</a> != var-&gt;<a class=
"code" href="structvariable__list.html#5b8071f7514fb530c9b596791bca6813" title="90 percentile &amp;lt; 24.">name_loc</a>)
<a name="l03608" id="l03608"></a>03608         <a class="code" href="group__util.html#g951e93edb6f0ea941e26155e3f8912a6" title=
"Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(var-&gt;<a class="code" href=
"structvariable__list.html#7b5bdda01921550d24ea53033ce76146" title="Object identifier of variable.">name</a>);
<a name="l03609" id="l03609"></a>03609     <span class="keywordflow">switch</span> (var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a>) {
<a name="l03610" id="l03610"></a>03610     <span class="keywordflow">case</span> ASN_INTEGER:
<a name="l03611" id="l03611"></a>03611     <span class="keywordflow">case</span> ASN_COUNTER:
<a name="l03612" id="l03612"></a>03612     <span class="keywordflow">case</span> ASN_GAUGE:
<a name="l03613" id="l03613"></a>03613     <span class="keywordflow">case</span> ASN_TIMETICKS:
<a name="l03614" id="l03614"></a>03614         var-&gt;<a class="code" href=
"structvariable__list.html#089e5b1a422bf8e693510ff5408a57a7" title="number of subid&amp;#39;s in name">name_length</a> = 1;
<a name="l03615" id="l03615"></a>03615         var-&gt;<a class="code" href=
"structvariable__list.html#7b5bdda01921550d24ea53033ce76146" title="Object identifier of variable.">name</a> = var-&gt;<a class=
"code" href="structvariable__list.html#5b8071f7514fb530c9b596791bca6813" title="90 percentile &amp;lt; 24.">name_loc</a>;
<a name="l03616" id="l03616"></a>03616         var-&gt;<a class="code" href=
"structvariable__list.html#7b5bdda01921550d24ea53033ce76146" title=
"Object identifier of variable.">name</a>[0] = *(var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.integer);
<a name="l03617" id="l03617"></a>03617         <span class="keywordflow">break</span>;
<a name="l03618" id="l03618"></a>03618 
<a name="l03619" id="l03619"></a>03619     <span class="keywordflow">case</span> ASN_IPADDRESS:
<a name="l03620" id="l03620"></a>03620         var-&gt;<a class="code" href=
"structvariable__list.html#089e5b1a422bf8e693510ff5408a57a7" title="number of subid&amp;#39;s in name">name_length</a> = 4;
<a name="l03621" id="l03621"></a>03621         var-&gt;<a class="code" href=
"structvariable__list.html#7b5bdda01921550d24ea53033ce76146" title="Object identifier of variable.">name</a> = var-&gt;<a class=
"code" href="structvariable__list.html#5b8071f7514fb530c9b596791bca6813" title="90 percentile &amp;lt; 24.">name_loc</a>;
<a name="l03622" id="l03622"></a>03622         var-&gt;<a class="code" href=
"structvariable__list.html#7b5bdda01921550d24ea53033ce76146" title="Object identifier of variable.">name</a>[0] =
<a name="l03623" id="l03623"></a>03623             (((<span class="keywordtype">unsigned</span> int) *(var-&gt;<a class="code"
href="structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title=
"value of variable">val</a>.integer)) &amp; 0xff000000) &gt;&gt; 24;
<a name="l03624" id="l03624"></a>03624         var-&gt;<a class="code" href=
"structvariable__list.html#7b5bdda01921550d24ea53033ce76146" title="Object identifier of variable.">name</a>[1] =
<a name="l03625" id="l03625"></a>03625             (((<span class="keywordtype">unsigned</span> int) *(var-&gt;<a class="code"
href="structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title=
"value of variable">val</a>.integer)) &amp; 0x00ff0000) &gt;&gt; 16;
<a name="l03626" id="l03626"></a>03626         var-&gt;<a class="code" href=
"structvariable__list.html#7b5bdda01921550d24ea53033ce76146" title="Object identifier of variable.">name</a>[2] =
<a name="l03627" id="l03627"></a>03627             (((<span class="keywordtype">unsigned</span> int) *(var-&gt;<a class="code"
href="structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title=
"value of variable">val</a>.integer)) &amp; 0x0000ff00) &gt;&gt; 8;
<a name="l03628" id="l03628"></a>03628         var-&gt;<a class="code" href=
"structvariable__list.html#7b5bdda01921550d24ea53033ce76146" title="Object identifier of variable.">name</a>[3] =
<a name="l03629" id="l03629"></a>03629             (((<span class="keywordtype">unsigned</span> int) *(var-&gt;<a class="code"
href="structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.integer)) &amp; 0x000000ff);
<a name="l03630" id="l03630"></a>03630         <span class="keywordflow">break</span>;
<a name="l03631" id="l03631"></a>03631         
<a name="l03632" id="l03632"></a>03632     <span class="keywordflow">case</span> ASN_PRIV_IMPLIED_OBJECT_ID:
<a name="l03633" id="l03633"></a>03633         var-&gt;<a class="code" href=
"structvariable__list.html#089e5b1a422bf8e693510ff5408a57a7" title=
"number of subid&amp;#39;s in name">name_length</a> = var-&gt;<a class="code" href=
"structvariable__list.html#17aaa6b445178fc39aba69642247d3e9" title=
"the length of the value to be copied into buf">val_len</a> / <span class="keyword">sizeof</span>(oid);
<a name="l03634" id="l03634"></a>03634         <span class="keywordflow">if</span> (var-&gt;<a class="code" href=
"structvariable__list.html#089e5b1a422bf8e693510ff5408a57a7" title=
"number of subid&amp;#39;s in name">name_length</a> &gt; (<span class="keyword">sizeof</span>(var-&gt;<a class="code" href=
"structvariable__list.html#5b8071f7514fb530c9b596791bca6813" title="90 percentile &amp;lt; 24.">name_loc</a>) / <span class=
"keyword">sizeof</span>(oid)))
<a name="l03635" id="l03635"></a>03635             var-&gt;<a class="code" href=
"structvariable__list.html#7b5bdda01921550d24ea53033ce76146" title=
"Object identifier of variable.">name</a> = (oid *) malloc(<span class="keyword">sizeof</span>(oid) * (var-&gt;<a class="code"
href="structvariable__list.html#089e5b1a422bf8e693510ff5408a57a7" title="number of subid&amp;#39;s in name">name_length</a>));
<a name="l03636" id="l03636"></a>03636         <span class="keywordflow">else</span>
<a name="l03637" id="l03637"></a>03637             var-&gt;<a class="code" href=
"structvariable__list.html#7b5bdda01921550d24ea53033ce76146" title="Object identifier of variable.">name</a> = var-&gt;<a class=
"code" href="structvariable__list.html#5b8071f7514fb530c9b596791bca6813" title="90 percentile &amp;lt; 24.">name_loc</a>;
<a name="l03638" id="l03638"></a>03638         <span class="keywordflow">if</span> (var-&gt;<a class="code" href=
"structvariable__list.html#7b5bdda01921550d24ea53033ce76146" title="Object identifier of variable.">name</a> == NULL)
<a name="l03639" id="l03639"></a>03639             <span class="keywordflow">return</span> SNMPERR_GENERR;
<a name="l03640" id="l03640"></a>03640 
<a name="l03641" id="l03641"></a>03641         <span class="keywordflow">for</span> (i = 0; i &lt; (int) var-&gt;<a class="code"
href="structvariable__list.html#089e5b1a422bf8e693510ff5408a57a7" title="number of subid&amp;#39;s in name">name_length</a>; i++)
<a name="l03642" id="l03642"></a>03642             var-&gt;<a class="code" href=
"structvariable__list.html#7b5bdda01921550d24ea53033ce76146" title=
"Object identifier of variable.">name</a>[i] = var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.objid[i];
<a name="l03643" id="l03643"></a>03643         <span class="keywordflow">break</span>;
<a name="l03644" id="l03644"></a>03644 
<a name="l03645" id="l03645"></a>03645     <span class="keywordflow">case</span> ASN_OBJECT_ID:
<a name="l03646" id="l03646"></a>03646         var-&gt;<a class="code" href=
"structvariable__list.html#089e5b1a422bf8e693510ff5408a57a7" title=
"number of subid&amp;#39;s in name">name_length</a> = var-&gt;<a class="code" href=
"structvariable__list.html#17aaa6b445178fc39aba69642247d3e9" title=
"the length of the value to be copied into buf">val_len</a> / <span class="keyword">sizeof</span>(oid) + 1;
<a name="l03647" id="l03647"></a>03647         <span class="keywordflow">if</span> (var-&gt;<a class="code" href=
"structvariable__list.html#089e5b1a422bf8e693510ff5408a57a7" title=
"number of subid&amp;#39;s in name">name_length</a> &gt; (<span class="keyword">sizeof</span>(var-&gt;<a class="code" href=
"structvariable__list.html#5b8071f7514fb530c9b596791bca6813" title="90 percentile &amp;lt; 24.">name_loc</a>) / <span class=
"keyword">sizeof</span>(oid)))
<a name="l03648" id="l03648"></a>03648             var-&gt;<a class="code" href=
"structvariable__list.html#7b5bdda01921550d24ea53033ce76146" title=
"Object identifier of variable.">name</a> = (oid *) malloc(<span class="keyword">sizeof</span>(oid) * (var-&gt;<a class="code"
href="structvariable__list.html#089e5b1a422bf8e693510ff5408a57a7" title="number of subid&amp;#39;s in name">name_length</a>));
<a name="l03649" id="l03649"></a>03649         <span class="keywordflow">else</span>
<a name="l03650" id="l03650"></a>03650             var-&gt;<a class="code" href=
"structvariable__list.html#7b5bdda01921550d24ea53033ce76146" title="Object identifier of variable.">name</a> = var-&gt;<a class=
"code" href="structvariable__list.html#5b8071f7514fb530c9b596791bca6813" title="90 percentile &amp;lt; 24.">name_loc</a>;
<a name="l03651" id="l03651"></a>03651         <span class="keywordflow">if</span> (var-&gt;<a class="code" href=
"structvariable__list.html#7b5bdda01921550d24ea53033ce76146" title="Object identifier of variable.">name</a> == NULL)
<a name="l03652" id="l03652"></a>03652             <span class="keywordflow">return</span> SNMPERR_GENERR;
<a name="l03653" id="l03653"></a>03653 
<a name="l03654" id="l03654"></a>03654         var-&gt;<a class="code" href=
"structvariable__list.html#7b5bdda01921550d24ea53033ce76146" title=
"Object identifier of variable.">name</a>[0] = var-&gt;<a class="code" href=
"structvariable__list.html#089e5b1a422bf8e693510ff5408a57a7" title="number of subid&amp;#39;s in name">name_length</a> - 1;
<a name="l03655" id="l03655"></a>03655         <span class="keywordflow">for</span> (i = 0; i &lt; (int) var-&gt;<a class="code"
href="structvariable__list.html#089e5b1a422bf8e693510ff5408a57a7" title=
"number of subid&amp;#39;s in name">name_length</a> - 1; i++)
<a name="l03656" id="l03656"></a>03656             var-&gt;<a class="code" href=
"structvariable__list.html#7b5bdda01921550d24ea53033ce76146" title=
"Object identifier of variable.">name</a>[i + 1] = var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.objid[i];
<a name="l03657" id="l03657"></a>03657         <span class="keywordflow">break</span>;
<a name="l03658" id="l03658"></a>03658 
<a name="l03659" id="l03659"></a>03659     <span class="keywordflow">case</span> ASN_PRIV_IMPLIED_OCTET_STR:
<a name="l03660" id="l03660"></a>03660         var-&gt;<a class="code" href=
"structvariable__list.html#089e5b1a422bf8e693510ff5408a57a7" title=
"number of subid&amp;#39;s in name">name_length</a> = var-&gt;<a class="code" href=
"structvariable__list.html#17aaa6b445178fc39aba69642247d3e9" title="the length of the value to be copied into buf">val_len</a>;
<a name="l03661" id="l03661"></a>03661         <span class="keywordflow">if</span> (var-&gt;<a class="code" href=
"structvariable__list.html#089e5b1a422bf8e693510ff5408a57a7" title=
"number of subid&amp;#39;s in name">name_length</a> &gt; (<span class="keyword">sizeof</span>(var-&gt;<a class="code" href=
"structvariable__list.html#5b8071f7514fb530c9b596791bca6813" title="90 percentile &amp;lt; 24.">name_loc</a>) / <span class=
"keyword">sizeof</span>(oid)))
<a name="l03662" id="l03662"></a>03662             var-&gt;<a class="code" href=
"structvariable__list.html#7b5bdda01921550d24ea53033ce76146" title=
"Object identifier of variable.">name</a> = (oid *) malloc(<span class="keyword">sizeof</span>(oid) * (var-&gt;<a class="code"
href="structvariable__list.html#089e5b1a422bf8e693510ff5408a57a7" title="number of subid&amp;#39;s in name">name_length</a>));
<a name="l03663" id="l03663"></a>03663         <span class="keywordflow">else</span>
<a name="l03664" id="l03664"></a>03664             var-&gt;<a class="code" href=
"structvariable__list.html#7b5bdda01921550d24ea53033ce76146" title="Object identifier of variable.">name</a> = var-&gt;<a class=
"code" href="structvariable__list.html#5b8071f7514fb530c9b596791bca6813" title="90 percentile &amp;lt; 24.">name_loc</a>;
<a name="l03665" id="l03665"></a>03665         <span class="keywordflow">if</span> (var-&gt;<a class="code" href=
"structvariable__list.html#7b5bdda01921550d24ea53033ce76146" title="Object identifier of variable.">name</a> == NULL)
<a name="l03666" id="l03666"></a>03666             <span class="keywordflow">return</span> SNMPERR_GENERR;
<a name="l03667" id="l03667"></a>03667 
<a name="l03668" id="l03668"></a>03668         <span class="keywordflow">for</span> (i = 0; i &lt; (int) var-&gt;<a class="code"
href="structvariable__list.html#17aaa6b445178fc39aba69642247d3e9" title=
"the length of the value to be copied into buf">val_len</a>; i++)
<a name="l03669" id="l03669"></a>03669             var-&gt;<a class="code" href=
"structvariable__list.html#7b5bdda01921550d24ea53033ce76146" title=
"Object identifier of variable.">name</a>[i] = (oid) var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.string[i];
<a name="l03670" id="l03670"></a>03670         <span class="keywordflow">break</span>;
<a name="l03671" id="l03671"></a>03671 
<a name="l03672" id="l03672"></a>03672     <span class="keywordflow">case</span> ASN_OPAQUE:
<a name="l03673" id="l03673"></a>03673     <span class="keywordflow">case</span> ASN_OCTET_STR:
<a name="l03674" id="l03674"></a>03674         var-&gt;<a class="code" href=
"structvariable__list.html#089e5b1a422bf8e693510ff5408a57a7" title=
"number of subid&amp;#39;s in name">name_length</a> = var-&gt;<a class="code" href=
"structvariable__list.html#17aaa6b445178fc39aba69642247d3e9" title=
"the length of the value to be copied into buf">val_len</a> + 1;
<a name="l03675" id="l03675"></a>03675         if (var-&gt;<a class="code" href=
"structvariable__list.html#089e5b1a422bf8e693510ff5408a57a7" title=
"number of subid&amp;#39;s in name">name_length</a> &gt; (<span class="keyword">sizeof</span>(var-&gt;<a class="code" href=
"structvariable__list.html#5b8071f7514fb530c9b596791bca6813" title="90 percentile &amp;lt; 24.">name_loc</a>) / <span class=
"keyword">sizeof</span>(oid)))
<a name="l03676" id="l03676"></a>03676             var-&gt;<a class="code" href=
"structvariable__list.html#7b5bdda01921550d24ea53033ce76146" title=
"Object identifier of variable.">name</a> = (oid *) malloc(<span class="keyword">sizeof</span>(oid) * (var-&gt;<a class="code"
href="structvariable__list.html#089e5b1a422bf8e693510ff5408a57a7" title="number of subid&amp;#39;s in name">name_length</a>));
<a name="l03677" id="l03677"></a>03677         <span class="keywordflow">else</span>
<a name="l03678" id="l03678"></a>03678             var-&gt;<a class="code" href=
"structvariable__list.html#7b5bdda01921550d24ea53033ce76146" title="Object identifier of variable.">name</a> = var-&gt;<a class=
"code" href="structvariable__list.html#5b8071f7514fb530c9b596791bca6813" title="90 percentile &amp;lt; 24.">name_loc</a>;
<a name="l03679" id="l03679"></a>03679         <span class="keywordflow">if</span> (var-&gt;<a class="code" href=
"structvariable__list.html#7b5bdda01921550d24ea53033ce76146" title="Object identifier of variable.">name</a> == NULL)
<a name="l03680" id="l03680"></a>03680             <span class="keywordflow">return</span> SNMPERR_GENERR;
<a name="l03681" id="l03681"></a>03681 
<a name="l03682" id="l03682"></a>03682         var-&gt;<a class="code" href=
"structvariable__list.html#7b5bdda01921550d24ea53033ce76146" title=
"Object identifier of variable.">name</a>[0] = (oid) var-&gt;<a class="code" href=
"structvariable__list.html#17aaa6b445178fc39aba69642247d3e9" title="the length of the value to be copied into buf">val_len</a>;
<a name="l03683" id="l03683"></a>03683         for (i = 0; i &lt; (int) var-&gt;<a class="code" href=
"structvariable__list.html#17aaa6b445178fc39aba69642247d3e9" title=
"the length of the value to be copied into buf">val_len</a>; i++)
<a name="l03684" id="l03684"></a>03684             var-&gt;<a class="code" href=
"structvariable__list.html#7b5bdda01921550d24ea53033ce76146" title=
"Object identifier of variable.">name</a>[i + 1] = (oid) var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.string[i];
<a name="l03685" id="l03685"></a>03685         <span class="keywordflow">break</span>;
<a name="l03686" id="l03686"></a>03686 
<a name="l03687" id="l03687"></a>03687     <span class="keywordflow">default</span>:
<a name="l03688" id="l03688"></a>03688         DEBUGMSGTL((<span class="stringliteral">"build_oid_segment"</span>,
<a name="l03689" id="l03689"></a>03689                     <span class=
"stringliteral">"invalid asn type: %d\n"</span>, var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a>));
<a name="l03690" id="l03690"></a>03690         <span class="keywordflow">return</span> SNMPERR_GENERR;
<a name="l03691" id="l03691"></a>03691     }
<a name="l03692" id="l03692"></a>03692 
<a name="l03693" id="l03693"></a>03693     <span class="keywordflow">if</span> (var-&gt;<a class="code" href=
"structvariable__list.html#089e5b1a422bf8e693510ff5408a57a7" title=
"number of subid&amp;#39;s in name">name_length</a> &gt; MAX_OID_LEN) {
<a name="l03694" id="l03694"></a>03694         DEBUGMSGTL((<span class="stringliteral">"build_oid_segment"</span>,
<a name="l03695" id="l03695"></a>03695                     <span class=
"stringliteral">"Something terribly wrong, namelen = %lu\n"</span>,
<a name="l03696" id="l03696"></a>03696                     (<span class="keywordtype">unsigned</span> <span class=
"keywordtype">long</span>)var-&gt;<a class="code" href="structvariable__list.html#089e5b1a422bf8e693510ff5408a57a7" title=
"number of subid&amp;#39;s in name">name_length</a>));
<a name="l03697" id="l03697"></a>03697         <span class="keywordflow">return</span> SNMPERR_GENERR;
<a name="l03698" id="l03698"></a>03698     }
<a name="l03699" id="l03699"></a>03699 
<a name="l03700" id="l03700"></a>03700     <span class="keywordflow">return</span> SNMPERR_SUCCESS;
<a name="l03701" id="l03701"></a>03701 }
<a name="l03702" id="l03702"></a>03702 
<a name="l03703" id="l03703"></a>03703 
<a name="l03704" id="l03704"></a>03704 <span class="keywordtype">int</span>
<a name="l03705" id="l03705"></a>03705 build_oid_noalloc(oid * in, <span class="keywordtype">size_t</span> in_len, <span class=
"keywordtype">size_t</span> * out_len,
<a name="l03706" id="l03706"></a>03706                   oid * prefix, <span class="keywordtype">size_t</span> prefix_len,
<a name="l03707" id="l03707"></a>03707                   <a class="code" href="structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * indexes)
<a name="l03708" id="l03708"></a>03708 {
<a name="l03709" id="l03709"></a>03709     <a class="code" href="structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> *var;
<a name="l03710" id="l03710"></a>03710 
<a name="l03711" id="l03711"></a>03711     <span class="keywordflow">if</span> (prefix) {
<a name="l03712" id="l03712"></a>03712         <span class="keywordflow">if</span> (in_len &lt; prefix_len)
<a name="l03713" id="l03713"></a>03713             <span class="keywordflow">return</span> SNMPERR_GENERR;
<a name="l03714" id="l03714"></a>03714         memcpy(in, prefix, prefix_len * <span class="keyword">sizeof</span>(oid));
<a name="l03715" id="l03715"></a>03715         *out_len = prefix_len;
<a name="l03716" id="l03716"></a>03716     } <span class="keywordflow">else</span> {
<a name="l03717" id="l03717"></a>03717         *out_len = 0;
<a name="l03718" id="l03718"></a>03718     }
<a name="l03719" id="l03719"></a>03719 
<a name="l03720" id="l03720"></a>03720     <span class=
"keywordflow">for</span> (var = indexes; var != NULL; var = var-&gt;<a class="code" href=
"structvariable__list.html#036af3c8c73da042622a58afa452d76e" title="NULL for last variable.">next_variable</a>) {
<a name="l03721" id="l03721"></a>03721         <span class="keywordflow">if</span> (<a class="code" href=
"group__mib__utilities.html#g0d3a6feb3852ee6f6901f442ff9900cf" title=
"Takes the value in VAR and turns it into an OID segment in var-&amp;gt;name.">build_oid_segment</a>(var) != SNMPERR_SUCCESS)
<a name="l03722" id="l03722"></a>03722             <span class="keywordflow">return</span> SNMPERR_GENERR;
<a name="l03723" id="l03723"></a>03723         <span class="keywordflow">if</span> (var-&gt;<a class="code" href=
"structvariable__list.html#089e5b1a422bf8e693510ff5408a57a7" title=
"number of subid&amp;#39;s in name">name_length</a> + *out_len &lt;= in_len) {
<a name="l03724" id="l03724"></a>03724             memcpy(&amp;(in[*out_len]), var-&gt;<a class="code" href=
"structvariable__list.html#7b5bdda01921550d24ea53033ce76146" title="Object identifier of variable.">name</a>,
<a name="l03725" id="l03725"></a>03725                    <span class="keyword">sizeof</span>(oid) * var-&gt;<a class="code"
href="structvariable__list.html#089e5b1a422bf8e693510ff5408a57a7" title="number of subid&amp;#39;s in name">name_length</a>);
<a name="l03726" id="l03726"></a>03726             *out_len += var-&gt;<a class="code" href=
"structvariable__list.html#089e5b1a422bf8e693510ff5408a57a7" title="number of subid&amp;#39;s in name">name_length</a>;
<a name="l03727" id="l03727"></a>03727         } <span class="keywordflow">else</span> {
<a name="l03728" id="l03728"></a>03728             <span class="keywordflow">return</span> SNMPERR_GENERR;
<a name="l03729" id="l03729"></a>03729         }
<a name="l03730" id="l03730"></a>03730     }
<a name="l03731" id="l03731"></a>03731 
<a name="l03732" id="l03732"></a>03732     DEBUGMSGTL((<span class="stringliteral">"build_oid_noalloc"</span>, <span class=
"stringliteral">"generated: "</span>));
<a name="l03733" id="l03733"></a>03733     DEBUGMSGOID((<span class="stringliteral">"build_oid_noalloc"</span>, in, *out_len));
<a name="l03734" id="l03734"></a>03734     DEBUGMSG((<span class="stringliteral">"build_oid_noalloc"</span>, <span class=
"stringliteral">"\n"</span>));
<a name="l03735" id="l03735"></a>03735     <span class="keywordflow">return</span> SNMPERR_SUCCESS;
<a name="l03736" id="l03736"></a>03736 }
<a name="l03737" id="l03737"></a>03737 
<a name="l03738" id="l03738"></a>03738 <span class="keywordtype">int</span>
<a name="l03739" id="l03739"></a><a class="code" href=
"group__mib__utilities.html#g438e30e7500b071916fec5592384f956">03739</a> <a class="code" href=
"group__mib__utilities.html#g438e30e7500b071916fec5592384f956">build_oid</a>(oid ** out, <span class=
"keywordtype">size_t</span> * out_len,
<a name="l03740" id="l03740"></a>03740           oid * prefix, <span class="keywordtype">size_t</span> prefix_len, <a class=
"code" href="structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * indexes)
<a name="l03741" id="l03741"></a>03741 {
<a name="l03742" id="l03742"></a>03742     oid             tmpout[MAX_OID_LEN];
<a name="l03743" id="l03743"></a>03743 
<a name="l03744" id="l03744"></a>03744     <span class="comment">/*</span>
<a name="l03745" id="l03745"></a>03745 <span class=
"comment">     * xxx-rks: inefficent. try only building segments to find index len:</span>
<a name="l03746" id="l03746"></a>03746 <span class=
"comment">     *   for (var = indexes; var != NULL; var = var-&gt;next_variable) {</span>
<a name="l03747" id="l03747"></a>03747 <span class="comment">     *      if (build_oid_segment(var) != SNMPERR_SUCCESS)</span>
<a name="l03748" id="l03748"></a>03748 <span class="comment">     *         return SNMPERR_GENERR;</span>
<a name="l03749" id="l03749"></a>03749 <span class="comment">     *      *out_len += var-&gt;name_length;</span>
<a name="l03750" id="l03750"></a>03750 <span class="comment">     *</span>
<a name="l03751" id="l03751"></a>03751 <span class=
"comment">     * then see if it fits in existing buffer, or realloc buffer.</span>
<a name="l03752" id="l03752"></a>03752 <span class="comment">     */</span>
<a name="l03753" id="l03753"></a>03753     <span class="keywordflow">if</span> (build_oid_noalloc(tmpout, <span class=
"keyword">sizeof</span>(tmpout), out_len,
<a name="l03754" id="l03754"></a>03754                           prefix, prefix_len, indexes) != SNMPERR_SUCCESS)
<a name="l03755" id="l03755"></a>03755         <span class="keywordflow">return</span> SNMPERR_GENERR;
<a name="l03756" id="l03756"></a>03756 
<a name="l03758" id="l03758"></a>03758     snmp_clone_mem((<span class="keywordtype">void</span> **) out, (<span class=
"keywordtype">void</span> *) tmpout, *out_len * <span class="keyword">sizeof</span>(oid));
<a name="l03759" id="l03759"></a>03759 
<a name="l03760" id="l03760"></a>03760     <span class="keywordflow">return</span> SNMPERR_SUCCESS;
<a name="l03761" id="l03761"></a>03761 }
<a name="l03762" id="l03762"></a>03762 
<a name="l03763" id="l03763"></a>03763 <span class="comment">/*</span>
<a name="l03764" id="l03764"></a>03764 <span class=
"comment"> * vblist_out must contain a pre-allocated string of variables into</span>
<a name="l03765" id="l03765"></a>03765 <span class=
"comment"> * which indexes can be extracted based on the previously existing</span>
<a name="l03766" id="l03766"></a>03766 <span class="comment"> * types in the variable chain</span>
<a name="l03767" id="l03767"></a>03767 <span class="comment"> * returns:</span>
<a name="l03768" id="l03768"></a>03768 <span class="comment"> * SNMPERR_GENERR  on error</span>
<a name="l03769" id="l03769"></a>03769 <span class="comment"> * SNMPERR_SUCCESS on success</span>
<a name="l03770" id="l03770"></a>03770 <span class="comment"> */</span>
<a name="l03771" id="l03771"></a>03771 
<a name="l03772" id="l03772"></a>03772 <span class="keywordtype">int</span>
<a name="l03773" id="l03773"></a>03773 parse_oid_indexes(oid * oidIndex, <span class="keywordtype">size_t</span> oidLen,
<a name="l03774" id="l03774"></a>03774                   <a class="code" href="structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * data)
<a name="l03775" id="l03775"></a>03775 {
<a name="l03776" id="l03776"></a>03776     <a class="code" href="structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> *var = data;
<a name="l03777" id="l03777"></a>03777 
<a name="l03778" id="l03778"></a>03778     <span class="keywordflow">while</span> (var &amp;&amp; oidLen &gt; 0) {
<a name="l03779" id="l03779"></a>03779 
<a name="l03780" id="l03780"></a>03780         <span class=
"keywordflow">if</span> (parse_one_oid_index(&amp;oidIndex, &amp;oidLen, var, 0) !=
<a name="l03781" id="l03781"></a>03781             SNMPERR_SUCCESS)
<a name="l03782" id="l03782"></a>03782             <span class="keywordflow">break</span>;
<a name="l03783" id="l03783"></a>03783 
<a name="l03784" id="l03784"></a>03784         var = var-&gt;<a class="code" href=
"structvariable__list.html#036af3c8c73da042622a58afa452d76e" title="NULL for last variable.">next_variable</a>;
<a name="l03785" id="l03785"></a>03785     }
<a name="l03786" id="l03786"></a>03786 
<a name="l03787" id="l03787"></a>03787     <span class="keywordflow">if</span> (var != NULL || oidLen != 0)
<a name="l03788" id="l03788"></a>03788         <span class="keywordflow">return</span> SNMPERR_GENERR;
<a name="l03789" id="l03789"></a>03789     <span class="keywordflow">return</span> SNMPERR_SUCCESS;
<a name="l03790" id="l03790"></a>03790 }
<a name="l03791" id="l03791"></a>03791 
<a name="l03792" id="l03792"></a>03792 
<a name="l03793" id="l03793"></a>03793 <span class="keywordtype">int</span>
<a name="l03794" id="l03794"></a>03794 parse_one_oid_index(oid ** oidStart, <span class="keywordtype">size_t</span> * oidLen,
<a name="l03795" id="l03795"></a>03795                     <a class="code" href="structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * data, <span class="keywordtype">int</span> complete)
<a name="l03796" id="l03796"></a>03796 {
<a name="l03797" id="l03797"></a>03797     <a class="code" href="structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> *var = data;
<a name="l03798" id="l03798"></a>03798     oid             tmpout[MAX_OID_LEN];
<a name="l03799" id="l03799"></a>03799     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>    i;
<a name="l03800" id="l03800"></a>03800     <span class="keywordtype">unsigned</span> <span class=
"keywordtype">int</span>    uitmp = 0;
<a name="l03801" id="l03801"></a>03801 
<a name="l03802" id="l03802"></a>03802     oid            *oidIndex = *oidStart;
<a name="l03803" id="l03803"></a>03803 
<a name="l03804" id="l03804"></a>03804     <span class=
"keywordflow">if</span> (var == NULL || ((*oidLen == 0) &amp;&amp; (complete == 0)))
<a name="l03805" id="l03805"></a>03805         <span class="keywordflow">return</span> SNMPERR_GENERR;
<a name="l03806" id="l03806"></a>03806     <span class="keywordflow">else</span> {
<a name="l03807" id="l03807"></a>03807         <span class="keywordflow">switch</span> (var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a>) {
<a name="l03808" id="l03808"></a>03808         <span class="keywordflow">case</span> ASN_INTEGER:
<a name="l03809" id="l03809"></a>03809         <span class="keywordflow">case</span> ASN_COUNTER:
<a name="l03810" id="l03810"></a>03810         <span class="keywordflow">case</span> ASN_GAUGE:
<a name="l03811" id="l03811"></a>03811         <span class="keywordflow">case</span> ASN_TIMETICKS:
<a name="l03812" id="l03812"></a>03812             <span class="keywordflow">if</span> (*oidLen) {
<a name="l03813" id="l03813"></a>03813                 <a class="code" href=
"group__snmp__client.html#g28c2d9210fdcae7155218418b3f89a2c">snmp_set_var_value</a>(var, (u_char *) oidIndex++,
<a name="l03814" id="l03814"></a>03814                                    <span class="keyword">sizeof</span>(<span class=
"keywordtype">long</span>));
<a name="l03815" id="l03815"></a>03815                 --(*oidLen);
<a name="l03816" id="l03816"></a>03816             } <span class="keywordflow">else</span> {
<a name="l03817" id="l03817"></a>03817                 <a class="code" href=
"group__snmp__client.html#g28c2d9210fdcae7155218418b3f89a2c">snmp_set_var_value</a>(var, (u_char *) oidLen, <span class=
"keyword">sizeof</span>(<span class="keywordtype">long</span>));
<a name="l03818" id="l03818"></a>03818             }
<a name="l03819" id="l03819"></a>03819             DEBUGMSGTL((<span class="stringliteral">"parse_oid_indexes"</span>,
<a name="l03820" id="l03820"></a>03820                         <span class=
"stringliteral">"Parsed int(%d): %ld\n"</span>, var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a>,
<a name="l03821" id="l03821"></a>03821                         *var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.integer));
<a name="l03822" id="l03822"></a>03822             <span class="keywordflow">break</span>;
<a name="l03823" id="l03823"></a>03823 
<a name="l03824" id="l03824"></a>03824         <span class="keywordflow">case</span> ASN_IPADDRESS:
<a name="l03825" id="l03825"></a>03825             <span class=
"keywordflow">if</span> ((4 &gt; *oidLen) &amp;&amp; (complete == 0))
<a name="l03826" id="l03826"></a>03826                 <span class="keywordflow">return</span> SNMPERR_GENERR;
<a name="l03827" id="l03827"></a>03827             
<a name="l03828" id="l03828"></a>03828             <span class=
"keywordflow">for</span> (i = 0; i &lt; 4 &amp;&amp; i &lt; *oidLen; ++i) {
<a name="l03829" id="l03829"></a>03829                 <span class="keywordflow">if</span> (oidIndex[i] &gt; 255) {
<a name="l03830" id="l03830"></a>03830                     DEBUGMSGTL((<span class="stringliteral">"parse_oid_indexes"</span>,
<a name="l03831" id="l03831"></a>03831                                 <span class=
"stringliteral">"illegal oid in index: %ld\n"</span>, oidIndex[0]));
<a name="l03832" id="l03832"></a>03832                         <span class=
"keywordflow">return</span> SNMPERR_GENERR;  <span class="comment">/* sub-identifier too large */</span>
<a name="l03833" id="l03833"></a>03833                     }
<a name="l03834" id="l03834"></a>03834                     uitmp = uitmp + (oidIndex[i] &lt;&lt; (8*(3-i)));
<a name="l03835" id="l03835"></a>03835                 }
<a name="l03836" id="l03836"></a>03836             <span class="keywordflow">if</span> (4 &gt; (<span class=
"keywordtype">int</span>) (*oidLen)) {
<a name="l03837" id="l03837"></a>03837                 oidIndex += *oidLen;
<a name="l03838" id="l03838"></a>03838                 (*oidLen) = 0;
<a name="l03839" id="l03839"></a>03839             } <span class="keywordflow">else</span> {
<a name="l03840" id="l03840"></a>03840                 oidIndex += 4;
<a name="l03841" id="l03841"></a>03841                 (*oidLen) -= 4;
<a name="l03842" id="l03842"></a>03842             }
<a name="l03843" id="l03843"></a>03843             uitmp = htonl(uitmp); <span class=
"comment">/* put it in proper order for byte copies */</span>
<a name="l03844" id="l03844"></a>03844             uitmp = 
<a name="l03845" id="l03845"></a>03845                 <a class="code" href=
"group__snmp__client.html#g28c2d9210fdcae7155218418b3f89a2c">snmp_set_var_value</a>(var, (u_char *) &amp;uitmp, 4);
<a name="l03846" id="l03846"></a>03846             DEBUGMSGTL((<span class="stringliteral">"parse_oid_indexes"</span>,
<a name="l03847" id="l03847"></a>03847                         <span class=
"stringliteral">"Parsed ipaddr(%d): %d.%d.%d.%d\n"</span>, var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a>,
<a name="l03848" id="l03848"></a>03848                         var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.string[0], var-&gt;<a class="code"
href="structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.string[1],
<a name="l03849" id="l03849"></a>03849                         var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.string[2], var-&gt;<a class="code"
href="structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.string[3]));
<a name="l03850" id="l03850"></a>03850             <span class="keywordflow">break</span>;
<a name="l03851" id="l03851"></a>03851 
<a name="l03852" id="l03852"></a>03852         <span class="keywordflow">case</span> ASN_OBJECT_ID:
<a name="l03853" id="l03853"></a>03853         <span class="keywordflow">case</span> ASN_PRIV_IMPLIED_OBJECT_ID:
<a name="l03854" id="l03854"></a>03854             <span class="keywordflow">if</span> (var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title=
"ASN type of variable.">type</a> == ASN_PRIV_IMPLIED_OBJECT_ID) {
<a name="l03855" id="l03855"></a>03855                 <span class="comment">/*</span>
<a name="l03856" id="l03856"></a>03856 <span class=
"comment">                 * might not be implied, might be fixed len. check if</span>
<a name="l03857" id="l03857"></a>03857 <span class=
"comment">                 * caller set up val len, and use it if they did.</span>
<a name="l03858" id="l03858"></a>03858 <span class="comment">                 */</span>
<a name="l03859" id="l03859"></a>03859                 <span class="keywordflow">if</span> (0 == var-&gt;<a class="code" href=
"structvariable__list.html#17aaa6b445178fc39aba69642247d3e9" title="the length of the value to be copied into buf">val_len</a>)
<a name="l03860" id="l03860"></a>03860                     uitmp = *oidLen;
<a name="l03861" id="l03861"></a>03861                 <span class="keywordflow">else</span> {
<a name="l03862" id="l03862"></a>03862                     DEBUGMSGTL((<span class=
"stringliteral">"parse_oid_indexes:fix"</span>, <span class="stringliteral">"fixed len oid\n"</span>));
<a name="l03863" id="l03863"></a>03863                     uitmp = var-&gt;<a class="code" href=
"structvariable__list.html#17aaa6b445178fc39aba69642247d3e9" title="the length of the value to be copied into buf">val_len</a>;
<a name="l03864" id="l03864"></a>03864                 }
<a name="l03865" id="l03865"></a>03865             } <span class="keywordflow">else</span> {
<a name="l03866" id="l03866"></a>03866                 <span class="keywordflow">if</span> (*oidLen) {
<a name="l03867" id="l03867"></a>03867                     uitmp = *oidIndex++;
<a name="l03868" id="l03868"></a>03868                     --(*oidLen);
<a name="l03869" id="l03869"></a>03869                 } <span class="keywordflow">else</span> {
<a name="l03870" id="l03870"></a>03870                     uitmp = 0;
<a name="l03871" id="l03871"></a>03871                 }
<a name="l03872" id="l03872"></a>03872                 <span class=
"keywordflow">if</span> ((uitmp &gt; *oidLen) &amp;&amp; (complete == 0))
<a name="l03873" id="l03873"></a>03873                     <span class="keywordflow">return</span> SNMPERR_GENERR;
<a name="l03874" id="l03874"></a>03874             }
<a name="l03875" id="l03875"></a>03875 
<a name="l03876" id="l03876"></a>03876             <span class="keywordflow">if</span> (uitmp &gt; MAX_OID_LEN)
<a name="l03877" id="l03877"></a>03877                 <span class="keywordflow">return</span> SNMPERR_GENERR;  <span class=
"comment">/* too big and illegal */</span>
<a name="l03878" id="l03878"></a>03878 
<a name="l03879" id="l03879"></a>03879             <span class="keywordflow">if</span> (uitmp &gt; *oidLen) {
<a name="l03880" id="l03880"></a>03880                 memcpy(tmpout, oidIndex, <span class=
"keyword">sizeof</span>(oid) * (*oidLen));
<a name="l03881" id="l03881"></a>03881                 memset(&amp;tmpout[*oidLen], 0x00,
<a name="l03882" id="l03882"></a>03882                        <span class="keyword">sizeof</span>(oid) * (uitmp - *oidLen));
<a name="l03883" id="l03883"></a>03883                 <a class="code" href=
"group__snmp__client.html#g28c2d9210fdcae7155218418b3f89a2c">snmp_set_var_value</a>(var, (u_char *) tmpout,
<a name="l03884" id="l03884"></a>03884                                    <span class="keyword">sizeof</span>(oid) * uitmp);
<a name="l03885" id="l03885"></a>03885                 oidIndex += *oidLen;
<a name="l03886" id="l03886"></a>03886                 (*oidLen) = 0;
<a name="l03887" id="l03887"></a>03887             } <span class="keywordflow">else</span> {
<a name="l03888" id="l03888"></a>03888                 <a class="code" href=
"group__snmp__client.html#g28c2d9210fdcae7155218418b3f89a2c">snmp_set_var_value</a>(var, (u_char *) oidIndex,
<a name="l03889" id="l03889"></a>03889                                    <span class="keyword">sizeof</span>(oid) * uitmp);
<a name="l03890" id="l03890"></a>03890                 oidIndex += uitmp;
<a name="l03891" id="l03891"></a>03891                 (*oidLen) -= uitmp;
<a name="l03892" id="l03892"></a>03892             }
<a name="l03893" id="l03893"></a>03893 
<a name="l03894" id="l03894"></a>03894             DEBUGMSGTL((<span class=
"stringliteral">"parse_oid_indexes"</span>, <span class="stringliteral">"Parsed oid: "</span>));
<a name="l03895" id="l03895"></a>03895             DEBUGMSGOID((<span class="stringliteral">"parse_oid_indexes"</span>,
<a name="l03896" id="l03896"></a>03896                          var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.objid, var-&gt;<a class="code"
href="structvariable__list.html#17aaa6b445178fc39aba69642247d3e9" title=
"the length of the value to be copied into buf">val_len</a> / <span class="keyword">sizeof</span>(oid)));
<a name="l03897" id="l03897"></a>03897             DEBUGMSG((<span class="stringliteral">"parse_oid_indexes"</span>, <span class=
"stringliteral">"\n"</span>));
<a name="l03898" id="l03898"></a>03898             <span class="keywordflow">break</span>;
<a name="l03899" id="l03899"></a>03899 
<a name="l03900" id="l03900"></a>03900         <span class="keywordflow">case</span> ASN_OPAQUE:
<a name="l03901" id="l03901"></a>03901         <span class="keywordflow">case</span> ASN_OCTET_STR:
<a name="l03902" id="l03902"></a>03902         <span class="keywordflow">case</span> ASN_PRIV_IMPLIED_OCTET_STR:
<a name="l03903" id="l03903"></a>03903             <span class="keywordflow">if</span> (var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title=
"ASN type of variable.">type</a> == ASN_PRIV_IMPLIED_OCTET_STR) {
<a name="l03904" id="l03904"></a>03904                 <span class="comment">/*</span>
<a name="l03905" id="l03905"></a>03905 <span class=
"comment">                 * might not be implied, might be fixed len. check if</span>
<a name="l03906" id="l03906"></a>03906 <span class=
"comment">                 * caller set up val len, and use it if they did.</span>
<a name="l03907" id="l03907"></a>03907 <span class="comment">                 */</span>
<a name="l03908" id="l03908"></a>03908                 <span class="keywordflow">if</span> (0 == var-&gt;<a class="code" href=
"structvariable__list.html#17aaa6b445178fc39aba69642247d3e9" title="the length of the value to be copied into buf">val_len</a>)
<a name="l03909" id="l03909"></a>03909                     uitmp = *oidLen;
<a name="l03910" id="l03910"></a>03910                 <span class="keywordflow">else</span> {
<a name="l03911" id="l03911"></a>03911                     DEBUGMSGTL((<span class=
"stringliteral">"parse_oid_indexes:fix"</span>, <span class="stringliteral">"fixed len str\n"</span>));
<a name="l03912" id="l03912"></a>03912                     uitmp = var-&gt;<a class="code" href=
"structvariable__list.html#17aaa6b445178fc39aba69642247d3e9" title="the length of the value to be copied into buf">val_len</a>;
<a name="l03913" id="l03913"></a>03913                 }
<a name="l03914" id="l03914"></a>03914             } <span class="keywordflow">else</span> {
<a name="l03915" id="l03915"></a>03915                 <span class="keywordflow">if</span> (*oidLen) {
<a name="l03916" id="l03916"></a>03916                     uitmp = *oidIndex++;
<a name="l03917" id="l03917"></a>03917                     --(*oidLen);
<a name="l03918" id="l03918"></a>03918                 } <span class="keywordflow">else</span> {
<a name="l03919" id="l03919"></a>03919                     uitmp = 0;
<a name="l03920" id="l03920"></a>03920                 }
<a name="l03921" id="l03921"></a>03921                 <span class=
"keywordflow">if</span> ((uitmp &gt; *oidLen) &amp;&amp; (complete == 0))
<a name="l03922" id="l03922"></a>03922                     <span class="keywordflow">return</span> SNMPERR_GENERR;
<a name="l03923" id="l03923"></a>03923             }
<a name="l03924" id="l03924"></a>03924 
<a name="l03925" id="l03925"></a>03925             <span class="comment">/*</span>
<a name="l03926" id="l03926"></a>03926 <span class=
"comment">             * we handle this one ourselves since we don't have</span>
<a name="l03927" id="l03927"></a>03927 <span class="comment">             * pre-allocated memory to copy from using</span>
<a name="l03928" id="l03928"></a>03928 <span class="comment">             * snmp_set_var_value() </span>
<a name="l03929" id="l03929"></a>03929 <span class="comment">             */</span>
<a name="l03930" id="l03930"></a>03930 
<a name="l03931" id="l03931"></a>03931             <span class="keywordflow">if</span> (uitmp == 0)
<a name="l03932" id="l03932"></a>03932                 <span class="keywordflow">break</span>;          <span class=
"comment">/* zero length strings shouldn't malloc */</span>
<a name="l03933" id="l03933"></a>03933 
<a name="l03934" id="l03934"></a>03934             <span class="keywordflow">if</span> (uitmp &gt; MAX_OID_LEN)
<a name="l03935" id="l03935"></a>03935                 <span class="keywordflow">return</span> SNMPERR_GENERR;  <span class=
"comment">/* too big and illegal */</span>
<a name="l03936" id="l03936"></a>03936 
<a name="l03937" id="l03937"></a>03937             <span class="comment">/*</span>
<a name="l03938" id="l03938"></a>03938 <span class=
"comment">             * malloc by size+1 to allow a null to be appended. </span>
<a name="l03939" id="l03939"></a>03939 <span class="comment">             */</span>
<a name="l03940" id="l03940"></a>03940             var-&gt;<a class="code" href=
"structvariable__list.html#17aaa6b445178fc39aba69642247d3e9" title=
"the length of the value to be copied into buf">val_len</a> = uitmp;
<a name="l03941" id="l03941"></a>03941             var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title=
"value of variable">val</a>.string = (u_char *) calloc(1, uitmp + 1);
<a name="l03942" id="l03942"></a>03942             <span class="keywordflow">if</span> (var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.string == NULL)
<a name="l03943" id="l03943"></a>03943                 <span class="keywordflow">return</span> SNMPERR_GENERR;
<a name="l03944" id="l03944"></a>03944 
<a name="l03945" id="l03945"></a>03945             <span class="keywordflow">if</span> ((<span class=
"keywordtype">size_t</span>)uitmp &gt; (*oidLen)) {
<a name="l03946" id="l03946"></a>03946                 <span class="keywordflow">for</span> (i = 0; i &lt; *oidLen; ++i)
<a name="l03947" id="l03947"></a>03947                     var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.string[i] = (u_char) * oidIndex++;
<a name="l03948" id="l03948"></a>03948                 <span class="keywordflow">for</span> (i = *oidLen; i &lt; uitmp; ++i)
<a name="l03949" id="l03949"></a>03949                     var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.string[i] = <span class=
"charliteral">'\0'</span>;
<a name="l03950" id="l03950"></a>03950                 (*oidLen) = 0;
<a name="l03951" id="l03951"></a>03951             } <span class="keywordflow">else</span> {
<a name="l03952" id="l03952"></a>03952                 <span class="keywordflow">for</span> (i = 0; i &lt; uitmp; ++i)
<a name="l03953" id="l03953"></a>03953                     var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.string[i] = (u_char) * oidIndex++;
<a name="l03954" id="l03954"></a>03954                 (*oidLen) -= uitmp;
<a name="l03955" id="l03955"></a>03955             }
<a name="l03956" id="l03956"></a>03956             var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.string[uitmp] = <span class=
"charliteral">'\0'</span>;
<a name="l03957" id="l03957"></a>03957 
<a name="l03958" id="l03958"></a>03958             DEBUGMSGTL((<span class="stringliteral">"parse_oid_indexes"</span>,
<a name="l03959" id="l03959"></a>03959                         <span class=
"stringliteral">"Parsed str(%d): %s\n"</span>, var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a>,
<a name="l03960" id="l03960"></a>03960                         var-&gt;<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.string));
<a name="l03961" id="l03961"></a>03961             <span class="keywordflow">break</span>;
<a name="l03962" id="l03962"></a>03962 
<a name="l03963" id="l03963"></a>03963         <span class="keywordflow">default</span>:
<a name="l03964" id="l03964"></a>03964             DEBUGMSGTL((<span class="stringliteral">"parse_oid_indexes"</span>,
<a name="l03965" id="l03965"></a>03965                         <span class=
"stringliteral">"invalid asn type: %d\n"</span>, var-&gt;<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a>));
<a name="l03966" id="l03966"></a>03966             <span class="keywordflow">return</span> SNMPERR_GENERR;
<a name="l03967" id="l03967"></a>03967         }
<a name="l03968" id="l03968"></a>03968     }
<a name="l03969" id="l03969"></a>03969     (*oidStart) = oidIndex;
<a name="l03970" id="l03970"></a>03970     <span class="keywordflow">return</span> SNMPERR_SUCCESS;
<a name="l03971" id="l03971"></a>03971 }
<a name="l03972" id="l03972"></a>03972 
<a name="l03973" id="l03973"></a>03973 <span class="comment">/*</span>
<a name="l03974" id="l03974"></a>03974 <span class="comment"> * dump_realloc_oid_to_inetaddress:</span>
<a name="l03975" id="l03975"></a>03975 <span class="comment"> *   return 0 for failure,</span>
<a name="l03976" id="l03976"></a>03976 <span class="comment"> *   return 1 for success,</span>
<a name="l03977" id="l03977"></a>03977 <span class="comment"> *   return 2 for not handled</span>
<a name="l03978" id="l03978"></a>03978 <span class="comment"> */</span>
<a name="l03979" id="l03979"></a>03979 
<a name="l03980" id="l03980"></a>03980 <span class="keywordtype">int</span> 
<a name="l03981" id="l03981"></a>03981 dump_realloc_oid_to_inetaddress(<span class="keyword">const</span> <span class=
"keywordtype">int</span> addr_type, <span class="keyword">const</span> oid * objid, <span class=
"keywordtype">size_t</span> objidlen, 
<a name="l03982" id="l03982"></a>03982                                 u_char ** buf, <span class=
"keywordtype">size_t</span> * buf_len,
<a name="l03983" id="l03983"></a>03983                                 <span class=
"keywordtype">size_t</span> * out_len, <span class="keywordtype">int</span> allow_realloc, 
<a name="l03984" id="l03984"></a>03984                                 <span class="keywordtype">char</span> quotechar)
<a name="l03985" id="l03985"></a>03985 {
<a name="l03986" id="l03986"></a>03986     <span class="keywordflow">if</span> (buf) {
<a name="l03987" id="l03987"></a>03987         <span class="keywordtype">int</span>             i, len;
<a name="l03988" id="l03988"></a>03988         <span class="keywordtype">char</span>            intbuf[64], * p;
<a name="l03989" id="l03989"></a>03989         <span class="keywordtype">unsigned</span> <span class=
"keywordtype">char</span>  *zc;
<a name="l03990" id="l03990"></a>03990         <span class="keywordtype">unsigned</span> <span class=
"keywordtype">long</span>   zone;
<a name="l03991" id="l03991"></a>03991 
<a name="l03992" id="l03992"></a>03992         memset(intbuf, 0, 64);
<a name="l03993" id="l03993"></a>03993 
<a name="l03994" id="l03994"></a>03994         p = intbuf;
<a name="l03995" id="l03995"></a>03995         *p = quotechar;
<a name="l03996" id="l03996"></a>03996         p++;
<a name="l03997" id="l03997"></a>03997         <span class="keywordflow">switch</span> (addr_type) {
<a name="l03998" id="l03998"></a>03998             <span class="keywordflow">case</span> IPV4:
<a name="l03999" id="l03999"></a>03999             <span class="keywordflow">case</span> IPV4Z:
<a name="l04000" id="l04000"></a>04000                 <span class=
"keywordflow">if</span> ((addr_type == IPV4  &amp;&amp; objidlen != 4) ||
<a name="l04001" id="l04001"></a>04001                     (addr_type == IPV4Z &amp;&amp; objidlen != 8))
<a name="l04002" id="l04002"></a>04002                     <span class="keywordflow">return</span> 2;
<a name="l04003" id="l04003"></a>04003 
<a name="l04004" id="l04004"></a>04004                 len = sprintf(p, <span class=
"stringliteral">"%lu.%lu.%lu.%lu"</span>, objid[0], objid[1], objid[2], objid[3]);
<a name="l04005" id="l04005"></a>04005                 p += len;
<a name="l04006" id="l04006"></a>04006                 <span class="keywordflow">if</span> (addr_type == IPV4Z) {
<a name="l04007" id="l04007"></a>04007                     zc = (<span class="keywordtype">unsigned</span> <span class=
"keywordtype">char</span>*)&amp;zone;
<a name="l04008" id="l04008"></a>04008                     zc[0] = (u_char)(objid[4]);
<a name="l04009" id="l04009"></a>04009                     zc[1] = (u_char)(objid[5]);
<a name="l04010" id="l04010"></a>04010                     zc[2] = (u_char)(objid[6]);
<a name="l04011" id="l04011"></a>04011                     zc[3] = (u_char)(objid[7]);
<a name="l04012" id="l04012"></a>04012                     zone = ntohl(zone);
<a name="l04013" id="l04013"></a>04013                     len = sprintf(p, <span class="stringliteral">"%%%lu"</span>, zone);
<a name="l04014" id="l04014"></a>04014                     p += len;
<a name="l04015" id="l04015"></a>04015                 }
<a name="l04016" id="l04016"></a>04016 
<a name="l04017" id="l04017"></a>04017                 <span class="keywordflow">break</span>;
<a name="l04018" id="l04018"></a>04018 
<a name="l04019" id="l04019"></a>04019             <span class="keywordflow">case</span> IPV6:
<a name="l04020" id="l04020"></a>04020             <span class="keywordflow">case</span> IPV6Z:
<a name="l04021" id="l04021"></a>04021                 <span class=
"keywordflow">if</span> ((addr_type == IPV6 &amp;&amp; objidlen != 16) ||
<a name="l04022" id="l04022"></a>04022                     (addr_type == IPV6Z &amp;&amp; objidlen != 20))
<a name="l04023" id="l04023"></a>04023                     <span class="keywordflow">return</span> 2;
<a name="l04024" id="l04024"></a>04024 
<a name="l04025" id="l04025"></a>04025                 len = 0;
<a name="l04026" id="l04026"></a>04026                 <span class="keywordflow">for</span> (i = 0; i &lt; 16; i ++) {
<a name="l04027" id="l04027"></a>04027                     len = snprintf(p, 4, <span class=
"stringliteral">"%02lx:"</span>, objid[i]);
<a name="l04028" id="l04028"></a>04028                     p += len;
<a name="l04029" id="l04029"></a>04029                 }
<a name="l04030" id="l04030"></a>04030                 p-- ; <span class="comment">/* do not include the last ':' */</span>
<a name="l04031" id="l04031"></a>04031 
<a name="l04032" id="l04032"></a>04032                 <span class="keywordflow">if</span> (addr_type == IPV6Z) {
<a name="l04033" id="l04033"></a>04033                     zc = (<span class="keywordtype">unsigned</span> <span class=
"keywordtype">char</span>*)&amp;zone;
<a name="l04034" id="l04034"></a>04034                     zc[0] = (u_char)(objid[16]);
<a name="l04035" id="l04035"></a>04035                     zc[1] = (u_char)(objid[17]);
<a name="l04036" id="l04036"></a>04036                     zc[2] = (u_char)(objid[18]);
<a name="l04037" id="l04037"></a>04037                     zc[3] = (u_char)(objid[19]);
<a name="l04038" id="l04038"></a>04038                     zone = ntohl(zone);
<a name="l04039" id="l04039"></a>04039                     len = sprintf(p, <span class="stringliteral">"%%%lu"</span>, zone);
<a name="l04040" id="l04040"></a>04040                     p += len;
<a name="l04041" id="l04041"></a>04041                 }
<a name="l04042" id="l04042"></a>04042 
<a name="l04043" id="l04043"></a>04043                 <span class="keywordflow">break</span>;
<a name="l04044" id="l04044"></a>04044 
<a name="l04045" id="l04045"></a>04045             <span class="keywordflow">case</span> DNS:
<a name="l04046" id="l04046"></a>04046             <span class="keywordflow">default</span>: 
<a name="l04047" id="l04047"></a>04047                 <span class=
"comment">/* DNS can just be handled by dump_realloc_oid_to_string() */</span>
<a name="l04048" id="l04048"></a>04048                 <span class="keywordflow">return</span> 2;
<a name="l04049" id="l04049"></a>04049         }
<a name="l04050" id="l04050"></a>04050 
<a name="l04051" id="l04051"></a>04051         *p = quotechar;
<a name="l04052" id="l04052"></a>04052 
<a name="l04053" id="l04053"></a>04053         <span class=
"keywordflow">return</span> snmp_strcat(buf, buf_len, out_len, allow_realloc, 
<a name="l04054" id="l04054"></a>04054                                                (<span class=
"keyword">const</span> u_char *) intbuf);
<a name="l04055" id="l04055"></a>04055     }
<a name="l04056" id="l04056"></a>04056     <span class="keywordflow">return</span> 1;
<a name="l04057" id="l04057"></a>04057 }
<a name="l04058" id="l04058"></a>04058 
<a name="l04059" id="l04059"></a>04059 <span class="keywordtype">int</span>
<a name="l04060" id="l04060"></a>04060 dump_realloc_oid_to_string(<span class="keyword">const</span> oid * objid, <span class=
"keywordtype">size_t</span> objidlen,
<a name="l04061" id="l04061"></a>04061                            u_char ** buf, <span class=
"keywordtype">size_t</span> * buf_len,
<a name="l04062" id="l04062"></a>04062                            <span class="keywordtype">size_t</span> * out_len, <span class=
"keywordtype">int</span> allow_realloc,
<a name="l04063" id="l04063"></a>04063                            <span class="keywordtype">char</span> quotechar)
<a name="l04064" id="l04064"></a>04064 {
<a name="l04065" id="l04065"></a>04065     <span class="keywordflow">if</span> (buf) {
<a name="l04066" id="l04066"></a>04066         <span class="keywordtype">int</span>             i, alen;
<a name="l04067" id="l04067"></a>04067 
<a name="l04068" id="l04068"></a>04068         <span class=
"keywordflow">for</span> (i = 0, alen = 0; i &lt; (int) objidlen; i++) {
<a name="l04069" id="l04069"></a>04069             oid             tst = objid[i];
<a name="l04070" id="l04070"></a>04070             <span class="keywordflow">if</span> ((tst &gt; 254) || (!isprint(tst))) {
<a name="l04071" id="l04071"></a>04071                 tst = (oid) <span class="charliteral">'.'</span>;
<a name="l04072" id="l04072"></a>04072             }
<a name="l04073" id="l04073"></a>04073 
<a name="l04074" id="l04074"></a>04074             <span class="keywordflow">if</span> (alen == 0) {
<a name="l04075" id="l04075"></a>04075                 <span class=
"keywordflow">if</span> (netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_ESCAPE_QUOTES)) {
<a name="l04076" id="l04076"></a>04076                     <span class=
"keywordflow">while</span> ((*out_len + 2) &gt;= *buf_len) {
<a name="l04077" id="l04077"></a>04077                         <span class=
"keywordflow">if</span> (!(allow_realloc &amp;&amp; <a class="code" href="group__util.html#g7b42d706225a788adcfeaad9b24717de"
title=
"This function increase the size of the buffer pointed at by *buf, which is initially...">snmp_realloc</a>(buf, buf_len))) {
<a name="l04078" id="l04078"></a>04078                             <span class="keywordflow">return</span> 0;
<a name="l04079" id="l04079"></a>04079                         }
<a name="l04080" id="l04080"></a>04080                     }
<a name="l04081" id="l04081"></a>04081                     *(*buf + *out_len) = <span class="charliteral">'\\'</span>;
<a name="l04082" id="l04082"></a>04082                     (*out_len)++;
<a name="l04083" id="l04083"></a>04083                 }
<a name="l04084" id="l04084"></a>04084                 <span class="keywordflow">while</span> ((*out_len + 2) &gt;= *buf_len) {
<a name="l04085" id="l04085"></a>04085                     <span class=
"keywordflow">if</span> (!(allow_realloc &amp;&amp; <a class="code" href="group__util.html#g7b42d706225a788adcfeaad9b24717de"
title=
"This function increase the size of the buffer pointed at by *buf, which is initially...">snmp_realloc</a>(buf, buf_len))) {
<a name="l04086" id="l04086"></a>04086                         <span class="keywordflow">return</span> 0;
<a name="l04087" id="l04087"></a>04087                     }
<a name="l04088" id="l04088"></a>04088                 }
<a name="l04089" id="l04089"></a>04089                 *(*buf + *out_len) = quotechar;
<a name="l04090" id="l04090"></a>04090                 (*out_len)++;
<a name="l04091" id="l04091"></a>04091             }
<a name="l04092" id="l04092"></a>04092 
<a name="l04093" id="l04093"></a>04093             <span class="keywordflow">while</span> ((*out_len + 2) &gt;= *buf_len) {
<a name="l04094" id="l04094"></a>04094                 <span class="keywordflow">if</span> (!(allow_realloc &amp;&amp; <a class=
"code" href="group__util.html#g7b42d706225a788adcfeaad9b24717de" title=
"This function increase the size of the buffer pointed at by *buf, which is initially...">snmp_realloc</a>(buf, buf_len))) {
<a name="l04095" id="l04095"></a>04095                     <span class="keywordflow">return</span> 0;
<a name="l04096" id="l04096"></a>04096                 }
<a name="l04097" id="l04097"></a>04097             }
<a name="l04098" id="l04098"></a>04098             *(*buf + *out_len) = (<span class="keywordtype">char</span>) tst;
<a name="l04099" id="l04099"></a>04099             (*out_len)++;
<a name="l04100" id="l04100"></a>04100             alen++;
<a name="l04101" id="l04101"></a>04101         }
<a name="l04102" id="l04102"></a>04102 
<a name="l04103" id="l04103"></a>04103         <span class="keywordflow">if</span> (alen) {
<a name="l04104" id="l04104"></a>04104             <span class=
"keywordflow">if</span> (netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_ESCAPE_QUOTES)) {
<a name="l04105" id="l04105"></a>04105                 <span class="keywordflow">while</span> ((*out_len + 2) &gt;= *buf_len) {
<a name="l04106" id="l04106"></a>04106                     <span class=
"keywordflow">if</span> (!(allow_realloc &amp;&amp; <a class="code" href="group__util.html#g7b42d706225a788adcfeaad9b24717de"
title=
"This function increase the size of the buffer pointed at by *buf, which is initially...">snmp_realloc</a>(buf, buf_len))) {
<a name="l04107" id="l04107"></a>04107                         <span class="keywordflow">return</span> 0;
<a name="l04108" id="l04108"></a>04108                     }
<a name="l04109" id="l04109"></a>04109                 }
<a name="l04110" id="l04110"></a>04110                 *(*buf + *out_len) = <span class="charliteral">'\\'</span>;
<a name="l04111" id="l04111"></a>04111                 (*out_len)++;
<a name="l04112" id="l04112"></a>04112             }
<a name="l04113" id="l04113"></a>04113             <span class="keywordflow">while</span> ((*out_len + 2) &gt;= *buf_len) {
<a name="l04114" id="l04114"></a>04114                 <span class="keywordflow">if</span> (!(allow_realloc &amp;&amp; <a class=
"code" href="group__util.html#g7b42d706225a788adcfeaad9b24717de" title=
"This function increase the size of the buffer pointed at by *buf, which is initially...">snmp_realloc</a>(buf, buf_len))) {
<a name="l04115" id="l04115"></a>04115                     <span class="keywordflow">return</span> 0;
<a name="l04116" id="l04116"></a>04116                 }
<a name="l04117" id="l04117"></a>04117             }
<a name="l04118" id="l04118"></a>04118             *(*buf + *out_len) = quotechar;
<a name="l04119" id="l04119"></a>04119             (*out_len)++;
<a name="l04120" id="l04120"></a>04120         }
<a name="l04121" id="l04121"></a>04121 
<a name="l04122" id="l04122"></a>04122         *(*buf + *out_len) = <span class="charliteral">'\0'</span>;
<a name="l04123" id="l04123"></a>04123     }
<a name="l04124" id="l04124"></a>04124 
<a name="l04125" id="l04125"></a>04125     <span class="keywordflow">return</span> 1;
<a name="l04126" id="l04126"></a>04126 }
<a name="l04127" id="l04127"></a>04127 
<a name="l04128" id="l04128"></a>04128 <span class="keywordtype">void</span>
<a name="l04129" id="l04129"></a>04129 _oid_finish_printing(<span class="keyword">const</span> oid * objid, <span class=
"keywordtype">size_t</span> objidlen,
<a name="l04130" id="l04130"></a>04130                      u_char ** buf, <span class=
"keywordtype">size_t</span> * buf_len, <span class="keywordtype">size_t</span> * out_len,
<a name="l04131" id="l04131"></a>04131                      <span class="keywordtype">int</span> allow_realloc, <span class=
"keywordtype">int</span> *buf_overflow) {
<a name="l04132" id="l04132"></a>04132     <span class="keywordtype">char</span>            intbuf[64];
<a name="l04133" id="l04133"></a>04133     <span class=
"keywordflow">if</span> (*buf != NULL &amp;&amp; *(*buf + *out_len - 1) != <span class="charliteral">'.'</span>) {
<a name="l04134" id="l04134"></a>04134         <span class=
"keywordflow">if</span> (!*buf_overflow &amp;&amp; !snmp_strcat(buf, buf_len, out_len,
<a name="l04135" id="l04135"></a>04135                                            allow_realloc,
<a name="l04136" id="l04136"></a>04136                                            (<span class=
"keyword">const</span> u_char *) <span class="stringliteral">"."</span>)) {
<a name="l04137" id="l04137"></a>04137             *buf_overflow = 1;
<a name="l04138" id="l04138"></a>04138         }
<a name="l04139" id="l04139"></a>04139     }
<a name="l04140" id="l04140"></a>04140 
<a name="l04141" id="l04141"></a>04141     <span class="keywordflow">while</span> (objidlen-- &gt; 0) {    <span class=
"comment">/* output rest of name, uninterpreted */</span>
<a name="l04142" id="l04142"></a>04142         sprintf(intbuf, <span class="stringliteral">"%lu."</span>, *objid++);
<a name="l04143" id="l04143"></a>04143         <span class=
"keywordflow">if</span> (!*buf_overflow &amp;&amp; !snmp_strcat(buf, buf_len, out_len,
<a name="l04144" id="l04144"></a>04144                                            allow_realloc,
<a name="l04145" id="l04145"></a>04145                                            (<span class=
"keyword">const</span> u_char *) intbuf)) {
<a name="l04146" id="l04146"></a>04146             *buf_overflow = 1;
<a name="l04147" id="l04147"></a>04147         }
<a name="l04148" id="l04148"></a>04148     }
<a name="l04149" id="l04149"></a>04149 
<a name="l04150" id="l04150"></a>04150     <span class="keywordflow">if</span> (*buf != NULL) {
<a name="l04151" id="l04151"></a>04151         *(*buf + *out_len - 1) = <span class="charliteral">'\0'</span>;  <span class=
"comment">/* remove trailing dot */</span>
<a name="l04152" id="l04152"></a>04152         *out_len = *out_len - 1;
<a name="l04153" id="l04153"></a>04153     }
<a name="l04154" id="l04154"></a>04154 }
<a name="l04155" id="l04155"></a>04155 
<a name="l04156" id="l04156"></a>04156 <span class="preprocessor">#ifndef NETSNMP_DISABLE_MIB_LOADING</span>
<a name="l04157" id="l04157"></a>04157 <span class="keyword">static</span> <span class="keyword">struct </span>tree *
<a name="l04158" id="l04158"></a>04158 _get_realloc_symbol(<span class="keyword">const</span> oid * objid, <span class=
"keywordtype">size_t</span> objidlen,
<a name="l04159" id="l04159"></a>04159                     <span class="keyword">struct</span> tree *subtree,
<a name="l04160" id="l04160"></a>04160                     u_char ** buf, <span class=
"keywordtype">size_t</span> * buf_len, <span class="keywordtype">size_t</span> * out_len,
<a name="l04161" id="l04161"></a>04161                     <span class="keywordtype">int</span> allow_realloc, <span class=
"keywordtype">int</span> *buf_overflow,
<a name="l04162" id="l04162"></a>04162                     <span class="keyword">struct</span> index_list *in_dices, <span class=
"keywordtype">size_t</span> * end_of_known)
<a name="l04163" id="l04163"></a>04163 {
<a name="l04164" id="l04164"></a>04164     <span class="keyword">struct </span>tree    *return_tree = NULL;
<a name="l04165" id="l04165"></a>04165     <span class="keywordtype">int</span>             extended_index =
<a name="l04166" id="l04166"></a>04166         netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_EXTENDED_INDEX);
<a name="l04167" id="l04167"></a>04167     <span class="keywordtype">int</span>             output_format =
<a name="l04168" id="l04168"></a>04168         netsnmp_ds_get_int(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_OID_OUTPUT_FORMAT);
<a name="l04169" id="l04169"></a>04169     <span class="keywordtype">char</span>            intbuf[64];
<a name="l04170" id="l04170"></a>04170 
<a name="l04171" id="l04171"></a>04171     <span class="keywordflow">if</span> (!objid || !buf) {
<a name="l04172" id="l04172"></a>04172         <span class="keywordflow">return</span> NULL;
<a name="l04173" id="l04173"></a>04173     }
<a name="l04174" id="l04174"></a>04174 
<a name="l04175" id="l04175"></a>04175     <span class="keywordflow">for</span> (; subtree; subtree = subtree-&gt;next_peer) {
<a name="l04176" id="l04176"></a>04176         <span class="keywordflow">if</span> (*objid == subtree-&gt;subid) {
<a name="l04177" id="l04177"></a>04177             <span class=
"keywordflow">while</span> (subtree-&gt;next_peer &amp;&amp; subtree-&gt;next_peer-&gt;subid == *objid)
<a name="l04178" id="l04178"></a>04178                 subtree = subtree-&gt;next_peer;
<a name="l04179" id="l04179"></a>04179             <span class="keywordflow">if</span> (subtree-&gt;indexes) {
<a name="l04180" id="l04180"></a>04180                 in_dices = subtree-&gt;indexes;
<a name="l04181" id="l04181"></a>04181             } <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (subtree-&gt;augments) {
<a name="l04182" id="l04182"></a>04182                 <span class="keyword">struct </span>tree    *tp2 =
<a name="l04183" id="l04183"></a>04183                     find_tree_node(subtree-&gt;augments, -1);
<a name="l04184" id="l04184"></a>04184                 <span class="keywordflow">if</span> (tp2) {
<a name="l04185" id="l04185"></a>04185                     in_dices = tp2-&gt;indexes;
<a name="l04186" id="l04186"></a>04186                 }
<a name="l04187" id="l04187"></a>04187             }
<a name="l04188" id="l04188"></a>04188 
<a name="l04189" id="l04189"></a>04189             <span class=
"keywordflow">if</span> (!strncmp(subtree-&gt;label, ANON, ANON_LEN) ||
<a name="l04190" id="l04190"></a>04190                 (NETSNMP_OID_OUTPUT_NUMERIC == output_format)) {
<a name="l04191" id="l04191"></a>04191                 sprintf(intbuf, <span class=
"stringliteral">"%lu"</span>, subtree-&gt;subid);
<a name="l04192" id="l04192"></a>04192                 <span class=
"keywordflow">if</span> (!*buf_overflow &amp;&amp; !snmp_strcat(buf, buf_len, out_len,
<a name="l04193" id="l04193"></a>04193                                                    allow_realloc,
<a name="l04194" id="l04194"></a>04194                                                    (<span class=
"keyword">const</span> u_char *)
<a name="l04195" id="l04195"></a>04195                                                    intbuf)) {
<a name="l04196" id="l04196"></a>04196                     *buf_overflow = 1;
<a name="l04197" id="l04197"></a>04197                 }
<a name="l04198" id="l04198"></a>04198             } <span class="keywordflow">else</span> {
<a name="l04199" id="l04199"></a>04199                 <span class=
"keywordflow">if</span> (!*buf_overflow &amp;&amp; !snmp_strcat(buf, buf_len, out_len,
<a name="l04200" id="l04200"></a>04200                                                    allow_realloc,
<a name="l04201" id="l04201"></a>04201                                                    (<span class=
"keyword">const</span> u_char *)
<a name="l04202" id="l04202"></a>04202                                                    subtree-&gt;label)) {
<a name="l04203" id="l04203"></a>04203                     *buf_overflow = 1;
<a name="l04204" id="l04204"></a>04204                 }
<a name="l04205" id="l04205"></a>04205             }
<a name="l04206" id="l04206"></a>04206 
<a name="l04207" id="l04207"></a>04207             <span class="keywordflow">if</span> (objidlen &gt; 1) {
<a name="l04208" id="l04208"></a>04208                 <span class=
"keywordflow">if</span> (!*buf_overflow &amp;&amp; !snmp_strcat(buf, buf_len, out_len,
<a name="l04209" id="l04209"></a>04209                                                    allow_realloc,
<a name="l04210" id="l04210"></a>04210                                                    (<span class=
"keyword">const</span> u_char *) <span class="stringliteral">"."</span>)) {
<a name="l04211" id="l04211"></a>04211                     *buf_overflow = 1;
<a name="l04212" id="l04212"></a>04212                 }
<a name="l04213" id="l04213"></a>04213 
<a name="l04214" id="l04214"></a>04214                 return_tree = _get_realloc_symbol(objid + 1, objidlen - 1,
<a name="l04215" id="l04215"></a>04215                                                   subtree-&gt;child_list,
<a name="l04216" id="l04216"></a>04216                                                   buf, buf_len, out_len,
<a name="l04217" id="l04217"></a>04217                                                   allow_realloc,
<a name="l04218" id="l04218"></a>04218                                                   buf_overflow, in_dices,
<a name="l04219" id="l04219"></a>04219                                                   end_of_known);
<a name="l04220" id="l04220"></a>04220             }
<a name="l04221" id="l04221"></a>04221 
<a name="l04222" id="l04222"></a>04222             <span class="keywordflow">if</span> (return_tree != NULL) {
<a name="l04223" id="l04223"></a>04223                 <span class="keywordflow">return</span> return_tree;
<a name="l04224" id="l04224"></a>04224             } <span class="keywordflow">else</span> {
<a name="l04225" id="l04225"></a>04225                 <span class="keywordflow">return</span> subtree;
<a name="l04226" id="l04226"></a>04226             }
<a name="l04227" id="l04227"></a>04227         }
<a name="l04228" id="l04228"></a>04228     }
<a name="l04229" id="l04229"></a>04229 
<a name="l04230" id="l04230"></a>04230 
<a name="l04231" id="l04231"></a>04231     <span class="keywordflow">if</span> (end_of_known) {
<a name="l04232" id="l04232"></a>04232         *end_of_known = *out_len;
<a name="l04233" id="l04233"></a>04233     }
<a name="l04234" id="l04234"></a>04234 
<a name="l04235" id="l04235"></a>04235     <span class="comment">/*</span>
<a name="l04236" id="l04236"></a>04236 <span class="comment">     * Subtree not found.  </span>
<a name="l04237" id="l04237"></a>04237 <span class="comment">     */</span>
<a name="l04238" id="l04238"></a>04238 
<a name="l04239" id="l04239"></a>04239     <span class=
"keywordflow">while</span> (in_dices &amp;&amp; (objidlen &gt; 0) &amp;&amp;
<a name="l04240" id="l04240"></a>04240            (NETSNMP_OID_OUTPUT_NUMERIC != output_format) &amp;&amp;
<a name="l04241" id=
"l04241"></a>04241            !netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_DONT_BREAKDOWN_OIDS)) {
<a name="l04242" id="l04242"></a>04242         <span class="keywordtype">size_t</span>          numids;
<a name="l04243" id="l04243"></a>04243         <span class="keyword">struct </span>tree    *tp;
<a name="l04244" id="l04244"></a>04244 
<a name="l04245" id="l04245"></a>04245         tp = find_tree_node(in_dices-&gt;ilabel, -1);
<a name="l04246" id="l04246"></a>04246 
<a name="l04247" id="l04247"></a>04247         <span class="keywordflow">if</span> (!tp) {
<a name="l04248" id="l04248"></a>04248             <span class="comment">/*</span>
<a name="l04249" id="l04249"></a>04249 <span class="comment">             * Can't find an index in the mib tree.  Bail.  </span>
<a name="l04250" id="l04250"></a>04250 <span class="comment">             */</span>
<a name="l04251" id="l04251"></a>04251             <span class="keywordflow">goto</span> finish_it;
<a name="l04252" id="l04252"></a>04252         }
<a name="l04253" id="l04253"></a>04253 
<a name="l04254" id="l04254"></a>04254         <span class="keywordflow">if</span> (extended_index) {
<a name="l04255" id="l04255"></a>04255             <span class=
"keywordflow">if</span> (*buf != NULL &amp;&amp; *(*buf + *out_len - 1) == <span class="charliteral">'.'</span>) {
<a name="l04256" id="l04256"></a>04256                 (*out_len)--;
<a name="l04257" id="l04257"></a>04257             }
<a name="l04258" id="l04258"></a>04258             <span class=
"keywordflow">if</span> (!*buf_overflow &amp;&amp; !snmp_strcat(buf, buf_len, out_len,
<a name="l04259" id="l04259"></a>04259                                                allow_realloc,
<a name="l04260" id="l04260"></a>04260                                                (<span class=
"keyword">const</span> u_char *) <span class="stringliteral">"["</span>)) {
<a name="l04261" id="l04261"></a>04261                 *buf_overflow = 1;
<a name="l04262" id="l04262"></a>04262             }
<a name="l04263" id="l04263"></a>04263         }
<a name="l04264" id="l04264"></a>04264 
<a name="l04265" id="l04265"></a>04265         <span class="keywordflow">switch</span> (tp-&gt;type) {
<a name="l04266" id="l04266"></a>04266         <span class="keywordflow">case</span> TYPE_OCTETSTR:
<a name="l04267" id="l04267"></a>04267             <span class="keywordflow">if</span> (extended_index &amp;&amp; tp-&gt;hint) {
<a name="l04268" id="l04268"></a>04268                 <a class="code" href="structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> var;
<a name="l04269" id="l04269"></a>04269                 u_char          buffer[1024];
<a name="l04270" id="l04270"></a>04270                 <span class="keywordtype">int</span>             i;
<a name="l04271" id="l04271"></a>04271 
<a name="l04272" id="l04272"></a>04272                 memset(&amp;var, 0, <span class="keyword">sizeof</span> var);
<a name="l04273" id="l04273"></a>04273                 <span class="keywordflow">if</span> (in_dices-&gt;isimplied) {
<a name="l04274" id="l04274"></a>04274                     numids = objidlen;
<a name="l04275" id="l04275"></a>04275                     <span class="keywordflow">if</span> (numids &gt; objidlen)
<a name="l04276" id="l04276"></a>04276                         <span class="keywordflow">goto</span> finish_it;
<a name="l04277" id="l04277"></a>04277                 } <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (tp-&gt;ranges &amp;&amp; !tp-&gt;ranges-&gt;next
<a name="l04278" id="l04278"></a>04278                            &amp;&amp; tp-&gt;ranges-&gt;low == tp-&gt;ranges-&gt;high) {
<a name="l04279" id="l04279"></a>04279                     numids = tp-&gt;ranges-&gt;low;
<a name="l04280" id="l04280"></a>04280                     <span class="keywordflow">if</span> (numids &gt; objidlen)
<a name="l04281" id="l04281"></a>04281                         <span class="keywordflow">goto</span> finish_it;
<a name="l04282" id="l04282"></a>04282                 } <span class="keywordflow">else</span> {
<a name="l04283" id="l04283"></a>04283                     numids = *objid;
<a name="l04284" id="l04284"></a>04284                     <span class="keywordflow">if</span> (numids &gt;= objidlen)
<a name="l04285" id="l04285"></a>04285                         <span class="keywordflow">goto</span> finish_it;
<a name="l04286" id="l04286"></a>04286                     objid++;
<a name="l04287" id="l04287"></a>04287                     objidlen--;
<a name="l04288" id="l04288"></a>04288                 }
<a name="l04289" id="l04289"></a>04289                 <span class="keywordflow">if</span> (numids &gt; objidlen)
<a name="l04290" id="l04290"></a>04290                     <span class="keywordflow">goto</span> finish_it;
<a name="l04291" id="l04291"></a>04291                 <span class="keywordflow">for</span> (i = 0; i &lt; (int) numids; i++)
<a name="l04292" id="l04292"></a>04292                     buffer[i] = (u_char) objid[i];
<a name="l04293" id="l04293"></a>04293                 var.<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a> = ASN_OCTET_STR;
<a name="l04294" id="l04294"></a>04294                 var.<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.string = buffer;
<a name="l04295" id="l04295"></a>04295                 var.<a class="code" href=
"structvariable__list.html#17aaa6b445178fc39aba69642247d3e9" title=
"the length of the value to be copied into buf">val_len</a> = numids;
<a name="l04296" id="l04296"></a>04296                 <span class="keywordflow">if</span> (!*buf_overflow) {
<a name="l04297" id="l04297"></a>04297                     <span class="keywordflow">if</span> (!<a class="code" href=
"group__mib__utilities.html#gbe71c710f2173fb85512d08c088ea12e" title=
"Prints an octet string into a buffer.">sprint_realloc_octet_string</a>(buf, buf_len, out_len,
<a name="l04298" id="l04298"></a>04298                                                      allow_realloc, &amp;var,
<a name="l04299" id="l04299"></a>04299                                                      NULL, tp-&gt;hint,
<a name="l04300" id="l04300"></a>04300                                                      NULL)) {
<a name="l04301" id="l04301"></a>04301                         *buf_overflow = 1;
<a name="l04302" id="l04302"></a>04302                     }
<a name="l04303" id="l04303"></a>04303                 }
<a name="l04304" id="l04304"></a>04304             } <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (in_dices-&gt;isimplied) {
<a name="l04305" id="l04305"></a>04305                 numids = objidlen;
<a name="l04306" id="l04306"></a>04306                 <span class="keywordflow">if</span> (numids &gt; objidlen)
<a name="l04307" id="l04307"></a>04307                     <span class="keywordflow">goto</span> finish_it;
<a name="l04308" id="l04308"></a>04308 
<a name="l04309" id="l04309"></a>04309                 <span class="keywordflow">if</span> (!*buf_overflow) {
<a name="l04310" id="l04310"></a>04310                     <span class="keywordflow">if</span> (!dump_realloc_oid_to_string
<a name="l04311" id="l04311"></a>04311                         (objid, numids, buf, buf_len, out_len,
<a name="l04312" id="l04312"></a>04312                          allow_realloc, <span class="charliteral">'\''</span>)) {
<a name="l04313" id="l04313"></a>04313                         *buf_overflow = 1;
<a name="l04314" id="l04314"></a>04314                     }
<a name="l04315" id="l04315"></a>04315                 }
<a name="l04316" id="l04316"></a>04316             } <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (tp-&gt;ranges &amp;&amp; !tp-&gt;ranges-&gt;next
<a name="l04317" id="l04317"></a>04317                        &amp;&amp; tp-&gt;ranges-&gt;low == tp-&gt;ranges-&gt;high) {
<a name="l04318" id="l04318"></a>04318                 <span class="comment">/*</span>
<a name="l04319" id="l04319"></a>04319 <span class="comment">                 * a fixed-length octet string </span>
<a name="l04320" id="l04320"></a>04320 <span class="comment">                 */</span>
<a name="l04321" id="l04321"></a>04321                 numids = tp-&gt;ranges-&gt;low;
<a name="l04322" id="l04322"></a>04322                 <span class="keywordflow">if</span> (numids &gt; objidlen)
<a name="l04323" id="l04323"></a>04323                     <span class="keywordflow">goto</span> finish_it;
<a name="l04324" id="l04324"></a>04324 
<a name="l04325" id="l04325"></a>04325                 <span class="keywordflow">if</span> (!*buf_overflow) {
<a name="l04326" id="l04326"></a>04326                     <span class="keywordflow">if</span> (!dump_realloc_oid_to_string
<a name="l04327" id="l04327"></a>04327                         (objid, numids, buf, buf_len, out_len,
<a name="l04328" id="l04328"></a>04328                          allow_realloc, <span class="charliteral">'\''</span>)) {
<a name="l04329" id="l04329"></a>04329                         *buf_overflow = 1;
<a name="l04330" id="l04330"></a>04330                     }
<a name="l04331" id="l04331"></a>04331                 }
<a name="l04332" id="l04332"></a>04332             } <span class="keywordflow">else</span> {
<a name="l04333" id="l04333"></a>04333                 numids = (size_t) * objid + 1;
<a name="l04334" id="l04334"></a>04334                 <span class="keywordflow">if</span> (numids &gt; objidlen)
<a name="l04335" id="l04335"></a>04335                     <span class="keywordflow">goto</span> finish_it;
<a name="l04336" id="l04336"></a>04336                 <span class="keywordflow">if</span> (numids == 1) {
<a name="l04337" id="l04337"></a>04337                     <span class="keywordflow">if</span> (netsnmp_ds_get_boolean
<a name="l04338" id="l04338"></a>04338                         (NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_ESCAPE_QUOTES)) {
<a name="l04339" id="l04339"></a>04339                         <span class="keywordflow">if</span> (!*buf_overflow
<a name="l04340" id="l04340"></a>04340                             &amp;&amp; !snmp_strcat(buf, buf_len, out_len,
<a name="l04341" id="l04341"></a>04341                                             allow_realloc,
<a name="l04342" id="l04342"></a>04342                                             (<span class=
"keyword">const</span> u_char *) <span class="stringliteral">"\\"</span>)) {
<a name="l04343" id="l04343"></a>04343                             *buf_overflow = 1;
<a name="l04344" id="l04344"></a>04344                         }
<a name="l04345" id="l04345"></a>04345                     }
<a name="l04346" id="l04346"></a>04346                     <span class="keywordflow">if</span> (!*buf_overflow
<a name="l04347" id="l04347"></a>04347                         &amp;&amp; !snmp_strcat(buf, buf_len, out_len,
<a name="l04348" id="l04348"></a>04348                                         allow_realloc,
<a name="l04349" id="l04349"></a>04349                                         (<span class=
"keyword">const</span> u_char *) <span class="stringliteral">"\""</span>)) {
<a name="l04350" id="l04350"></a>04350                         *buf_overflow = 1;
<a name="l04351" id="l04351"></a>04351                     }
<a name="l04352" id="l04352"></a>04352                     <span class="keywordflow">if</span> (netsnmp_ds_get_boolean
<a name="l04353" id="l04353"></a>04353                         (NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_ESCAPE_QUOTES)) {
<a name="l04354" id="l04354"></a>04354                         <span class="keywordflow">if</span> (!*buf_overflow
<a name="l04355" id="l04355"></a>04355                             &amp;&amp; !snmp_strcat(buf, buf_len, out_len,
<a name="l04356" id="l04356"></a>04356                                             allow_realloc,
<a name="l04357" id="l04357"></a>04357                                             (<span class=
"keyword">const</span> u_char *) <span class="stringliteral">"\\"</span>)) {
<a name="l04358" id="l04358"></a>04358                             *buf_overflow = 1;
<a name="l04359" id="l04359"></a>04359                         }
<a name="l04360" id="l04360"></a>04360                     }
<a name="l04361" id="l04361"></a>04361                     <span class="keywordflow">if</span> (!*buf_overflow
<a name="l04362" id="l04362"></a>04362                         &amp;&amp; !snmp_strcat(buf, buf_len, out_len,
<a name="l04363" id="l04363"></a>04363                                         allow_realloc,
<a name="l04364" id="l04364"></a>04364                                         (<span class=
"keyword">const</span> u_char *) <span class="stringliteral">"\""</span>)) {
<a name="l04365" id="l04365"></a>04365                         *buf_overflow = 1;
<a name="l04366" id="l04366"></a>04366                     }
<a name="l04367" id="l04367"></a>04367                 } <span class="keywordflow">else</span> {
<a name="l04368" id="l04368"></a>04368                     <span class="keywordflow">if</span> (!*buf_overflow) {
<a name="l04369" id="l04369"></a>04369                         <span class="keyword">struct </span>tree * next_peer;
<a name="l04370" id="l04370"></a>04370                         <span class="keywordtype">int</span> normal_handling = 1;
<a name="l04371" id="l04371"></a>04371 
<a name="l04372" id="l04372"></a>04372                         <span class="keywordflow">if</span> (tp-&gt;next_peer) {
<a name="l04373" id="l04373"></a>04373                             next_peer = tp-&gt;next_peer;
<a name="l04374" id="l04374"></a>04374                         }
<a name="l04375" id="l04375"></a>04375 
<a name="l04376" id="l04376"></a>04376                         <span class=
"comment">/* Try handling the InetAddress in the OID, in case of failure,</span>
<a name="l04377" id="l04377"></a>04377 <span class="comment">                         * use the normal_handling. </span>
<a name="l04378" id="l04378"></a>04378 <span class="comment">                         */</span>
<a name="l04379" id="l04379"></a>04379                         <span class="keywordflow">if</span> (tp-&gt;next_peer &amp;&amp;
<a name="l04380" id="l04380"></a>04380                             tp-&gt;tc_index != -1 &amp;&amp;
<a name="l04381" id="l04381"></a>04381                             next_peer-&gt;tc_index != -1 &amp;&amp;
<a name="l04382" id="l04382"></a>04382                             strcmp(get_tc_descriptor(tp-&gt;tc_index), <span class=
"stringliteral">"InetAddress"</span>) == 0 &amp;&amp;
<a name="l04383" id="l04383"></a>04383                             strcmp(get_tc_descriptor(next_peer-&gt;tc_index), 
<a name="l04384" id="l04384"></a>04384                                     <span class=
"stringliteral">"InetAddressType"</span>) == 0 ) {
<a name="l04385" id="l04385"></a>04385 
<a name="l04386" id="l04386"></a>04386                             <span class="keywordtype">int</span> ret;
<a name="l04387" id="l04387"></a>04387                             <span class="keywordtype">int</span> addr_type = *(objid - 1);
<a name="l04388" id="l04388"></a>04388 
<a name="l04389" id="l04389"></a>04389                             ret = dump_realloc_oid_to_inetaddress(addr_type, 
<a name="l04390" id="l04390"></a>04390                                         objid + 1, numids - 1, buf, buf_len, out_len,
<a name="l04391" id="l04391"></a>04391                                         allow_realloc, <span class=
"charliteral">'"'</span>);
<a name="l04392" id="l04392"></a>04392                             <span class="keywordflow">if</span> (ret != 2) {
<a name="l04393" id="l04393"></a>04393                                 normal_handling = 0;
<a name="l04394" id="l04394"></a>04394                                 <span class="keywordflow">if</span> (ret == 0) {
<a name="l04395" id="l04395"></a>04395                                     *buf_overflow = 1;
<a name="l04396" id="l04396"></a>04396                                 }
<a name="l04397" id="l04397"></a>04397 
<a name="l04398" id="l04398"></a>04398                             }
<a name="l04399" id="l04399"></a>04399                         } 
<a name="l04400" id="l04400"></a>04400                         <span class=
"keywordflow">if</span> (normal_handling &amp;&amp; !dump_realloc_oid_to_string
<a name="l04401" id="l04401"></a>04401                             (objid + 1, numids - 1, buf, buf_len, out_len,
<a name="l04402" id="l04402"></a>04402                              allow_realloc, <span class="charliteral">'"'</span>)) {
<a name="l04403" id="l04403"></a>04403                             *buf_overflow = 1;
<a name="l04404" id="l04404"></a>04404                         }
<a name="l04405" id="l04405"></a>04405                     }
<a name="l04406" id="l04406"></a>04406                 }
<a name="l04407" id="l04407"></a>04407             }
<a name="l04408" id="l04408"></a>04408             objid += numids;
<a name="l04409" id="l04409"></a>04409             objidlen -= numids;
<a name="l04410" id="l04410"></a>04410             <span class="keywordflow">break</span>;
<a name="l04411" id="l04411"></a>04411 
<a name="l04412" id="l04412"></a>04412         <span class="keywordflow">case</span> TYPE_INTEGER32:
<a name="l04413" id="l04413"></a>04413         <span class="keywordflow">case</span> TYPE_UINTEGER:
<a name="l04414" id="l04414"></a>04414         <span class="keywordflow">case</span> TYPE_UNSIGNED32:
<a name="l04415" id="l04415"></a>04415         <span class="keywordflow">case</span> TYPE_GAUGE:
<a name="l04416" id="l04416"></a>04416         <span class="keywordflow">case</span> TYPE_INTEGER:
<a name="l04417" id="l04417"></a>04417             <span class="keywordflow">if</span> (tp-&gt;enums) {
<a name="l04418" id="l04418"></a>04418                 <span class="keyword">struct </span>enum_list *ep = tp-&gt;enums;
<a name="l04419" id="l04419"></a>04419                 <span class=
"keywordflow">while</span> (ep &amp;&amp; ep-&gt;value != (<span class="keywordtype">int</span>) (*objid)) {
<a name="l04420" id="l04420"></a>04420                     ep = ep-&gt;next;
<a name="l04421" id="l04421"></a>04421                 }
<a name="l04422" id="l04422"></a>04422                 <span class="keywordflow">if</span> (ep) {
<a name="l04423" id="l04423"></a>04423                     <span class="keywordflow">if</span> (!*buf_overflow
<a name="l04424" id="l04424"></a>04424                         &amp;&amp; !snmp_strcat(buf, buf_len, out_len,
<a name="l04425" id="l04425"></a>04425                                         allow_realloc,
<a name="l04426" id="l04426"></a>04426                                         (<span class=
"keyword">const</span> u_char *) ep-&gt;label)) {
<a name="l04427" id="l04427"></a>04427                         *buf_overflow = 1;
<a name="l04428" id="l04428"></a>04428                     }
<a name="l04429" id="l04429"></a>04429                 } <span class="keywordflow">else</span> {
<a name="l04430" id="l04430"></a>04430                     sprintf(intbuf, <span class="stringliteral">"%lu"</span>, *objid);
<a name="l04431" id="l04431"></a>04431                     <span class="keywordflow">if</span> (!*buf_overflow
<a name="l04432" id="l04432"></a>04432                         &amp;&amp; !snmp_strcat(buf, buf_len, out_len,
<a name="l04433" id="l04433"></a>04433                                         allow_realloc,
<a name="l04434" id="l04434"></a>04434                                         (<span class=
"keyword">const</span> u_char *) intbuf)) {
<a name="l04435" id="l04435"></a>04435                         *buf_overflow = 1;
<a name="l04436" id="l04436"></a>04436                     }
<a name="l04437" id="l04437"></a>04437                 }
<a name="l04438" id="l04438"></a>04438             } <span class="keywordflow">else</span> {
<a name="l04439" id="l04439"></a>04439                 sprintf(intbuf, <span class="stringliteral">"%lu"</span>, *objid);
<a name="l04440" id="l04440"></a>04440                 <span class=
"keywordflow">if</span> (!*buf_overflow &amp;&amp; !snmp_strcat(buf, buf_len, out_len,
<a name="l04441" id="l04441"></a>04441                                                    allow_realloc,
<a name="l04442" id="l04442"></a>04442                                                    (<span class=
"keyword">const</span> u_char *)
<a name="l04443" id="l04443"></a>04443                                                    intbuf)) {
<a name="l04444" id="l04444"></a>04444                     *buf_overflow = 1;
<a name="l04445" id="l04445"></a>04445                 }
<a name="l04446" id="l04446"></a>04446             }
<a name="l04447" id="l04447"></a>04447             objid++;
<a name="l04448" id="l04448"></a>04448             objidlen--;
<a name="l04449" id="l04449"></a>04449             <span class="keywordflow">break</span>;
<a name="l04450" id="l04450"></a>04450 
<a name="l04451" id="l04451"></a>04451         <span class="keywordflow">case</span> TYPE_OBJID:
<a name="l04452" id="l04452"></a>04452             <span class="keywordflow">if</span> (in_dices-&gt;isimplied) {
<a name="l04453" id="l04453"></a>04453                 numids = objidlen;
<a name="l04454" id="l04454"></a>04454             } <span class="keywordflow">else</span> {
<a name="l04455" id="l04455"></a>04455                 numids = (size_t) * objid + 1;
<a name="l04456" id="l04456"></a>04456             }
<a name="l04457" id="l04457"></a>04457             <span class="keywordflow">if</span> (numids &gt; objidlen)
<a name="l04458" id="l04458"></a>04458                 <span class="keywordflow">goto</span> finish_it;
<a name="l04459" id="l04459"></a>04459             <span class="keywordflow">if</span> (extended_index) {
<a name="l04460" id="l04460"></a>04460                 <span class="keywordflow">if</span> (in_dices-&gt;isimplied) {
<a name="l04461" id="l04461"></a>04461                     <span class="keywordflow">if</span> (!*buf_overflow
<a name="l04462" id="l04462"></a>04462                         &amp;&amp; !netsnmp_sprint_realloc_objid_tree(buf, buf_len,
<a name="l04463" id="l04463"></a>04463                                                               out_len,
<a name="l04464" id="l04464"></a>04464                                                               allow_realloc,
<a name="l04465" id="l04465"></a>04465                                                               buf_overflow,
<a name="l04466" id="l04466"></a>04466                                                               objid,
<a name="l04467" id="l04467"></a>04467                                                               numids)) {
<a name="l04468" id="l04468"></a>04468                         *buf_overflow = 1;
<a name="l04469" id="l04469"></a>04469                     }
<a name="l04470" id="l04470"></a>04470                 } <span class="keywordflow">else</span> {
<a name="l04471" id="l04471"></a>04471                     <span class="keywordflow">if</span> (!*buf_overflow
<a name="l04472" id="l04472"></a>04472                         &amp;&amp; !netsnmp_sprint_realloc_objid_tree(buf, buf_len,
<a name="l04473" id="l04473"></a>04473                                                               out_len,
<a name="l04474" id="l04474"></a>04474                                                               allow_realloc,
<a name="l04475" id="l04475"></a>04475                                                               buf_overflow,
<a name="l04476" id="l04476"></a>04476                                                               objid + 1,
<a name="l04477" id="l04477"></a>04477                                                               numids -
<a name="l04478" id="l04478"></a>04478                                                               1)) {
<a name="l04479" id="l04479"></a>04479                         *buf_overflow = 1;
<a name="l04480" id="l04480"></a>04480                     }
<a name="l04481" id="l04481"></a>04481                 }
<a name="l04482" id="l04482"></a>04482             } <span class="keywordflow">else</span> {
<a name="l04483" id="l04483"></a>04483                 _get_realloc_symbol(objid, numids, NULL, buf, buf_len,
<a name="l04484" id="l04484"></a>04484                                     out_len, allow_realloc, buf_overflow,
<a name="l04485" id="l04485"></a>04485                                     NULL, NULL);
<a name="l04486" id="l04486"></a>04486             }
<a name="l04487" id="l04487"></a>04487             objid += (numids);
<a name="l04488" id="l04488"></a>04488             objidlen -= (numids);
<a name="l04489" id="l04489"></a>04489             <span class="keywordflow">break</span>;
<a name="l04490" id="l04490"></a>04490 
<a name="l04491" id="l04491"></a>04491         <span class="keywordflow">case</span> TYPE_IPADDR:
<a name="l04492" id="l04492"></a>04492             <span class="keywordflow">if</span> (objidlen &lt; 4)
<a name="l04493" id="l04493"></a>04493                 <span class="keywordflow">goto</span> finish_it;
<a name="l04494" id="l04494"></a>04494             sprintf(intbuf, <span class="stringliteral">"%lu.%lu.%lu.%lu"</span>,
<a name="l04495" id="l04495"></a>04495                     objid[0], objid[1], objid[2], objid[3]);
<a name="l04496" id="l04496"></a>04496             objid += 4;
<a name="l04497" id="l04497"></a>04497             objidlen -= 4;
<a name="l04498" id="l04498"></a>04498             <span class=
"keywordflow">if</span> (!*buf_overflow &amp;&amp; !snmp_strcat(buf, buf_len, out_len,
<a name="l04499" id="l04499"></a>04499                                                allow_realloc,
<a name="l04500" id="l04500"></a>04500                                                (<span class=
"keyword">const</span> u_char *) intbuf)) {
<a name="l04501" id="l04501"></a>04501                 *buf_overflow = 1;
<a name="l04502" id="l04502"></a>04502             }
<a name="l04503" id="l04503"></a>04503             <span class="keywordflow">break</span>;
<a name="l04504" id="l04504"></a>04504 
<a name="l04505" id="l04505"></a>04505         <span class="keywordflow">case</span> TYPE_NETADDR:{
<a name="l04506" id="l04506"></a>04506                 oid             ntype = *objid++;
<a name="l04507" id="l04507"></a>04507 
<a name="l04508" id="l04508"></a>04508                 objidlen--;
<a name="l04509" id="l04509"></a>04509                 sprintf(intbuf, <span class="stringliteral">"%lu."</span>, ntype);
<a name="l04510" id="l04510"></a>04510                 <span class=
"keywordflow">if</span> (!*buf_overflow &amp;&amp; !snmp_strcat(buf, buf_len, out_len,
<a name="l04511" id="l04511"></a>04511                                                    allow_realloc,
<a name="l04512" id="l04512"></a>04512                                                    (<span class=
"keyword">const</span> u_char *)
<a name="l04513" id="l04513"></a>04513                                                    intbuf)) {
<a name="l04514" id="l04514"></a>04514                     *buf_overflow = 1;
<a name="l04515" id="l04515"></a>04515                 }
<a name="l04516" id="l04516"></a>04516 
<a name="l04517" id="l04517"></a>04517                 <span class=
"keywordflow">if</span> (ntype == 1 &amp;&amp; objidlen &gt;= 4) {
<a name="l04518" id="l04518"></a>04518                     sprintf(intbuf, <span class="stringliteral">"%lu.%lu.%lu.%lu"</span>,
<a name="l04519" id="l04519"></a>04519                             objid[0], objid[1], objid[2], objid[3]);
<a name="l04520" id="l04520"></a>04520                     <span class="keywordflow">if</span> (!*buf_overflow
<a name="l04521" id="l04521"></a>04521                         &amp;&amp; !snmp_strcat(buf, buf_len, out_len,
<a name="l04522" id="l04522"></a>04522                                         allow_realloc,
<a name="l04523" id="l04523"></a>04523                                         (<span class=
"keyword">const</span> u_char *) intbuf)) {
<a name="l04524" id="l04524"></a>04524                         *buf_overflow = 1;
<a name="l04525" id="l04525"></a>04525                     }
<a name="l04526" id="l04526"></a>04526                     objid += 4;
<a name="l04527" id="l04527"></a>04527                     objidlen -= 4;
<a name="l04528" id="l04528"></a>04528                 } <span class="keywordflow">else</span> {
<a name="l04529" id="l04529"></a>04529                     <span class="keywordflow">goto</span> finish_it;
<a name="l04530" id="l04530"></a>04530                 }
<a name="l04531" id="l04531"></a>04531             }
<a name="l04532" id="l04532"></a>04532             <span class="keywordflow">break</span>;
<a name="l04533" id="l04533"></a>04533 
<a name="l04534" id="l04534"></a>04534         <span class="keywordflow">case</span> TYPE_NSAPADDRESS:
<a name="l04535" id="l04535"></a>04535         <span class="keywordflow">default</span>:
<a name="l04536" id="l04536"></a>04536             <span class="keywordflow">goto</span> finish_it;
<a name="l04537" id="l04537"></a>04537             <span class="keywordflow">break</span>;
<a name="l04538" id="l04538"></a>04538         }
<a name="l04539" id="l04539"></a>04539 
<a name="l04540" id="l04540"></a>04540         <span class="keywordflow">if</span> (extended_index) {
<a name="l04541" id="l04541"></a>04541             <span class=
"keywordflow">if</span> (!*buf_overflow &amp;&amp; !snmp_strcat(buf, buf_len, out_len,
<a name="l04542" id="l04542"></a>04542                                                allow_realloc,
<a name="l04543" id="l04543"></a>04543                                                (<span class=
"keyword">const</span> u_char *) <span class="stringliteral">"]"</span>)) {
<a name="l04544" id="l04544"></a>04544                 *buf_overflow = 1;
<a name="l04545" id="l04545"></a>04545             }
<a name="l04546" id="l04546"></a>04546         } <span class="keywordflow">else</span> {
<a name="l04547" id="l04547"></a>04547             <span class=
"keywordflow">if</span> (!*buf_overflow &amp;&amp; !snmp_strcat(buf, buf_len, out_len,
<a name="l04548" id="l04548"></a>04548                                                allow_realloc,
<a name="l04549" id="l04549"></a>04549                                                (<span class=
"keyword">const</span> u_char *) <span class="stringliteral">"."</span>)) {
<a name="l04550" id="l04550"></a>04550                 *buf_overflow = 1;
<a name="l04551" id="l04551"></a>04551             }
<a name="l04552" id="l04552"></a>04552         }
<a name="l04553" id="l04553"></a>04553         in_dices = in_dices-&gt;next;
<a name="l04554" id="l04554"></a>04554     }
<a name="l04555" id="l04555"></a>04555 
<a name="l04556" id="l04556"></a>04556   finish_it:
<a name="l04557" id="l04557"></a>04557     _oid_finish_printing(objid, objidlen,
<a name="l04558" id="l04558"></a>04558                          buf, buf_len, out_len,
<a name="l04559" id="l04559"></a>04559                          allow_realloc, buf_overflow);
<a name="l04560" id="l04560"></a>04560     <span class="keywordflow">return</span> NULL;
<a name="l04561" id="l04561"></a>04561 }
<a name="l04562" id="l04562"></a>04562 
<a name="l04563" id="l04563"></a>04563 <span class="keyword">struct </span>tree    *
<a name="l04564" id="l04564"></a>04564 get_tree(<span class="keyword">const</span> oid * objid, <span class=
"keywordtype">size_t</span> objidlen, <span class="keyword">struct</span> tree *subtree)
<a name="l04565" id="l04565"></a>04565 {
<a name="l04566" id="l04566"></a>04566     <span class="keyword">struct </span>tree    *return_tree = NULL;
<a name="l04567" id="l04567"></a>04567 
<a name="l04568" id="l04568"></a>04568     <span class="keywordflow">for</span> (; subtree; subtree = subtree-&gt;next_peer) {
<a name="l04569" id="l04569"></a>04569         <span class="keywordflow">if</span> (*objid == subtree-&gt;subid)
<a name="l04570" id="l04570"></a>04570             <span class="keywordflow">goto</span> found;
<a name="l04571" id="l04571"></a>04571     }
<a name="l04572" id="l04572"></a>04572 
<a name="l04573" id="l04573"></a>04573     <span class="keywordflow">return</span> NULL;
<a name="l04574" id="l04574"></a>04574 
<a name="l04575" id="l04575"></a>04575   found:
<a name="l04576" id="l04576"></a>04576     <span class=
"keywordflow">while</span> (subtree-&gt;next_peer &amp;&amp; subtree-&gt;next_peer-&gt;subid == *objid)
<a name="l04577" id="l04577"></a>04577         subtree = subtree-&gt;next_peer;
<a name="l04578" id="l04578"></a>04578     <span class="keywordflow">if</span> (objidlen &gt; 1)
<a name="l04579" id="l04579"></a>04579         return_tree =
<a name="l04580" id="l04580"></a>04580             get_tree(objid + 1, objidlen - 1, subtree-&gt;child_list);
<a name="l04581" id="l04581"></a>04581     <span class="keywordflow">if</span> (return_tree != NULL)
<a name="l04582" id="l04582"></a>04582         <span class="keywordflow">return</span> return_tree;
<a name="l04583" id="l04583"></a>04583     <span class="keywordflow">else</span>
<a name="l04584" id="l04584"></a>04584         <span class="keywordflow">return</span> subtree;
<a name="l04585" id="l04585"></a>04585 }
<a name="l04586" id="l04586"></a>04586 
<a name="l04592" id="l04592"></a>04592 <span class="keywordtype">void</span>
<a name="l04593" id="l04593"></a><a class="code" href=
"group__mib__utilities.html#g3ad2e46fc532f09e1fd97c06b9c5f0b0">04593</a> <a class="code" href=
"group__mib__utilities.html#g3ad2e46fc532f09e1fd97c06b9c5f0b0" title=
"Prints on oid description on stdout.">print_description</a>(oid * objid, <span class=
"keywordtype">size_t</span> objidlen, <span class="comment">/* number of subidentifiers */</span>
<a name="l04594" id="l04594"></a>04594                   <span class="keywordtype">int</span> width)
<a name="l04595" id="l04595"></a>04595 {
<a name="l04596" id="l04596"></a>04596     <a class="code" href="group__mib__utilities.html#geef53f656646fe9c5cb8d8986cdfe53d"
title="Prints on oid description into a file descriptor.">fprint_description</a>(stdout, objid, objidlen, width);
<a name="l04597" id="l04597"></a>04597 }
<a name="l04598" id="l04598"></a>04598 
<a name="l04599" id="l04599"></a>04599 
<a name="l04608" id="l04608"></a>04608 <span class="keywordtype">void</span>
<a name="l04609" id="l04609"></a><a class="code" href=
"group__mib__utilities.html#geef53f656646fe9c5cb8d8986cdfe53d">04609</a> <a class="code" href=
"group__mib__utilities.html#geef53f656646fe9c5cb8d8986cdfe53d" title=
"Prints on oid description into a file descriptor.">fprint_description</a>(FILE * f, oid * objid, <span class=
"keywordtype">size_t</span> objidlen,
<a name="l04610" id="l04610"></a>04610                    <span class="keywordtype">int</span> width)
<a name="l04611" id="l04611"></a>04611 {
<a name="l04612" id="l04612"></a>04612     u_char         *buf = NULL;
<a name="l04613" id="l04613"></a>04613     <span class="keywordtype">size_t</span>          buf_len = 256, out_len = 0;
<a name="l04614" id="l04614"></a>04614 
<a name="l04615" id="l04615"></a>04615     <span class="keywordflow">if</span> ((buf = (u_char *) calloc(buf_len, 1)) == NULL) {
<a name="l04616" id="l04616"></a>04616         fprintf(f, <span class="stringliteral">"[TRUNCATED]\n"</span>);
<a name="l04617" id="l04617"></a>04617         <span class="keywordflow">return</span>;
<a name="l04618" id="l04618"></a>04618     } <span class="keywordflow">else</span> {
<a name="l04619" id="l04619"></a>04619         <span class=
"keywordflow">if</span> (!sprint_realloc_description(&amp;buf, &amp;buf_len, &amp;out_len, 1,
<a name="l04620" id="l04620"></a>04620                                    objid, objidlen, width)) {
<a name="l04621" id="l04621"></a>04621             fprintf(f, <span class="stringliteral">"%s [TRUNCATED]\n"</span>, buf);
<a name="l04622" id="l04622"></a>04622         } <span class="keywordflow">else</span> {
<a name="l04623" id="l04623"></a>04623             fprintf(f, <span class="stringliteral">"%s\n"</span>, buf);
<a name="l04624" id="l04624"></a>04624         }
<a name="l04625" id="l04625"></a>04625     }
<a name="l04626" id="l04626"></a>04626 
<a name="l04627" id="l04627"></a>04627     <a class="code" href="group__util.html#g951e93edb6f0ea941e26155e3f8912a6" title=
"Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(buf);
<a name="l04628" id="l04628"></a>04628 }
<a name="l04629" id="l04629"></a>04629 
<a name="l04630" id="l04630"></a>04630 <span class="keywordtype">int</span>
<a name="l04631" id="l04631"></a>04631 snprint_description(<span class="keywordtype">char</span> *buf, <span class=
"keywordtype">size_t</span> buf_len,
<a name="l04632" id="l04632"></a>04632                     oid * objid, <span class=
"keywordtype">size_t</span> objidlen, <span class="keywordtype">int</span> width)
<a name="l04633" id="l04633"></a>04633 {
<a name="l04634" id="l04634"></a>04634     <span class="keywordtype">size_t</span>          out_len = 0;
<a name="l04635" id="l04635"></a>04635 
<a name="l04636" id="l04636"></a>04636     <span class=
"keywordflow">if</span> (sprint_realloc_description((u_char **) &amp; buf, &amp;buf_len, &amp;out_len, 0,
<a name="l04637" id="l04637"></a>04637                                     objid, objidlen, width)) {
<a name="l04638" id="l04638"></a>04638         <span class="keywordflow">return</span> (<span class=
"keywordtype">int</span>) out_len;
<a name="l04639" id="l04639"></a>04639     } <span class="keywordflow">else</span> {
<a name="l04640" id="l04640"></a>04640         <span class="keywordflow">return</span> -1;
<a name="l04641" id="l04641"></a>04641     }
<a name="l04642" id="l04642"></a>04642 }
<a name="l04643" id="l04643"></a>04643 
<a name="l04644" id="l04644"></a>04644 <span class="keywordtype">int</span>
<a name="l04645" id="l04645"></a>04645 sprint_realloc_description(u_char ** buf, <span class=
"keywordtype">size_t</span> * buf_len,
<a name="l04646" id="l04646"></a>04646                      <span class="keywordtype">size_t</span> * out_len, <span class=
"keywordtype">int</span> allow_realloc,
<a name="l04647" id="l04647"></a>04647                      oid * objid, <span class=
"keywordtype">size_t</span> objidlen, <span class="keywordtype">int</span> width)
<a name="l04648" id="l04648"></a>04648 {
<a name="l04649" id="l04649"></a>04649     <span class=
"keyword">struct </span>tree    *tp = get_tree(objid, objidlen, tree_head);
<a name="l04650" id="l04650"></a>04650     <span class="keyword">struct </span>tree    *subtree = tree_head;
<a name="l04651" id="l04651"></a>04651     <span class="keywordtype">int</span>             pos, len;
<a name="l04652" id="l04652"></a>04652     <span class="keywordtype">char</span>            tmpbuf[128];
<a name="l04653" id="l04653"></a>04653     <span class="keyword">const</span> <span class="keywordtype">char</span>     *cp;
<a name="l04654" id="l04654"></a>04654 
<a name="l04655" id="l04655"></a>04655     <span class="keywordflow">if</span> (NULL == tp)
<a name="l04656" id="l04656"></a>04656         <span class="keywordflow">return</span> 0;
<a name="l04657" id="l04657"></a>04657 
<a name="l04658" id="l04658"></a>04658     <span class="keywordflow">if</span> (tp-&gt;type &lt;= TYPE_SIMPLE_LAST)
<a name="l04659" id="l04659"></a>04659         cp = <span class="stringliteral">" OBJECT-TYPE"</span>;
<a name="l04660" id="l04660"></a>04660     <span class="keywordflow">else</span>
<a name="l04661" id="l04661"></a>04661         <span class="keywordflow">switch</span> (tp-&gt;type) {
<a name="l04662" id="l04662"></a>04662         <span class="keywordflow">case</span> TYPE_TRAPTYPE:
<a name="l04663" id="l04663"></a>04663             cp = <span class="stringliteral">" TRAP-TYPE"</span>;
<a name="l04664" id="l04664"></a>04664             <span class="keywordflow">break</span>;
<a name="l04665" id="l04665"></a>04665         <span class="keywordflow">case</span> TYPE_NOTIFTYPE:
<a name="l04666" id="l04666"></a>04666             cp = <span class="stringliteral">" NOTIFICATION-TYPE"</span>;
<a name="l04667" id="l04667"></a>04667             <span class="keywordflow">break</span>;
<a name="l04668" id="l04668"></a>04668         <span class="keywordflow">case</span> TYPE_OBJGROUP:
<a name="l04669" id="l04669"></a>04669             cp = <span class="stringliteral">" OBJECT-GROUP"</span>;
<a name="l04670" id="l04670"></a>04670             <span class="keywordflow">break</span>;
<a name="l04671" id="l04671"></a>04671         <span class="keywordflow">case</span> TYPE_AGENTCAP:
<a name="l04672" id="l04672"></a>04672             cp = <span class="stringliteral">" AGENT-CAPABILITIES"</span>;
<a name="l04673" id="l04673"></a>04673             <span class="keywordflow">break</span>;
<a name="l04674" id="l04674"></a>04674         <span class="keywordflow">case</span> TYPE_MODID:
<a name="l04675" id="l04675"></a>04675             cp = <span class="stringliteral">" MODULE-IDENTITY"</span>;
<a name="l04676" id="l04676"></a>04676             <span class="keywordflow">break</span>;
<a name="l04677" id="l04677"></a>04677         <span class="keywordflow">case</span> TYPE_OBJIDENTITY:
<a name="l04678" id="l04678"></a>04678             cp = <span class="stringliteral">" OBJECT-IDENTITY"</span>;
<a name="l04679" id="l04679"></a>04679             <span class="keywordflow">break</span>;
<a name="l04680" id="l04680"></a>04680         <span class="keywordflow">case</span> TYPE_MODCOMP:
<a name="l04681" id="l04681"></a>04681             cp = <span class="stringliteral">" MODULE-COMPLIANCE"</span>;
<a name="l04682" id="l04682"></a>04682             <span class="keywordflow">break</span>;
<a name="l04683" id="l04683"></a>04683         <span class="keywordflow">default</span>:
<a name="l04684" id="l04684"></a>04684             sprintf(tmpbuf, <span class="stringliteral">" type_%d"</span>, tp-&gt;type);
<a name="l04685" id="l04685"></a>04685             cp = tmpbuf;
<a name="l04686" id="l04686"></a>04686         }
<a name="l04687" id="l04687"></a>04687 
<a name="l04688" id="l04688"></a>04688     <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, tp-&gt;label) ||
<a name="l04689" id="l04689"></a>04689         !snmp_cstrcat(buf, buf_len, out_len, allow_realloc, cp) ||
<a name="l04690" id="l04690"></a>04690         !snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class=
"stringliteral">"\n"</span>)) {
<a name="l04691" id="l04691"></a>04691         <span class="keywordflow">return</span> 0;
<a name="l04692" id="l04692"></a>04692     }
<a name="l04693" id="l04693"></a>04693     <span class=
"keywordflow">if</span> (!print_tree_node(buf, buf_len, out_len, allow_realloc, tp, width))
<a name="l04694" id="l04694"></a>04694         <span class="keywordflow">return</span> 0;
<a name="l04695" id="l04695"></a>04695     <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class="stringliteral">"::= {"</span>))
<a name="l04696" id="l04696"></a>04696         <span class="keywordflow">return</span> 0;
<a name="l04697" id="l04697"></a>04697     pos = 5;
<a name="l04698" id="l04698"></a>04698     <span class="keywordflow">while</span> (objidlen &gt; 1) {
<a name="l04699" id="l04699"></a>04699         <span class=
"keywordflow">for</span> (; subtree; subtree = subtree-&gt;next_peer) {
<a name="l04700" id="l04700"></a>04700             <span class="keywordflow">if</span> (*objid == subtree-&gt;subid) {
<a name="l04701" id="l04701"></a>04701                 <span class=
"keywordflow">while</span> (subtree-&gt;next_peer &amp;&amp; subtree-&gt;next_peer-&gt;subid == *objid)
<a name="l04702" id="l04702"></a>04702                     subtree = subtree-&gt;next_peer;
<a name="l04703" id="l04703"></a>04703                 <span class=
"keywordflow">if</span> (strncmp(subtree-&gt;label, ANON, ANON_LEN)) {
<a name="l04704" id="l04704"></a>04704                     snprintf(tmpbuf, <span class=
"keyword">sizeof</span>(tmpbuf), <span class="stringliteral">" %s(%lu)"</span>, subtree-&gt;label, subtree-&gt;subid);
<a name="l04705" id="l04705"></a>04705                     tmpbuf[ <span class="keyword">sizeof</span>(tmpbuf)-1 ] = 0;
<a name="l04706" id="l04706"></a>04706                 } <span class="keywordflow">else</span>
<a name="l04707" id="l04707"></a>04707                     sprintf(tmpbuf, <span class=
"stringliteral">" %lu"</span>, subtree-&gt;subid);
<a name="l04708" id="l04708"></a>04708                 len = strlen(tmpbuf);
<a name="l04709" id="l04709"></a>04709                 <span class="keywordflow">if</span> (pos + len + 2 &gt; width) {
<a name="l04710" id="l04710"></a>04710                     <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len,
<a name="l04711" id="l04711"></a>04711                                      allow_realloc, <span class=
"stringliteral">"\n     "</span>))
<a name="l04712" id="l04712"></a>04712                         <span class="keywordflow">return</span> 0;
<a name="l04713" id="l04713"></a>04713                     pos = 5;
<a name="l04714" id="l04714"></a>04714                 }
<a name="l04715" id="l04715"></a>04715                 <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, tmpbuf))
<a name="l04716" id="l04716"></a>04716                     <span class="keywordflow">return</span> 0;
<a name="l04717" id="l04717"></a>04717                 pos += len;
<a name="l04718" id="l04718"></a>04718                 objid++;
<a name="l04719" id="l04719"></a>04719                 objidlen--;
<a name="l04720" id="l04720"></a>04720                 <span class="keywordflow">break</span>;
<a name="l04721" id="l04721"></a>04721             }
<a name="l04722" id="l04722"></a>04722         }
<a name="l04723" id="l04723"></a>04723         <span class="keywordflow">if</span> (subtree)
<a name="l04724" id="l04724"></a>04724             subtree = subtree-&gt;child_list;
<a name="l04725" id="l04725"></a>04725         <span class="keywordflow">else</span>
<a name="l04726" id="l04726"></a>04726             <span class="keywordflow">break</span>;
<a name="l04727" id="l04727"></a>04727     }
<a name="l04728" id="l04728"></a>04728     <span class="keywordflow">while</span> (objidlen &gt; 1) {
<a name="l04729" id="l04729"></a>04729         sprintf(tmpbuf, <span class="stringliteral">" %lu"</span>, *objid);
<a name="l04730" id="l04730"></a>04730         len = strlen(tmpbuf);
<a name="l04731" id="l04731"></a>04731         <span class="keywordflow">if</span> (pos + len + 2 &gt; width) {
<a name="l04732" id="l04732"></a>04732             <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class="stringliteral">"\n     "</span>))
<a name="l04733" id="l04733"></a>04733                 <span class="keywordflow">return</span> 0;
<a name="l04734" id="l04734"></a>04734             pos = 5;
<a name="l04735" id="l04735"></a>04735         }
<a name="l04736" id="l04736"></a>04736         <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, tmpbuf))
<a name="l04737" id="l04737"></a>04737             <span class="keywordflow">return</span> 0;
<a name="l04738" id="l04738"></a>04738         pos += len;
<a name="l04739" id="l04739"></a>04739         objid++;
<a name="l04740" id="l04740"></a>04740         objidlen--;
<a name="l04741" id="l04741"></a>04741     }
<a name="l04742" id="l04742"></a>04742     sprintf(tmpbuf, <span class="stringliteral">" %lu }"</span>, *objid);
<a name="l04743" id="l04743"></a>04743     len = strlen(tmpbuf);
<a name="l04744" id="l04744"></a>04744     <span class="keywordflow">if</span> (pos + len + 2 &gt; width) {
<a name="l04745" id="l04745"></a>04745         <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class="stringliteral">"\n     "</span>))
<a name="l04746" id="l04746"></a>04746             <span class="keywordflow">return</span> 0;
<a name="l04747" id="l04747"></a>04747         pos = 5;
<a name="l04748" id="l04748"></a>04748     }
<a name="l04749" id="l04749"></a>04749     <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, tmpbuf))
<a name="l04750" id="l04750"></a>04750         <span class="keywordflow">return</span> 0;
<a name="l04751" id="l04751"></a>04751     <span class="keywordflow">return</span> 1;
<a name="l04752" id="l04752"></a>04752 }
<a name="l04753" id="l04753"></a>04753 
<a name="l04754" id="l04754"></a>04754 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l04755" id="l04755"></a>04755 print_tree_node(u_char ** buf, <span class="keywordtype">size_t</span> * buf_len,
<a name="l04756" id="l04756"></a>04756                      <span class="keywordtype">size_t</span> * out_len, <span class=
"keywordtype">int</span> allow_realloc,
<a name="l04757" id="l04757"></a>04757                      <span class="keyword">struct</span> tree *tp, <span class=
"keywordtype">int</span> width)
<a name="l04758" id="l04758"></a>04758 {
<a name="l04759" id="l04759"></a>04759     <span class="keyword">const</span> <span class="keywordtype">char</span>     *cp;
<a name="l04760" id="l04760"></a>04760     <span class="keywordtype">char</span>            str[MAXTOKEN];
<a name="l04761" id="l04761"></a>04761     <span class="keywordtype">int</span>             i, prevmod, pos, len;
<a name="l04762" id="l04762"></a>04762 
<a name="l04763" id="l04763"></a>04763     <span class="keywordflow">if</span> (tp) {
<a name="l04764" id="l04764"></a>04764         module_name(tp-&gt;modid, str);
<a name="l04765" id="l04765"></a>04765         <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class="stringliteral">"  -- FROM\t"</span>) ||
<a name="l04766" id="l04766"></a>04766             !snmp_cstrcat(buf, buf_len, out_len, allow_realloc, str))
<a name="l04767" id="l04767"></a>04767             <span class="keywordflow">return</span> 0;
<a name="l04768" id="l04768"></a>04768         pos = 16+strlen(str);
<a name="l04769" id="l04769"></a>04769         <span class=
"keywordflow">for</span> (i = 1, prevmod = tp-&gt;modid; i &lt; tp-&gt;number_modules; i++) {
<a name="l04770" id="l04770"></a>04770             <span class="keywordflow">if</span> (prevmod != tp-&gt;module_list[i]) {
<a name="l04771" id="l04771"></a>04771                 module_name(tp-&gt;module_list[i], str);
<a name="l04772" id="l04772"></a>04772                 len = strlen(str);
<a name="l04773" id="l04773"></a>04773                 <span class="keywordflow">if</span> (pos + len + 2 &gt; width) {
<a name="l04774" id="l04774"></a>04774                     <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc,
<a name="l04775" id="l04775"></a>04775                                      <span class="stringliteral">",\n  --\t\t"</span>))
<a name="l04776" id="l04776"></a>04776                         <span class="keywordflow">return</span> 0;
<a name="l04777" id="l04777"></a>04777                     pos = 16;
<a name="l04778" id="l04778"></a>04778                 }
<a name="l04779" id="l04779"></a>04779                 <span class="keywordflow">else</span> {
<a name="l04780" id="l04780"></a>04780                     <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class="stringliteral">", "</span>))
<a name="l04781" id="l04781"></a>04781                         <span class="keywordflow">return</span> 0;
<a name="l04782" id="l04782"></a>04782                     pos += 2;
<a name="l04783" id="l04783"></a>04783                 }
<a name="l04784" id="l04784"></a>04784                 <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, str))
<a name="l04785" id="l04785"></a>04785                     <span class="keywordflow">return</span> 0;
<a name="l04786" id="l04786"></a>04786                 pos += len;
<a name="l04787" id="l04787"></a>04787             }
<a name="l04788" id="l04788"></a>04788             prevmod = tp-&gt;module_list[i];
<a name="l04789" id="l04789"></a>04789         }
<a name="l04790" id="l04790"></a>04790         <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class="stringliteral">"\n"</span>))
<a name="l04791" id="l04791"></a>04791             <span class="keywordflow">return</span> 0;
<a name="l04792" id="l04792"></a>04792         <span class="keywordflow">if</span> (tp-&gt;tc_index != -1) {
<a name="l04793" id="l04793"></a>04793             <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc,
<a name="l04794" id="l04794"></a>04794                               <span class=
"stringliteral">"  -- TEXTUAL CONVENTION "</span>) ||
<a name="l04795" id="l04795"></a>04795                 !snmp_cstrcat(buf, buf_len, out_len, allow_realloc,
<a name="l04796" id="l04796"></a>04796                               get_tc_descriptor(tp-&gt;tc_index)) ||
<a name="l04797" id="l04797"></a>04797                 !snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class=
"stringliteral">"\n"</span>))
<a name="l04798" id="l04798"></a>04798                 <span class="keywordflow">return</span> 0;
<a name="l04799" id="l04799"></a>04799         }
<a name="l04800" id="l04800"></a>04800         <span class="keywordflow">switch</span> (tp-&gt;type) {
<a name="l04801" id="l04801"></a>04801         <span class="keywordflow">case</span> TYPE_OBJID:
<a name="l04802" id="l04802"></a>04802             cp = <span class="stringliteral">"OBJECT IDENTIFIER"</span>;
<a name="l04803" id="l04803"></a>04803             <span class="keywordflow">break</span>;
<a name="l04804" id="l04804"></a>04804         <span class="keywordflow">case</span> TYPE_OCTETSTR:
<a name="l04805" id="l04805"></a>04805             cp = <span class="stringliteral">"OCTET STRING"</span>;
<a name="l04806" id="l04806"></a>04806             <span class="keywordflow">break</span>;
<a name="l04807" id="l04807"></a>04807         <span class="keywordflow">case</span> TYPE_INTEGER:
<a name="l04808" id="l04808"></a>04808             cp = <span class="stringliteral">"INTEGER"</span>;
<a name="l04809" id="l04809"></a>04809             <span class="keywordflow">break</span>;
<a name="l04810" id="l04810"></a>04810         <span class="keywordflow">case</span> TYPE_NETADDR:
<a name="l04811" id="l04811"></a>04811             cp = <span class="stringliteral">"NetworkAddress"</span>;
<a name="l04812" id="l04812"></a>04812             <span class="keywordflow">break</span>;
<a name="l04813" id="l04813"></a>04813         <span class="keywordflow">case</span> TYPE_IPADDR:
<a name="l04814" id="l04814"></a>04814             cp = <span class="stringliteral">"IpAddress"</span>;
<a name="l04815" id="l04815"></a>04815             <span class="keywordflow">break</span>;
<a name="l04816" id="l04816"></a>04816         <span class="keywordflow">case</span> TYPE_COUNTER:
<a name="l04817" id="l04817"></a>04817             cp = <span class="stringliteral">"Counter32"</span>;
<a name="l04818" id="l04818"></a>04818             <span class="keywordflow">break</span>;
<a name="l04819" id="l04819"></a>04819         <span class="keywordflow">case</span> TYPE_GAUGE:
<a name="l04820" id="l04820"></a>04820             cp = <span class="stringliteral">"Gauge32"</span>;
<a name="l04821" id="l04821"></a>04821             <span class="keywordflow">break</span>;
<a name="l04822" id="l04822"></a>04822         <span class="keywordflow">case</span> TYPE_TIMETICKS:
<a name="l04823" id="l04823"></a>04823             cp = <span class="stringliteral">"TimeTicks"</span>;
<a name="l04824" id="l04824"></a>04824             <span class="keywordflow">break</span>;
<a name="l04825" id="l04825"></a>04825         <span class="keywordflow">case</span> TYPE_OPAQUE:
<a name="l04826" id="l04826"></a>04826             cp = <span class="stringliteral">"Opaque"</span>;
<a name="l04827" id="l04827"></a>04827             <span class="keywordflow">break</span>;
<a name="l04828" id="l04828"></a>04828         <span class="keywordflow">case</span> TYPE_NULL:
<a name="l04829" id="l04829"></a>04829             cp = <span class="stringliteral">"NULL"</span>;
<a name="l04830" id="l04830"></a>04830             <span class="keywordflow">break</span>;
<a name="l04831" id="l04831"></a>04831         <span class="keywordflow">case</span> TYPE_COUNTER64:
<a name="l04832" id="l04832"></a>04832             cp = <span class="stringliteral">"Counter64"</span>;
<a name="l04833" id="l04833"></a>04833             <span class="keywordflow">break</span>;
<a name="l04834" id="l04834"></a>04834         <span class="keywordflow">case</span> TYPE_BITSTRING:
<a name="l04835" id="l04835"></a>04835             cp = <span class="stringliteral">"BITS"</span>;
<a name="l04836" id="l04836"></a>04836             <span class="keywordflow">break</span>;
<a name="l04837" id="l04837"></a>04837         <span class="keywordflow">case</span> TYPE_NSAPADDRESS:
<a name="l04838" id="l04838"></a>04838             cp = <span class="stringliteral">"NsapAddress"</span>;
<a name="l04839" id="l04839"></a>04839             <span class="keywordflow">break</span>;
<a name="l04840" id="l04840"></a>04840         <span class="keywordflow">case</span> TYPE_UINTEGER:
<a name="l04841" id="l04841"></a>04841             cp = <span class="stringliteral">"UInteger32"</span>;
<a name="l04842" id="l04842"></a>04842             <span class="keywordflow">break</span>;
<a name="l04843" id="l04843"></a>04843         <span class="keywordflow">case</span> TYPE_UNSIGNED32:
<a name="l04844" id="l04844"></a>04844             cp = <span class="stringliteral">"Unsigned32"</span>;
<a name="l04845" id="l04845"></a>04845             <span class="keywordflow">break</span>;
<a name="l04846" id="l04846"></a>04846         <span class="keywordflow">case</span> TYPE_INTEGER32:
<a name="l04847" id="l04847"></a>04847             cp = <span class="stringliteral">"Integer32"</span>;
<a name="l04848" id="l04848"></a>04848             <span class="keywordflow">break</span>;
<a name="l04849" id="l04849"></a>04849         <span class="keywordflow">default</span>:
<a name="l04850" id="l04850"></a>04850             cp = NULL;
<a name="l04851" id="l04851"></a>04851             <span class="keywordflow">break</span>;
<a name="l04852" id="l04852"></a>04852         }
<a name="l04853" id="l04853"></a>04853 <span class="preprocessor">#if NETSNMP_ENABLE_TESTING_CODE</span>
<a name="l04854" id="l04854"></a>04854         <span class=
"keywordflow">if</span> (!cp &amp;&amp; (tp-&gt;ranges || tp-&gt;enums)) { <span class=
"comment">/* ranges without type ? */</span>
<a name="l04855" id="l04855"></a>04855             sprintf(str, <span class="stringliteral">"?0 with %s %s ?"</span>,
<a name="l04856" id="l04856"></a>04856                     tp-&gt;ranges ? <span class=
"stringliteral">"Range"</span> : <span class="stringliteral">""</span>, tp-&gt;enums ? <span class=
"stringliteral">"Enum"</span> : <span class="stringliteral">""</span>);
<a name="l04857" id="l04857"></a>04857             cp = str;
<a name="l04858" id="l04858"></a>04858         }
<a name="l04859" id="l04859"></a>04859 <span class="preprocessor">#endif                          </span><span class=
"comment">/* NETSNMP_ENABLE_TESTING_CODE */</span>
<a name="l04860" id="l04860"></a>04860         <span class="keywordflow">if</span> (cp)
<a name="l04861" id="l04861"></a>04861             <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc,
<a name="l04862" id="l04862"></a>04862                              <span class="stringliteral">"  SYNTAX\t"</span>) ||
<a name="l04863" id="l04863"></a>04863                 !snmp_cstrcat(buf, buf_len, out_len, allow_realloc, cp))
<a name="l04864" id="l04864"></a>04864                 <span class="keywordflow">return</span> 0;
<a name="l04865" id="l04865"></a>04865         <span class="keywordflow">if</span> (tp-&gt;ranges) {
<a name="l04866" id="l04866"></a>04866             <span class="keyword">struct </span>range_list *rp = tp-&gt;ranges;
<a name="l04867" id="l04867"></a>04867             <span class="keywordtype">int</span>             first = 1;
<a name="l04868" id="l04868"></a>04868             <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class="stringliteral">" ("</span>))
<a name="l04869" id="l04869"></a>04869                 <span class="keywordflow">return</span> 0;
<a name="l04870" id="l04870"></a>04870             <span class="keywordflow">while</span> (rp) {
<a name="l04871" id="l04871"></a>04871                 <span class="keywordflow">if</span> (rp-&gt;low == rp-&gt;high)
<a name="l04872" id="l04872"></a>04872                     sprintf(str, <span class=
"stringliteral">"%s%d"</span>, (first ? <span class="stringliteral">""</span> : <span class=
"stringliteral">" | "</span>), rp-&gt;low );
<a name="l04873" id="l04873"></a>04873                 <span class="keywordflow">else</span>
<a name="l04874" id="l04874"></a>04874                     sprintf(str, <span class=
"stringliteral">"%s%d..%d"</span>, (first ? <span class="stringliteral">""</span> : <span class="stringliteral">" | "</span>),
<a name="l04875" id="l04875"></a>04875                                               rp-&gt;low, rp-&gt;high);
<a name="l04876" id="l04876"></a>04876                 <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, str))
<a name="l04877" id="l04877"></a>04877                     <span class="keywordflow">return</span> 0;
<a name="l04878" id="l04878"></a>04878                 <span class="keywordflow">if</span> (first)
<a name="l04879" id="l04879"></a>04879                     first = 0;
<a name="l04880" id="l04880"></a>04880                 rp = rp-&gt;next;
<a name="l04881" id="l04881"></a>04881             }
<a name="l04882" id="l04882"></a>04882             <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class="stringliteral">") "</span>))
<a name="l04883" id="l04883"></a>04883                 <span class="keywordflow">return</span> 0;
<a name="l04884" id="l04884"></a>04884         }
<a name="l04885" id="l04885"></a>04885         <span class="keywordflow">if</span> (tp-&gt;enums) {
<a name="l04886" id="l04886"></a>04886             <span class="keyword">struct </span>enum_list *ep = tp-&gt;enums;
<a name="l04887" id="l04887"></a>04887             <span class="keywordtype">int</span>             first = 1;
<a name="l04888" id="l04888"></a>04888             <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class="stringliteral">" {"</span>))
<a name="l04889" id="l04889"></a>04889                 <span class="keywordflow">return</span> 0;
<a name="l04890" id="l04890"></a>04890             pos = 16 + strlen(cp) + 2;
<a name="l04891" id="l04891"></a>04891             <span class="keywordflow">while</span> (ep) {
<a name="l04892" id="l04892"></a>04892                 <span class="keywordflow">if</span> (first)
<a name="l04893" id="l04893"></a>04893                     first = 0;
<a name="l04894" id="l04894"></a>04894                 <span class="keywordflow">else</span>
<a name="l04895" id="l04895"></a>04895                     <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class="stringliteral">", "</span>))
<a name="l04896" id="l04896"></a>04896                         <span class="keywordflow">return</span> 0;
<a name="l04897" id="l04897"></a>04897                 snprintf(str, <span class="keyword">sizeof</span>(str), <span class=
"stringliteral">"%s(%d)"</span>, ep-&gt;label, ep-&gt;value);
<a name="l04898" id="l04898"></a>04898                 str[ <span class="keyword">sizeof</span>(str)-1 ] = 0;
<a name="l04899" id="l04899"></a>04899                 len = strlen(str);
<a name="l04900" id="l04900"></a>04900                 <span class="keywordflow">if</span> (pos + len + 2 &gt; width) {
<a name="l04901" id="l04901"></a>04901                     <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len,
<a name="l04902" id="l04902"></a>04902                                      allow_realloc, <span class=
"stringliteral">"\n\t\t  "</span>))
<a name="l04903" id="l04903"></a>04903                         <span class="keywordflow">return</span> 0;
<a name="l04904" id="l04904"></a>04904                     pos = 18;
<a name="l04905" id="l04905"></a>04905                 }
<a name="l04906" id="l04906"></a>04906                 <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, str))
<a name="l04907" id="l04907"></a>04907                     <span class="keywordflow">return</span> 0;
<a name="l04908" id="l04908"></a>04908                 pos += len + 2;
<a name="l04909" id="l04909"></a>04909                 ep = ep-&gt;next;
<a name="l04910" id="l04910"></a>04910             }
<a name="l04911" id="l04911"></a>04911             <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class="stringliteral">"} "</span>))
<a name="l04912" id="l04912"></a>04912                 <span class="keywordflow">return</span> 0;
<a name="l04913" id="l04913"></a>04913         }
<a name="l04914" id="l04914"></a>04914         <span class="keywordflow">if</span> (cp)
<a name="l04915" id="l04915"></a>04915             <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class="stringliteral">"\n"</span>))
<a name="l04916" id="l04916"></a>04916                 <span class="keywordflow">return</span> 0;
<a name="l04917" id="l04917"></a>04917         <span class="keywordflow">if</span> (tp-&gt;hint)
<a name="l04918" id="l04918"></a>04918             <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc,
<a name="l04919" id="l04919"></a>04919                              <span class="stringliteral">"  DISPLAY-HINT\t\""</span>) ||
<a name="l04920" id="l04920"></a>04920                 !snmp_cstrcat(buf, buf_len, out_len, allow_realloc, tp-&gt;hint) ||
<a name="l04921" id="l04921"></a>04921                 !snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class=
"stringliteral">"\"\n"</span>))
<a name="l04922" id="l04922"></a>04922                 <span class="keywordflow">return</span> 0;
<a name="l04923" id="l04923"></a>04923         <span class="keywordflow">if</span> (tp-&gt;units)
<a name="l04924" id="l04924"></a>04924             <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc,
<a name="l04925" id="l04925"></a>04925                              <span class="stringliteral">"  UNITS\t\t\""</span>) ||
<a name="l04926" id="l04926"></a>04926                 !snmp_cstrcat(buf, buf_len, out_len, allow_realloc, tp-&gt;units) ||
<a name="l04927" id="l04927"></a>04927                 !snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class=
"stringliteral">"\"\n"</span>))
<a name="l04928" id="l04928"></a>04928                 <span class="keywordflow">return</span> 0;
<a name="l04929" id="l04929"></a>04929         <span class="keywordflow">switch</span> (tp-&gt;access) {
<a name="l04930" id="l04930"></a>04930         <span class="keywordflow">case</span> MIB_ACCESS_READONLY:
<a name="l04931" id="l04931"></a>04931             cp = <span class="stringliteral">"read-only"</span>;
<a name="l04932" id="l04932"></a>04932             <span class="keywordflow">break</span>;
<a name="l04933" id="l04933"></a>04933         <span class="keywordflow">case</span> MIB_ACCESS_READWRITE:
<a name="l04934" id="l04934"></a>04934             cp = <span class="stringliteral">"read-write"</span>;
<a name="l04935" id="l04935"></a>04935             <span class="keywordflow">break</span>;
<a name="l04936" id="l04936"></a>04936         <span class="keywordflow">case</span> MIB_ACCESS_WRITEONLY:
<a name="l04937" id="l04937"></a>04937             cp = <span class="stringliteral">"write-only"</span>;
<a name="l04938" id="l04938"></a>04938             <span class="keywordflow">break</span>;
<a name="l04939" id="l04939"></a>04939         <span class="keywordflow">case</span> MIB_ACCESS_NOACCESS:
<a name="l04940" id="l04940"></a>04940             cp = <span class="stringliteral">"not-accessible"</span>;
<a name="l04941" id="l04941"></a>04941             <span class="keywordflow">break</span>;
<a name="l04942" id="l04942"></a>04942         <span class="keywordflow">case</span> MIB_ACCESS_NOTIFY:
<a name="l04943" id="l04943"></a>04943             cp = <span class="stringliteral">"accessible-for-notify"</span>;
<a name="l04944" id="l04944"></a>04944             <span class="keywordflow">break</span>;
<a name="l04945" id="l04945"></a>04945         <span class="keywordflow">case</span> MIB_ACCESS_CREATE:
<a name="l04946" id="l04946"></a>04946             cp = <span class="stringliteral">"read-create"</span>;
<a name="l04947" id="l04947"></a>04947             <span class="keywordflow">break</span>;
<a name="l04948" id="l04948"></a>04948         <span class="keywordflow">case</span> 0:
<a name="l04949" id="l04949"></a>04949             cp = NULL;
<a name="l04950" id="l04950"></a>04950             <span class="keywordflow">break</span>;
<a name="l04951" id="l04951"></a>04951         <span class="keywordflow">default</span>:
<a name="l04952" id="l04952"></a>04952             sprintf(str, <span class="stringliteral">"access_%d"</span>, tp-&gt;access);
<a name="l04953" id="l04953"></a>04953             cp = str;
<a name="l04954" id="l04954"></a>04954         }
<a name="l04955" id="l04955"></a>04955         <span class="keywordflow">if</span> (cp)
<a name="l04956" id="l04956"></a>04956             <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc,
<a name="l04957" id="l04957"></a>04957                              <span class="stringliteral">"  MAX-ACCESS\t"</span>) ||
<a name="l04958" id="l04958"></a>04958                 !snmp_cstrcat(buf, buf_len, out_len, allow_realloc, cp) ||
<a name="l04959" id="l04959"></a>04959                 !snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class=
"stringliteral">"\n"</span>))
<a name="l04960" id="l04960"></a>04960                 <span class="keywordflow">return</span> 0;
<a name="l04961" id="l04961"></a>04961         <span class="keywordflow">switch</span> (tp-&gt;status) {
<a name="l04962" id="l04962"></a>04962         <span class="keywordflow">case</span> MIB_STATUS_MANDATORY:
<a name="l04963" id="l04963"></a>04963             cp = <span class="stringliteral">"mandatory"</span>;
<a name="l04964" id="l04964"></a>04964             <span class="keywordflow">break</span>;
<a name="l04965" id="l04965"></a>04965         <span class="keywordflow">case</span> MIB_STATUS_OPTIONAL:
<a name="l04966" id="l04966"></a>04966             cp = <span class="stringliteral">"optional"</span>;
<a name="l04967" id="l04967"></a>04967             <span class="keywordflow">break</span>;
<a name="l04968" id="l04968"></a>04968         <span class="keywordflow">case</span> MIB_STATUS_OBSOLETE:
<a name="l04969" id="l04969"></a>04969             cp = <span class="stringliteral">"obsolete"</span>;
<a name="l04970" id="l04970"></a>04970             <span class="keywordflow">break</span>;
<a name="l04971" id="l04971"></a>04971         <span class="keywordflow">case</span> MIB_STATUS_DEPRECATED:
<a name="l04972" id="l04972"></a>04972             cp = <span class="stringliteral">"deprecated"</span>;
<a name="l04973" id="l04973"></a>04973             <span class="keywordflow">break</span>;
<a name="l04974" id="l04974"></a>04974         <span class="keywordflow">case</span> MIB_STATUS_CURRENT:
<a name="l04975" id="l04975"></a>04975             cp = <span class="stringliteral">"current"</span>;
<a name="l04976" id="l04976"></a>04976             <span class="keywordflow">break</span>;
<a name="l04977" id="l04977"></a>04977         <span class="keywordflow">case</span> 0:
<a name="l04978" id="l04978"></a>04978             cp = NULL;
<a name="l04979" id="l04979"></a>04979             <span class="keywordflow">break</span>;
<a name="l04980" id="l04980"></a>04980         <span class="keywordflow">default</span>:
<a name="l04981" id="l04981"></a>04981             sprintf(str, <span class="stringliteral">"status_%d"</span>, tp-&gt;status);
<a name="l04982" id="l04982"></a>04982             cp = str;
<a name="l04983" id="l04983"></a>04983         }
<a name="l04984" id="l04984"></a>04984 <span class="preprocessor">#if NETSNMP_ENABLE_TESTING_CODE</span>
<a name="l04985" id="l04985"></a>04985         <span class=
"keywordflow">if</span> (!cp &amp;&amp; (tp-&gt;indexes)) {     <span class="comment">/* index without status ? */</span>
<a name="l04986" id="l04986"></a>04986             sprintf(str, <span class=
"stringliteral">"?0 with %s ?"</span>, tp-&gt;indexes ? <span class="stringliteral">"Index"</span> : <span class=
"stringliteral">""</span>);
<a name="l04987" id="l04987"></a>04987             cp = str;
<a name="l04988" id="l04988"></a>04988         }
<a name="l04989" id="l04989"></a>04989 <span class="preprocessor">#endif                          </span><span class=
"comment">/* NETSNMP_ENABLE_TESTING_CODE */</span>
<a name="l04990" id="l04990"></a>04990         <span class="keywordflow">if</span> (cp)
<a name="l04991" id="l04991"></a>04991             <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc,
<a name="l04992" id="l04992"></a>04992                              <span class="stringliteral">"  STATUS\t"</span>) ||
<a name="l04993" id="l04993"></a>04993                 !snmp_cstrcat(buf, buf_len, out_len, allow_realloc, cp) ||
<a name="l04994" id="l04994"></a>04994                 !snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class=
"stringliteral">"\n"</span>))
<a name="l04995" id="l04995"></a>04995                 <span class="keywordflow">return</span> 0;
<a name="l04996" id="l04996"></a>04996         <span class="keywordflow">if</span> (tp-&gt;augments)
<a name="l04997" id="l04997"></a>04997             <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc,
<a name="l04998" id="l04998"></a>04998                              <span class="stringliteral">"  AUGMENTS\t{ "</span>) ||
<a name="l04999" id="l04999"></a>04999                 !snmp_cstrcat(buf, buf_len, out_len, allow_realloc, tp-&gt;augments) ||
<a name="l05000" id="l05000"></a>05000                 !snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class=
"stringliteral">" }\n"</span>))
<a name="l05001" id="l05001"></a>05001                 <span class="keywordflow">return</span> 0;
<a name="l05002" id="l05002"></a>05002         <span class="keywordflow">if</span> (tp-&gt;indexes) {
<a name="l05003" id="l05003"></a>05003             <span class="keyword">struct </span>index_list *ip = tp-&gt;indexes;
<a name="l05004" id="l05004"></a>05004             <span class="keywordtype">int</span>             first = 1;
<a name="l05005" id="l05005"></a>05005             <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc,
<a name="l05006" id="l05006"></a>05006                              <span class="stringliteral">"  INDEX\t\t{ "</span>))
<a name="l05007" id="l05007"></a>05007                 <span class="keywordflow">return</span> 0;
<a name="l05008" id="l05008"></a>05008             pos = 16 + 2;
<a name="l05009" id="l05009"></a>05009             <span class="keywordflow">while</span> (ip) {
<a name="l05010" id="l05010"></a>05010                 <span class="keywordflow">if</span> (first)
<a name="l05011" id="l05011"></a>05011                     first = 0;
<a name="l05012" id="l05012"></a>05012                 <span class="keywordflow">else</span>
<a name="l05013" id="l05013"></a>05013                     <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class="stringliteral">", "</span>))
<a name="l05014" id="l05014"></a>05014                         <span class="keywordflow">return</span> 0;
<a name="l05015" id="l05015"></a>05015                 snprintf(str, <span class="keyword">sizeof</span>(str), <span class=
"stringliteral">"%s%s"</span>,
<a name="l05016" id="l05016"></a>05016                         ip-&gt;isimplied ? <span class=
"stringliteral">"IMPLIED "</span> : <span class="stringliteral">""</span>,
<a name="l05017" id="l05017"></a>05017                         ip-&gt;ilabel);
<a name="l05018" id="l05018"></a>05018                 str[ <span class="keyword">sizeof</span>(str)-1 ] = 0;
<a name="l05019" id="l05019"></a>05019                 len = strlen(str);
<a name="l05020" id="l05020"></a>05020                 <span class="keywordflow">if</span> (pos + len + 2 &gt; width) {
<a name="l05021" id="l05021"></a>05021                     <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class="stringliteral">"\n\t\t  "</span>))
<a name="l05022" id="l05022"></a>05022                         <span class="keywordflow">return</span> 0;
<a name="l05023" id="l05023"></a>05023                     pos = 16 + 2;
<a name="l05024" id="l05024"></a>05024                 }
<a name="l05025" id="l05025"></a>05025                 <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, str))
<a name="l05026" id="l05026"></a>05026                     <span class="keywordflow">return</span> 0;
<a name="l05027" id="l05027"></a>05027                 pos += len + 2;
<a name="l05028" id="l05028"></a>05028                 ip = ip-&gt;next;
<a name="l05029" id="l05029"></a>05029             }
<a name="l05030" id="l05030"></a>05030             <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class="stringliteral">" }\n"</span>))
<a name="l05031" id="l05031"></a>05031                 <span class="keywordflow">return</span> 0;
<a name="l05032" id="l05032"></a>05032         }
<a name="l05033" id="l05033"></a>05033         <span class="keywordflow">if</span> (tp-&gt;varbinds) {
<a name="l05034" id="l05034"></a>05034             <span class="keyword">struct </span>varbind_list *vp = tp-&gt;varbinds;
<a name="l05035" id="l05035"></a>05035             <span class="keywordtype">int</span>             first = 1;
<a name="l05036" id="l05036"></a>05036 
<a name="l05037" id="l05037"></a>05037             <span class="keywordflow">if</span> (tp-&gt;type == TYPE_TRAPTYPE) {
<a name="l05038" id="l05038"></a>05038                 <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc,
<a name="l05039" id="l05039"></a>05039                     <span class="stringliteral">"  VARIABLES\t{ "</span>))
<a name="l05040" id="l05040"></a>05040                     <span class="keywordflow">return</span> 0;
<a name="l05041" id="l05041"></a>05041             } <span class="keywordflow">else</span> {
<a name="l05042" id="l05042"></a>05042                 <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc,
<a name="l05043" id="l05043"></a>05043                     <span class="stringliteral">"  OBJECTS\t{ "</span>))
<a name="l05044" id="l05044"></a>05044                     <span class="keywordflow">return</span> 0;
<a name="l05045" id="l05045"></a>05045             }
<a name="l05046" id="l05046"></a>05046             pos = 16 + 2;
<a name="l05047" id="l05047"></a>05047             <span class="keywordflow">while</span> (vp) {
<a name="l05048" id="l05048"></a>05048                 <span class="keywordflow">if</span> (first)
<a name="l05049" id="l05049"></a>05049                     first = 0;
<a name="l05050" id="l05050"></a>05050                 <span class="keywordflow">else</span>
<a name="l05051" id="l05051"></a>05051                     <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class="stringliteral">", "</span>))
<a name="l05052" id="l05052"></a>05052                         <span class="keywordflow">return</span> 0;
<a name="l05053" id="l05053"></a>05053                 snprintf(str, <span class="keyword">sizeof</span>(str), <span class=
"stringliteral">"%s"</span>, vp-&gt;vblabel);
<a name="l05054" id="l05054"></a>05054                 str[ <span class="keyword">sizeof</span>(str)-1 ] = 0;
<a name="l05055" id="l05055"></a>05055                 len = strlen(str);
<a name="l05056" id="l05056"></a>05056                 <span class="keywordflow">if</span> (pos + len + 2 &gt; width) {
<a name="l05057" id="l05057"></a>05057                     <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc,
<a name="l05058" id="l05058"></a>05058                                     <span class="stringliteral">"\n\t\t  "</span>))
<a name="l05059" id="l05059"></a>05059                         <span class="keywordflow">return</span> 0;
<a name="l05060" id="l05060"></a>05060                     pos = 16 + 2;
<a name="l05061" id="l05061"></a>05061                 }
<a name="l05062" id="l05062"></a>05062                 <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, str))
<a name="l05063" id="l05063"></a>05063                     <span class="keywordflow">return</span> 0;
<a name="l05064" id="l05064"></a>05064                 pos += len + 2;
<a name="l05065" id="l05065"></a>05065                 vp = vp-&gt;next;
<a name="l05066" id="l05066"></a>05066             }
<a name="l05067" id="l05067"></a>05067             <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class="stringliteral">" }\n"</span>))
<a name="l05068" id="l05068"></a>05068                 <span class="keywordflow">return</span> 0;
<a name="l05069" id="l05069"></a>05069         }
<a name="l05070" id="l05070"></a>05070         <span class="keywordflow">if</span> (tp-&gt;description)
<a name="l05071" id="l05071"></a>05071             <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc,
<a name="l05072" id="l05072"></a>05072                               <span class="stringliteral">"  DESCRIPTION\t\""</span>) ||
<a name="l05073" id="l05073"></a>05073                 !snmp_cstrcat(buf, buf_len, out_len, allow_realloc, tp-&gt;description) ||
<a name="l05074" id="l05074"></a>05074                 !snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class=
"stringliteral">"\"\n"</span>))
<a name="l05075" id="l05075"></a>05075                 <span class="keywordflow">return</span> 0;
<a name="l05076" id="l05076"></a>05076         <span class="keywordflow">if</span> (tp-&gt;defaultValue)
<a name="l05077" id="l05077"></a>05077             <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc,
<a name="l05078" id="l05078"></a>05078                               <span class="stringliteral">"  DEFVAL\t{ "</span>) ||
<a name="l05079" id=
"l05079"></a>05079                 !snmp_cstrcat(buf, buf_len, out_len, allow_realloc, tp-&gt;defaultValue) ||
<a name="l05080" id="l05080"></a>05080                 !snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class=
"stringliteral">" }\n"</span>))
<a name="l05081" id="l05081"></a>05081                 <span class="keywordflow">return</span> 0;
<a name="l05082" id="l05082"></a>05082     } <span class="keywordflow">else</span>
<a name="l05083" id="l05083"></a>05083         <span class=
"keywordflow">if</span> (!snmp_cstrcat(buf, buf_len, out_len, allow_realloc, <span class=
"stringliteral">"No description\n"</span>))
<a name="l05084" id="l05084"></a>05084             <span class="keywordflow">return</span> 0;
<a name="l05085" id="l05085"></a>05085     <span class="keywordflow">return</span> 1;
<a name="l05086" id="l05086"></a>05086 }
<a name="l05087" id="l05087"></a>05087 
<a name="l05088" id="l05088"></a>05088 <span class="keywordtype">int</span>
<a name="l05089" id="l05089"></a>05089 get_module_node(<span class="keyword">const</span> <span class=
"keywordtype">char</span> *fname,
<a name="l05090" id="l05090"></a>05090                 <span class="keyword">const</span> <span class=
"keywordtype">char</span> *module, oid * objid, <span class="keywordtype">size_t</span> * objidlen)
<a name="l05091" id="l05091"></a>05091 {
<a name="l05092" id="l05092"></a>05092     <span class="keywordtype">int</span>             modid, rc = 0;
<a name="l05093" id="l05093"></a>05093     <span class="keyword">struct </span>tree    *tp;
<a name="l05094" id="l05094"></a>05094     <span class="keywordtype">char</span>           *name, *cp;
<a name="l05095" id="l05095"></a>05095 
<a name="l05096" id="l05096"></a>05096     <span class="keywordflow">if</span> (!strcmp(module, <span class=
"stringliteral">"ANY"</span>))
<a name="l05097" id="l05097"></a>05097         modid = -1;
<a name="l05098" id="l05098"></a>05098     <span class="keywordflow">else</span> {
<a name="l05099" id="l05099"></a>05099         netsnmp_read_module(module);
<a name="l05100" id="l05100"></a>05100         modid = which_module(module);
<a name="l05101" id="l05101"></a>05101         <span class="keywordflow">if</span> (modid == -1)
<a name="l05102" id="l05102"></a>05102             <span class="keywordflow">return</span> 0;
<a name="l05103" id="l05103"></a>05103     }
<a name="l05104" id="l05104"></a>05104 
<a name="l05105" id="l05105"></a>05105     <span class="comment">/*</span>
<a name="l05106" id="l05106"></a>05106 <span class="comment">     * Isolate the first component of the name ... </span>
<a name="l05107" id="l05107"></a>05107 <span class="comment">     */</span>
<a name="l05108" id="l05108"></a>05108     name = strdup(fname);
<a name="l05109" id="l05109"></a>05109     cp = strchr(name, <span class="charliteral">'.'</span>);
<a name="l05110" id="l05110"></a>05110     <span class="keywordflow">if</span> (cp != NULL) {
<a name="l05111" id="l05111"></a>05111         *cp = <span class="charliteral">'\0'</span>;
<a name="l05112" id="l05112"></a>05112         cp++;
<a name="l05113" id="l05113"></a>05113     }
<a name="l05114" id="l05114"></a>05114     <span class="comment">/*</span>
<a name="l05115" id="l05115"></a>05115 <span class="comment">     * ... and locate it in the tree. </span>
<a name="l05116" id="l05116"></a>05116 <span class="comment">     */</span>
<a name="l05117" id="l05117"></a>05117     tp = find_tree_node(name, modid);
<a name="l05118" id="l05118"></a>05118     <span class="keywordflow">if</span> (tp) {
<a name="l05119" id="l05119"></a>05119         <span class="keywordtype">size_t</span>          maxlen = *objidlen;
<a name="l05120" id="l05120"></a>05120 
<a name="l05121" id="l05121"></a>05121         <span class="comment">/*</span>
<a name="l05122" id="l05122"></a>05122 <span class="comment">         * Set the first element of the object ID </span>
<a name="l05123" id="l05123"></a>05123 <span class="comment">         */</span>
<a name="l05124" id="l05124"></a>05124         <span class="keywordflow">if</span> (node_to_oid(tp, objid, objidlen)) {
<a name="l05125" id="l05125"></a>05125             rc = 1;
<a name="l05126" id="l05126"></a>05126 
<a name="l05127" id="l05127"></a>05127             <span class="comment">/*</span>
<a name="l05128" id="l05128"></a>05128 <span class=
"comment">             * If the name requested was more than one element,</span>
<a name="l05129" id="l05129"></a>05129 <span class="comment">             * tag on the rest of the components </span>
<a name="l05130" id="l05130"></a>05130 <span class="comment">             */</span>
<a name="l05131" id="l05131"></a>05131             <span class="keywordflow">if</span> (cp != NULL)
<a name="l05132" id="l05132"></a>05132                 rc = _add_strings_to_oid(tp, cp, objid, objidlen, maxlen);
<a name="l05133" id="l05133"></a>05133         }
<a name="l05134" id="l05134"></a>05134     }
<a name="l05135" id="l05135"></a>05135 
<a name="l05136" id="l05136"></a>05136     <a class="code" href="group__util.html#g951e93edb6f0ea941e26155e3f8912a6" title=
"Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(name);
<a name="l05137" id="l05137"></a>05137     <span class="keywordflow">return</span> (rc);
<a name="l05138" id="l05138"></a>05138 }
<a name="l05139" id="l05139"></a>05139 
<a name="l05140" id="l05140"></a>05140 
<a name="l05158" id="l05158"></a>05158 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l05159" id="l05159"></a>05159 node_to_oid(<span class="keyword">struct</span> tree *tp, oid * objid, <span class=
"keywordtype">size_t</span> * objidlen)
<a name="l05160" id="l05160"></a>05160 {
<a name="l05161" id="l05161"></a>05161     <span class="keywordtype">int</span>             numids, lenids;
<a name="l05162" id="l05162"></a>05162     oid            *op;
<a name="l05163" id="l05163"></a>05163 
<a name="l05164" id="l05164"></a>05164     <span class="keywordflow">if</span> (!tp || !objid || !objidlen)
<a name="l05165" id="l05165"></a>05165         <span class="keywordflow">return</span> 0;
<a name="l05166" id="l05166"></a>05166 
<a name="l05167" id="l05167"></a>05167     lenids = (int) *objidlen;
<a name="l05168" id="l05168"></a>05168     op = objid + lenids;        <span class=
"comment">/* points after the last element */</span>
<a name="l05169" id="l05169"></a>05169 
<a name="l05170" id="l05170"></a>05170     <span class="keywordflow">for</span> (numids = 0; tp; tp = tp-&gt;parent, numids++) {
<a name="l05171" id="l05171"></a>05171         <span class="keywordflow">if</span> (numids &gt;= lenids)
<a name="l05172" id="l05172"></a>05172             <span class="keywordflow">continue</span>;
<a name="l05173" id="l05173"></a>05173         --op;
<a name="l05174" id="l05174"></a>05174         *op = tp-&gt;subid;
<a name="l05175" id="l05175"></a>05175     }
<a name="l05176" id="l05176"></a>05176 
<a name="l05177" id="l05177"></a>05177     *objidlen = (size_t) numids;
<a name="l05178" id="l05178"></a>05178     <span class="keywordflow">if</span> (numids &gt; lenids) {
<a name="l05179" id="l05179"></a>05179         <span class="keywordflow">return</span> 0;
<a name="l05180" id="l05180"></a>05180     }
<a name="l05181" id="l05181"></a>05181 
<a name="l05182" id="l05182"></a>05182     <span class="keywordflow">if</span> (numids &lt; lenids)
<a name="l05183" id="l05183"></a>05183         memmove(objid, op, numids * <span class="keyword">sizeof</span>(oid));
<a name="l05184" id="l05184"></a>05184 
<a name="l05185" id="l05185"></a>05185     <span class="keywordflow">return</span> (numids);
<a name="l05186" id="l05186"></a>05186 }
<a name="l05187" id="l05187"></a>05187 <span class="preprocessor">#endif </span><span class=
"comment">/* NETSNMP_DISABLE_MIB_LOADING */</span>
<a name="l05188" id="l05188"></a>05188 
<a name="l05189" id="l05189"></a>05189 <span class="comment">/*</span>
<a name="l05190" id="l05190"></a>05190 <span class="comment"> * Replace \x with x stop at eos_marker</span>
<a name="l05191" id="l05191"></a>05191 <span class="comment"> * return NULL if eos_marker not found</span>
<a name="l05192" id="l05192"></a>05192 <span class="comment"> */</span>
<a name="l05193" id="l05193"></a>05193 <span class="keyword">static</span> <span class=
"keywordtype">char</span> *_apply_escapes(<span class="keywordtype">char</span> *src, <span class=
"keywordtype">char</span> eos_marker)
<a name="l05194" id="l05194"></a>05194 {
<a name="l05195" id="l05195"></a>05195     <span class="keywordtype">char</span> *dst;
<a name="l05196" id="l05196"></a>05196     <span class="keywordtype">int</span> backslash = 0;
<a name="l05197" id="l05197"></a>05197     
<a name="l05198" id="l05198"></a>05198     dst = src;
<a name="l05199" id="l05199"></a>05199     <span class="keywordflow">while</span> (*src) {
<a name="l05200" id="l05200"></a>05200         <span class="keywordflow">if</span> (backslash) {
<a name="l05201" id="l05201"></a>05201             backslash = 0;
<a name="l05202" id="l05202"></a>05202             *dst++ = *src;
<a name="l05203" id="l05203"></a>05203         } <span class="keywordflow">else</span> {
<a name="l05204" id="l05204"></a>05204             <span class="keywordflow">if</span> (eos_marker == *src) <span class=
"keywordflow">break</span>;
<a name="l05205" id="l05205"></a>05205             <span class="keywordflow">if</span> (<span class=
"charliteral">'\\'</span> == *src) {
<a name="l05206" id="l05206"></a>05206                 backslash = 1;
<a name="l05207" id="l05207"></a>05207             } <span class="keywordflow">else</span> {
<a name="l05208" id="l05208"></a>05208                 *dst++ = *src;
<a name="l05209" id="l05209"></a>05209             }
<a name="l05210" id="l05210"></a>05210         }
<a name="l05211" id="l05211"></a>05211         src++;
<a name="l05212" id="l05212"></a>05212     }
<a name="l05213" id="l05213"></a>05213     <span class="keywordflow">if</span> (!*src) {
<a name="l05214" id="l05214"></a>05214         <span class="comment">/* never found eos_marker */</span>
<a name="l05215" id="l05215"></a>05215         <span class="keywordflow">return</span> NULL;
<a name="l05216" id="l05216"></a>05216     } <span class="keywordflow">else</span> {
<a name="l05217" id="l05217"></a>05217         *dst = 0;
<a name="l05218" id="l05218"></a>05218         <span class="keywordflow">return</span> src;
<a name="l05219" id="l05219"></a>05219     }
<a name="l05220" id="l05220"></a>05220 }
<a name="l05221" id="l05221"></a>05221 
<a name="l05222" id="l05222"></a>05222 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l05223" id="l05223"></a>05223 <span class="preprocessor">#ifndef NETSNMP_DISABLE_MIB_LOADING</span>
<a name="l05224" id="l05224"></a>05224 _add_strings_to_oid(<span class="keyword">struct</span> tree *tp, <span class=
"keywordtype">char</span> *cp,
<a name="l05225" id="l05225"></a>05225                     oid * objid, <span class=
"keywordtype">size_t</span> * objidlen, <span class="keywordtype">size_t</span> maxlen)
<a name="l05226" id="l05226"></a>05226 <span class="preprocessor">#else</span>
<a name="l05227" id="l05227"></a>05227 _add_strings_to_oid(<span class="keywordtype">void</span> *tp, <span class=
"keywordtype">char</span> *cp,
<a name="l05228" id="l05228"></a>05228                     oid * objid, <span class=
"keywordtype">size_t</span> * objidlen, <span class="keywordtype">size_t</span> maxlen)
<a name="l05229" id="l05229"></a>05229 <span class="preprocessor">#endif </span><span class=
"comment">/* NETSNMP_DISABLE_MIB_LOADING */</span>
<a name="l05230" id="l05230"></a>05230 {
<a name="l05231" id="l05231"></a>05231     oid             subid;
<a name="l05232" id="l05232"></a>05232     <span class="keywordtype">int</span>             len_index = 1000000;
<a name="l05233" id="l05233"></a>05233 <span class="preprocessor">#ifndef NETSNMP_DISABLE_MIB_LOADING</span>
<a name="l05234" id="l05234"></a>05234     <span class="keyword">struct </span>tree    *tp2 = NULL;
<a name="l05235" id="l05235"></a>05235     <span class="keyword">struct </span>index_list *in_dices = NULL;
<a name="l05236" id="l05236"></a>05236 <span class="preprocessor">#endif </span><span class=
"comment">/* NETSNMP_DISABLE_MIB_LOADING */</span>
<a name="l05237" id="l05237"></a>05237     <span class="keywordtype">char</span>           *fcp, *ecp, *cp2 = NULL;
<a name="l05238" id="l05238"></a>05238     <span class="keywordtype">char</span>            doingquote;
<a name="l05239" id="l05239"></a>05239     <span class="keywordtype">int</span>             len = -1, pos = -1;
<a name="l05240" id="l05240"></a>05240 <span class="preprocessor">#ifndef NETSNMP_DISABLE_MIB_LOADING</span>
<a name="l05241" id="l05241"></a>05241     <span class="keywordtype">int</span>             check =
<a name="l05242" id="l05242"></a>05242         !netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_DONT_CHECK_RANGE);
<a name="l05243" id="l05243"></a>05243     <span class=
"keywordtype">int</span>             do_hint = !netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_NO_DISPLAY_HINT);
<a name="l05244" id="l05244"></a>05244 
<a name="l05245" id="l05245"></a>05245     <span class=
"keywordflow">while</span> (cp &amp;&amp; tp &amp;&amp; tp-&gt;child_list) {
<a name="l05246" id="l05246"></a>05246         fcp = cp;
<a name="l05247" id="l05247"></a>05247         tp2 = tp-&gt;child_list;
<a name="l05248" id="l05248"></a>05248         <span class="comment">/*</span>
<a name="l05249" id="l05249"></a>05249 <span class="comment">         * Isolate the next entry </span>
<a name="l05250" id="l05250"></a>05250 <span class="comment">         */</span>
<a name="l05251" id="l05251"></a>05251         cp2 = strchr(cp, <span class="charliteral">'.'</span>);
<a name="l05252" id="l05252"></a>05252         <span class="keywordflow">if</span> (cp2)
<a name="l05253" id="l05253"></a>05253             *cp2++ = <span class="charliteral">'\0'</span>;
<a name="l05254" id="l05254"></a>05254 
<a name="l05255" id="l05255"></a>05255         <span class="comment">/*</span>
<a name="l05256" id="l05256"></a>05256 <span class="comment">         * Search for the appropriate child </span>
<a name="l05257" id="l05257"></a>05257 <span class="comment">         */</span>
<a name="l05258" id="l05258"></a>05258         <span class="keywordflow">if</span> (isdigit(*cp)) {
<a name="l05259" id="l05259"></a>05259             subid = strtoul(cp, &amp;ecp, 0);
<a name="l05260" id="l05260"></a>05260             <span class="keywordflow">if</span> (*ecp)
<a name="l05261" id="l05261"></a>05261                 <span class="keywordflow">goto</span> bad_id;
<a name="l05262" id="l05262"></a>05262             <span class="keywordflow">while</span> (tp2 &amp;&amp; tp2-&gt;subid != subid)
<a name="l05263" id="l05263"></a>05263                 tp2 = tp2-&gt;next_peer;
<a name="l05264" id="l05264"></a>05264         } <span class="keywordflow">else</span> {
<a name="l05265" id="l05265"></a>05265             <span class=
"keywordflow">while</span> (tp2 &amp;&amp; strcmp(tp2-&gt;label, fcp))
<a name="l05266" id="l05266"></a>05266                 tp2 = tp2-&gt;next_peer;
<a name="l05267" id="l05267"></a>05267             <span class="keywordflow">if</span> (!tp2)
<a name="l05268" id="l05268"></a>05268                 <span class="keywordflow">goto</span> bad_id;
<a name="l05269" id="l05269"></a>05269             subid = tp2-&gt;subid;
<a name="l05270" id="l05270"></a>05270         }
<a name="l05271" id="l05271"></a>05271         <span class="keywordflow">if</span> (*objidlen &gt;= maxlen)
<a name="l05272" id="l05272"></a>05272             <span class="keywordflow">goto</span> bad_id;
<a name="l05273" id="l05273"></a>05273         <span class=
"keywordflow">while</span> (tp2 &amp;&amp; tp2-&gt;next_peer &amp;&amp; tp2-&gt;next_peer-&gt;subid == subid)
<a name="l05274" id="l05274"></a>05274             tp2 = tp2-&gt;next_peer;
<a name="l05275" id="l05275"></a>05275         objid[*objidlen] = subid;
<a name="l05276" id="l05276"></a>05276         (*objidlen)++;
<a name="l05277" id="l05277"></a>05277 
<a name="l05278" id="l05278"></a>05278         cp = cp2;
<a name="l05279" id="l05279"></a>05279         <span class="keywordflow">if</span> (!tp2)
<a name="l05280" id="l05280"></a>05280             <span class="keywordflow">break</span>;
<a name="l05281" id="l05281"></a>05281         tp = tp2;
<a name="l05282" id="l05282"></a>05282     }
<a name="l05283" id="l05283"></a>05283 
<a name="l05284" id="l05284"></a>05284     <span class="keywordflow">if</span> (tp &amp;&amp; !tp-&gt;child_list) {
<a name="l05285" id="l05285"></a>05285         <span class="keywordflow">if</span> ((tp2 = tp-&gt;parent)) {
<a name="l05286" id="l05286"></a>05286             <span class="keywordflow">if</span> (tp2-&gt;indexes)
<a name="l05287" id="l05287"></a>05287                 in_dices = tp2-&gt;indexes;
<a name="l05288" id="l05288"></a>05288             <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (tp2-&gt;augments) {
<a name="l05289" id="l05289"></a>05289                 tp2 = find_tree_node(tp2-&gt;augments, -1);
<a name="l05290" id="l05290"></a>05290                 <span class="keywordflow">if</span> (tp2)
<a name="l05291" id="l05291"></a>05291                     in_dices = tp2-&gt;indexes;
<a name="l05292" id="l05292"></a>05292             }
<a name="l05293" id="l05293"></a>05293         }
<a name="l05294" id="l05294"></a>05294         tp = NULL;
<a name="l05295" id="l05295"></a>05295     }
<a name="l05296" id="l05296"></a>05296 
<a name="l05297" id="l05297"></a>05297     <span class="keywordflow">while</span> (cp &amp;&amp; in_dices) {
<a name="l05298" id="l05298"></a>05298         fcp = cp;
<a name="l05299" id="l05299"></a>05299 
<a name="l05300" id="l05300"></a>05300         tp = find_tree_node(in_dices-&gt;ilabel, -1);
<a name="l05301" id="l05301"></a>05301         <span class="keywordflow">if</span> (!tp)
<a name="l05302" id="l05302"></a>05302             <span class="keywordflow">break</span>;
<a name="l05303" id="l05303"></a>05303         <span class="keywordflow">switch</span> (tp-&gt;type) {
<a name="l05304" id="l05304"></a>05304         <span class="keywordflow">case</span> TYPE_INTEGER:
<a name="l05305" id="l05305"></a>05305         <span class="keywordflow">case</span> TYPE_INTEGER32:
<a name="l05306" id="l05306"></a>05306         <span class="keywordflow">case</span> TYPE_UINTEGER:
<a name="l05307" id="l05307"></a>05307         <span class="keywordflow">case</span> TYPE_UNSIGNED32:
<a name="l05308" id="l05308"></a>05308         <span class="keywordflow">case</span> TYPE_TIMETICKS:
<a name="l05309" id="l05309"></a>05309             <span class="comment">/*</span>
<a name="l05310" id="l05310"></a>05310 <span class="comment">             * Isolate the next entry </span>
<a name="l05311" id="l05311"></a>05311 <span class="comment">             */</span>
<a name="l05312" id="l05312"></a>05312             cp2 = strchr(cp, <span class="charliteral">'.'</span>);
<a name="l05313" id="l05313"></a>05313             <span class="keywordflow">if</span> (cp2)
<a name="l05314" id="l05314"></a>05314                 *cp2++ = <span class="charliteral">'\0'</span>;
<a name="l05315" id="l05315"></a>05315             <span class="keywordflow">if</span> (isdigit(*cp)) {
<a name="l05316" id="l05316"></a>05316                 subid = strtoul(cp, &amp;ecp, 0);
<a name="l05317" id="l05317"></a>05317                 <span class="keywordflow">if</span> (*ecp)
<a name="l05318" id="l05318"></a>05318                     <span class="keywordflow">goto</span> bad_id;
<a name="l05319" id="l05319"></a>05319             } <span class="keywordflow">else</span> {
<a name="l05320" id="l05320"></a>05320                 <span class="keywordflow">if</span> (tp-&gt;enums) {
<a name="l05321" id="l05321"></a>05321                     <span class="keyword">struct </span>enum_list *ep = tp-&gt;enums;
<a name="l05322" id="l05322"></a>05322                     <span class=
"keywordflow">while</span> (ep &amp;&amp; strcmp(ep-&gt;label, cp))
<a name="l05323" id="l05323"></a>05323                         ep = ep-&gt;next;
<a name="l05324" id="l05324"></a>05324                     <span class="keywordflow">if</span> (!ep)
<a name="l05325" id="l05325"></a>05325                         <span class="keywordflow">goto</span> bad_id;
<a name="l05326" id="l05326"></a>05326                     subid = ep-&gt;value;
<a name="l05327" id="l05327"></a>05327                 } <span class="keywordflow">else</span>
<a name="l05328" id="l05328"></a>05328                     <span class="keywordflow">goto</span> bad_id;
<a name="l05329" id="l05329"></a>05329             }
<a name="l05330" id="l05330"></a>05330             <span class="keywordflow">if</span> (check &amp;&amp; tp-&gt;ranges) {
<a name="l05331" id="l05331"></a>05331                 <span class="keyword">struct </span>range_list *rp = tp-&gt;ranges;
<a name="l05332" id="l05332"></a>05332                 <span class="keywordtype">int</span>             ok = 0;
<a name="l05333" id="l05333"></a>05333                 <span class="keywordflow">if</span> (tp-&gt;type == TYPE_INTEGER ||
<a name="l05334" id="l05334"></a>05334                     tp-&gt;type == TYPE_INTEGER32) {
<a name="l05335" id="l05335"></a>05335                   <span class="keywordflow">while</span> (!ok &amp;&amp; rp) {
<a name="l05336" id="l05336"></a>05336                     <span class="keywordflow">if</span> ((rp-&gt;low &lt;= (<span class=
"keywordtype">int</span>) subid)
<a name="l05337" id="l05337"></a>05337                         &amp;&amp; ((<span class=
"keywordtype">int</span>) subid &lt;= rp-&gt;high))
<a name="l05338" id="l05338"></a>05338                         ok = 1;
<a name="l05339" id="l05339"></a>05339                     <span class="keywordflow">else</span>
<a name="l05340" id="l05340"></a>05340                         rp = rp-&gt;next;
<a name="l05341" id="l05341"></a>05341                   }
<a name="l05342" id="l05342"></a>05342                 } <span class="keywordflow">else</span> { <span class=
"comment">/* check unsigned range */</span>
<a name="l05343" id="l05343"></a>05343                   <span class="keywordflow">while</span> (!ok &amp;&amp; rp) {
<a name="l05344" id="l05344"></a>05344                     <span class="keywordflow">if</span> (((<span class=
"keywordtype">unsigned</span> <span class="keywordtype">int</span>)rp-&gt;low &lt;= subid)
<a name="l05345" id="l05345"></a>05345                         &amp;&amp; (subid &lt;= (<span class=
"keywordtype">unsigned</span> <span class="keywordtype">int</span>)rp-&gt;high))
<a name="l05346" id="l05346"></a>05346                         ok = 1;
<a name="l05347" id="l05347"></a>05347                     <span class="keywordflow">else</span>
<a name="l05348" id="l05348"></a>05348                         rp = rp-&gt;next;
<a name="l05349" id="l05349"></a>05349                   }
<a name="l05350" id="l05350"></a>05350                 }
<a name="l05351" id="l05351"></a>05351                 <span class="keywordflow">if</span> (!ok)
<a name="l05352" id="l05352"></a>05352                     <span class="keywordflow">goto</span> bad_id;
<a name="l05353" id="l05353"></a>05353             }
<a name="l05354" id="l05354"></a>05354             <span class="keywordflow">if</span> (*objidlen &gt;= maxlen)
<a name="l05355" id="l05355"></a>05355                 <span class="keywordflow">goto</span> bad_id;
<a name="l05356" id="l05356"></a>05356             objid[*objidlen] = subid;
<a name="l05357" id="l05357"></a>05357             (*objidlen)++;
<a name="l05358" id="l05358"></a>05358             <span class="keywordflow">break</span>;
<a name="l05359" id="l05359"></a>05359         <span class="keywordflow">case</span> TYPE_IPADDR:
<a name="l05360" id="l05360"></a>05360             <span class="keywordflow">if</span> (*objidlen + 4 &gt; maxlen)
<a name="l05361" id="l05361"></a>05361                 <span class="keywordflow">goto</span> bad_id;
<a name="l05362" id="l05362"></a>05362             <span class=
"keywordflow">for</span> (subid = 0; cp &amp;&amp; subid &lt; 4; subid++) {
<a name="l05363" id="l05363"></a>05363                 fcp = cp;
<a name="l05364" id="l05364"></a>05364                 cp2 = strchr(cp, <span class="charliteral">'.'</span>);
<a name="l05365" id="l05365"></a>05365                 <span class="keywordflow">if</span> (cp2)
<a name="l05366" id="l05366"></a>05366                     *cp2++ = 0;
<a name="l05367" id="l05367"></a>05367                 objid[*objidlen] = strtoul(cp, &amp;ecp, 0);
<a name="l05368" id="l05368"></a>05368                 <span class="keywordflow">if</span> (*ecp)
<a name="l05369" id="l05369"></a>05369                     <span class="keywordflow">goto</span> bad_id;
<a name="l05370" id="l05370"></a>05370                 <span class=
"keywordflow">if</span> (check &amp;&amp; objid[*objidlen] &gt; 255)
<a name="l05371" id="l05371"></a>05371                     <span class="keywordflow">goto</span> bad_id;
<a name="l05372" id="l05372"></a>05372                 (*objidlen)++;
<a name="l05373" id="l05373"></a>05373                 cp = cp2;
<a name="l05374" id="l05374"></a>05374             }
<a name="l05375" id="l05375"></a>05375             <span class="keywordflow">break</span>;
<a name="l05376" id="l05376"></a>05376         <span class="keywordflow">case</span> TYPE_OCTETSTR:
<a name="l05377" id="l05377"></a>05377             <span class=
"keywordflow">if</span> (tp-&gt;ranges &amp;&amp; !tp-&gt;ranges-&gt;next
<a name="l05378" id="l05378"></a>05378                 &amp;&amp; tp-&gt;ranges-&gt;low == tp-&gt;ranges-&gt;high)
<a name="l05379" id="l05379"></a>05379                 len = tp-&gt;ranges-&gt;low;
<a name="l05380" id="l05380"></a>05380             <span class="keywordflow">else</span>
<a name="l05381" id="l05381"></a>05381                 len = -1;
<a name="l05382" id="l05382"></a>05382             pos = 0;
<a name="l05383" id="l05383"></a>05383             <span class="keywordflow">if</span> (*cp == <span class=
"charliteral">'"'</span> || *cp == <span class="charliteral">'\''</span>) {
<a name="l05384" id="l05384"></a>05384                 doingquote = *cp++;
<a name="l05385" id="l05385"></a>05385                 <span class="comment">/*</span>
<a name="l05386" id="l05386"></a>05386 <span class="comment">                 * insert length if requested </span>
<a name="l05387" id="l05387"></a>05387 <span class="comment">                 */</span>
<a name="l05388" id="l05388"></a>05388                 <span class=
"keywordflow">if</span> (!in_dices-&gt;isimplied &amp;&amp; len == -1) {
<a name="l05389" id="l05389"></a>05389                     <span class="keywordflow">if</span> (doingquote == <span class=
"charliteral">'\''</span>) {
<a name="l05390" id="l05390"></a>05390                         snmp_set_detail
<a name="l05391" id="l05391"></a>05391                             (<span class=
"stringliteral">"'-quote is for fixed length strings"</span>);
<a name="l05392" id="l05392"></a>05392                         <span class="keywordflow">return</span> 0;
<a name="l05393" id="l05393"></a>05393                     }
<a name="l05394" id="l05394"></a>05394                     <span class="keywordflow">if</span> (*objidlen &gt;= maxlen)
<a name="l05395" id="l05395"></a>05395                         <span class="keywordflow">goto</span> bad_id;
<a name="l05396" id="l05396"></a>05396                     len_index = *objidlen;
<a name="l05397" id="l05397"></a>05397                     (*objidlen)++;
<a name="l05398" id="l05398"></a>05398                 } <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (doingquote == <span class="charliteral">'"'</span>) {
<a name="l05399" id="l05399"></a>05399                     snmp_set_detail
<a name="l05400" id="l05400"></a>05400                         (<span class=
"stringliteral">"\"-quote is for variable length strings"</span>);
<a name="l05401" id="l05401"></a>05401                     <span class="keywordflow">return</span> 0;
<a name="l05402" id="l05402"></a>05402                 }
<a name="l05403" id="l05403"></a>05403 
<a name="l05404" id="l05404"></a>05404                 cp2 = _apply_escapes(cp, doingquote);
<a name="l05405" id="l05405"></a>05405                 <span class="keywordflow">if</span> (!cp2) <span class=
"keywordflow">goto</span> bad_id;
<a name="l05406" id="l05406"></a>05406                 <span class="keywordflow">else</span> {
<a name="l05407" id="l05407"></a>05407                     <span class="keywordtype">unsigned</span> <span class=
"keywordtype">char</span> *new_val;
<a name="l05408" id="l05408"></a>05408                     <span class="keywordtype">int</span> new_val_len;
<a name="l05409" id="l05409"></a>05409                     <span class="keywordtype">int</span> parsed_hint = 0;
<a name="l05410" id="l05410"></a>05410                     <span class="keyword">const</span> <span class=
"keywordtype">char</span> *parsed_value;
<a name="l05411" id="l05411"></a>05411 
<a name="l05412" id="l05412"></a>05412                     <span class="keywordflow">if</span> (do_hint &amp;&amp; tp-&gt;hint) {
<a name="l05413" id="l05413"></a>05413                         parsed_value = parse_octet_hint(tp-&gt;hint, cp,
<a name="l05414" id="l05414"></a>05414                                                         &amp;new_val, &amp;new_val_len);
<a name="l05415" id="l05415"></a>05415                         parsed_hint = parsed_value == NULL;
<a name="l05416" id="l05416"></a>05416                     }
<a name="l05417" id="l05417"></a>05417                     <span class="keywordflow">if</span> (parsed_hint) {
<a name="l05418" id="l05418"></a>05418                         <span class="keywordtype">int</span> i;
<a name="l05419" id="l05419"></a>05419                         <span class=
"keywordflow">for</span> (i = 0; i &lt; new_val_len; i++) {
<a name="l05420" id="l05420"></a>05420                             <span class=
"keywordflow">if</span> (*objidlen &gt;= maxlen) <span class="keywordflow">goto</span> bad_id;
<a name="l05421" id="l05421"></a>05421                             objid[ *objidlen ] = new_val[i];
<a name="l05422" id="l05422"></a>05422                             (*objidlen)++;
<a name="l05423" id="l05423"></a>05423                             pos++;
<a name="l05424" id="l05424"></a>05424                         }
<a name="l05425" id="l05425"></a>05425                         <a class="code" href=
"group__util.html#g951e93edb6f0ea941e26155e3f8912a6" title=
"Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(new_val);
<a name="l05426" id="l05426"></a>05426                     } <span class="keywordflow">else</span> {
<a name="l05427" id="l05427"></a>05427                         <span class="keywordflow">while</span>(*cp) {
<a name="l05428" id="l05428"></a>05428                             <span class=
"keywordflow">if</span> (*objidlen &gt;= maxlen) <span class="keywordflow">goto</span> bad_id;
<a name="l05429" id="l05429"></a>05429                             objid[ *objidlen ] = *cp++;
<a name="l05430" id="l05430"></a>05430                             (*objidlen)++;
<a name="l05431" id="l05431"></a>05431                             pos++;
<a name="l05432" id="l05432"></a>05432                         }
<a name="l05433" id="l05433"></a>05433                     }
<a name="l05434" id="l05434"></a>05434                 }
<a name="l05435" id="l05435"></a>05435                 
<a name="l05436" id="l05436"></a>05436                 cp2++;
<a name="l05437" id="l05437"></a>05437                 <span class="keywordflow">if</span> (!*cp2)
<a name="l05438" id="l05438"></a>05438                     cp2 = NULL;
<a name="l05439" id="l05439"></a>05439                 <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (*cp2 != <span class="charliteral">'.'</span>)
<a name="l05440" id="l05440"></a>05440                     <span class="keywordflow">goto</span> bad_id;
<a name="l05441" id="l05441"></a>05441                 <span class="keywordflow">else</span>
<a name="l05442" id="l05442"></a>05442                     cp2++;
<a name="l05443" id="l05443"></a>05443                 <span class="keywordflow">if</span> (check) {
<a name="l05444" id="l05444"></a>05444                     <span class="keywordflow">if</span> (len == -1) {
<a name="l05445" id="l05445"></a>05445                         <span class=
"keyword">struct </span>range_list *rp = tp-&gt;ranges;
<a name="l05446" id="l05446"></a>05446                         <span class="keywordtype">int</span>             ok = 0;
<a name="l05447" id="l05447"></a>05447                         <span class="keywordflow">while</span> (rp &amp;&amp; !ok)
<a name="l05448" id="l05448"></a>05448                             <span class=
"keywordflow">if</span> (rp-&gt;low &lt;= pos &amp;&amp; pos &lt;= rp-&gt;high)
<a name="l05449" id="l05449"></a>05449                                 ok = 1;
<a name="l05450" id="l05450"></a>05450                             <span class="keywordflow">else</span>
<a name="l05451" id="l05451"></a>05451                                 rp = rp-&gt;next;
<a name="l05452" id="l05452"></a>05452                         <span class="keywordflow">if</span> (!ok)
<a name="l05453" id="l05453"></a>05453                             <span class="keywordflow">goto</span> bad_id;
<a name="l05454" id="l05454"></a>05454                         <span class="keywordflow">if</span> (!in_dices-&gt;isimplied)
<a name="l05455" id="l05455"></a>05455                             objid[len_index] = pos;
<a name="l05456" id="l05456"></a>05456                     } <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (pos != len)
<a name="l05457" id="l05457"></a>05457                         <span class="keywordflow">goto</span> bad_id;
<a name="l05458" id="l05458"></a>05458                 }
<a name="l05459" id="l05459"></a>05459                 <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (len == -1 &amp;&amp; !in_dices-&gt;isimplied)
<a name="l05460" id="l05460"></a>05460                     objid[len_index] = pos;
<a name="l05461" id="l05461"></a>05461             } <span class="keywordflow">else</span> {
<a name="l05462" id="l05462"></a>05462                 <span class=
"keywordflow">if</span> (!in_dices-&gt;isimplied &amp;&amp; len == -1) {
<a name="l05463" id="l05463"></a>05463                     fcp = cp;
<a name="l05464" id="l05464"></a>05464                     cp2 = strchr(cp, <span class="charliteral">'.'</span>);
<a name="l05465" id="l05465"></a>05465                     <span class="keywordflow">if</span> (cp2)
<a name="l05466" id="l05466"></a>05466                         *cp2++ = 0;
<a name="l05467" id="l05467"></a>05467                     len = strtoul(cp, &amp;ecp, 0);
<a name="l05468" id="l05468"></a>05468                     <span class="keywordflow">if</span> (*ecp)
<a name="l05469" id="l05469"></a>05469                         <span class="keywordflow">goto</span> bad_id;
<a name="l05470" id="l05470"></a>05470                     <span class="keywordflow">if</span> (*objidlen + len + 1 &gt;= maxlen)
<a name="l05471" id="l05471"></a>05471                         <span class="keywordflow">goto</span> bad_id;
<a name="l05472" id="l05472"></a>05472                     objid[*objidlen] = len;
<a name="l05473" id="l05473"></a>05473                     (*objidlen)++;
<a name="l05474" id="l05474"></a>05474                     cp = cp2;
<a name="l05475" id="l05475"></a>05475                 }
<a name="l05476" id="l05476"></a>05476                 <span class="keywordflow">while</span> (len &amp;&amp; cp) {
<a name="l05477" id="l05477"></a>05477                     fcp = cp;
<a name="l05478" id="l05478"></a>05478                     cp2 = strchr(cp, <span class="charliteral">'.'</span>);
<a name="l05479" id="l05479"></a>05479                     <span class="keywordflow">if</span> (cp2)
<a name="l05480" id="l05480"></a>05480                         *cp2++ = 0;
<a name="l05481" id="l05481"></a>05481                     objid[*objidlen] = strtoul(cp, &amp;ecp, 0);
<a name="l05482" id="l05482"></a>05482                     <span class="keywordflow">if</span> (*ecp)
<a name="l05483" id="l05483"></a>05483                         <span class="keywordflow">goto</span> bad_id;
<a name="l05484" id="l05484"></a>05484                     <span class=
"keywordflow">if</span> (check &amp;&amp; objid[*objidlen] &gt; 255)
<a name="l05485" id="l05485"></a>05485                         <span class="keywordflow">goto</span> bad_id;
<a name="l05486" id="l05486"></a>05486                     (*objidlen)++;
<a name="l05487" id="l05487"></a>05487                     len--;
<a name="l05488" id="l05488"></a>05488                     cp = cp2;
<a name="l05489" id="l05489"></a>05489                 }
<a name="l05490" id="l05490"></a>05490             }
<a name="l05491" id="l05491"></a>05491             <span class="keywordflow">break</span>;
<a name="l05492" id="l05492"></a>05492         <span class="keywordflow">case</span> TYPE_OBJID:
<a name="l05493" id="l05493"></a>05493             in_dices = NULL;
<a name="l05494" id="l05494"></a>05494             cp2 = cp;
<a name="l05495" id="l05495"></a>05495             <span class="keywordflow">break</span>;
<a name="l05496" id="l05496"></a>05496         <span class="keywordflow">case</span> TYPE_NETADDR:
<a name="l05497" id="l05497"></a>05497             fcp = cp;
<a name="l05498" id="l05498"></a>05498             cp2 = strchr(cp, <span class="charliteral">'.'</span>);
<a name="l05499" id="l05499"></a>05499             <span class="keywordflow">if</span> (cp2)
<a name="l05500" id="l05500"></a>05500                 *cp2++ = 0;
<a name="l05501" id="l05501"></a>05501             subid = strtoul(cp, &amp;ecp, 0);
<a name="l05502" id="l05502"></a>05502             <span class="keywordflow">if</span> (*ecp)
<a name="l05503" id="l05503"></a>05503                 <span class="keywordflow">goto</span> bad_id;
<a name="l05504" id="l05504"></a>05504             <span class="keywordflow">if</span> (*objidlen + 1 &gt;= maxlen)
<a name="l05505" id="l05505"></a>05505                 <span class="keywordflow">goto</span> bad_id;
<a name="l05506" id="l05506"></a>05506             objid[*objidlen] = subid;
<a name="l05507" id="l05507"></a>05507             (*objidlen)++;
<a name="l05508" id="l05508"></a>05508             cp = cp2;
<a name="l05509" id="l05509"></a>05509             <span class="keywordflow">if</span> (subid == 1) {
<a name="l05510" id="l05510"></a>05510                 <span class=
"keywordflow">for</span> (len = 0; cp &amp;&amp; len &lt; 4; len++) {
<a name="l05511" id="l05511"></a>05511                     fcp = cp;
<a name="l05512" id="l05512"></a>05512                     cp2 = strchr(cp, <span class="charliteral">'.'</span>);
<a name="l05513" id="l05513"></a>05513                     <span class="keywordflow">if</span> (cp2)
<a name="l05514" id="l05514"></a>05514                         *cp2++ = 0;
<a name="l05515" id="l05515"></a>05515                     subid = strtoul(cp, &amp;ecp, 0);
<a name="l05516" id="l05516"></a>05516                     <span class="keywordflow">if</span> (*ecp)
<a name="l05517" id="l05517"></a>05517                         <span class="keywordflow">goto</span> bad_id;
<a name="l05518" id="l05518"></a>05518                     <span class="keywordflow">if</span> (*objidlen + 1 &gt;= maxlen)
<a name="l05519" id="l05519"></a>05519                         <span class="keywordflow">goto</span> bad_id;
<a name="l05520" id="l05520"></a>05520                     <span class="keywordflow">if</span> (check &amp;&amp; subid &gt; 255)
<a name="l05521" id="l05521"></a>05521                         <span class="keywordflow">goto</span> bad_id;
<a name="l05522" id="l05522"></a>05522                     objid[*objidlen] = subid;
<a name="l05523" id="l05523"></a>05523                     (*objidlen)++;
<a name="l05524" id="l05524"></a>05524                     cp = cp2;
<a name="l05525" id="l05525"></a>05525                 }
<a name="l05526" id="l05526"></a>05526             }
<a name="l05527" id="l05527"></a>05527             <span class="keywordflow">else</span> {
<a name="l05528" id="l05528"></a>05528                 in_dices = NULL;
<a name="l05529" id="l05529"></a>05529             }
<a name="l05530" id="l05530"></a>05530             <span class="keywordflow">break</span>;
<a name="l05531" id="l05531"></a>05531         <span class="keywordflow">default</span>:
<a name="l05532" id="l05532"></a>05532             <a class="code" href=
"group__snmp__logging.html#g9ba905368ea1c551b969af44b13e37c2" title=
"This snmp logging function allows variable argument list given the specified format...">snmp_log</a>(LOG_ERR, <span class=
"stringliteral">"Unexpected index type: %d %s %s\n"</span>,
<a name="l05533" id="l05533"></a>05533                      tp-&gt;type, in_dices-&gt;ilabel, cp);
<a name="l05534" id="l05534"></a>05534             in_dices = NULL;
<a name="l05535" id="l05535"></a>05535             cp2 = cp;
<a name="l05536" id="l05536"></a>05536             <span class="keywordflow">break</span>;
<a name="l05537" id="l05537"></a>05537         }
<a name="l05538" id="l05538"></a>05538         cp = cp2;
<a name="l05539" id="l05539"></a>05539         <span class="keywordflow">if</span> (in_dices)
<a name="l05540" id="l05540"></a>05540             in_dices = in_dices-&gt;next;
<a name="l05541" id="l05541"></a>05541     }
<a name="l05542" id="l05542"></a>05542 
<a name="l05543" id="l05543"></a>05543 <span class="preprocessor">#endif </span><span class=
"comment">/* NETSNMP_DISABLE_MIB_LOADING */</span>
<a name="l05544" id="l05544"></a>05544     <span class="keywordflow">while</span> (cp) {
<a name="l05545" id="l05545"></a>05545         fcp = cp;
<a name="l05546" id="l05546"></a>05546         <span class="keywordflow">switch</span> (*cp) {
<a name="l05547" id="l05547"></a>05547         <span class="keywordflow">case</span> <span class="charliteral">'0'</span>:
<a name="l05548" id="l05548"></a>05548         <span class="keywordflow">case</span> <span class="charliteral">'1'</span>:
<a name="l05549" id="l05549"></a>05549         <span class="keywordflow">case</span> <span class="charliteral">'2'</span>:
<a name="l05550" id="l05550"></a>05550         <span class="keywordflow">case</span> <span class="charliteral">'3'</span>:
<a name="l05551" id="l05551"></a>05551         <span class="keywordflow">case</span> <span class="charliteral">'4'</span>:
<a name="l05552" id="l05552"></a>05552         <span class="keywordflow">case</span> <span class="charliteral">'5'</span>:
<a name="l05553" id="l05553"></a>05553         <span class="keywordflow">case</span> <span class="charliteral">'6'</span>:
<a name="l05554" id="l05554"></a>05554         <span class="keywordflow">case</span> <span class="charliteral">'7'</span>:
<a name="l05555" id="l05555"></a>05555         <span class="keywordflow">case</span> <span class="charliteral">'8'</span>:
<a name="l05556" id="l05556"></a>05556         <span class="keywordflow">case</span> <span class="charliteral">'9'</span>:
<a name="l05557" id="l05557"></a>05557             cp2 = strchr(cp, <span class="charliteral">'.'</span>);
<a name="l05558" id="l05558"></a>05558             <span class="keywordflow">if</span> (cp2)
<a name="l05559" id="l05559"></a>05559                 *cp2++ = 0;
<a name="l05560" id="l05560"></a>05560             subid = strtoul(cp, &amp;ecp, 0);
<a name="l05561" id="l05561"></a>05561             <span class="keywordflow">if</span> (*ecp)
<a name="l05562" id="l05562"></a>05562                 <span class="keywordflow">goto</span> bad_id;
<a name="l05563" id="l05563"></a>05563             <span class="keywordflow">if</span> (*objidlen &gt;= maxlen)
<a name="l05564" id="l05564"></a>05564                 <span class="keywordflow">goto</span> bad_id;
<a name="l05565" id="l05565"></a>05565             objid[*objidlen] = subid;
<a name="l05566" id="l05566"></a>05566             (*objidlen)++;
<a name="l05567" id="l05567"></a>05567             <span class="keywordflow">break</span>;
<a name="l05568" id="l05568"></a>05568         <span class="keywordflow">case</span> <span class="charliteral">'"'</span>:
<a name="l05569" id="l05569"></a>05569         <span class="keywordflow">case</span> <span class="charliteral">'\''</span>:
<a name="l05570" id="l05570"></a>05570             doingquote = *cp++;
<a name="l05571" id="l05571"></a>05571             <span class="comment">/*</span>
<a name="l05572" id="l05572"></a>05572 <span class="comment">             * insert length if requested </span>
<a name="l05573" id="l05573"></a>05573 <span class="comment">             */</span>
<a name="l05574" id="l05574"></a>05574             <span class="keywordflow">if</span> (doingquote == <span class=
"charliteral">'"'</span>) {
<a name="l05575" id="l05575"></a>05575                 <span class="keywordflow">if</span> (*objidlen &gt;= maxlen)
<a name="l05576" id="l05576"></a>05576                     <span class="keywordflow">goto</span> bad_id;
<a name="l05577" id="l05577"></a>05577                 objid[*objidlen] = len = strchr(cp, doingquote) - cp;
<a name="l05578" id="l05578"></a>05578                 (*objidlen)++;
<a name="l05579" id="l05579"></a>05579             }
<a name="l05580" id="l05580"></a>05580 
<a name="l05581" id="l05581"></a>05581             <span class="keywordflow">if</span> (!cp)
<a name="l05582" id="l05582"></a>05582                 <span class="keywordflow">goto</span> bad_id;
<a name="l05583" id="l05583"></a>05583             <span class="keywordflow">while</span> (*cp &amp;&amp; *cp != doingquote) {
<a name="l05584" id="l05584"></a>05584                 <span class="keywordflow">if</span> (*objidlen &gt;= maxlen)
<a name="l05585" id="l05585"></a>05585                     <span class="keywordflow">goto</span> bad_id;
<a name="l05586" id="l05586"></a>05586                 objid[*objidlen] = *cp++;
<a name="l05587" id="l05587"></a>05587                 (*objidlen)++;
<a name="l05588" id="l05588"></a>05588             }
<a name="l05589" id="l05589"></a>05589             cp2 = cp + 1;
<a name="l05590" id="l05590"></a>05590             <span class="keywordflow">if</span> (!*cp2)
<a name="l05591" id="l05591"></a>05591                 cp2 = NULL;
<a name="l05592" id="l05592"></a>05592             <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (*cp2 == <span class="charliteral">'.'</span>)
<a name="l05593" id="l05593"></a>05593                 cp2++;
<a name="l05594" id="l05594"></a>05594             <span class="keywordflow">else</span>
<a name="l05595" id="l05595"></a>05595                 <span class="keywordflow">goto</span> bad_id;
<a name="l05596" id="l05596"></a>05596             <span class="keywordflow">break</span>;
<a name="l05597" id="l05597"></a>05597         <span class="keywordflow">default</span>:
<a name="l05598" id="l05598"></a>05598             <span class="keywordflow">goto</span> bad_id;
<a name="l05599" id="l05599"></a>05599         }
<a name="l05600" id="l05600"></a>05600         cp = cp2;
<a name="l05601" id="l05601"></a>05601     }
<a name="l05602" id="l05602"></a>05602     <span class="keywordflow">return</span> 1;
<a name="l05603" id="l05603"></a>05603 
<a name="l05604" id="l05604"></a>05604   bad_id:
<a name="l05605" id="l05605"></a>05605     {
<a name="l05606" id="l05606"></a>05606         <span class="keywordtype">char</span>            buf[256];
<a name="l05607" id="l05607"></a>05607 <span class="preprocessor">#ifndef NETSNMP_DISABLE_MIB_LOADING</span>
<a name="l05608" id="l05608"></a>05608         <span class="keywordflow">if</span> (in_dices)
<a name="l05609" id="l05609"></a>05609             snprintf(buf, <span class="keyword">sizeof</span>(buf), <span class=
"stringliteral">"Index out of range: %s (%s)"</span>,
<a name="l05610" id="l05610"></a>05610                     fcp, in_dices-&gt;ilabel);
<a name="l05611" id="l05611"></a>05611         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tp)
<a name="l05612" id="l05612"></a>05612             snprintf(buf, <span class="keyword">sizeof</span>(buf), <span class=
"stringliteral">"Sub-id not found: %s -&gt; %s"</span>, tp-&gt;label, fcp);
<a name="l05613" id="l05613"></a>05613         <span class="keywordflow">else</span>
<a name="l05614" id="l05614"></a>05614 <span class="preprocessor">#endif </span><span class=
"comment">/* NETSNMP_DISABLE_MIB_LOADING */</span>
<a name="l05615" id="l05615"></a>05615             snprintf(buf, <span class="keyword">sizeof</span>(buf), <span class=
"stringliteral">"%s"</span>, fcp);
<a name="l05616" id="l05616"></a>05616         buf[ <span class="keyword">sizeof</span>(buf)-1 ] = 0;
<a name="l05617" id="l05617"></a>05617 
<a name="l05618" id="l05618"></a>05618         snmp_set_detail(buf);
<a name="l05619" id="l05619"></a>05619     }
<a name="l05620" id="l05620"></a>05620     <span class="keywordflow">return</span> 0;
<a name="l05621" id="l05621"></a>05621 }
<a name="l05622" id="l05622"></a>05622 
<a name="l05623" id="l05623"></a>05623 
<a name="l05624" id="l05624"></a>05624 <span class="preprocessor">#ifndef NETSNMP_DISABLE_MIB_LOADING</span>
<a name="l05625" id="l05625"></a>05625 
<a name="l05628" id="l05628"></a>05628 <span class="keywordtype">int</span>
<a name="l05629" id="l05629"></a><a class="code" href=
"group__mib__utilities.html#g01c1f66f4afdfbbcca1ed3cbb572e739">05629</a> <a class="code" href=
"group__mib__utilities.html#g01c1f66f4afdfbbcca1ed3cbb572e739">get_wild_node</a>(<span class="keyword">const</span> <span class=
"keywordtype">char</span> *name, oid * objid, <span class="keywordtype">size_t</span> * objidlen)
<a name="l05630" id="l05630"></a>05630 {
<a name="l05631" id="l05631"></a>05631     <span class=
"keyword">struct </span>tree    *tp = find_best_tree_node(name, tree_head, NULL);
<a name="l05632" id="l05632"></a>05632     <span class="keywordflow">if</span> (!tp)
<a name="l05633" id="l05633"></a>05633         <span class="keywordflow">return</span> 0;
<a name="l05634" id="l05634"></a>05634     <span class="keywordflow">return</span> get_node(tp-&gt;label, objid, objidlen);
<a name="l05635" id="l05635"></a>05635 }
<a name="l05636" id="l05636"></a>05636 
<a name="l05637" id="l05637"></a>05637 <span class="keywordtype">int</span>
<a name="l05638" id="l05638"></a>05638 get_node(<span class="keyword">const</span> <span class=
"keywordtype">char</span> *name, oid * objid, <span class="keywordtype">size_t</span> * objidlen)
<a name="l05639" id="l05639"></a>05639 {
<a name="l05640" id="l05640"></a>05640     <span class="keyword">const</span> <span class="keywordtype">char</span>     *cp;
<a name="l05641" id="l05641"></a>05641     <span class="keywordtype">char</span>            ch;
<a name="l05642" id="l05642"></a>05642     <span class="keywordtype">int</span>             res;
<a name="l05643" id="l05643"></a>05643 
<a name="l05644" id="l05644"></a>05644     cp = name;
<a name="l05645" id="l05645"></a>05645     <span class="keywordflow">while</span> ((ch = *cp))
<a name="l05646" id="l05646"></a>05646         <span class="keywordflow">if</span> ((<span class=
"charliteral">'0'</span> &lt;= ch &amp;&amp; ch &lt;= <span class="charliteral">'9'</span>)
<a name="l05647" id="l05647"></a>05647             || (<span class=
"charliteral">'a'</span> &lt;= ch &amp;&amp; ch &lt;= <span class="charliteral">'z'</span>)
<a name="l05648" id="l05648"></a>05648             || (<span class=
"charliteral">'A'</span> &lt;= ch &amp;&amp; ch &lt;= <span class="charliteral">'Z'</span>)
<a name="l05649" id="l05649"></a>05649             || ch == <span class="charliteral">'-'</span>)
<a name="l05650" id="l05650"></a>05650             cp++;
<a name="l05651" id="l05651"></a>05651         <span class="keywordflow">else</span>
<a name="l05652" id="l05652"></a>05652             <span class="keywordflow">break</span>;
<a name="l05653" id="l05653"></a>05653     <span class="keywordflow">if</span> (ch != <span class="charliteral">':'</span>)
<a name="l05654" id="l05654"></a>05654         <span class="keywordflow">if</span> (*name == <span class=
"charliteral">'.'</span>)
<a name="l05655" id="l05655"></a>05655             res = get_module_node(name + 1, <span class=
"stringliteral">"ANY"</span>, objid, objidlen);
<a name="l05656" id="l05656"></a>05656         <span class="keywordflow">else</span>
<a name="l05657" id="l05657"></a>05657             res = get_module_node(name, <span class=
"stringliteral">"ANY"</span>, objid, objidlen);
<a name="l05658" id="l05658"></a>05658     <span class="keywordflow">else</span> {
<a name="l05659" id="l05659"></a>05659         <span class="keywordtype">char</span>           *module;
<a name="l05660" id="l05660"></a>05660         <span class="comment">/*</span>
<a name="l05661" id="l05661"></a>05661 <span class="comment">         *  requested name is of the form</span>
<a name="l05662" id="l05662"></a>05662 <span class="comment">         *      "module:subidentifier"</span>
<a name="l05663" id="l05663"></a>05663 <span class="comment">         */</span>
<a name="l05664" id="l05664"></a>05664         module = (<span class="keywordtype">char</span> *) malloc((<span class=
"keywordtype">size_t</span>) (cp - name + 1));
<a name="l05665" id="l05665"></a>05665         <span class="keywordflow">if</span> (!module)
<a name="l05666" id="l05666"></a>05666             <span class="keywordflow">return</span> SNMPERR_GENERR;
<a name="l05667" id="l05667"></a>05667         memcpy(module, name, (<span class="keywordtype">size_t</span>) (cp - name));
<a name="l05668" id="l05668"></a>05668         module[cp - name] = 0;
<a name="l05669" id="l05669"></a>05669         cp++;                   <span class=
"comment">/* cp now point to the subidentifier */</span>
<a name="l05670" id="l05670"></a>05670         <span class="keywordflow">if</span> (*cp == <span class="charliteral">':'</span>)
<a name="l05671" id="l05671"></a>05671             cp++;
<a name="l05672" id="l05672"></a>05672 
<a name="l05673" id="l05673"></a>05673         <span class="comment">/*</span>
<a name="l05674" id="l05674"></a>05674 <span class="comment">         * 'cp' and 'name' *do* go that way round! </span>
<a name="l05675" id="l05675"></a>05675 <span class="comment">         */</span>
<a name="l05676" id="l05676"></a>05676         res = get_module_node(cp, module, objid, objidlen);
<a name="l05677" id="l05677"></a>05677         <a class="code" href="group__util.html#g951e93edb6f0ea941e26155e3f8912a6" title=
"Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(module);
<a name="l05678" id="l05678"></a>05678     }
<a name="l05679" id="l05679"></a>05679     <span class="keywordflow">if</span> (res == 0) {
<a name="l05680" id="l05680"></a>05680         SET_SNMP_ERROR(SNMPERR_UNKNOWN_OBJID);
<a name="l05681" id="l05681"></a>05681     }
<a name="l05682" id="l05682"></a>05682 
<a name="l05683" id="l05683"></a>05683     <span class="keywordflow">return</span> res;
<a name="l05684" id="l05684"></a>05684 }
<a name="l05685" id="l05685"></a>05685 <span class="preprocessor">#endif </span><span class=
"comment">/* NETSNMP_DISABLE_MIB_LOADING */</span>
<a name="l05686" id="l05686"></a>05686 
<a name="l05687" id="l05687"></a>05687 <span class="preprocessor">#ifdef testing</span>
<a name="l05688" id="l05688"></a>05688 
<a name="l05689" id="l05689"></a>05689 main(<span class="keywordtype">int</span> argc, <span class=
"keywordtype">char</span> *argv[])
<a name="l05690" id="l05690"></a>05690 {
<a name="l05691" id="l05691"></a>05691     oid             objid[MAX_OID_LEN];
<a name="l05692" id="l05692"></a>05692     <span class="keywordtype">int</span>             objidlen = MAX_OID_LEN;
<a name="l05693" id="l05693"></a>05693     <span class="keywordtype">int</span>             count;
<a name="l05694" id="l05694"></a>05694     <a class="code" href="structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> variable;
<a name="l05695" id="l05695"></a>05695 
<a name="l05696" id="l05696"></a>05696     <a class="code" href="group__mib__utilities.html#ge4976578d871e017d0deffd30afff243"
title="Initialises the mib reader.">netsnmp_init_mib</a>();
<a name="l05697" id="l05697"></a>05697     <span class="keywordflow">if</span> (argc &lt; 2)
<a name="l05698" id="l05698"></a>05698         print_subtree(stdout, tree_head, 0);
<a name="l05699" id="l05699"></a>05699     variable.<a class="code" href=
"structvariable__list.html#8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a> = ASN_INTEGER;
<a name="l05700" id="l05700"></a>05700     variable.<a class="code" href=
"structvariable__list.html#6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.integer = 3;
<a name="l05701" id="l05701"></a>05701     variable.<a class="code" href=
"structvariable__list.html#17aaa6b445178fc39aba69642247d3e9" title=
"the length of the value to be copied into buf">val_len</a> = 4;
<a name="l05702" id="l05702"></a>05702     <span class="keywordflow">for</span> (argc--; argc; argc--, argv++) {
<a name="l05703" id="l05703"></a>05703         objidlen = MAX_OID_LEN;
<a name="l05704" id="l05704"></a>05704         printf(<span class="stringliteral">"read_objid(%s) = %d\n"</span>,
<a name="l05705" id="l05705"></a>05705                argv[1], <a class="code" href=
"group__mib__utilities.html#g1e4e5be57e55313a6c2bd2aabc065966" title=
"Reads an object identifier from an input string into internal OID form.">read_objid</a>(argv[1], objid, &amp;objidlen));
<a name="l05706" id="l05706"></a>05706         <span class="keywordflow">for</span> (count = 0; count &lt; objidlen; count++)
<a name="l05707" id="l05707"></a>05707             printf(<span class="stringliteral">"%d."</span>, objid[count]);
<a name="l05708" id="l05708"></a>05708         printf(<span class="stringliteral">"\n"</span>);
<a name="l05709" id="l05709"></a>05709         <a class="code" href=
"group__mib__utilities.html#g61cb98397be40630427b08b5e2789a81" title=
"Prints a variable to stdout.">print_variable</a>(objid, objidlen, &amp;variable);
<a name="l05710" id="l05710"></a>05710     }
<a name="l05711" id="l05711"></a>05711 }
<a name="l05712" id="l05712"></a>05712 
<a name="l05713" id="l05713"></a>05713 <span class="preprocessor">#endif                          </span><span class=
"comment">/* testing */</span>
<a name="l05714" id="l05714"></a>05714 
<a name="l05715" id="l05715"></a>05715 <span class="preprocessor">#ifndef NETSNMP_DISABLE_MIB_LOADING</span>
<a name="l05716" id="l05716"></a>05716 <span class="comment">/*</span>
<a name="l05717" id="l05717"></a>05717 <span class="comment"> * initialize: no peers included in the report. </span>
<a name="l05718" id="l05718"></a>05718 <span class="comment"> */</span>
<a name="l05719" id="l05719"></a>05719 <span class="keywordtype">void</span>
<a name="l05720" id="l05720"></a>05720 clear_tree_flags(<span class="keyword">register</span> <span class=
"keyword">struct</span> tree *tp)
<a name="l05721" id="l05721"></a>05721 {
<a name="l05722" id="l05722"></a>05722     <span class="keywordflow">for</span> (; tp; tp = tp-&gt;next_peer) {
<a name="l05723" id="l05723"></a>05723         tp-&gt;reported = 0;
<a name="l05724" id="l05724"></a>05724         <span class="keywordflow">if</span> (tp-&gt;child_list)
<a name="l05725" id="l05725"></a>05725             clear_tree_flags(tp-&gt;child_list);
<a name="l05726" id="l05726"></a>05726      <span class="comment">/*RECURSE*/</span>}
<a name="l05727" id="l05727"></a>05727 }
<a name="l05728" id="l05728"></a>05728 
<a name="l05729" id="l05729"></a>05729 <span class="comment">/*</span>
<a name="l05730" id="l05730"></a>05730 <span class="comment"> * Update: 1998-07-17 &lt;jhy@gsu.edu&gt;</span>
<a name="l05731" id="l05731"></a>05731 <span class="comment"> * Added print_oid_report* functions.</span>
<a name="l05732" id="l05732"></a>05732 <span class="comment"> */</span>
<a name="l05733" id="l05733"></a>05733 <span class="keyword">static</span> <span class=
"keywordtype">int</span>      print_subtree_oid_report_labeledoid = 0;
<a name="l05734" id="l05734"></a>05734 <span class="keyword">static</span> <span class=
"keywordtype">int</span>      print_subtree_oid_report_oid = 0;
<a name="l05735" id="l05735"></a>05735 <span class="keyword">static</span> <span class=
"keywordtype">int</span>      print_subtree_oid_report_symbolic = 0;
<a name="l05736" id="l05736"></a>05736 <span class="keyword">static</span> <span class=
"keywordtype">int</span>      print_subtree_oid_report_mibchildoid = 0;
<a name="l05737" id="l05737"></a>05737 <span class="keyword">static</span> <span class=
"keywordtype">int</span>      print_subtree_oid_report_suffix = 0;
<a name="l05738" id="l05738"></a>05738 
<a name="l05739" id="l05739"></a>05739 <span class="comment">/*</span>
<a name="l05740" id="l05740"></a>05740 <span class="comment"> * These methods recurse. </span>
<a name="l05741" id="l05741"></a>05741 <span class="comment"> */</span>
<a name="l05742" id="l05742"></a>05742 <span class="keyword">static</span> <span class=
"keywordtype">void</span>     print_parent_labeledoid(FILE *, <span class="keyword">struct</span> tree *);
<a name="l05743" id="l05743"></a>05743 <span class="keyword">static</span> <span class=
"keywordtype">void</span>     print_parent_oid(FILE *, <span class="keyword">struct</span> tree *);
<a name="l05744" id="l05744"></a>05744 <span class="keyword">static</span> <span class=
"keywordtype">void</span>     print_parent_mibchildoid(FILE *, <span class="keyword">struct</span> tree *);
<a name="l05745" id="l05745"></a>05745 <span class="keyword">static</span> <span class=
"keywordtype">void</span>     print_parent_label(FILE *, <span class="keyword">struct</span> tree *);
<a name="l05746" id="l05746"></a>05746 <span class="keyword">static</span> <span class=
"keywordtype">void</span>     print_subtree_oid_report(FILE *, <span class="keyword">struct</span> tree *, <span class=
"keywordtype">int</span>);
<a name="l05747" id="l05747"></a>05747 
<a name="l05748" id="l05748"></a>05748 
<a name="l05749" id="l05749"></a>05749 <span class="keywordtype">void</span>
<a name="l05750" id="l05750"></a>05750 print_oid_report(FILE * fp)
<a name="l05751" id="l05751"></a>05751 {
<a name="l05752" id="l05752"></a>05752     <span class="keyword">struct </span>tree    *tp;
<a name="l05753" id="l05753"></a>05753     clear_tree_flags(tree_head);
<a name="l05754" id="l05754"></a>05754     <span class="keywordflow">for</span> (tp = tree_head; tp; tp = tp-&gt;next_peer)
<a name="l05755" id="l05755"></a>05755         print_subtree_oid_report(fp, tp, 0);
<a name="l05756" id="l05756"></a>05756 }
<a name="l05757" id="l05757"></a>05757 
<a name="l05758" id="l05758"></a>05758 <span class="keywordtype">void</span>
<a name="l05759" id="l05759"></a>05759 print_oid_report_enable_labeledoid(<span class="keywordtype">void</span>)
<a name="l05760" id="l05760"></a>05760 {
<a name="l05761" id="l05761"></a>05761     print_subtree_oid_report_labeledoid = 1;
<a name="l05762" id="l05762"></a>05762 }
<a name="l05763" id="l05763"></a>05763 
<a name="l05764" id="l05764"></a>05764 <span class="keywordtype">void</span>
<a name="l05765" id="l05765"></a>05765 print_oid_report_enable_oid(<span class="keywordtype">void</span>)
<a name="l05766" id="l05766"></a>05766 {
<a name="l05767" id="l05767"></a>05767     print_subtree_oid_report_oid = 1;
<a name="l05768" id="l05768"></a>05768 }
<a name="l05769" id="l05769"></a>05769 
<a name="l05770" id="l05770"></a>05770 <span class="keywordtype">void</span>
<a name="l05771" id="l05771"></a>05771 print_oid_report_enable_suffix(<span class="keywordtype">void</span>)
<a name="l05772" id="l05772"></a>05772 {
<a name="l05773" id="l05773"></a>05773     print_subtree_oid_report_suffix = 1;
<a name="l05774" id="l05774"></a>05774 }
<a name="l05775" id="l05775"></a>05775 
<a name="l05776" id="l05776"></a>05776 <span class="keywordtype">void</span>
<a name="l05777" id="l05777"></a>05777 print_oid_report_enable_symbolic(<span class="keywordtype">void</span>)
<a name="l05778" id="l05778"></a>05778 {
<a name="l05779" id="l05779"></a>05779     print_subtree_oid_report_symbolic = 1;
<a name="l05780" id="l05780"></a>05780 }
<a name="l05781" id="l05781"></a>05781 
<a name="l05782" id="l05782"></a>05782 <span class="keywordtype">void</span>
<a name="l05783" id="l05783"></a>05783 print_oid_report_enable_mibchildoid(<span class="keywordtype">void</span>)
<a name="l05784" id="l05784"></a>05784 {
<a name="l05785" id="l05785"></a>05785     print_subtree_oid_report_mibchildoid = 1;
<a name="l05786" id="l05786"></a>05786 }
<a name="l05787" id="l05787"></a>05787 
<a name="l05788" id="l05788"></a>05788 <span class="comment">/*</span>
<a name="l05789" id="l05789"></a>05789 <span class="comment"> * helper methods for print_subtree_oid_report()</span>
<a name="l05790" id="l05790"></a>05790 <span class="comment"> * each one traverses back up the node tree</span>
<a name="l05791" id="l05791"></a>05791 <span class="comment"> * until there is no parent.  Then, the label combination</span>
<a name="l05792" id="l05792"></a>05792 <span class="comment"> * is output, such that the parent is displayed first.</span>
<a name="l05793" id="l05793"></a>05793 <span class="comment"> *</span>
<a name="l05794" id="l05794"></a>05794 <span class="comment"> * Warning: these methods are all recursive.</span>
<a name="l05795" id="l05795"></a>05795 <span class="comment"> */</span>
<a name="l05796" id="l05796"></a>05796 
<a name="l05797" id="l05797"></a>05797 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l05798" id="l05798"></a>05798 print_parent_labeledoid(FILE * f, <span class="keyword">struct</span> tree *tp)
<a name="l05799" id="l05799"></a>05799 {
<a name="l05800" id="l05800"></a>05800     <span class="keywordflow">if</span> (tp) {
<a name="l05801" id="l05801"></a>05801         <span class="keywordflow">if</span> (tp-&gt;parent) {
<a name="l05802" id="l05802"></a>05802             print_parent_labeledoid(f, tp-&gt;parent);
<a name="l05803" id="l05803"></a>05803          <span class="comment">/*RECURSE*/</span>}
<a name="l05804" id="l05804"></a>05804         fprintf(f, <span class=
"stringliteral">".%s(%lu)"</span>, tp-&gt;label, tp-&gt;subid);
<a name="l05805" id="l05805"></a>05805     }
<a name="l05806" id="l05806"></a>05806 }
<a name="l05807" id="l05807"></a>05807 
<a name="l05808" id="l05808"></a>05808 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l05809" id="l05809"></a>05809 print_parent_oid(FILE * f, <span class="keyword">struct</span> tree *tp)
<a name="l05810" id="l05810"></a>05810 {
<a name="l05811" id="l05811"></a>05811     <span class="keywordflow">if</span> (tp) {
<a name="l05812" id="l05812"></a>05812         <span class="keywordflow">if</span> (tp-&gt;parent) {
<a name="l05813" id="l05813"></a>05813             print_parent_oid(f, tp-&gt;parent);
<a name="l05814" id="l05814"></a>05814          <span class="comment">/*RECURSE*/</span>}
<a name="l05815" id="l05815"></a>05815         fprintf(f, <span class="stringliteral">".%lu"</span>, tp-&gt;subid);
<a name="l05816" id="l05816"></a>05816     }
<a name="l05817" id="l05817"></a>05817 }
<a name="l05818" id="l05818"></a>05818 
<a name="l05819" id="l05819"></a>05819 
<a name="l05820" id="l05820"></a>05820 <span class="keyword">static</span> <span class=
"keywordtype">void</span> print_parent_mibchildoid(FILE * f, <span class="keyword">struct</span> tree *tp)
<a name="l05821" id="l05821"></a>05821 {
<a name="l05822" id="l05822"></a>05822     <span class="keyword">static</span> <span class="keyword">struct </span>tree *temp;
<a name="l05823" id="l05823"></a>05823     <span class="keywordtype">unsigned</span> <span class=
"keywordtype">long</span> elems[100];
<a name="l05824" id="l05824"></a>05824     <span class="keywordtype">int</span> elem_cnt = 0;
<a name="l05825" id="l05825"></a>05825     <span class="keywordtype">int</span> i = 0;
<a name="l05826" id="l05826"></a>05826     temp = tp;
<a name="l05827" id="l05827"></a>05827     <span class="keywordflow">if</span> (temp) {
<a name="l05828" id="l05828"></a>05828         <span class="keywordflow">while</span> (temp-&gt;parent) {
<a name="l05829" id="l05829"></a>05829                 elems[elem_cnt++] = temp-&gt;subid;
<a name="l05830" id="l05830"></a>05830                 temp = temp-&gt;parent;
<a name="l05831" id="l05831"></a>05831         }
<a name="l05832" id="l05832"></a>05832         elems[elem_cnt++] = temp-&gt;subid;
<a name="l05833" id="l05833"></a>05833     }
<a name="l05834" id="l05834"></a>05834     <span class="keywordflow">for</span> (i = elem_cnt - 1; i &gt;= 0; i--) {
<a name="l05835" id="l05835"></a>05835         <span class="keywordflow">if</span> (i == elem_cnt - 1) {
<a name="l05836" id="l05836"></a>05836             fprintf(f, <span class="stringliteral">"%lu"</span>, elems[i]);           
<a name="l05837" id="l05837"></a>05837             } <span class="keywordflow">else</span> {
<a name="l05838" id="l05838"></a>05838             fprintf(f, <span class="stringliteral">".%lu"</span>, elems[i]);          
<a name="l05839" id="l05839"></a>05839         }
<a name="l05840" id="l05840"></a>05840     }
<a name="l05841" id="l05841"></a>05841 }
<a name="l05842" id="l05842"></a>05842 
<a name="l05843" id="l05843"></a>05843 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l05844" id="l05844"></a>05844 print_parent_label(FILE * f, <span class="keyword">struct</span> tree *tp)
<a name="l05845" id="l05845"></a>05845 {
<a name="l05846" id="l05846"></a>05846     <span class="keywordflow">if</span> (tp) {
<a name="l05847" id="l05847"></a>05847         <span class="keywordflow">if</span> (tp-&gt;parent) {
<a name="l05848" id="l05848"></a>05848             print_parent_label(f, tp-&gt;parent);
<a name="l05849" id="l05849"></a>05849          <span class="comment">/*RECURSE*/</span>}
<a name="l05850" id="l05850"></a>05850         fprintf(f, <span class="stringliteral">".%s"</span>, tp-&gt;label);
<a name="l05851" id="l05851"></a>05851     }
<a name="l05852" id="l05852"></a>05852 }
<a name="l05853" id="l05853"></a>05853 
<a name="l05865" id="l05865"></a>05865 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l05866" id="l05866"></a>05866 print_subtree_oid_report(FILE * f, <span class=
"keyword">struct</span> tree *tree, <span class="keywordtype">int</span> count)
<a name="l05867" id="l05867"></a>05867 {
<a name="l05868" id="l05868"></a>05868     <span class="keyword">struct </span>tree    *tp;
<a name="l05869" id="l05869"></a>05869 
<a name="l05870" id="l05870"></a>05870     count++;
<a name="l05871" id="l05871"></a>05871 
<a name="l05872" id="l05872"></a>05872     <span class="comment">/*</span>
<a name="l05873" id="l05873"></a>05873 <span class="comment">     * sanity check </span>
<a name="l05874" id="l05874"></a>05874 <span class="comment">     */</span>
<a name="l05875" id="l05875"></a>05875     <span class="keywordflow">if</span> (!tree) {
<a name="l05876" id="l05876"></a>05876         <span class="keywordflow">return</span>;
<a name="l05877" id="l05877"></a>05877     }
<a name="l05878" id="l05878"></a>05878 
<a name="l05879" id="l05879"></a>05879     <span class="comment">/*</span>
<a name="l05880" id="l05880"></a>05880 <span class=
"comment">     * find the not reported peer with the lowest sub-identifier.</span>
<a name="l05881" id="l05881"></a>05881 <span class="comment">     * if no more, break the loop and cleanup.</span>
<a name="l05882" id="l05882"></a>05882 <span class="comment">     * set "reported" flag, and create report for this peer.</span>
<a name="l05883" id="l05883"></a>05883 <span class="comment">     * recurse using the children of this peer, if any.</span>
<a name="l05884" id="l05884"></a>05884 <span class="comment">     */</span>
<a name="l05885" id="l05885"></a>05885     <span class="keywordflow">while</span> (1) {
<a name="l05886" id="l05886"></a>05886         <span class="keyword">register</span> <span class=
"keyword">struct </span>tree *ntp;
<a name="l05887" id="l05887"></a>05887 
<a name="l05888" id="l05888"></a>05888         tp = NULL;
<a name="l05889" id="l05889"></a>05889         <span class=
"keywordflow">for</span> (ntp = tree-&gt;child_list; ntp; ntp = ntp-&gt;next_peer) {
<a name="l05890" id="l05890"></a>05890             <span class="keywordflow">if</span> (ntp-&gt;reported)
<a name="l05891" id="l05891"></a>05891                 <span class="keywordflow">continue</span>;
<a name="l05892" id="l05892"></a>05892 
<a name="l05893" id="l05893"></a>05893             <span class="keywordflow">if</span> (!tp || (tp-&gt;subid &gt; ntp-&gt;subid))
<a name="l05894" id="l05894"></a>05894                 tp = ntp;
<a name="l05895" id="l05895"></a>05895         }
<a name="l05896" id="l05896"></a>05896         <span class="keywordflow">if</span> (!tp)
<a name="l05897" id="l05897"></a>05897             <span class="keywordflow">break</span>;
<a name="l05898" id="l05898"></a>05898 
<a name="l05899" id="l05899"></a>05899         tp-&gt;reported = 1;
<a name="l05900" id="l05900"></a>05900 
<a name="l05901" id="l05901"></a>05901         <span class="keywordflow">if</span> (print_subtree_oid_report_labeledoid) {
<a name="l05902" id="l05902"></a>05902             print_parent_labeledoid(f, tp);
<a name="l05903" id="l05903"></a>05903             fprintf(f, <span class="stringliteral">"\n"</span>);
<a name="l05904" id="l05904"></a>05904         }
<a name="l05905" id="l05905"></a>05905         <span class="keywordflow">if</span> (print_subtree_oid_report_oid) {
<a name="l05906" id="l05906"></a>05906             print_parent_oid(f, tp);
<a name="l05907" id="l05907"></a>05907             fprintf(f, <span class="stringliteral">"\n"</span>);
<a name="l05908" id="l05908"></a>05908         }
<a name="l05909" id="l05909"></a>05909         <span class="keywordflow">if</span> (print_subtree_oid_report_symbolic) {
<a name="l05910" id="l05910"></a>05910             print_parent_label(f, tp);
<a name="l05911" id="l05911"></a>05911             fprintf(f, <span class="stringliteral">"\n"</span>);
<a name="l05912" id="l05912"></a>05912         }
<a name="l05913" id="l05913"></a>05913         <span class="keywordflow">if</span> (print_subtree_oid_report_mibchildoid) {
<a name="l05914" id="l05914"></a>05914             fprintf(f, <span class="stringliteral">"\"%s\"\t"</span>, tp-&gt;label);
<a name="l05915" id="l05915"></a>05915             fprintf(f, <span class="stringliteral">"\t\t\""</span>);
<a name="l05916" id="l05916"></a>05916             print_parent_mibchildoid(f, tp);
<a name="l05917" id="l05917"></a>05917             fprintf(f, <span class="stringliteral">"\"\n"</span>);
<a name="l05918" id="l05918"></a>05918         }
<a name="l05919" id="l05919"></a>05919         <span class="keywordflow">if</span> (print_subtree_oid_report_suffix) {
<a name="l05920" id="l05920"></a>05920             <span class="keywordtype">int</span>             i;
<a name="l05921" id="l05921"></a>05921             <span class="keywordflow">for</span> (i = 0; i &lt; count; i++)
<a name="l05922" id="l05922"></a>05922                 fprintf(f, <span class="stringliteral">"  "</span>);
<a name="l05923" id="l05923"></a>05923             fprintf(f, <span class=
"stringliteral">"%s(%ld) type=%d"</span>, tp-&gt;label, tp-&gt;subid, tp-&gt;type);
<a name="l05924" id="l05924"></a>05924             <span class="keywordflow">if</span> (tp-&gt;tc_index != -1)
<a name="l05925" id="l05925"></a>05925                 fprintf(f, <span class="stringliteral">" tc=%d"</span>, tp-&gt;tc_index);
<a name="l05926" id="l05926"></a>05926             <span class="keywordflow">if</span> (tp-&gt;hint)
<a name="l05927" id="l05927"></a>05927                 fprintf(f, <span class="stringliteral">" hint=%s"</span>, tp-&gt;hint);
<a name="l05928" id="l05928"></a>05928             <span class="keywordflow">if</span> (tp-&gt;units)
<a name="l05929" id="l05929"></a>05929                 fprintf(f, <span class="stringliteral">" units=%s"</span>, tp-&gt;units);
<a name="l05930" id="l05930"></a>05930 
<a name="l05931" id="l05931"></a>05931             fprintf(f, <span class="stringliteral">"\n"</span>);
<a name="l05932" id="l05932"></a>05932         }
<a name="l05933" id="l05933"></a>05933         print_subtree_oid_report(f, tp, count);
<a name="l05934" id="l05934"></a>05934      <span class="comment">/*RECURSE*/</span>}
<a name="l05935" id="l05935"></a>05935 }
<a name="l05936" id="l05936"></a>05936 <span class="preprocessor">#endif </span><span class=
"comment">/* NETSNMP_DISABLE_MIB_LOADING */</span>
<a name="l05937" id="l05937"></a>05937 
<a name="l05938" id="l05938"></a>05938 
<a name="l05951" id="l05951"></a>05951 <span class="keywordtype">char</span>           *
<a name="l05952" id="l05952"></a><a class="code" href=
"group__mib__utilities.html#g126d35e840a96b33a7860425a1fc1f4c">05952</a> <a class="code" href=
"group__mib__utilities.html#g126d35e840a96b33a7860425a1fc1f4c" title=
"Converts timeticks to hours, minutes, seconds string.">uptime_string</a>(u_long timeticks, <span class=
"keywordtype">char</span> *buf)
<a name="l05953" id="l05953"></a>05953 {
<a name="l05954" id="l05954"></a>05954     <span class="keywordflow">return</span> uptime_string_n( timeticks, buf, 40);
<a name="l05955" id="l05955"></a>05955 }
<a name="l05956" id="l05956"></a>05956 
<a name="l05957" id="l05957"></a>05957 <span class="keywordtype">char</span>           *
<a name="l05958" id="l05958"></a>05958 uptime_string_n(u_long timeticks, <span class="keywordtype">char</span> *buf, <span class=
"keywordtype">size_t</span> buflen)
<a name="l05959" id="l05959"></a>05959 {
<a name="l05960" id="l05960"></a>05960     uptimeString(timeticks, buf, buflen);
<a name="l05961" id="l05961"></a>05961 <span class="preprocessor">#ifdef CMU_COMPATIBLE</span>
<a name="l05962" id="l05962"></a>05962     {
<a name="l05963" id="l05963"></a>05963     <span class="keywordtype">char</span> *cp = strrchr(buf, <span class=
"charliteral">'.'</span>);
<a name="l05964" id="l05964"></a>05964     <span class="keywordflow">if</span> (cp)
<a name="l05965" id="l05965"></a>05965         *cp = <span class="charliteral">'\0'</span>;
<a name="l05966" id="l05966"></a>05966     }
<a name="l05967" id="l05967"></a>05967 <span class="preprocessor">#endif</span>
<a name="l05968" id="l05968"></a>05968     <span class="keywordflow">return</span> buf;
<a name="l05969" id="l05969"></a>05969 }
<a name="l05970" id="l05970"></a>05970 
<a name="l05986" id="l05986"></a>05986 oid            *
<a name="l05987" id="l05987"></a><a class="code" href=
"group__mib__utilities.html#gcc48b7be12a42c7c4e388e8775c60557">05987</a> <a class="code" href=
"group__mib__utilities.html#gcc48b7be12a42c7c4e388e8775c60557" title=
"Given a string, parses an oid out of it (if possible).">snmp_parse_oid</a>(<span class="keyword">const</span> <span class=
"keywordtype">char</span> *argv, oid * root, <span class="keywordtype">size_t</span> * rootlen)
<a name="l05988" id="l05988"></a>05988 {
<a name="l05989" id="l05989"></a>05989     <span class="keywordtype">size_t</span>          savlen = *rootlen;
<a name="l05990" id="l05990"></a>05990     <span class="keyword">static</span> <span class=
"keywordtype">size_t</span>   tmpbuf_len = 0;
<a name="l05991" id="l05991"></a>05991     <span class="keyword">static</span> <span class="keywordtype">char</span>    *tmpbuf;
<a name="l05992" id="l05992"></a>05992     <span class="keyword">const</span> <span class=
"keywordtype">char</span>     *suffix, *prefix;
<a name="l05993" id="l05993"></a>05993 
<a name="l05994" id="l05994"></a>05994     suffix = netsnmp_ds_get_string(NETSNMP_DS_LIBRARY_ID,
<a name="l05995" id="l05995"></a>05995                                    NETSNMP_DS_LIB_OIDSUFFIX);
<a name="l05996" id="l05996"></a>05996     prefix = netsnmp_ds_get_string(NETSNMP_DS_LIBRARY_ID,
<a name="l05997" id="l05997"></a>05997                                    NETSNMP_DS_LIB_OIDPREFIX);
<a name="l05998" id="l05998"></a>05998     <span class=
"keywordflow">if</span> ((suffix &amp;&amp; suffix[0]) || (prefix &amp;&amp; prefix[0])) {
<a name="l05999" id="l05999"></a>05999         <span class="keywordflow">if</span> (!suffix)
<a name="l06000" id="l06000"></a>06000             suffix = <span class="stringliteral">""</span>;
<a name="l06001" id="l06001"></a>06001         <span class="keywordflow">if</span> (!prefix)
<a name="l06002" id="l06002"></a>06002             prefix = <span class="stringliteral">""</span>;
<a name="l06003" id="l06003"></a>06003         <span class=
"keywordflow">if</span> ((strlen(suffix) + strlen(prefix) + strlen(argv) + 2) &gt; tmpbuf_len) {
<a name="l06004" id="l06004"></a>06004             tmpbuf_len = strlen(suffix) + strlen(argv) + strlen(prefix) + 2;
<a name="l06005" id="l06005"></a>06005             tmpbuf = (<span class="keywordtype">char</span> *)realloc(tmpbuf, tmpbuf_len);
<a name="l06006" id="l06006"></a>06006         }
<a name="l06007" id="l06007"></a>06007         snprintf(tmpbuf, tmpbuf_len, <span class=
"stringliteral">"%s%s%s%s"</span>, prefix, argv,
<a name="l06008" id="l06008"></a>06008                  ((suffix[0] == <span class=
"charliteral">'.'</span> || suffix[0] == <span class="charliteral">'\0'</span>) ? <span class=
"stringliteral">""</span> : <span class="stringliteral">"."</span>),
<a name="l06009" id="l06009"></a>06009                  suffix);
<a name="l06010" id="l06010"></a>06010         argv = tmpbuf;
<a name="l06011" id="l06011"></a>06011         DEBUGMSGTL((<span class="stringliteral">"snmp_parse_oid"</span>,<span class=
"stringliteral">"Parsing: %s\n"</span>,argv));
<a name="l06012" id="l06012"></a>06012     }
<a name="l06013" id="l06013"></a>06013 
<a name="l06014" id="l06014"></a>06014 <span class="preprocessor">#ifndef NETSNMP_DISABLE_MIB_LOADING</span>
<a name="l06015" id="l06015"></a>06015     <span class=
"keywordflow">if</span> (netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_RANDOM_ACCESS)
<a name="l06016" id="l06016"></a>06016         || strchr(argv, <span class="charliteral">':'</span>)) {
<a name="l06017" id="l06017"></a>06017         <span class="keywordflow">if</span> (get_node(argv, root, rootlen)) {
<a name="l06018" id="l06018"></a>06018             <span class="keywordflow">return</span> root;
<a name="l06019" id="l06019"></a>06019         }
<a name="l06020" id="l06020"></a>06020     } <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (netsnmp_ds_get_boolean(NETSNMP_DS_LIBRARY_ID, NETSNMP_DS_LIB_REGEX_ACCESS)) {
<a name="l06021" id="l06021"></a>06021         clear_tree_flags(tree_head);
<a name="l06022" id="l06022"></a>06022         <span class="keywordflow">if</span> (<a class="code" href=
"group__mib__utilities.html#g01c1f66f4afdfbbcca1ed3cbb572e739">get_wild_node</a>(argv, root, rootlen)) {
<a name="l06023" id="l06023"></a>06023             <span class="keywordflow">return</span> root;
<a name="l06024" id="l06024"></a>06024         }
<a name="l06025" id="l06025"></a>06025     } <span class="keywordflow">else</span> {
<a name="l06026" id="l06026"></a>06026 <span class="preprocessor">#endif </span><span class=
"comment">/* NETSNMP_DISABLE_MIB_LOADING */</span>
<a name="l06027" id="l06027"></a>06027         <span class="keywordflow">if</span> (<a class="code" href=
"group__mib__utilities.html#g1e4e5be57e55313a6c2bd2aabc065966" title=
"Reads an object identifier from an input string into internal OID form.">read_objid</a>(argv, root, rootlen)) {
<a name="l06028" id="l06028"></a>06028             <span class="keywordflow">return</span> root;
<a name="l06029" id="l06029"></a>06029         }
<a name="l06030" id="l06030"></a>06030 <span class="preprocessor">#ifndef NETSNMP_DISABLE_MIB_LOADING</span>
<a name="l06031" id="l06031"></a>06031         *rootlen = savlen;
<a name="l06032" id="l06032"></a>06032         <span class="keywordflow">if</span> (get_node(argv, root, rootlen)) {
<a name="l06033" id="l06033"></a>06033             <span class="keywordflow">return</span> root;
<a name="l06034" id="l06034"></a>06034         }
<a name="l06035" id="l06035"></a>06035         *rootlen = savlen;
<a name="l06036" id="l06036"></a>06036         DEBUGMSGTL((<span class="stringliteral">"parse_oid"</span>, <span class=
"stringliteral">"wildly parsing\n"</span>));
<a name="l06037" id="l06037"></a>06037         clear_tree_flags(tree_head);
<a name="l06038" id="l06038"></a>06038         <span class="keywordflow">if</span> (<a class="code" href=
"group__mib__utilities.html#g01c1f66f4afdfbbcca1ed3cbb572e739">get_wild_node</a>(argv, root, rootlen)) {
<a name="l06039" id="l06039"></a>06039             <span class="keywordflow">return</span> root;
<a name="l06040" id="l06040"></a>06040         }
<a name="l06041" id="l06041"></a>06041     }
<a name="l06042" id="l06042"></a>06042 <span class="preprocessor">#endif </span><span class=
"comment">/* NETSNMP_DISABLE_MIB_LOADING */</span>
<a name="l06043" id="l06043"></a>06043     <span class="keywordflow">return</span> NULL;
<a name="l06044" id="l06044"></a>06044 }
<a name="l06045" id="l06045"></a>06045 
<a name="l06046" id="l06046"></a>06046 <span class="preprocessor">#ifndef NETSNMP_DISABLE_MIB_LOADING</span>
<a name="l06047" id="l06047"></a>06047 <span class="comment">/*</span>
<a name="l06048" id="l06048"></a>06048 <span class="comment"> * Use DISPLAY-HINT to parse a value into an octet string.</span>
<a name="l06049" id="l06049"></a>06049 <span class="comment"> *</span>
<a name="l06050" id="l06050"></a>06050 <span class=
"comment"> * note that "1d1d", "11" could have come from an octet string that</span>
<a name="l06051" id="l06051"></a>06051 <span class=
"comment"> * looked like { 1, 1 } or an octet string that looked like { 11 }</span>
<a name="l06052" id="l06052"></a>06052 <span class=
"comment"> * because of this, it's doubtful that anyone would use such a display</span>
<a name="l06053" id="l06053"></a>06053 <span class="comment"> * string. Therefore, the parser ignores this case.</span>
<a name="l06054" id="l06054"></a>06054 <span class="comment"> */</span>
<a name="l06055" id="l06055"></a>06055 
<a name="l06056" id="l06056"></a>06056 <span class="keyword">struct </span>parse_hints {
<a name="l06057" id="l06057"></a>06057     <span class="keywordtype">int</span> length;
<a name="l06058" id="l06058"></a>06058     <span class="keywordtype">int</span> repeat;
<a name="l06059" id="l06059"></a>06059     <span class="keywordtype">int</span> format;
<a name="l06060" id="l06060"></a>06060     <span class="keywordtype">int</span> separator;
<a name="l06061" id="l06061"></a>06061     <span class="keywordtype">int</span> terminator;
<a name="l06062" id="l06062"></a>06062     <span class="keywordtype">unsigned</span> <span class=
"keywordtype">char</span> *result;
<a name="l06063" id="l06063"></a>06063     <span class="keywordtype">int</span> result_max;
<a name="l06064" id="l06064"></a>06064     <span class="keywordtype">int</span> result_len;
<a name="l06065" id="l06065"></a>06065 };
<a name="l06066" id="l06066"></a>06066 
<a name="l06067" id="l06067"></a>06067 <span class="keyword">static</span> <span class=
"keywordtype">void</span> parse_hints_reset(<span class="keyword">struct</span> parse_hints *ph)
<a name="l06068" id="l06068"></a>06068 {
<a name="l06069" id="l06069"></a>06069     ph-&gt;length = 0;
<a name="l06070" id="l06070"></a>06070     ph-&gt;repeat = 0;
<a name="l06071" id="l06071"></a>06071     ph-&gt;format = 0;
<a name="l06072" id="l06072"></a>06072     ph-&gt;separator = 0;
<a name="l06073" id="l06073"></a>06073     ph-&gt;terminator = 0;
<a name="l06074" id="l06074"></a>06074 }
<a name="l06075" id="l06075"></a>06075 
<a name="l06076" id="l06076"></a>06076 <span class="keyword">static</span> <span class=
"keywordtype">void</span> parse_hints_ctor(<span class="keyword">struct</span> parse_hints *ph)
<a name="l06077" id="l06077"></a>06077 {
<a name="l06078" id="l06078"></a>06078     parse_hints_reset(ph);
<a name="l06079" id="l06079"></a>06079     ph-&gt;result = NULL;
<a name="l06080" id="l06080"></a>06080     ph-&gt;result_max = 0;
<a name="l06081" id="l06081"></a>06081     ph-&gt;result_len = 0;
<a name="l06082" id="l06082"></a>06082 }
<a name="l06083" id="l06083"></a>06083 
<a name="l06084" id="l06084"></a>06084 <span class="keyword">static</span> <span class=
"keywordtype">int</span> parse_hints_add_result_octet(<span class="keyword">struct</span> parse_hints *ph, <span class=
"keywordtype">unsigned</span> <span class="keywordtype">char</span> octet)
<a name="l06085" id="l06085"></a>06085 {
<a name="l06086" id="l06086"></a>06086     <span class="keywordflow">if</span> (!(ph-&gt;result_len &lt; ph-&gt;result_max)) {
<a name="l06087" id="l06087"></a>06087         ph-&gt;result_max = ph-&gt;result_len + 32;
<a name="l06088" id="l06088"></a>06088         <span class="keywordflow">if</span> (!ph-&gt;result) {
<a name="l06089" id="l06089"></a>06089             ph-&gt;result = (<span class="keywordtype">unsigned</span> <span class=
"keywordtype">char</span> *)malloc(ph-&gt;result_max);
<a name="l06090" id="l06090"></a>06090         } <span class="keywordflow">else</span> {
<a name="l06091" id="l06091"></a>06091             ph-&gt;result = (<span class="keywordtype">unsigned</span> <span class=
"keywordtype">char</span> *)realloc(ph-&gt;result, ph-&gt;result_max);
<a name="l06092" id="l06092"></a>06092         }
<a name="l06093" id="l06093"></a>06093     }
<a name="l06094" id="l06094"></a>06094     
<a name="l06095" id="l06095"></a>06095     <span class="keywordflow">if</span> (!ph-&gt;result) {
<a name="l06096" id="l06096"></a>06096         <span class="keywordflow">return</span> 0;               <span class=
"comment">/* failed */</span>
<a name="l06097" id="l06097"></a>06097     }
<a name="l06098" id="l06098"></a>06098 
<a name="l06099" id="l06099"></a>06099     ph-&gt;result[ph-&gt;result_len++] = octet;
<a name="l06100" id="l06100"></a>06100     <span class="keywordflow">return</span> 1;                   <span class=
"comment">/* success */</span>
<a name="l06101" id="l06101"></a>06101 }
<a name="l06102" id="l06102"></a>06102 
<a name="l06103" id="l06103"></a>06103 <span class="keyword">static</span> <span class=
"keywordtype">int</span> parse_hints_parse(<span class="keyword">struct</span> parse_hints *ph, <span class=
"keyword">const</span> <span class="keywordtype">char</span> **v_in_out)
<a name="l06104" id="l06104"></a>06104 {
<a name="l06105" id="l06105"></a>06105     <span class="keyword">const</span> <span class=
"keywordtype">char</span> *v = *v_in_out;
<a name="l06106" id="l06106"></a>06106     <span class="keywordtype">char</span> *nv;
<a name="l06107" id="l06107"></a>06107     <span class="keywordtype">int</span> base;
<a name="l06108" id="l06108"></a>06108     <span class="keywordtype">int</span> repeats = 0;
<a name="l06109" id="l06109"></a>06109     <span class="keywordtype">int</span> repeat_fixup = ph-&gt;result_len;
<a name="l06110" id="l06110"></a>06110     
<a name="l06111" id="l06111"></a>06111     <span class="keywordflow">if</span> (ph-&gt;repeat) {
<a name="l06112" id="l06112"></a>06112         <span class="keywordflow">if</span> (!parse_hints_add_result_octet(ph, 0)) {
<a name="l06113" id="l06113"></a>06113             <span class="keywordflow">return</span> 0;
<a name="l06114" id="l06114"></a>06114         }
<a name="l06115" id="l06115"></a>06115     }
<a name="l06116" id="l06116"></a>06116     <span class="keywordflow">do</span> {
<a name="l06117" id="l06117"></a>06117         base = 0;
<a name="l06118" id="l06118"></a>06118         <span class="keywordflow">switch</span> (ph-&gt;format) {
<a name="l06119" id="l06119"></a>06119         <span class="keywordflow">case</span> <span class=
"charliteral">'x'</span>: base += 6;    <span class="comment">/* fall through */</span>
<a name="l06120" id="l06120"></a>06120         <span class="keywordflow">case</span> <span class=
"charliteral">'d'</span>: base += 2;    <span class="comment">/* fall through */</span>
<a name="l06121" id="l06121"></a>06121         <span class="keywordflow">case</span> <span class=
"charliteral">'o'</span>: base += 8;    <span class="comment">/* fall through */</span>
<a name="l06122" id="l06122"></a>06122             {
<a name="l06123" id="l06123"></a>06123                 <span class="keywordtype">int</span> i;
<a name="l06124" id="l06124"></a>06124                 <span class="keywordtype">unsigned</span> <span class=
"keywordtype">long</span> number = strtol(v, &amp;nv, base);
<a name="l06125" id="l06125"></a>06125                 <span class="keywordflow">if</span> (nv == v) <span class=
"keywordflow">return</span> 0;
<a name="l06126" id="l06126"></a>06126                 v = nv;
<a name="l06127" id="l06127"></a>06127                 <span class="keywordflow">for</span> (i = 0; i &lt; ph-&gt;length; i++) {
<a name="l06128" id="l06128"></a>06128                     <span class=
"keywordtype">int</span> shift = 8 * (ph-&gt;length - 1 - i);
<a name="l06129" id="l06129"></a>06129                     <span class=
"keywordflow">if</span> (!parse_hints_add_result_octet(ph, (u_char)(number &gt;&gt; shift) )) {
<a name="l06130" id="l06130"></a>06130                         <span class="keywordflow">return</span> 0; <span class=
"comment">/* failed */</span>
<a name="l06131" id="l06131"></a>06131                     }
<a name="l06132" id="l06132"></a>06132                 }
<a name="l06133" id="l06133"></a>06133             }
<a name="l06134" id="l06134"></a>06134             <span class="keywordflow">break</span>;
<a name="l06135" id="l06135"></a>06135 
<a name="l06136" id="l06136"></a>06136         <span class="keywordflow">case</span> <span class="charliteral">'a'</span>:
<a name="l06137" id="l06137"></a>06137             {
<a name="l06138" id="l06138"></a>06138                 <span class="keywordtype">int</span> i;
<a name="l06139" id="l06139"></a>06139                     
<a name="l06140" id="l06140"></a>06140                 <span class=
"keywordflow">for</span> (i = 0; i &lt; ph-&gt;length &amp;&amp; *v; i++) {
<a name="l06141" id="l06141"></a>06141                     <span class=
"keywordflow">if</span> (!parse_hints_add_result_octet(ph, *v++)) {
<a name="l06142" id="l06142"></a>06142                         <span class="keywordflow">return</span> 0;       <span class=
"comment">/* failed */</span>
<a name="l06143" id="l06143"></a>06143                     }
<a name="l06144" id="l06144"></a>06144                 }
<a name="l06145" id="l06145"></a>06145             }
<a name="l06146" id="l06146"></a>06146             <span class="keywordflow">break</span>;
<a name="l06147" id="l06147"></a>06147         }
<a name="l06148" id="l06148"></a>06148 
<a name="l06149" id="l06149"></a>06149         repeats++;
<a name="l06150" id="l06150"></a>06150 
<a name="l06151" id="l06151"></a>06151         <span class="keywordflow">if</span> (ph-&gt;separator &amp;&amp; *v) {
<a name="l06152" id="l06152"></a>06152             <span class="keywordflow">if</span> (*v == ph-&gt;separator) {
<a name="l06153" id="l06153"></a>06153                 v++;
<a name="l06154" id="l06154"></a>06154             } <span class="keywordflow">else</span> {
<a name="l06155" id="l06155"></a>06155                 <span class="keywordflow">return</span> 0;               <span class=
"comment">/* failed */</span>
<a name="l06156" id="l06156"></a>06156             }
<a name="l06157" id="l06157"></a>06157         }
<a name="l06158" id="l06158"></a>06158 
<a name="l06159" id="l06159"></a>06159         <span class="keywordflow">if</span> (ph-&gt;terminator) {
<a name="l06160" id="l06160"></a>06160             <span class="keywordflow">if</span> (*v == ph-&gt;terminator) {
<a name="l06161" id="l06161"></a>06161                 v++;
<a name="l06162" id="l06162"></a>06162                 <span class="keywordflow">break</span>;
<a name="l06163" id="l06163"></a>06163             }
<a name="l06164" id="l06164"></a>06164         }
<a name="l06165" id="l06165"></a>06165     } <span class="keywordflow">while</span> (ph-&gt;repeat &amp;&amp; *v);
<a name="l06166" id="l06166"></a>06166     <span class="keywordflow">if</span> (ph-&gt;repeat) {
<a name="l06167" id="l06167"></a>06167         ph-&gt;result[repeat_fixup] = repeats;
<a name="l06168" id="l06168"></a>06168     }
<a name="l06169" id="l06169"></a>06169 
<a name="l06170" id="l06170"></a>06170     *v_in_out = v;
<a name="l06171" id="l06171"></a>06171     <span class="keywordflow">return</span> 1;
<a name="l06172" id="l06172"></a>06172 }
<a name="l06173" id="l06173"></a>06173 
<a name="l06174" id="l06174"></a>06174 <span class="keyword">static</span> <span class=
"keywordtype">void</span> parse_hints_length_add_digit(<span class="keyword">struct</span> parse_hints *ph, <span class=
"keywordtype">int</span> digit)
<a name="l06175" id="l06175"></a>06175 {
<a name="l06176" id="l06176"></a>06176     ph-&gt;length *= 10;
<a name="l06177" id="l06177"></a>06177     ph-&gt;length += digit - <span class="charliteral">'0'</span>;
<a name="l06178" id="l06178"></a>06178 }
<a name="l06179" id="l06179"></a>06179 
<a name="l06180" id="l06180"></a>06180 <span class="keyword">const</span> <span class=
"keywordtype">char</span> *parse_octet_hint(<span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *value, <span class=
"keywordtype">unsigned</span> <span class="keywordtype">char</span> **new_val, <span class="keywordtype">int</span> *new_val_len)
<a name="l06181" id="l06181"></a>06181 {
<a name="l06182" id="l06182"></a>06182     <span class="keyword">const</span> <span class="keywordtype">char</span> *h = hint;
<a name="l06183" id="l06183"></a>06183     <span class="keyword">const</span> <span class="keywordtype">char</span> *v = value;
<a name="l06184" id="l06184"></a>06184     <span class="keyword">struct </span>parse_hints ph;
<a name="l06185" id="l06185"></a>06185     <span class="keywordtype">int</span> retval = 1;
<a name="l06186" id="l06186"></a>06186     <span class="comment">/* See RFC 1443 */</span>
<a name="l06187" id="l06187"></a>06187     <span class="keyword">enum</span> {
<a name="l06188" id="l06188"></a>06188         HINT_1_2,
<a name="l06189" id="l06189"></a>06189         HINT_2_3,
<a name="l06190" id="l06190"></a>06190         HINT_1_2_4,
<a name="l06191" id="l06191"></a>06191         HINT_1_2_5
<a name="l06192" id="l06192"></a>06192     } state = HINT_1_2;
<a name="l06193" id="l06193"></a>06193 
<a name="l06194" id="l06194"></a>06194     parse_hints_ctor(&amp;ph);
<a name="l06195" id="l06195"></a>06195     <span class="keywordflow">while</span> (*h &amp;&amp; *v &amp;&amp; retval) {
<a name="l06196" id="l06196"></a>06196         <span class="keywordflow">switch</span> (state) {
<a name="l06197" id="l06197"></a>06197         <span class="keywordflow">case</span> HINT_1_2:
<a name="l06198" id="l06198"></a>06198             <span class="keywordflow">if</span> (<span class=
"charliteral">'*'</span> == *h) {
<a name="l06199" id="l06199"></a>06199                 ph.repeat = 1;
<a name="l06200" id="l06200"></a>06200                 state = HINT_2_3;
<a name="l06201" id="l06201"></a>06201             } <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (isdigit(*h)) {
<a name="l06202" id="l06202"></a>06202                 parse_hints_length_add_digit(&amp;ph, *h);
<a name="l06203" id="l06203"></a>06203                 state = HINT_2_3;
<a name="l06204" id="l06204"></a>06204             } <span class="keywordflow">else</span> {
<a name="l06205" id="l06205"></a>06205                 <span class="keywordflow">return</span> v;       <span class=
"comment">/* failed */</span>
<a name="l06206" id="l06206"></a>06206             }
<a name="l06207" id="l06207"></a>06207             <span class="keywordflow">break</span>;
<a name="l06208" id="l06208"></a>06208 
<a name="l06209" id="l06209"></a>06209         <span class="keywordflow">case</span> HINT_2_3:
<a name="l06210" id="l06210"></a>06210             <span class="keywordflow">if</span> (isdigit(*h)) {
<a name="l06211" id="l06211"></a>06211                 parse_hints_length_add_digit(&amp;ph, *h);
<a name="l06212" id="l06212"></a>06212                 <span class="comment">/* state = HINT_2_3 */</span>
<a name="l06213" id="l06213"></a>06213             } <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (<span class="charliteral">'x'</span> == *h || <span class="charliteral">'d'</span> == *h || <span class=
"charliteral">'o'</span> == *h || <span class="charliteral">'a'</span> == *h) {
<a name="l06214" id="l06214"></a>06214                 ph.format = *h;
<a name="l06215" id="l06215"></a>06215                 state = HINT_1_2_4;
<a name="l06216" id="l06216"></a>06216             } <span class="keywordflow">else</span> {
<a name="l06217" id="l06217"></a>06217                 <span class="keywordflow">return</span> v;       <span class=
"comment">/* failed */</span>
<a name="l06218" id="l06218"></a>06218             }
<a name="l06219" id="l06219"></a>06219             <span class="keywordflow">break</span>;
<a name="l06220" id="l06220"></a>06220 
<a name="l06221" id="l06221"></a>06221         <span class="keywordflow">case</span> HINT_1_2_4:
<a name="l06222" id="l06222"></a>06222             <span class="keywordflow">if</span> (<span class=
"charliteral">'*'</span> == *h) {
<a name="l06223" id="l06223"></a>06223                 retval = parse_hints_parse(&amp;ph, &amp;v);
<a name="l06224" id="l06224"></a>06224                 parse_hints_reset(&amp;ph);
<a name="l06225" id="l06225"></a>06225                 
<a name="l06226" id="l06226"></a>06226                 ph.repeat = 1;
<a name="l06227" id="l06227"></a>06227                 state = HINT_2_3;
<a name="l06228" id="l06228"></a>06228             } <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (isdigit(*h)) {
<a name="l06229" id="l06229"></a>06229                 retval = parse_hints_parse(&amp;ph, &amp;v);
<a name="l06230" id="l06230"></a>06230                 parse_hints_reset(&amp;ph);
<a name="l06231" id="l06231"></a>06231                 
<a name="l06232" id="l06232"></a>06232                 parse_hints_length_add_digit(&amp;ph, *h);
<a name="l06233" id="l06233"></a>06233                 state = HINT_2_3;
<a name="l06234" id="l06234"></a>06234             } <span class="keywordflow">else</span> {
<a name="l06235" id="l06235"></a>06235                 ph.separator = *h;
<a name="l06236" id="l06236"></a>06236                 state = HINT_1_2_5;
<a name="l06237" id="l06237"></a>06237             }
<a name="l06238" id="l06238"></a>06238             <span class="keywordflow">break</span>;
<a name="l06239" id="l06239"></a>06239 
<a name="l06240" id="l06240"></a>06240         <span class="keywordflow">case</span> HINT_1_2_5:
<a name="l06241" id="l06241"></a>06241             <span class="keywordflow">if</span> (<span class=
"charliteral">'*'</span> == *h) {
<a name="l06242" id="l06242"></a>06242                 retval = parse_hints_parse(&amp;ph, &amp;v);
<a name="l06243" id="l06243"></a>06243                 parse_hints_reset(&amp;ph);
<a name="l06244" id="l06244"></a>06244                 
<a name="l06245" id="l06245"></a>06245                 ph.repeat = 1;
<a name="l06246" id="l06246"></a>06246                 state = HINT_2_3;
<a name="l06247" id="l06247"></a>06247             } <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (isdigit(*h)) {
<a name="l06248" id="l06248"></a>06248                 retval = parse_hints_parse(&amp;ph, &amp;v);
<a name="l06249" id="l06249"></a>06249                 parse_hints_reset(&amp;ph);
<a name="l06250" id="l06250"></a>06250                 
<a name="l06251" id="l06251"></a>06251                 parse_hints_length_add_digit(&amp;ph, *h);
<a name="l06252" id="l06252"></a>06252                 state = HINT_2_3;
<a name="l06253" id="l06253"></a>06253             } <span class="keywordflow">else</span> {
<a name="l06254" id="l06254"></a>06254                 ph.terminator = *h;
<a name="l06255" id="l06255"></a>06255 
<a name="l06256" id="l06256"></a>06256                 retval = parse_hints_parse(&amp;ph, &amp;v);
<a name="l06257" id="l06257"></a>06257                 parse_hints_reset(&amp;ph);
<a name="l06258" id="l06258"></a>06258 
<a name="l06259" id="l06259"></a>06259                 state = HINT_1_2;
<a name="l06260" id="l06260"></a>06260             }
<a name="l06261" id="l06261"></a>06261             <span class="keywordflow">break</span>;
<a name="l06262" id="l06262"></a>06262         }
<a name="l06263" id="l06263"></a>06263         h++;
<a name="l06264" id="l06264"></a>06264     }
<a name="l06265" id="l06265"></a>06265     <span class="keywordflow">while</span> (*v &amp;&amp; retval) {
<a name="l06266" id="l06266"></a>06266         retval = parse_hints_parse(&amp;ph, &amp;v);
<a name="l06267" id="l06267"></a>06267     }
<a name="l06268" id="l06268"></a>06268     <span class="keywordflow">if</span> (retval) {
<a name="l06269" id="l06269"></a>06269         *new_val = ph.result;
<a name="l06270" id="l06270"></a>06270         *new_val_len = ph.result_len;
<a name="l06271" id="l06271"></a>06271     } <span class="keywordflow">else</span> {
<a name="l06272" id="l06272"></a>06272         <span class="keywordflow">if</span> (ph.result) {
<a name="l06273" id="l06273"></a>06273             <a class="code" href="group__util.html#g951e93edb6f0ea941e26155e3f8912a6"
title="Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(ph.result);
<a name="l06274" id="l06274"></a>06274         }
<a name="l06275" id="l06275"></a>06275         *new_val = NULL;
<a name="l06276" id="l06276"></a>06276         *new_val_len = 0;
<a name="l06277" id="l06277"></a>06277     }
<a name="l06278" id="l06278"></a>06278     <span class="keywordflow">return</span> retval ? NULL : v;
<a name="l06279" id="l06279"></a>06279 }
<a name="l06280" id="l06280"></a>06280 <span class="preprocessor">#endif </span><span class=
"comment">/* NETSNMP_DISABLE_MIB_LOADING */</span>
<a name="l06281" id="l06281"></a>06281 
<a name="l06282" id="l06282"></a>06282 <span class="preprocessor">#ifdef test_display_hint</span>
<a name="l06283" id="l06283"></a>06283 
<a name="l06284" id="l06284"></a>06284 <span class="keywordtype">int</span> main(<span class=
"keywordtype">int</span> argc, <span class="keyword">const</span> <span class="keywordtype">char</span> **argv)
<a name="l06285" id="l06285"></a>06285 {
<a name="l06286" id="l06286"></a>06286     <span class="keyword">const</span> <span class="keywordtype">char</span> *hint;
<a name="l06287" id="l06287"></a>06287     <span class="keyword">const</span> <span class="keywordtype">char</span> *value;
<a name="l06288" id="l06288"></a>06288     <span class="keywordtype">unsigned</span> <span class=
"keywordtype">char</span> *new_val;
<a name="l06289" id="l06289"></a>06289     <span class="keywordtype">int</span> new_val_len;
<a name="l06290" id="l06290"></a>06290     <span class="keywordtype">char</span> *r;
<a name="l06291" id="l06291"></a>06291     
<a name="l06292" id="l06292"></a>06292     <span class="keywordflow">if</span> (argc &lt; 3) {
<a name="l06293" id="l06293"></a>06293         fprintf(stderr, <span class=
"stringliteral">"usage: dh &lt;hint&gt; &lt;value&gt;\n"</span>);
<a name="l06294" id="l06294"></a>06294         exit(2);
<a name="l06295" id="l06295"></a>06295     }
<a name="l06296" id="l06296"></a>06296     hint = argv[1];
<a name="l06297" id="l06297"></a>06297     value = argv[2];
<a name="l06298" id="l06298"></a>06298     r = parse_octet_hint(hint, value, &amp;new_val, &amp;new_val_len);
<a name="l06299" id="l06299"></a>06299     printf(<span class="stringliteral">"{\"%s\", \"%s\"}: \n\t"</span>, hint, value);
<a name="l06300" id="l06300"></a>06300     <span class="keywordflow">if</span> (r) {
<a name="l06301" id="l06301"></a>06301         *r = 0;
<a name="l06302" id="l06302"></a>06302         printf(<span class="stringliteral">"returned failed\n"</span>);
<a name="l06303" id="l06303"></a>06303         printf(<span class="stringliteral">"value syntax error at: %s\n"</span>, value);
<a name="l06304" id="l06304"></a>06304     }
<a name="l06305" id="l06305"></a>06305     <span class="keywordflow">else</span> {
<a name="l06306" id="l06306"></a>06306         <span class="keywordtype">int</span> i;
<a name="l06307" id="l06307"></a>06307         printf(<span class="stringliteral">"returned success\n"</span>);
<a name="l06308" id="l06308"></a>06308         <span class="keywordflow">for</span> (i = 0; i &lt; new_val_len; i++) {
<a name="l06309" id="l06309"></a>06309             <span class="keywordtype">int</span> c = new_val[i] &amp; 0xFF;
<a name="l06310" id="l06310"></a>06310             printf(<span class=
"stringliteral">"%02X(%c) "</span>, c, isprint(c) ? c : <span class="charliteral">' '</span>);
<a name="l06311" id="l06311"></a>06311         }
<a name="l06312" id="l06312"></a>06312         <a class="code" href="group__util.html#g951e93edb6f0ea941e26155e3f8912a6" title=
"Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(new_val);
<a name="l06313" id="l06313"></a>06313     }
<a name="l06314" id="l06314"></a>06314     printf(<span class="stringliteral">"\n"</span>);
<a name="l06315" id="l06315"></a>06315     exit(0);
<a name="l06316" id="l06316"></a>06316 }
<a name="l06317" id="l06317"></a>06317 
<a name="l06318" id="l06318"></a>06318 <span class="preprocessor">#endif </span><span class=
"comment">/* test_display_hint */</span>
<a name="l06319" id="l06319"></a>06319 
<a name="l06320" id="l06320"></a>06320 u_char
<a name="l06321" id="l06321"></a>06321 mib_to_asn_type(<span class="keywordtype">int</span> mib_type)
<a name="l06322" id="l06322"></a>06322 {
<a name="l06323" id="l06323"></a>06323     <span class="keywordflow">switch</span> (mib_type) {
<a name="l06324" id="l06324"></a>06324     <span class="keywordflow">case</span> TYPE_OBJID:
<a name="l06325" id="l06325"></a>06325         <span class="keywordflow">return</span> ASN_OBJECT_ID;
<a name="l06326" id="l06326"></a>06326 
<a name="l06327" id="l06327"></a>06327     <span class="keywordflow">case</span> TYPE_OCTETSTR:
<a name="l06328" id="l06328"></a>06328         <span class="keywordflow">return</span> ASN_OCTET_STR;
<a name="l06329" id="l06329"></a>06329 
<a name="l06330" id="l06330"></a>06330     <span class="keywordflow">case</span> TYPE_NETADDR:
<a name="l06331" id="l06331"></a>06331     <span class="keywordflow">case</span> TYPE_IPADDR:
<a name="l06332" id="l06332"></a>06332         <span class="keywordflow">return</span> ASN_IPADDRESS;
<a name="l06333" id="l06333"></a>06333 
<a name="l06334" id="l06334"></a>06334     <span class="keywordflow">case</span> TYPE_INTEGER32:
<a name="l06335" id="l06335"></a>06335     <span class="keywordflow">case</span> TYPE_INTEGER:
<a name="l06336" id="l06336"></a>06336         <span class="keywordflow">return</span> ASN_INTEGER;
<a name="l06337" id="l06337"></a>06337 
<a name="l06338" id="l06338"></a>06338     <span class="keywordflow">case</span> TYPE_COUNTER:
<a name="l06339" id="l06339"></a>06339         <span class="keywordflow">return</span> ASN_COUNTER;
<a name="l06340" id="l06340"></a>06340 
<a name="l06341" id="l06341"></a>06341     <span class="keywordflow">case</span> TYPE_GAUGE:
<a name="l06342" id="l06342"></a>06342         <span class="keywordflow">return</span> ASN_GAUGE;
<a name="l06343" id="l06343"></a>06343 
<a name="l06344" id="l06344"></a>06344     <span class="keywordflow">case</span> TYPE_TIMETICKS:
<a name="l06345" id="l06345"></a>06345         <span class="keywordflow">return</span> ASN_TIMETICKS;
<a name="l06346" id="l06346"></a>06346 
<a name="l06347" id="l06347"></a>06347     <span class="keywordflow">case</span> TYPE_OPAQUE:
<a name="l06348" id="l06348"></a>06348         <span class="keywordflow">return</span> ASN_OPAQUE;
<a name="l06349" id="l06349"></a>06349 
<a name="l06350" id="l06350"></a>06350     <span class="keywordflow">case</span> TYPE_NULL:
<a name="l06351" id="l06351"></a>06351         <span class="keywordflow">return</span> ASN_NULL;
<a name="l06352" id="l06352"></a>06352 
<a name="l06353" id="l06353"></a>06353     <span class="keywordflow">case</span> TYPE_COUNTER64:
<a name="l06354" id="l06354"></a>06354         <span class="keywordflow">return</span> ASN_COUNTER64;
<a name="l06355" id="l06355"></a>06355 
<a name="l06356" id="l06356"></a>06356     <span class="keywordflow">case</span> TYPE_BITSTRING:
<a name="l06357" id="l06357"></a>06357         <span class="keywordflow">return</span> ASN_BIT_STR;
<a name="l06358" id="l06358"></a>06358 
<a name="l06359" id="l06359"></a>06359     <span class="keywordflow">case</span> TYPE_UINTEGER:
<a name="l06360" id="l06360"></a>06360     <span class="keywordflow">case</span> TYPE_UNSIGNED32:
<a name="l06361" id="l06361"></a>06361         <span class="keywordflow">return</span> ASN_UNSIGNED;
<a name="l06362" id="l06362"></a>06362 
<a name="l06363" id="l06363"></a>06363     <span class="keywordflow">case</span> TYPE_NSAPADDRESS:
<a name="l06364" id="l06364"></a>06364         <span class="keywordflow">return</span> ASN_NSAP;
<a name="l06365" id="l06365"></a>06365 
<a name="l06366" id="l06366"></a>06366     }
<a name="l06367" id="l06367"></a>06367     <span class="keywordflow">return</span> -1;
<a name="l06368" id="l06368"></a>06368 }
<a name="l06369" id="l06369"></a>06369 
<a name="l06380" id="l06380"></a>06380 <span class="keywordtype">int</span>
<a name="l06381" id="l06381"></a><a class="code" href=
"group__mib__utilities.html#g5b5e00f313a49465d2f774e0eefb4aac">06381</a> <a class="code" href=
"group__mib__utilities.html#g5b5e00f313a49465d2f774e0eefb4aac" title=
"Converts a string to its OID form.">netsnmp_str2oid</a>(<span class="keyword">const</span> <span class=
"keywordtype">char</span> *S, oid * O, <span class="keywordtype">int</span> L)
<a name="l06382" id="l06382"></a>06382 {
<a name="l06383" id="l06383"></a>06383     <span class="keyword">const</span> <span class="keywordtype">char</span>     *c = S;
<a name="l06384" id="l06384"></a>06384     oid            *o = &amp;O[1];
<a name="l06385" id="l06385"></a>06385 
<a name="l06386" id="l06386"></a>06386     --L;                        <span class=
"comment">/* leave room for length prefix */</span>
<a name="l06387" id="l06387"></a>06387 
<a name="l06388" id="l06388"></a>06388     <span class="keywordflow">for</span> (; *c &amp;&amp; L; --L, ++o, ++c)
<a name="l06389" id="l06389"></a>06389         *o = *c;
<a name="l06390" id="l06390"></a>06390 
<a name="l06391" id="l06391"></a>06391     <span class="comment">/*</span>
<a name="l06392" id="l06392"></a>06392 <span class="comment">     * make sure we got to the end of the string </span>
<a name="l06393" id="l06393"></a>06393 <span class="comment">     */</span>
<a name="l06394" id="l06394"></a>06394     <span class="keywordflow">if</span> (*c != 0)
<a name="l06395" id="l06395"></a>06395         <span class="keywordflow">return</span> 1;
<a name="l06396" id="l06396"></a>06396 
<a name="l06397" id="l06397"></a>06397     <span class="comment">/*</span>
<a name="l06398" id="l06398"></a>06398 <span class="comment">     * set the length of the oid </span>
<a name="l06399" id="l06399"></a>06399 <span class="comment">     */</span>
<a name="l06400" id="l06400"></a>06400     *O = c - S;
<a name="l06401" id="l06401"></a>06401 
<a name="l06402" id="l06402"></a>06402     <span class="keywordflow">return</span> 0;
<a name="l06403" id="l06403"></a>06403 }
<a name="l06404" id="l06404"></a>06404 
<a name="l06415" id="l06415"></a>06415 <span class="keywordtype">int</span>
<a name="l06416" id="l06416"></a><a class="code" href=
"group__mib__utilities.html#g2ff5fadbd6d3703b63d8e4561ad75680">06416</a> <a class="code" href=
"group__mib__utilities.html#g2ff5fadbd6d3703b63d8e4561ad75680" title=
"Converts an OID to its character form.">netsnmp_oid2chars</a>(<span class="keywordtype">char</span> *C, <span class=
"keywordtype">int</span> L, <span class="keyword">const</span> oid * O)
<a name="l06417" id="l06417"></a>06417 {
<a name="l06418" id="l06418"></a>06418     <span class="keywordtype">char</span>           *c = C;
<a name="l06419" id="l06419"></a>06419     <span class="keyword">const</span> oid      *o = &amp;O[1];
<a name="l06420" id="l06420"></a>06420 
<a name="l06421" id="l06421"></a>06421     <span class="keywordflow">if</span> (L &lt; (<span class="keywordtype">int</span>)*O)
<a name="l06422" id="l06422"></a>06422         <span class="keywordflow">return</span> 1;
<a name="l06423" id="l06423"></a>06423 
<a name="l06424" id="l06424"></a>06424     L = *O; 
<a name="l06425" id="l06425"></a>06425     <span class="keywordflow">for</span> (; L; --L, ++o, ++c) {
<a name="l06426" id="l06426"></a>06426         <span class="keywordflow">if</span> (*o &gt; 0xFF)
<a name="l06427" id="l06427"></a>06427             <span class="keywordflow">return</span> 1;
<a name="l06428" id="l06428"></a>06428         *c = (char)*o;
<a name="l06429" id="l06429"></a>06429     }
<a name="l06430" id="l06430"></a>06430     <span class="keywordflow">return</span> 0;
<a name="l06431" id="l06431"></a>06431 }
<a name="l06432" id="l06432"></a>06432 
<a name="l06443" id="l06443"></a>06443 <span class="keywordtype">int</span>
<a name="l06444" id="l06444"></a><a class="code" href=
"group__mib__utilities.html#g289544dec535ff6b22bdf4c4f56c898d">06444</a> <a class="code" href=
"group__mib__utilities.html#g289544dec535ff6b22bdf4c4f56c898d" title=
"Converts an OID to its string form.">netsnmp_oid2str</a>(<span class="keywordtype">char</span> *S, <span class=
"keywordtype">int</span> L, oid * O)
<a name="l06445" id="l06445"></a>06445 {
<a name="l06446" id="l06446"></a>06446     <span class="keywordtype">int</span>            rc;
<a name="l06447" id="l06447"></a>06447 
<a name="l06448" id="l06448"></a>06448     <span class="keywordflow">if</span> (L &lt;= (<span class="keywordtype">int</span>)*O)
<a name="l06449" id="l06449"></a>06449         <span class="keywordflow">return</span> 1;
<a name="l06450" id="l06450"></a>06450 
<a name="l06451" id="l06451"></a>06451     rc = <a class="code" href=
"group__mib__utilities.html#g2ff5fadbd6d3703b63d8e4561ad75680" title=
"Converts an OID to its character form.">netsnmp_oid2chars</a>(S, L, O);
<a name="l06452" id="l06452"></a>06452     <span class="keywordflow">if</span> (rc)
<a name="l06453" id="l06453"></a>06453         <span class="keywordflow">return</span> 1;
<a name="l06454" id="l06454"></a>06454 
<a name="l06455" id="l06455"></a>06455     S[ *O ] = 0;
<a name="l06456" id="l06456"></a>06456 
<a name="l06457" id="l06457"></a>06457     <span class="keywordflow">return</span> 0;
<a name="l06458" id="l06458"></a>06458 }
<a name="l06459" id="l06459"></a>06459 
<a name="l06460" id="l06460"></a>06460 <span class="keywordtype">int</span>
<a name="l06461" id="l06461"></a>06461 snprint_by_type(<span class="keywordtype">char</span> *buf, <span class=
"keywordtype">size_t</span> buf_len,
<a name="l06462" id="l06462"></a>06462                 <a class="code" href="structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var,
<a name="l06463" id="l06463"></a>06463                 <span class="keyword">const</span> <span class=
"keyword">struct</span> enum_list *enums,
<a name="l06464" id="l06464"></a>06464                 <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *units)
<a name="l06465" id="l06465"></a>06465 {
<a name="l06466" id="l06466"></a>06466     <span class="keywordtype">size_t</span>          out_len = 0;
<a name="l06467" id="l06467"></a>06467     <span class="keywordflow">if</span> (<a class="code" href=
"group__mib__utilities.html#gabc12c361abdca75234c11dccb34871b" title=
"Universal print routine, prints a variable into a buffer according to the variable...">sprint_realloc_by_type</a>((u_char **) &amp; buf, &amp;buf_len, &amp;out_len, 0,
<a name="l06468" id="l06468"></a>06468                                var, enums, hint, units))
<a name="l06469" id="l06469"></a>06469         <span class="keywordflow">return</span> (<span class=
"keywordtype">int</span>) out_len;
<a name="l06470" id="l06470"></a>06470     <span class="keywordflow">else</span>
<a name="l06471" id="l06471"></a>06471         <span class="keywordflow">return</span> -1;
<a name="l06472" id="l06472"></a>06472 }
<a name="l06473" id="l06473"></a>06473 
<a name="l06474" id="l06474"></a>06474 <span class="keywordtype">int</span>
<a name="l06475" id="l06475"></a>06475 snprint_hexstring(<span class="keywordtype">char</span> *buf, <span class=
"keywordtype">size_t</span> buf_len, <span class="keyword">const</span> u_char * cp, <span class="keywordtype">size_t</span> len)
<a name="l06476" id="l06476"></a>06476 {
<a name="l06477" id="l06477"></a>06477     <span class="keywordtype">size_t</span>          out_len = 0;
<a name="l06478" id="l06478"></a>06478     <span class=
"keywordflow">if</span> (sprint_realloc_hexstring((u_char **) &amp; buf, &amp;buf_len, &amp;out_len, 0,
<a name="l06479" id="l06479"></a>06479                                  cp, len))
<a name="l06480" id="l06480"></a>06480         <span class="keywordflow">return</span> (<span class=
"keywordtype">int</span>) out_len;
<a name="l06481" id="l06481"></a>06481     <span class="keywordflow">else</span>
<a name="l06482" id="l06482"></a>06482         <span class="keywordflow">return</span> -1;
<a name="l06483" id="l06483"></a>06483 }
<a name="l06484" id="l06484"></a>06484 
<a name="l06485" id="l06485"></a>06485 <span class="keywordtype">int</span>
<a name="l06486" id="l06486"></a>06486 snprint_asciistring(<span class="keywordtype">char</span> *buf, <span class=
"keywordtype">size_t</span> buf_len,
<a name="l06487" id="l06487"></a>06487                     <span class="keyword">const</span> u_char * cp, <span class=
"keywordtype">size_t</span> len)
<a name="l06488" id="l06488"></a>06488 {
<a name="l06489" id="l06489"></a>06489     <span class="keywordtype">size_t</span>          out_len = 0;
<a name="l06490" id="l06490"></a>06490     <span class="keywordflow">if</span> (<a class="code" href=
"group__mib__utilities.html#g7ff1971fc340b2789d48895086bf3230" title=
"Prints an ascii string into a buffer.">sprint_realloc_asciistring</a>
<a name="l06491" id="l06491"></a>06491         ((u_char **) &amp; buf, &amp;buf_len, &amp;out_len, 0, cp, len))
<a name="l06492" id="l06492"></a>06492         <span class="keywordflow">return</span> (<span class=
"keywordtype">int</span>) out_len;
<a name="l06493" id="l06493"></a>06493     <span class="keywordflow">else</span>
<a name="l06494" id="l06494"></a>06494         <span class="keywordflow">return</span> -1;
<a name="l06495" id="l06495"></a>06495 }
<a name="l06496" id="l06496"></a>06496 
<a name="l06497" id="l06497"></a>06497 <span class="keywordtype">int</span>
<a name="l06498" id="l06498"></a>06498 snprint_octet_string(<span class="keywordtype">char</span> *buf, <span class=
"keywordtype">size_t</span> buf_len,
<a name="l06499" id="l06499"></a>06499                      <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var, <span class="keyword">const</span> <span class="keyword">struct</span> enum_list *enums,
<a name="l06500" id="l06500"></a>06500                      <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *units)
<a name="l06501" id="l06501"></a>06501 {
<a name="l06502" id="l06502"></a>06502     <span class="keywordtype">size_t</span>          out_len = 0;
<a name="l06503" id="l06503"></a>06503     <span class="keywordflow">if</span> (<a class="code" href=
"group__mib__utilities.html#gbe71c710f2173fb85512d08c088ea12e" title=
"Prints an octet string into a buffer.">sprint_realloc_octet_string</a>
<a name="l06504" id="l06504"></a>06504         ((u_char **) &amp; buf, &amp;buf_len, &amp;out_len, 0, var, enums, hint,
<a name="l06505" id="l06505"></a>06505          units))
<a name="l06506" id="l06506"></a>06506         <span class="keywordflow">return</span> (<span class=
"keywordtype">int</span>) out_len;
<a name="l06507" id="l06507"></a>06507     <span class="keywordflow">else</span>
<a name="l06508" id="l06508"></a>06508         <span class="keywordflow">return</span> -1;
<a name="l06509" id="l06509"></a>06509 }
<a name="l06510" id="l06510"></a>06510 
<a name="l06511" id="l06511"></a>06511 <span class="keywordtype">int</span>
<a name="l06512" id="l06512"></a>06512 snprint_opaque(<span class="keywordtype">char</span> *buf, <span class=
"keywordtype">size_t</span> buf_len,
<a name="l06513" id="l06513"></a>06513                <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var, <span class="keyword">const</span> <span class="keyword">struct</span> enum_list *enums,
<a name="l06514" id="l06514"></a>06514                <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *units)
<a name="l06515" id="l06515"></a>06515 {
<a name="l06516" id="l06516"></a>06516     <span class="keywordtype">size_t</span>          out_len = 0;
<a name="l06517" id="l06517"></a>06517     <span class="keywordflow">if</span> (<a class="code" href=
"group__mib__utilities.html#g0e42660c74b91d68e088b53e41ba6658" title=
"Prints an object identifier into a buffer.">sprint_realloc_opaque</a>((u_char **) &amp; buf, &amp;buf_len, &amp;out_len, 0,
<a name="l06518" id="l06518"></a>06518                               var, enums, hint, units))
<a name="l06519" id="l06519"></a>06519         <span class="keywordflow">return</span> (<span class=
"keywordtype">int</span>) out_len;
<a name="l06520" id="l06520"></a>06520     <span class="keywordflow">else</span>
<a name="l06521" id="l06521"></a>06521         <span class="keywordflow">return</span> -1;
<a name="l06522" id="l06522"></a>06522 }
<a name="l06523" id="l06523"></a>06523 
<a name="l06524" id="l06524"></a>06524 <span class="keywordtype">int</span>
<a name="l06525" id="l06525"></a>06525 snprint_object_identifier(<span class="keywordtype">char</span> *buf, <span class=
"keywordtype">size_t</span> buf_len,
<a name="l06526" id="l06526"></a>06526                           <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var,
<a name="l06527" id="l06527"></a>06527                           <span class="keyword">const</span> <span class=
"keyword">struct</span> enum_list *enums, <span class="keyword">const</span> <span class="keywordtype">char</span> *hint,
<a name="l06528" id="l06528"></a>06528                           <span class="keyword">const</span> <span class=
"keywordtype">char</span> *units)
<a name="l06529" id="l06529"></a>06529 {
<a name="l06530" id="l06530"></a>06530     <span class="keywordtype">size_t</span>          out_len = 0;
<a name="l06531" id="l06531"></a>06531     <span class="keywordflow">if</span> (<a class="code" href=
"group__mib__utilities.html#g58c583005d5df719f3866ff0f06ec800" title=
"Prints an object identifier into a buffer.">sprint_realloc_object_identifier</a>
<a name="l06532" id="l06532"></a>06532         ((u_char **) &amp; buf, &amp;buf_len, &amp;out_len, 0, var, enums, hint,
<a name="l06533" id="l06533"></a>06533          units))
<a name="l06534" id="l06534"></a>06534         <span class="keywordflow">return</span> (<span class=
"keywordtype">int</span>) out_len;
<a name="l06535" id="l06535"></a>06535     <span class="keywordflow">else</span>
<a name="l06536" id="l06536"></a>06536         <span class="keywordflow">return</span> -1;
<a name="l06537" id="l06537"></a>06537 }
<a name="l06538" id="l06538"></a>06538 
<a name="l06539" id="l06539"></a>06539 <span class="keywordtype">int</span>
<a name="l06540" id="l06540"></a>06540 snprint_timeticks(<span class="keywordtype">char</span> *buf, <span class=
"keywordtype">size_t</span> buf_len,
<a name="l06541" id="l06541"></a>06541                   <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var, <span class="keyword">const</span> <span class="keyword">struct</span> enum_list *enums,
<a name="l06542" id="l06542"></a>06542                   <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *units)
<a name="l06543" id="l06543"></a>06543 {
<a name="l06544" id="l06544"></a>06544     <span class="keywordtype">size_t</span>          out_len = 0;
<a name="l06545" id="l06545"></a>06545     <span class="keywordflow">if</span> (<a class="code" href=
"group__mib__utilities.html#gd53723cfb568c73dc3b7af48985f96d2" title=
"Prints a timetick variable into a buffer.">sprint_realloc_timeticks</a>((u_char **) &amp; buf, &amp;buf_len, &amp;out_len, 0,
<a name="l06546" id="l06546"></a>06546                                  var, enums, hint, units))
<a name="l06547" id="l06547"></a>06547         <span class="keywordflow">return</span> (<span class=
"keywordtype">int</span>) out_len;
<a name="l06548" id="l06548"></a>06548     <span class="keywordflow">else</span>
<a name="l06549" id="l06549"></a>06549         <span class="keywordflow">return</span> -1;
<a name="l06550" id="l06550"></a>06550 }
<a name="l06551" id="l06551"></a>06551 
<a name="l06552" id="l06552"></a>06552 <span class="keywordtype">int</span>
<a name="l06553" id="l06553"></a>06553 snprint_hinted_integer(<span class="keywordtype">char</span> *buf, <span class=
"keywordtype">size_t</span> buf_len,
<a name="l06554" id="l06554"></a>06554                        <span class="keywordtype">long</span> val, <span class=
"keyword">const</span> <span class="keywordtype">char</span> *hint, <span class="keyword">const</span> <span class=
"keywordtype">char</span> *units)
<a name="l06555" id="l06555"></a>06555 {
<a name="l06556" id="l06556"></a>06556     <span class="keywordtype">size_t</span>          out_len = 0;
<a name="l06557" id="l06557"></a>06557     <span class="keywordflow">if</span> (<a class="code" href=
"group__mib__utilities.html#g810f08416e69b816e28c33ed3c447e95" title=
"Prints an integer according to the hint into a buffer.">sprint_realloc_hinted_integer</a>
<a name="l06558" id="l06558"></a>06558         ((u_char **) &amp; buf, &amp;buf_len, &amp;out_len, 0, val, <span class=
"charliteral">'d'</span>, hint, units))
<a name="l06559" id="l06559"></a>06559         <span class="keywordflow">return</span> (<span class=
"keywordtype">int</span>) out_len;
<a name="l06560" id="l06560"></a>06560     <span class="keywordflow">else</span>
<a name="l06561" id="l06561"></a>06561         <span class="keywordflow">return</span> -1;
<a name="l06562" id="l06562"></a>06562 }
<a name="l06563" id="l06563"></a>06563 
<a name="l06564" id="l06564"></a>06564 <span class="keywordtype">int</span>
<a name="l06565" id="l06565"></a>06565 snprint_integer(<span class="keywordtype">char</span> *buf, <span class=
"keywordtype">size_t</span> buf_len,
<a name="l06566" id="l06566"></a>06566                 <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var, <span class="keyword">const</span> <span class="keyword">struct</span> enum_list *enums,
<a name="l06567" id="l06567"></a>06567                 <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *units)
<a name="l06568" id="l06568"></a>06568 {
<a name="l06569" id="l06569"></a>06569     <span class="keywordtype">size_t</span>          out_len = 0;
<a name="l06570" id="l06570"></a>06570     <span class="keywordflow">if</span> (<a class="code" href=
"group__mib__utilities.html#g97e7b0a5f5da3d51d9ae32a89f901390" title=
"Prints an integer into a buffer.">sprint_realloc_integer</a>((u_char **) &amp; buf, &amp;buf_len, &amp;out_len, 0,
<a name="l06571" id="l06571"></a>06571                                var, enums, hint, units))
<a name="l06572" id="l06572"></a>06572         <span class="keywordflow">return</span> (<span class=
"keywordtype">int</span>) out_len;
<a name="l06573" id="l06573"></a>06573     <span class="keywordflow">else</span>
<a name="l06574" id="l06574"></a>06574         <span class="keywordflow">return</span> -1;
<a name="l06575" id="l06575"></a>06575 }
<a name="l06576" id="l06576"></a>06576 
<a name="l06577" id="l06577"></a>06577 <span class="keywordtype">int</span>
<a name="l06578" id="l06578"></a>06578 snprint_uinteger(<span class="keywordtype">char</span> *buf, <span class=
"keywordtype">size_t</span> buf_len,
<a name="l06579" id="l06579"></a>06579                  <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var, <span class="keyword">const</span> <span class="keyword">struct</span> enum_list *enums,
<a name="l06580" id="l06580"></a>06580                  <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *units)
<a name="l06581" id="l06581"></a>06581 {
<a name="l06582" id="l06582"></a>06582     <span class="keywordtype">size_t</span>          out_len = 0;
<a name="l06583" id="l06583"></a>06583     <span class="keywordflow">if</span> (<a class="code" href=
"group__mib__utilities.html#gccef8ad447c854b262acdf0c8f135084" title=
"Prints an unsigned integer into a buffer.">sprint_realloc_uinteger</a>((u_char **) &amp; buf, &amp;buf_len, &amp;out_len, 0,
<a name="l06584" id="l06584"></a>06584                                 var, enums, hint, units))
<a name="l06585" id="l06585"></a>06585         <span class="keywordflow">return</span> (<span class=
"keywordtype">int</span>) out_len;
<a name="l06586" id="l06586"></a>06586     <span class="keywordflow">else</span>
<a name="l06587" id="l06587"></a>06587         <span class="keywordflow">return</span> -1;
<a name="l06588" id="l06588"></a>06588 }
<a name="l06589" id="l06589"></a>06589 
<a name="l06590" id="l06590"></a>06590 <span class="keywordtype">int</span>
<a name="l06591" id="l06591"></a>06591 snprint_gauge(<span class="keywordtype">char</span> *buf, <span class=
"keywordtype">size_t</span> buf_len,
<a name="l06592" id="l06592"></a>06592               <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var, <span class="keyword">const</span> <span class="keyword">struct</span> enum_list *enums,
<a name="l06593" id="l06593"></a>06593               <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *units)
<a name="l06594" id="l06594"></a>06594 {
<a name="l06595" id="l06595"></a>06595     <span class="keywordtype">size_t</span>          out_len = 0;
<a name="l06596" id="l06596"></a>06596     <span class="keywordflow">if</span> (<a class="code" href=
"group__mib__utilities.html#gfe1758bc15693fc502e648c05f5c83f3" title=
"Prints a gauge value into a buffer.">sprint_realloc_gauge</a>((u_char **) &amp; buf, &amp;buf_len, &amp;out_len, 0,
<a name="l06597" id="l06597"></a>06597                              var, enums, hint, units))
<a name="l06598" id="l06598"></a>06598         <span class="keywordflow">return</span> (<span class=
"keywordtype">int</span>) out_len;
<a name="l06599" id="l06599"></a>06599     <span class="keywordflow">else</span>
<a name="l06600" id="l06600"></a>06600         <span class="keywordflow">return</span> -1;
<a name="l06601" id="l06601"></a>06601 }
<a name="l06602" id="l06602"></a>06602 
<a name="l06603" id="l06603"></a>06603 <span class="keywordtype">int</span>
<a name="l06604" id="l06604"></a>06604 snprint_counter(<span class="keywordtype">char</span> *buf, <span class=
"keywordtype">size_t</span> buf_len,
<a name="l06605" id="l06605"></a>06605                 <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var, <span class="keyword">const</span> <span class="keyword">struct</span> enum_list *enums,
<a name="l06606" id="l06606"></a>06606                 <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *units)
<a name="l06607" id="l06607"></a>06607 {
<a name="l06608" id="l06608"></a>06608     <span class="keywordtype">size_t</span>          out_len = 0;
<a name="l06609" id="l06609"></a>06609     <span class="keywordflow">if</span> (<a class="code" href=
"group__mib__utilities.html#gac841b689bafe52506f128201d57c51b" title=
"Prints a counter value into a buffer.">sprint_realloc_counter</a>((u_char **) &amp; buf, &amp;buf_len, &amp;out_len, 0,
<a name="l06610" id="l06610"></a>06610                                var, enums, hint, units))
<a name="l06611" id="l06611"></a>06611         <span class="keywordflow">return</span> (<span class=
"keywordtype">int</span>) out_len;
<a name="l06612" id="l06612"></a>06612     <span class="keywordflow">else</span>
<a name="l06613" id="l06613"></a>06613         <span class="keywordflow">return</span> -1;
<a name="l06614" id="l06614"></a>06614 }
<a name="l06615" id="l06615"></a>06615 
<a name="l06616" id="l06616"></a>06616 <span class="keywordtype">int</span>
<a name="l06617" id="l06617"></a>06617 snprint_networkaddress(<span class="keywordtype">char</span> *buf, <span class=
"keywordtype">size_t</span> buf_len,
<a name="l06618" id="l06618"></a>06618                        <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var,
<a name="l06619" id="l06619"></a>06619                        <span class="keyword">const</span> <span class=
"keyword">struct</span> enum_list *enums, <span class="keyword">const</span> <span class="keywordtype">char</span> *hint,
<a name="l06620" id="l06620"></a>06620                        <span class="keyword">const</span> <span class=
"keywordtype">char</span> *units)
<a name="l06621" id="l06621"></a>06621 {
<a name="l06622" id="l06622"></a>06622     <span class="keywordtype">size_t</span>          out_len = 0;
<a name="l06623" id="l06623"></a>06623     <span class="keywordflow">if</span> (<a class="code" href=
"group__mib__utilities.html#gb83236b9b61e69a06d1dc022eb3fb549" title=
"Prints a network address into a buffer.">sprint_realloc_networkaddress</a>
<a name="l06624" id="l06624"></a>06624         ((u_char **) &amp; buf, &amp;buf_len, &amp;out_len, 0, var, enums, hint,
<a name="l06625" id="l06625"></a>06625          units))
<a name="l06626" id="l06626"></a>06626         <span class="keywordflow">return</span> (<span class=
"keywordtype">int</span>) out_len;
<a name="l06627" id="l06627"></a>06627     <span class="keywordflow">else</span>
<a name="l06628" id="l06628"></a>06628         <span class="keywordflow">return</span> -1;
<a name="l06629" id="l06629"></a>06629 }
<a name="l06630" id="l06630"></a>06630 
<a name="l06631" id="l06631"></a>06631 <span class="keywordtype">int</span>
<a name="l06632" id="l06632"></a>06632 snprint_ipaddress(<span class="keywordtype">char</span> *buf, <span class=
"keywordtype">size_t</span> buf_len,
<a name="l06633" id="l06633"></a>06633                   <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var, <span class="keyword">const</span> <span class="keyword">struct</span> enum_list *enums,
<a name="l06634" id="l06634"></a>06634                   <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *units)
<a name="l06635" id="l06635"></a>06635 {
<a name="l06636" id="l06636"></a>06636     <span class="keywordtype">size_t</span>          out_len = 0;
<a name="l06637" id="l06637"></a>06637     <span class="keywordflow">if</span> (<a class="code" href=
"group__mib__utilities.html#gb65bcc37615acd994e02c08ece83a96f" title=
"Prints an ip-address into a buffer.">sprint_realloc_ipaddress</a>((u_char **) &amp; buf, &amp;buf_len, &amp;out_len, 0,
<a name="l06638" id="l06638"></a>06638                                  var, enums, hint, units))
<a name="l06639" id="l06639"></a>06639         <span class="keywordflow">return</span> (<span class=
"keywordtype">int</span>) out_len;
<a name="l06640" id="l06640"></a>06640     <span class="keywordflow">else</span>
<a name="l06641" id="l06641"></a>06641         <span class="keywordflow">return</span> -1;
<a name="l06642" id="l06642"></a>06642 }
<a name="l06643" id="l06643"></a>06643 
<a name="l06644" id="l06644"></a>06644 <span class="keywordtype">int</span>
<a name="l06645" id="l06645"></a>06645 snprint_null(<span class="keywordtype">char</span> *buf, <span class=
"keywordtype">size_t</span> buf_len,
<a name="l06646" id="l06646"></a>06646              <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var, <span class="keyword">const</span> <span class="keyword">struct</span> enum_list *enums,
<a name="l06647" id="l06647"></a>06647              <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *units)
<a name="l06648" id="l06648"></a>06648 {
<a name="l06649" id="l06649"></a>06649     <span class="keywordtype">size_t</span>          out_len = 0;
<a name="l06650" id="l06650"></a>06650     <span class="keywordflow">if</span> (<a class="code" href=
"group__mib__utilities.html#ga78ab15d7af7e907e57da5b42dbce9e4" title=
"Prints a null value into a buffer.">sprint_realloc_null</a>((u_char **) &amp; buf, &amp;buf_len, &amp;out_len, 0,
<a name="l06651" id="l06651"></a>06651                             var, enums, hint, units))
<a name="l06652" id="l06652"></a>06652         <span class="keywordflow">return</span> (<span class=
"keywordtype">int</span>) out_len;
<a name="l06653" id="l06653"></a>06653     <span class="keywordflow">else</span>
<a name="l06654" id="l06654"></a>06654         <span class="keywordflow">return</span> -1;
<a name="l06655" id="l06655"></a>06655 }
<a name="l06656" id="l06656"></a>06656 
<a name="l06657" id="l06657"></a>06657 <span class="keywordtype">int</span>
<a name="l06658" id="l06658"></a>06658 snprint_bitstring(<span class="keywordtype">char</span> *buf, <span class=
"keywordtype">size_t</span> buf_len,
<a name="l06659" id="l06659"></a>06659                   <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var, <span class="keyword">const</span> <span class="keyword">struct</span> enum_list *enums,
<a name="l06660" id="l06660"></a>06660                   <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *units)
<a name="l06661" id="l06661"></a>06661 {
<a name="l06662" id="l06662"></a>06662     <span class="keywordtype">size_t</span>          out_len = 0;
<a name="l06663" id="l06663"></a>06663     <span class="keywordflow">if</span> (<a class="code" href=
"group__mib__utilities.html#gfe6d528aa10dfac467956837ffa7c3ba" title=
"Prints a bit string into a buffer.">sprint_realloc_bitstring</a>((u_char **) &amp; buf, &amp;buf_len, &amp;out_len, 0,
<a name="l06664" id="l06664"></a>06664                                  var, enums, hint, units))
<a name="l06665" id="l06665"></a>06665         <span class="keywordflow">return</span> (<span class=
"keywordtype">int</span>) out_len;
<a name="l06666" id="l06666"></a>06666     <span class="keywordflow">else</span>
<a name="l06667" id="l06667"></a>06667         <span class="keywordflow">return</span> -1;
<a name="l06668" id="l06668"></a>06668 }
<a name="l06669" id="l06669"></a>06669 
<a name="l06670" id="l06670"></a>06670 <span class="keywordtype">int</span>
<a name="l06671" id="l06671"></a>06671 snprint_nsapaddress(<span class="keywordtype">char</span> *buf, <span class=
"keywordtype">size_t</span> buf_len,
<a name="l06672" id="l06672"></a>06672                     <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var, <span class="keyword">const</span> <span class="keyword">struct</span> enum_list *enums,
<a name="l06673" id="l06673"></a>06673                     <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *units)
<a name="l06674" id="l06674"></a>06674 {
<a name="l06675" id="l06675"></a>06675     <span class="keywordtype">size_t</span>          out_len = 0;
<a name="l06676" id="l06676"></a>06676     <span class="keywordflow">if</span> (sprint_realloc_nsapaddress
<a name="l06677" id="l06677"></a>06677         ((u_char **) &amp; buf, &amp;buf_len, &amp;out_len, 0, var, enums, hint,
<a name="l06678" id="l06678"></a>06678          units))
<a name="l06679" id="l06679"></a>06679         <span class="keywordflow">return</span> (<span class=
"keywordtype">int</span>) out_len;
<a name="l06680" id="l06680"></a>06680     <span class="keywordflow">else</span>
<a name="l06681" id="l06681"></a>06681         <span class="keywordflow">return</span> -1;
<a name="l06682" id="l06682"></a>06682 }
<a name="l06683" id="l06683"></a>06683 
<a name="l06684" id="l06684"></a>06684 <span class="keywordtype">int</span>
<a name="l06685" id="l06685"></a>06685 snprint_counter64(<span class="keywordtype">char</span> *buf, <span class=
"keywordtype">size_t</span> buf_len,
<a name="l06686" id="l06686"></a>06686                   <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var, <span class="keyword">const</span> <span class="keyword">struct</span> enum_list *enums,
<a name="l06687" id="l06687"></a>06687                   <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *units)
<a name="l06688" id="l06688"></a>06688 {
<a name="l06689" id="l06689"></a>06689     <span class="keywordtype">size_t</span>          out_len = 0;
<a name="l06690" id="l06690"></a>06690     <span class="keywordflow">if</span> (<a class="code" href=
"group__mib__utilities.html#g911270821df5b87de7a97dc5deb8f485" title=
"Prints a counter into a buffer.">sprint_realloc_counter64</a>((u_char **) &amp; buf, &amp;buf_len, &amp;out_len, 0,
<a name="l06691" id="l06691"></a>06691                                  var, enums, hint, units))
<a name="l06692" id="l06692"></a>06692         <span class="keywordflow">return</span> (<span class=
"keywordtype">int</span>) out_len;
<a name="l06693" id="l06693"></a>06693     <span class="keywordflow">else</span>
<a name="l06694" id="l06694"></a>06694         <span class="keywordflow">return</span> -1;
<a name="l06695" id="l06695"></a>06695 }
<a name="l06696" id="l06696"></a>06696 
<a name="l06697" id="l06697"></a>06697 <span class="keywordtype">int</span>
<a name="l06698" id="l06698"></a>06698 snprint_badtype(<span class="keywordtype">char</span> *buf, <span class=
"keywordtype">size_t</span> buf_len,
<a name="l06699" id="l06699"></a>06699                 <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var, <span class="keyword">const</span> <span class="keyword">struct</span> enum_list *enums,
<a name="l06700" id="l06700"></a>06700                 <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *units)
<a name="l06701" id="l06701"></a>06701 {
<a name="l06702" id="l06702"></a>06702     <span class="keywordtype">size_t</span>          out_len = 0;
<a name="l06703" id="l06703"></a>06703     <span class="keywordflow">if</span> (<a class="code" href=
"group__mib__utilities.html#g7ac6acaf3e0df6e8e99c225a6e8067d3" title=
"Fallback routine for a bad type, prints &amp;quot;Variable has bad type&amp;quot; into a...">sprint_realloc_badtype</a>((u_char **) &amp; buf, &amp;buf_len, &amp;out_len, 0,
<a name="l06704" id="l06704"></a>06704                                var, enums, hint, units))
<a name="l06705" id="l06705"></a>06705         <span class="keywordflow">return</span> (<span class=
"keywordtype">int</span>) out_len;
<a name="l06706" id="l06706"></a>06706     <span class="keywordflow">else</span>
<a name="l06707" id="l06707"></a>06707         <span class="keywordflow">return</span> -1;
<a name="l06708" id="l06708"></a>06708 }
<a name="l06709" id="l06709"></a>06709 
<a name="l06710" id="l06710"></a>06710 <span class="preprocessor">#ifdef NETSNMP_WITH_OPAQUE_SPECIAL_TYPES</span>
<a name="l06711" id="l06711"></a>06711 <span class="keywordtype">int</span>
<a name="l06712" id="l06712"></a>06712 snprint_float(<span class="keywordtype">char</span> *buf, <span class=
"keywordtype">size_t</span> buf_len,
<a name="l06713" id="l06713"></a>06713               <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var, <span class="keyword">const</span> <span class="keyword">struct</span> enum_list *enums,
<a name="l06714" id="l06714"></a>06714               <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *units)
<a name="l06715" id="l06715"></a>06715 {
<a name="l06716" id="l06716"></a>06716     <span class="keywordtype">size_t</span>          out_len = 0;
<a name="l06717" id="l06717"></a>06717     <span class=
"keywordflow">if</span> (sprint_realloc_float((u_char **) &amp; buf, &amp;buf_len, &amp;out_len, 0,
<a name="l06718" id="l06718"></a>06718                              var, enums, hint, units))
<a name="l06719" id="l06719"></a>06719         <span class="keywordflow">return</span> (<span class=
"keywordtype">int</span>) out_len;
<a name="l06720" id="l06720"></a>06720     <span class="keywordflow">else</span>
<a name="l06721" id="l06721"></a>06721         <span class="keywordflow">return</span> -1;
<a name="l06722" id="l06722"></a>06722 }
<a name="l06723" id="l06723"></a>06723 
<a name="l06724" id="l06724"></a>06724 <span class="keywordtype">int</span>
<a name="l06725" id="l06725"></a>06725 snprint_double(<span class="keywordtype">char</span> *buf, <span class=
"keywordtype">size_t</span> buf_len,
<a name="l06726" id="l06726"></a>06726                <span class="keyword">const</span> <a class="code" href=
"structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * var, <span class="keyword">const</span> <span class="keyword">struct</span> enum_list *enums,
<a name="l06727" id="l06727"></a>06727                <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hint, <span class="keyword">const</span> <span class="keywordtype">char</span> *units)
<a name="l06728" id="l06728"></a>06728 {
<a name="l06729" id="l06729"></a>06729     <span class="keywordtype">size_t</span>          out_len = 0;
<a name="l06730" id="l06730"></a>06730     <span class=
"keywordflow">if</span> (sprint_realloc_double((u_char **) &amp; buf, &amp;buf_len, &amp;out_len, 0,
<a name="l06731" id="l06731"></a>06731                               var, enums, hint, units))
<a name="l06732" id="l06732"></a>06732         <span class="keywordflow">return</span> (<span class=
"keywordtype">int</span>) out_len;
<a name="l06733" id="l06733"></a>06733     <span class="keywordflow">else</span>
<a name="l06734" id="l06734"></a>06734         <span class="keywordflow">return</span> -1;
<a name="l06735" id="l06735"></a>06735 }
<a name="l06736" id="l06736"></a>06736 <span class="preprocessor">#endif</span>
<a name="l06737" id="l06737"></a>06737 
</pre>
    </div>
  </div>
  <hr size="1" />

  <address style="text-align: right;">
    <small>Generated on Wed Aug 26 10:35:35 2009 for net-snmp by  <a href="http://www.doxygen.org/index.html"><img src=
    "doxygen.png" alt="doxygen" align="middle" border="0" /></a> 1.5.7.1</small>
<!-- CONTENT END -->
<!--#include virtual="/page-bottom.html" -->

