<!--#set var="section" value="development" -->
<!--#include virtual="/page-top.html" -->
<!-- CONTENT START -->
  <div class="navigation" id="top">
    <div class="tabs">
      <ul>
        <li><a href="index.html"><span>Main Page</span></a></li>

        <li><a href="pages.html"><span>Related Pages</span></a></li>

        <li><a href="modules.html"><span>Modules</span></a></li>

        <li><a href="annotated.html"><span>Data Structures</span></a></li>

        <li class="current"><a href="files.html"><span>Files</span></a></li>

        <li><a href="examples.html"><span>Examples</span></a></li>
      </ul>
    </div>

    <div class="tabs">
      <ul>
        <li><a href="files.html"><span>File List</span></a></li>

        <li><a href="globals.html"><span>Globals</span></a></li>
      </ul>
    </div>

    <h1>table.c</h1>

    <div class="fragment">
      <pre class="fragment">
<a name="l00001" id="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002" id="l00002"></a>00002 <span class="comment"> * table.c </span>
<a name="l00003" id="l00003"></a>00003 <span class="comment"> */</span>
<a name="l00004" id="l00004"></a>00004 
<a name="l00005" id="l00005"></a>00005 <span class=
"comment">/* Portions of this file are subject to the following copyright(s).  See</span>
<a name="l00006" id="l00006"></a>00006 <span class=
"comment"> * the Net-SNMP's COPYING file for more details and other copyrights</span>
<a name="l00007" id="l00007"></a>00007 <span class="comment"> * that may apply:</span>
<a name="l00008" id="l00008"></a>00008 <span class="comment"> */</span>
<a name="l00009" id="l00009"></a>00009 <span class="comment">/*</span>
<a name="l00010" id="l00010"></a>00010 <span class="comment"> * Portions of this file are copyrighted by:</span>
<a name="l00011" id="l00011"></a>00011 <span class=
"comment"> * Copyright &copy; 2003 Sun Microsystems, Inc. All rights reserved.</span>
<a name="l00012" id="l00012"></a>00012 <span class=
"comment"> * Use is subject to license terms specified in the COPYING file</span>
<a name="l00013" id="l00013"></a>00013 <span class="comment"> * distributed with the Net-SNMP package.</span>
<a name="l00014" id="l00014"></a>00014 <span class="comment"> */</span>
<a name="l00015" id="l00015"></a>00015 <span class="comment">/*</span>
<a name="l00016" id="l00016"></a>00016 <span class="comment"> * Portions of this file are copyrighted by:</span>
<a name="l00017" id="l00017"></a>00017 <span class="comment"> * Copyright (C) 2007 Apple, Inc. All rights reserved.</span>
<a name="l00018" id="l00018"></a>00018 <span class=
"comment"> * Use is subject to license terms specified in the COPYING file</span>
<a name="l00019" id="l00019"></a>00019 <span class="comment"> * distributed with the Net-SNMP package.</span>
<a name="l00020" id="l00020"></a>00020 <span class="comment"> */</span>
<a name="l00021" id="l00021"></a>00021 
<a name="l00022" id="l00022"></a>00022 <span class="preprocessor">#include &lt;net-snmp/net-snmp-config.h&gt;</span>
<a name="l00023" id="l00023"></a>00023 
<a name="l00024" id="l00024"></a>00024 <span class="preprocessor">#include &lt;net-snmp/net-snmp-includes.h&gt;</span>
<a name="l00025" id="l00025"></a>00025 <span class=
"preprocessor">#include &lt;net-snmp/agent/net-snmp-agent-includes.h&gt;</span>
<a name="l00026" id="l00026"></a>00026 
<a name="l00027" id="l00027"></a>00027 <span class="preprocessor">#include &lt;net-snmp/agent/table.h&gt;</span>
<a name="l00028" id="l00028"></a>00028 
<a name="l00029" id="l00029"></a>00029 <span class="preprocessor">#if HAVE_STRING_H</span>
<a name="l00030" id="l00030"></a>00030 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00031" id="l00031"></a>00031 <span class="preprocessor">#else</span>
<a name="l00032" id="l00032"></a>00032 <span class="preprocessor">#include &lt;strings.h&gt;</span>
<a name="l00033" id="l00033"></a>00033 <span class="preprocessor">#endif</span>
<a name="l00034" id="l00034"></a>00034 
<a name="l00035" id="l00035"></a>00035 <span class="preprocessor">#include &lt;net-snmp/library/snmp_assert.h&gt;</span>
<a name="l00036" id="l00036"></a>00036 
<a name="l00037" id="l00037"></a>00037 <span class="keyword">static</span> <span class=
"keywordtype">void</span>     table_helper_cleanup(<a class="code" href="structnetsnmp__agent__request__info__s.html" title=
"The agent transaction request structure.">netsnmp_agent_request_info</a> *reqinfo,
<a name="l00038" id="l00038"></a>00038                                      <a class="code" href=
"structnetsnmp__request__info__s.html" title="The netsnmp request info structure.">netsnmp_request_info</a> *request,
<a name="l00039" id="l00039"></a>00039                                      <span class="keywordtype">int</span> status);
<a name="l00040" id="l00040"></a>00040 <span class="keyword">static</span> <span class=
"keywordtype">void</span>     table_data_free_func(<span class="keywordtype">void</span> *data);
<a name="l00041" id="l00041"></a>00041 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00042" id="l00042"></a>00042 sparse_table_helper_handler(<a class="code" href="structnetsnmp__mib__handler__s.html"
title="the mib handler structure to be registered">netsnmp_mib_handler</a> *handler,
<a name="l00043" id="l00043"></a>00043                             <a class="code" href=
"structnetsnmp__handler__registration__s.html" title="Root registration info.">netsnmp_handler_registration</a> *reginfo,
<a name="l00044" id="l00044"></a>00044                             <a class="code" href=
"structnetsnmp__agent__request__info__s.html" title=
"The agent transaction request structure.">netsnmp_agent_request_info</a> *reqinfo,
<a name="l00045" id="l00045"></a>00045                             <a class="code" href="structnetsnmp__request__info__s.html"
title="The netsnmp request info structure.">netsnmp_request_info</a> *requests);
<a name="l00046" id="l00046"></a>00046 
<a name="l00090" id="l00090"></a>00090 <a class="code" href="structnetsnmp__mib__handler__s.html" title=
"the mib handler structure to be registered">netsnmp_mib_handler</a> *
<a name="l00091" id="l00091"></a><a class="code" href="group__table.html#gad675c0b9450afaf9f67d93e738319cf3">00091</a> <a class=
"code" href="group__table.html#gad675c0b9450afaf9f67d93e738319cf3" title=
"Given a netsnmp_table_registration_info object, creates a table handler.">netsnmp_get_table_handler</a>(<a class="code" href=
"structnetsnmp__table__registration__info__s.html" title=
"Table registration structure.">netsnmp_table_registration_info</a> *tabreq)
<a name="l00092" id="l00092"></a>00092 {
<a name="l00093" id="l00093"></a>00093     <a class="code" href="structnetsnmp__mib__handler__s.html" title=
"the mib handler structure to be registered">netsnmp_mib_handler</a> *ret = NULL;
<a name="l00094" id="l00094"></a>00094 
<a name="l00095" id="l00095"></a>00095     <span class="keywordflow">if</span> (!tabreq) {
<a name="l00096" id="l00096"></a>00096         <a class="code" href=
"group__snmp__logging.html#ga9ba905368ea1c551b969af44b13e37c2" title=
"This snmp logging function allows variable argument list given the specified format...">snmp_log</a>(LOG_INFO, <span class=
"stringliteral">"netsnmp_get_table_handler(NULL) called\n"</span>);
<a name="l00097" id="l00097"></a>00097         <span class="keywordflow">return</span> NULL;
<a name="l00098" id="l00098"></a>00098     }
<a name="l00099" id="l00099"></a>00099 
<a name="l00100" id="l00100"></a>00100     ret = <a class="code" href="group__handler.html#ga169c1653d481ed3d7df0c1795d99ca0c"
title=
"creates a netsnmp_mib_handler structure given a name and a access method.">netsnmp_create_handler</a>(TABLE_HANDLER_NAME, <a class="code"
href="group__table.html#ga571606b4d4e705a4420ff73ce3ac6b00" title=
"implements the table helper handler">table_helper_handler</a>);
<a name="l00101" id="l00101"></a>00101     <span class="keywordflow">if</span> (ret) {
<a name="l00102" id="l00102"></a>00102         ret-&gt;<a class="code" href=
"structnetsnmp__mib__handler__s.html#a74067d02cea4a059cd0fce7790b77b18" title=
"for handler&amp;#39;s internal use">myvoid</a> = (<span class="keywordtype">void</span> *) tabreq;
<a name="l00103" id="l00103"></a>00103         tabreq-&gt;<a class="code" href=
"structnetsnmp__table__registration__info__s.html#a31ac0da11dbc52abe401401df065020a" title=
"calculated automatically">number_indexes</a> = count_varbinds(tabreq-&gt;<a class="code" href=
"structnetsnmp__table__registration__info__s.html#a3045fe8e402e974d840af4084b88dc2a" title=
"list of varbinds with only &amp;#39;type&amp;#39; set">indexes</a>);
<a name="l00104" id="l00104"></a>00104     }
<a name="l00105" id="l00105"></a>00105     <span class="keywordflow">return</span> ret;
<a name="l00106" id="l00106"></a>00106 }
<a name="l00107" id="l00107"></a>00107 
<a name="l00108" id="l00108"></a>00108 
<a name="l00113" id="l00113"></a>00113 <span class="keywordtype">int</span>
<a name="l00114" id="l00114"></a><a class="code" href="group__table.html#ga9940ed4fe4f46dc0212ddd46967c16f2">00114</a> <a class=
"code" href="group__table.html#ga9940ed4fe4f46dc0212ddd46967c16f2" title=
"creates a table handler given the netsnmp_table_registration_info object, inserts...">netsnmp_register_table</a>(<a class="code"
href="structnetsnmp__handler__registration__s.html" title="Root registration info.">netsnmp_handler_registration</a> *reginfo,
<a name="l00115" id="l00115"></a>00115                        <a class="code" href=
"structnetsnmp__table__registration__info__s.html" title=
"Table registration structure.">netsnmp_table_registration_info</a> *tabreq)
<a name="l00116" id="l00116"></a>00116 {
<a name="l00117" id="l00117"></a>00117     <span class="keywordtype">int</span> rc = <a class="code" href=
"group__handler.html#ga6649d75b3eaf98d70704754d3d8235f3" title=
"inject a new handler into the calling chain of the handlers definedy by the netsnmp_handler_registra...">netsnmp_inject_handler</a>(reginfo, <a class="code"
href="group__table.html#gad675c0b9450afaf9f67d93e738319cf3" title=
"Given a netsnmp_table_registration_info object, creates a table handler.">netsnmp_get_table_handler</a>(tabreq));
<a name="l00118" id="l00118"></a>00118     <span class="keywordflow">if</span> (SNMPERR_SUCCESS != rc)
<a name="l00119" id="l00119"></a>00119         <span class="keywordflow">return</span> rc;
<a name="l00120" id="l00120"></a>00120 
<a name="l00121" id="l00121"></a>00121     <span class="keywordflow">return</span> <a class="code" href=
"group__handler.html#gacdbdb9d74898a5bf04b0992ea0316aa4" title=
"register a handler, as defined by the netsnmp_handler_registration pointer.">netsnmp_register_handler</a>(reginfo);
<a name="l00122" id="l00122"></a>00122 }
<a name="l00123" id="l00123"></a>00123 
<a name="l00124" id="l00124"></a>00124 <span class="keywordtype">int</span>
<a name="l00125" id="l00125"></a>00125 netsnmp_unregister_table(<a class="code" href=
"structnetsnmp__handler__registration__s.html" title="Root registration info.">netsnmp_handler_registration</a> *reginfo)
<a name="l00126" id="l00126"></a>00126 {
<a name="l00127" id="l00127"></a>00127     <span class="comment">/* Locate "this" reginfo */</span>
<a name="l00128" id="l00128"></a>00128     <span class="comment">/* SNMP_FREE(reginfo-&gt;myvoid); */</span>
<a name="l00129" id="l00129"></a>00129     <span class="comment">/* reginfo-&gt;myvoid = NULL; */</span>
<a name="l00130" id="l00130"></a>00130     <span class="keywordflow">return</span> <a class="code" href=
"group__handler.html#ga62639943d2328300a27a196205fe88de" title=
"unregister a handler, as defined by the netsnmp_handler_registration pointer.">netsnmp_unregister_handler</a>(reginfo);
<a name="l00131" id="l00131"></a>00131 }
<a name="l00132" id="l00132"></a>00132 
<a name="l00142" id="l00142"></a>00142 NETSNMP_INLINE <a class="code" href="structnetsnmp__table__request__info__s.html" title=
"The table request info structure.">netsnmp_table_request_info</a> *
<a name="l00143" id="l00143"></a><a class="code" href="group__table.html#ga0f2aa788814b909e3e3003b63b1dbd3a">00143</a> <a class=
"code" href="group__table.html#ga0f2aa788814b909e3e3003b63b1dbd3a" title=
"Extracts the processed table information from a given request.">netsnmp_extract_table_info</a>(<a class="code" href=
"structnetsnmp__request__info__s.html" title="The netsnmp request info structure.">netsnmp_request_info</a> *request)
<a name="l00144" id="l00144"></a>00144 {
<a name="l00145" id="l00145"></a>00145     <span class="keywordflow">return</span> (<a class="code" href=
"structnetsnmp__table__request__info__s.html" title="The table request info structure.">netsnmp_table_request_info</a> *)
<a name="l00146" id="l00146"></a>00146         <a class="code" href="group__handler.html#gac8ebe16c4ca9e9e8d06fadcaa2650079"
title=
"extract data from a request that was added previously by a parent module">netsnmp_request_get_list_data</a>(request, TABLE_HANDLER_NAME);
<a name="l00147" id="l00147"></a>00147 }
<a name="l00148" id="l00148"></a>00148 
<a name="l00151" id="l00151"></a>00151 <a class="code" href="structnetsnmp__table__registration__info__s.html" title=
"Table registration structure.">netsnmp_table_registration_info</a> *
<a name="l00152" id="l00152"></a><a class="code" href="group__table.html#gaf0f72a85bfca5e069971fa3869082267">00152</a> <a class=
"code" href="group__table.html#gaf0f72a85bfca5e069971fa3869082267" title=
"extracts the registered netsnmp_table_registration_info object from a netsnmp_handler_registration...">netsnmp_find_table_registration_info</a>(<a class="code"
href="structnetsnmp__handler__registration__s.html" title="Root registration info.">netsnmp_handler_registration</a> *reginfo)
<a name="l00153" id="l00153"></a>00153 {
<a name="l00154" id="l00154"></a>00154     <span class="keywordflow">return</span> (<a class="code" href=
"structnetsnmp__table__registration__info__s.html" title="Table registration structure.">netsnmp_table_registration_info</a> *)
<a name="l00155" id="l00155"></a>00155         <a class="code" href="group__handler.html#ga6b85cb5b40f357ae415c44a1f3e50f5a"
title=
"Returns a handler&amp;#39;s void * pointer from a chain based on the name.">netsnmp_find_handler_data_by_name</a>(reginfo, TABLE_HANDLER_NAME);
<a name="l00156" id="l00156"></a>00156 }
<a name="l00157" id="l00157"></a>00157 
<a name="l00159" id="l00159"></a>00159 <span class="keywordtype">int</span>
<a name="l00160" id="l00160"></a><a class="code" href="group__table.html#ga571606b4d4e705a4420ff73ce3ac6b00">00160</a> <a class=
"code" href="group__table.html#ga571606b4d4e705a4420ff73ce3ac6b00" title=
"implements the table helper handler">table_helper_handler</a>(<a class="code" href="structnetsnmp__mib__handler__s.html" title=
"the mib handler structure to be registered">netsnmp_mib_handler</a> *handler,
<a name="l00161" id="l00161"></a>00161                      <a class="code" href="structnetsnmp__handler__registration__s.html"
title="Root registration info.">netsnmp_handler_registration</a> *reginfo,
<a name="l00162" id="l00162"></a>00162                      <a class="code" href="structnetsnmp__agent__request__info__s.html"
title="The agent transaction request structure.">netsnmp_agent_request_info</a> *reqinfo,
<a name="l00163" id="l00163"></a>00163                      <a class="code" href="structnetsnmp__request__info__s.html" title=
"The netsnmp request info structure.">netsnmp_request_info</a> *requests)
<a name="l00164" id="l00164"></a>00164 {
<a name="l00165" id="l00165"></a>00165 
<a name="l00166" id="l00166"></a>00166     <a class="code" href="structnetsnmp__request__info__s.html" title=
"The netsnmp request info structure.">netsnmp_request_info</a> *request;
<a name="l00167" id="l00167"></a>00167     <a class="code" href="structnetsnmp__table__registration__info__s.html" title=
"Table registration structure.">netsnmp_table_registration_info</a> *tbl_info;
<a name="l00168" id="l00168"></a>00168     <span class="keywordtype">int</span>             oid_index_pos;
<a name="l00169" id="l00169"></a>00169     <span class="keywordtype">unsigned</span> <span class=
"keywordtype">int</span>    oid_column_pos;
<a name="l00170" id="l00170"></a>00170     <span class="keywordtype">unsigned</span> <span class=
"keywordtype">int</span>    tmp_idx;
<a name="l00171" id="l00171"></a>00171     <span class="keywordtype">size_t</span>          tmp_len;
<a name="l00172" id="l00172"></a>00172     <span class=
"keywordtype">int</span>             incomplete, out_of_range, cleaned_up = 0;
<a name="l00173" id="l00173"></a>00173     <span class=
"keywordtype">int</span>             status = SNMP_ERR_NOERROR, need_processing = 0;
<a name="l00174" id="l00174"></a>00174     oid            *tmp_name;
<a name="l00175" id="l00175"></a>00175     <a class="code" href="structnetsnmp__table__request__info__s.html" title=
"The table request info structure.">netsnmp_table_request_info</a> *tbl_req_info;
<a name="l00176" id="l00176"></a>00176     <a class="code" href="structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> *vb;
<a name="l00177" id="l00177"></a>00177 
<a name="l00178" id="l00178"></a>00178     <span class="keywordflow">if</span> (!reginfo || !handler)
<a name="l00179" id="l00179"></a>00179         <span class="keywordflow">return</span> SNMPERR_GENERR;
<a name="l00180" id="l00180"></a>00180 
<a name="l00181" id="l00181"></a>00181     oid_index_pos  = reginfo-&gt;rootoid_len + 2;
<a name="l00182" id="l00182"></a>00182     oid_column_pos = reginfo-&gt;rootoid_len + 1;
<a name="l00183" id="l00183"></a>00183     tbl_info = (<a class="code" href="structnetsnmp__table__registration__info__s.html"
title="Table registration structure.">netsnmp_table_registration_info</a> *) handler-&gt;<a class="code" href=
"structnetsnmp__mib__handler__s.html#a74067d02cea4a059cd0fce7790b77b18" title="for handler&amp;#39;s internal use">myvoid</a>;
<a name="l00184" id="l00184"></a>00184 
<a name="l00185" id="l00185"></a>00185     if ((!handler-&gt;<a class="code" href=
"structnetsnmp__mib__handler__s.html#a74067d02cea4a059cd0fce7790b77b18" title=
"for handler&amp;#39;s internal use">myvoid</a>) || (!tbl_info-&gt;<a class="code" href=
"structnetsnmp__table__registration__info__s.html#a3045fe8e402e974d840af4084b88dc2a" title=
"list of varbinds with only &amp;#39;type&amp;#39; set">indexes</a>)) {
<a name="l00186" id="l00186"></a>00186         <a class="code" href=
"group__snmp__logging.html#ga9ba905368ea1c551b969af44b13e37c2" title=
"This snmp logging function allows variable argument list given the specified format...">snmp_log</a>(LOG_ERR, <span class=
"stringliteral">"improperly registered table found\n"</span>);
<a name="l00187" id="l00187"></a>00187         <a class="code" href=
"group__snmp__logging.html#ga9ba905368ea1c551b969af44b13e37c2" title=
"This snmp logging function allows variable argument list given the specified format...">snmp_log</a>(LOG_ERR, <span class=
"stringliteral">"name: %s, table info: %p, indexes: %p\n"</span>,
<a name="l00188" id="l00188"></a>00188                  handler-&gt;handler_name, handler-&gt;<a class="code" href=
"structnetsnmp__mib__handler__s.html#a74067d02cea4a059cd0fce7790b77b18" title=
"for handler&amp;#39;s internal use">myvoid</a>, tbl_info-&gt;<a class="code" href=
"structnetsnmp__table__registration__info__s.html#a3045fe8e402e974d840af4084b88dc2a" title=
"list of varbinds with only &amp;#39;type&amp;#39; set">indexes</a>);
<a name="l00189" id="l00189"></a>00189 
<a name="l00190" id="l00190"></a>00190         <span class="comment">/*</span>
<a name="l00191" id="l00191"></a>00191 <span class="comment">         * XXX-rks: unregister table? </span>
<a name="l00192" id="l00192"></a>00192 <span class="comment">         */</span>
<a name="l00193" id="l00193"></a>00193         <span class="keywordflow">return</span> SNMP_ERR_GENERR;
<a name="l00194" id="l00194"></a>00194     }
<a name="l00195" id="l00195"></a>00195 
<a name="l00196" id="l00196"></a>00196     DEBUGIF(<span class="stringliteral">"helper:table:req"</span>) {
<a name="l00197" id="l00197"></a>00197         DEBUGMSGTL((<span class="stringliteral">"helper:table:req"</span>,
<a name="l00198" id="l00198"></a>00198                     <span class=
"stringliteral">"Got request for handler %s: base oid:"</span>,
<a name="l00199" id="l00199"></a>00199                     handler-&gt;handler_name));
<a name="l00200" id="l00200"></a>00200         DEBUGMSGOID((<span class=
"stringliteral">"helper:table:req"</span>, reginfo-&gt;<a class="code" href=
"structnetsnmp__handler__registration__s.html#a264722b6b9385237fbcb5f8bc144d470" title="where are we registered at?">rootoid</a>,
<a name="l00201" id="l00201"></a>00201                      reginfo-&gt;rootoid_len));
<a name="l00202" id="l00202"></a>00202         DEBUGMSG((<span class="stringliteral">"helper:table:req"</span>, <span class=
"stringliteral">"\n"</span>));
<a name="l00203" id="l00203"></a>00203     }
<a name="l00204" id="l00204"></a>00204     
<a name="l00205" id="l00205"></a>00205     <span class="comment">/*</span>
<a name="l00206" id="l00206"></a>00206 <span class=
"comment">     * if the agent request info has a state reference, then this is a </span>
<a name="l00207" id="l00207"></a>00207 <span class=
"comment">     * later pass of a set request and we can skip all the lookup stuff.</span>
<a name="l00208" id="l00208"></a>00208 <span class="comment">     *</span>
<a name="l00209" id="l00209"></a>00209 <span class=
"comment">     * xxx-rks: this might break for handlers which only handle one varbind</span>
<a name="l00210" id="l00210"></a>00210 <span class=
"comment">     * at a time... those handlers should not save data by their handler_name</span>
<a name="l00211" id="l00211"></a>00211 <span class="comment">     * in the netsnmp_agent_request_info. </span>
<a name="l00212" id="l00212"></a>00212 <span class="comment">     */</span>
<a name="l00213" id="l00213"></a>00213     <span class=
"keywordflow">if</span> (netsnmp_agent_get_list_data(reqinfo, handler-&gt;next-&gt;handler_name)) {
<a name="l00214" id="l00214"></a>00214         <span class="keywordflow">if</span> (MODE_IS_SET(reqinfo-&gt;mode)) {
<a name="l00215" id="l00215"></a>00215             <span class="keywordflow">return</span> <a class="code" href=
"group__handler.html#gae45d1dbf0999b242f4f45714c7a63c1b" title=
"calls the next handler in the chain after the current one with with appropriate NULL...">netsnmp_call_next_handler</a>(handler, reginfo, reqinfo,
<a name="l00216" id="l00216"></a>00216                                              requests);
<a name="l00217" id="l00217"></a>00217         } <span class="keywordflow">else</span> {
<a name="l00219" id="l00219"></a>00219             netsnmp_free_agent_data_sets(reqinfo);
<a name="l00220" id="l00220"></a>00220         }
<a name="l00221" id="l00221"></a>00221     }
<a name="l00222" id="l00222"></a>00222 
<a name="l00223" id="l00223"></a>00223     <span class="keywordflow">if</span> ( MODE_IS_SET(reqinfo-&gt;mode) &amp;&amp;
<a name="l00224" id="l00224"></a>00224          (reqinfo-&gt;mode != MODE_SET_RESERVE1)) {
<a name="l00225" id="l00225"></a>00225         <span class="comment">/*</span>
<a name="l00226" id="l00226"></a>00226 <span class=
"comment">         * for later set modes, we can skip all the index parsing,</span>
<a name="l00227" id="l00227"></a>00227 <span class=
"comment">         * and we always need to let child handlers have a chance</span>
<a name="l00228" id="l00228"></a>00228 <span class=
"comment">         * to clean up, if they were called in the first place (i.e. have</span>
<a name="l00229" id="l00229"></a>00229 <span class="comment">         * a valid table info pointer).</span>
<a name="l00230" id="l00230"></a>00230 <span class="comment">         */</span>
<a name="l00231" id="l00231"></a>00231         <span class="keywordflow">if</span>(NULL == <a class="code" href=
"group__table.html#ga0f2aa788814b909e3e3003b63b1dbd3a" title=
"Extracts the processed table information from a given request.">netsnmp_extract_table_info</a>(requests)) {
<a name="l00232" id="l00232"></a>00232             DEBUGMSGTL((<span class="stringliteral">"table:helper"</span>,<span class=
"stringliteral">"no table info for set - skipping\n"</span>));
<a name="l00233" id="l00233"></a>00233         }
<a name="l00234" id="l00234"></a>00234         <span class="keywordflow">else</span>
<a name="l00235" id="l00235"></a>00235             need_processing = 1;
<a name="l00236" id="l00236"></a>00236     }
<a name="l00237" id="l00237"></a>00237     <span class="keywordflow">else</span> {
<a name="l00238" id="l00238"></a>00238         <span class="comment">/*</span>
<a name="l00239" id="l00239"></a>00239 <span class=
"comment">         * for RESERVE1 and GETS, only continue if we have at least</span>
<a name="l00240" id="l00240"></a>00240 <span class="comment">         * one valid request.</span>
<a name="l00241" id="l00241"></a>00241 <span class="comment">         */</span>
<a name="l00242" id="l00242"></a>00242            
<a name="l00243" id="l00243"></a>00243     <span class="comment">/*</span>
<a name="l00244" id="l00244"></a>00244 <span class="comment">     * loop through requests</span>
<a name="l00245" id="l00245"></a>00245 <span class="comment">     */</span>
<a name="l00246" id="l00246"></a>00246 
<a name="l00247" id="l00247"></a>00247     <span class=
"keywordflow">for</span> (request = requests; request; request = request-&gt;next) {
<a name="l00248" id="l00248"></a>00248         <a class="code" href="structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> *var = request-&gt;<a class="code"
href="structnetsnmp__request__info__s.html#a455d87f6b7178fe19ea564c60c0ccb6f" title="variable bindings">requestvb</a>;
<a name="l00249" id="l00249"></a>00249 
<a name="l00250" id="l00250"></a>00250         DEBUGMSGOID((<span class="stringliteral">"verbose:table"</span>, var-&gt;<a class=
"code" href="structvariable__list.html#a7b5bdda01921550d24ea53033ce76146" title=
"Object identifier of variable.">name</a>, var-&gt;<a class="code" href=
"structvariable__list.html#a089e5b1a422bf8e693510ff5408a57a7" title="number of subid&amp;#39;s in name">name_length</a>));
<a name="l00251" id="l00251"></a>00251         DEBUGMSG((<span class="stringliteral">"verbose:table"</span>, <span class=
"stringliteral">"\n"</span>));
<a name="l00252" id="l00252"></a>00252 
<a name="l00253" id="l00253"></a>00253         <span class="keywordflow">if</span> (request-&gt;processed) {
<a name="l00254" id="l00254"></a>00254             DEBUGMSG((<span class="stringliteral">"verbose:table"</span>, <span class=
"stringliteral">"already processed\n"</span>));
<a name="l00255" id="l00255"></a>00255             <span class="keywordflow">continue</span>;
<a name="l00256" id="l00256"></a>00256         }
<a name="l00257" id="l00257"></a>00257         netsnmp_assert(request-&gt;status == SNMP_ERR_NOERROR);
<a name="l00258" id="l00258"></a>00258 
<a name="l00259" id="l00259"></a>00259         <span class="comment">/*</span>
<a name="l00260" id="l00260"></a>00260 <span class="comment">         * this should probably be handled further up </span>
<a name="l00261" id="l00261"></a>00261 <span class="comment">         */</span>
<a name="l00262" id="l00262"></a>00262         <span class=
"keywordflow">if</span> ((reqinfo-&gt;mode == MODE_GET) &amp;&amp; (var-&gt;<a class="code" href=
"structvariable__list.html#a8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a> != ASN_NULL)) {
<a name="l00263" id="l00263"></a>00263             <span class="comment">/*</span>
<a name="l00264" id="l00264"></a>00264 <span class="comment">             * valid request if ASN_NULL </span>
<a name="l00265" id="l00265"></a>00265 <span class="comment">             */</span>
<a name="l00266" id="l00266"></a>00266             DEBUGMSGTL((<span class="stringliteral">"helper:table"</span>,
<a name="l00267" id="l00267"></a>00267                         <span class=
"stringliteral">"  GET var type is not ASN_NULL\n"</span>));
<a name="l00268" id="l00268"></a>00268             <a class="code" href=
"group__snmp__agent.html#gac0668f1fd9036ebc88a734d9d4a6a59b" title=
"set error for a request">netsnmp_set_request_error</a>(reqinfo, request,
<a name="l00269" id="l00269"></a>00269                                       SNMP_ERR_WRONGTYPE);
<a name="l00270" id="l00270"></a>00270             <span class="keywordflow">continue</span>;
<a name="l00271" id="l00271"></a>00271         }
<a name="l00272" id="l00272"></a>00272 
<a name="l00273" id="l00273"></a>00273         <span class="keywordflow">if</span> (reqinfo-&gt;mode == MODE_SET_RESERVE1) {
<a name="l00274" id="l00274"></a>00274             DEBUGIF(<span class="stringliteral">"helper:table:set"</span>) {
<a name="l00275" id="l00275"></a>00275                 u_char         *buf = NULL;
<a name="l00276" id="l00276"></a>00276                 <span class="keywordtype">size_t</span>          buf_len = 0, out_len = 0;
<a name="l00277" id="l00277"></a>00277                 DEBUGMSGTL((<span class=
"stringliteral">"helper:table:set"</span>, <span class="stringliteral">" SET_REQUEST for OID: "</span>));
<a name="l00278" id="l00278"></a>00278                 DEBUGMSGOID((<span class=
"stringliteral">"helper:table:set"</span>, var-&gt;<a class="code" href=
"structvariable__list.html#a7b5bdda01921550d24ea53033ce76146" title="Object identifier of variable.">name</a>, var-&gt;<a class=
"code" href="structvariable__list.html#a089e5b1a422bf8e693510ff5408a57a7" title=
"number of subid&amp;#39;s in name">name_length</a>));
<a name="l00279" id="l00279"></a>00279                 out_len = 0;
<a name="l00280" id="l00280"></a>00280                 <span class="keywordflow">if</span> (<a class="code" href=
"group__mib__utilities.html#gaabc12c361abdca75234c11dccb34871b" title=
"Universal print routine, prints a variable into a buffer according to the variable...">sprint_realloc_by_type</a>(&amp;buf, &amp;buf_len, &amp;out_len, 1,
<a name="l00281" id="l00281"></a>00281                                            var, NULL, NULL, NULL)) {
<a name="l00282" id="l00282"></a>00282                     DEBUGMSG((<span class=
"stringliteral">"helper:table:set"</span>,<span class="stringliteral">" type=%d(%02x), value=%s\n"</span>,
<a name="l00283" id="l00283"></a>00283                               var-&gt;<a class="code" href=
"structvariable__list.html#a8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a>, var-&gt;<a class="code"
href="structvariable__list.html#a8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a>, buf));
<a name="l00284" id="l00284"></a>00284                 } <span class="keywordflow">else</span> {
<a name="l00285" id="l00285"></a>00285                     <span class="keywordflow">if</span> (buf != NULL) {
<a name="l00286" id="l00286"></a>00286                         DEBUGMSG((<span class="stringliteral">"helper:table:set"</span>,
<a name="l00287" id="l00287"></a>00287                                   <span class=
"stringliteral">" type=%d(%02x), value=%s [TRUNCATED]\n"</span>,
<a name="l00288" id="l00288"></a>00288                                   var-&gt;<a class="code" href=
"structvariable__list.html#a8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a>, var-&gt;<a class="code"
href="structvariable__list.html#a8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a>, buf));
<a name="l00289" id="l00289"></a>00289                     } <span class="keywordflow">else</span> {
<a name="l00290" id="l00290"></a>00290                         DEBUGMSG((<span class="stringliteral">"helper:table:set"</span>,
<a name="l00291" id="l00291"></a>00291                                   <span class=
"stringliteral">" type=%d(%02x), value=[NIL] [TRUNCATED]\n"</span>,
<a name="l00292" id="l00292"></a>00292                                   var-&gt;<a class="code" href=
"structvariable__list.html#a8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a>, var-&gt;<a class="code"
href="structvariable__list.html#a8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a>));
<a name="l00293" id="l00293"></a>00293                     }
<a name="l00294" id="l00294"></a>00294                 }
<a name="l00295" id="l00295"></a>00295                 <span class="keywordflow">if</span> (buf != NULL) {
<a name="l00296" id="l00296"></a>00296                     free(buf);
<a name="l00297" id="l00297"></a>00297                 }
<a name="l00298" id="l00298"></a>00298             }
<a name="l00299" id="l00299"></a>00299         }
<a name="l00300" id="l00300"></a>00300 
<a name="l00301" id="l00301"></a>00301         <span class="comment">/*</span>
<a name="l00302" id="l00302"></a>00302 <span class="comment">         * check to make sure its in table range </span>
<a name="l00303" id="l00303"></a>00303 <span class="comment">         */</span>
<a name="l00304" id="l00304"></a>00304 
<a name="l00305" id="l00305"></a>00305         out_of_range = 0;
<a name="l00306" id="l00306"></a>00306         <span class="comment">/*</span>
<a name="l00307" id="l00307"></a>00307 <span class=
"comment">         * if our root oid is &gt; var-&gt;name and this is not a GETNEXT, </span>
<a name="l00308" id="l00308"></a>00308 <span class=
"comment">         * then the oid is out of range. (only compare up to shorter </span>
<a name="l00309" id="l00309"></a>00309 <span class="comment">         * length) </span>
<a name="l00310" id="l00310"></a>00310 <span class="comment">         */</span>
<a name="l00311" id="l00311"></a>00311         <span class=
"keywordflow">if</span> (reginfo-&gt;rootoid_len &gt; var-&gt;<a class="code" href=
"structvariable__list.html#a089e5b1a422bf8e693510ff5408a57a7" title="number of subid&amp;#39;s in name">name_length</a>)
<a name="l00312" id="l00312"></a>00312             tmp_len = var-&gt;<a class="code" href=
"structvariable__list.html#a089e5b1a422bf8e693510ff5408a57a7" title="number of subid&amp;#39;s in name">name_length</a>;
<a name="l00313" id="l00313"></a>00313         <span class="keywordflow">else</span>
<a name="l00314" id="l00314"></a>00314             tmp_len = reginfo-&gt;rootoid_len;
<a name="l00315" id="l00315"></a>00315         <span class="keywordflow">if</span> (<a class="code" href=
"group__library.html#gab5b48a42c19a801547e025ed40b4561e" title=
"lexicographical compare two object identifiers.">snmp_oid_compare</a>(reginfo-&gt;<a class="code" href=
"structnetsnmp__handler__registration__s.html#a264722b6b9385237fbcb5f8bc144d470" title=
"where are we registered at?">rootoid</a>, reginfo-&gt;rootoid_len,
<a name="l00316" id="l00316"></a>00316                              var-&gt;<a class="code" href=
"structvariable__list.html#a7b5bdda01921550d24ea53033ce76146" title="Object identifier of variable.">name</a>, tmp_len) &gt; 0) {
<a name="l00317" id="l00317"></a>00317             <span class="keywordflow">if</span> (reqinfo-&gt;mode == MODE_GETNEXT) {
<a name="l00318" id="l00318"></a>00318                 <span class="keywordflow">if</span> (var-&gt;<a class="code" href=
"structvariable__list.html#a7b5bdda01921550d24ea53033ce76146" title=
"Object identifier of variable.">name</a> != var-&gt;<a class="code" href=
"structvariable__list.html#a5b8071f7514fb530c9b596791bca6813" title="90 percentile &amp;lt; 24.">name_loc</a>)
<a name="l00319" id="l00319"></a>00319                     <a class="code" href=
"group__util.html#ga951e93edb6f0ea941e26155e3f8912a6" title=
"Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(var-&gt;<a class="code" href=
"structvariable__list.html#a7b5bdda01921550d24ea53033ce76146" title="Object identifier of variable.">name</a>);
<a name="l00320" id="l00320"></a>00320                 snmp_set_var_objid(var, reginfo-&gt;<a class="code" href=
"structnetsnmp__handler__registration__s.html#a264722b6b9385237fbcb5f8bc144d470" title="where are we registered at?">rootoid</a>,
<a name="l00321" id="l00321"></a>00321                                    reginfo-&gt;rootoid_len);
<a name="l00322" id="l00322"></a>00322             } <span class="keywordflow">else</span> {
<a name="l00323" id="l00323"></a>00323                 DEBUGMSGTL((<span class=
"stringliteral">"helper:table"</span>, <span class="stringliteral">"  oid is out of range.\n"</span>));
<a name="l00324" id="l00324"></a>00324                 out_of_range = 1;
<a name="l00325" id="l00325"></a>00325             }
<a name="l00326" id="l00326"></a>00326         }
<a name="l00327" id="l00327"></a>00327         <span class="comment">/*</span>
<a name="l00328" id="l00328"></a>00328 <span class=
"comment">         * if var-&gt;name is longer than the root, make sure it is </span>
<a name="l00329" id="l00329"></a>00329 <span class="comment">         * table.1 (table.ENTRY).  </span>
<a name="l00330" id="l00330"></a>00330 <span class="comment">         */</span>
<a name="l00331" id="l00331"></a>00331         <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> ((var-&gt;<a class="code" href="structvariable__list.html#a089e5b1a422bf8e693510ff5408a57a7" title=
"number of subid&amp;#39;s in name">name_length</a> &gt; reginfo-&gt;rootoid_len) &amp;&amp;
<a name="l00332" id="l00332"></a>00332                  (var-&gt;<a class="code" href=
"structvariable__list.html#a7b5bdda01921550d24ea53033ce76146" title=
"Object identifier of variable.">name</a>[reginfo-&gt;rootoid_len] != 1)) {
<a name="l00333" id="l00333"></a>00333             <span class="keywordflow">if</span> ((var-&gt;<a class="code" href=
"structvariable__list.html#a7b5bdda01921550d24ea53033ce76146" title=
"Object identifier of variable.">name</a>[reginfo-&gt;rootoid_len] &lt; 1) &amp;&amp;
<a name="l00334" id="l00334"></a>00334                 (reqinfo-&gt;mode == MODE_GETNEXT)) {
<a name="l00335" id="l00335"></a>00335                 var-&gt;<a class="code" href=
"structvariable__list.html#a7b5bdda01921550d24ea53033ce76146" title=
"Object identifier of variable.">name</a>[reginfo-&gt;rootoid_len] = 1;
<a name="l00336" id="l00336"></a>00336                 var-&gt;<a class="code" href=
"structvariable__list.html#a089e5b1a422bf8e693510ff5408a57a7" title=
"number of subid&amp;#39;s in name">name_length</a> = reginfo-&gt;rootoid_len;
<a name="l00337" id="l00337"></a>00337             } <span class="keywordflow">else</span> {
<a name="l00338" id="l00338"></a>00338                 out_of_range = 1;
<a name="l00339" id="l00339"></a>00339                 DEBUGMSGTL((<span class=
"stringliteral">"helper:table"</span>, <span class="stringliteral">"  oid is out of range.\n"</span>));
<a name="l00340" id="l00340"></a>00340             }
<a name="l00341" id="l00341"></a>00341         }
<a name="l00342" id="l00342"></a>00342         <span class="comment">/*</span>
<a name="l00343" id="l00343"></a>00343 <span class=
"comment">         * if it is not in range, then mark it in the request list </span>
<a name="l00344" id="l00344"></a>00344 <span class="comment">         * because we can't process it, and set an error so</span>
<a name="l00345" id="l00345"></a>00345 <span class=
"comment">         * nobody else wastes time trying to process it either.  </span>
<a name="l00346" id="l00346"></a>00346 <span class="comment">         */</span>
<a name="l00347" id="l00347"></a>00347         <span class="keywordflow">if</span> (out_of_range) {
<a name="l00348" id="l00348"></a>00348             DEBUGMSGTL((<span class="stringliteral">"helper:table"</span>, <span class=
"stringliteral">"  Not processed: "</span>));
<a name="l00349" id="l00349"></a>00349             DEBUGMSGOID((<span class=
"stringliteral">"helper:table"</span>, var-&gt;<a class="code" href="structvariable__list.html#a7b5bdda01921550d24ea53033ce76146"
title="Object identifier of variable.">name</a>, var-&gt;<a class="code" href=
"structvariable__list.html#a089e5b1a422bf8e693510ff5408a57a7" title="number of subid&amp;#39;s in name">name_length</a>));
<a name="l00350" id="l00350"></a>00350             DEBUGMSG((<span class="stringliteral">"helper:table"</span>, <span class=
"stringliteral">"\n"</span>));
<a name="l00351" id="l00351"></a>00351 
<a name="l00352" id="l00352"></a>00352             <span class="comment">/*</span>
<a name="l00353" id="l00353"></a>00353 <span class=
"comment">             *  Reject requests of the form 'myTable.N'   (N != 1)</span>
<a name="l00354" id="l00354"></a>00354 <span class="comment">             */</span>
<a name="l00355" id="l00355"></a>00355             <span class="keywordflow">if</span> (reqinfo-&gt;mode == MODE_SET_RESERVE1)
<a name="l00356" id="l00356"></a>00356                 table_helper_cleanup(reqinfo, request,
<a name="l00357" id="l00357"></a>00357                                      SNMP_ERR_NOTWRITABLE);
<a name="l00358" id="l00358"></a>00358             <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (reqinfo-&gt;mode == MODE_GET)
<a name="l00359" id="l00359"></a>00359                 table_helper_cleanup(reqinfo, request,
<a name="l00360" id="l00360"></a>00360                                      SNMP_NOSUCHOBJECT);
<a name="l00361" id="l00361"></a>00361             <span class="keywordflow">continue</span>;
<a name="l00362" id="l00362"></a>00362         }
<a name="l00363" id="l00363"></a>00363 
<a name="l00364" id="l00364"></a>00364 
<a name="l00365" id="l00365"></a>00365         <span class="comment">/*</span>
<a name="l00366" id="l00366"></a>00366 <span class=
"comment">         * Check column ranges; set-up to pull out indexes from OID. </span>
<a name="l00367" id="l00367"></a>00367 <span class="comment">         */</span>
<a name="l00368" id="l00368"></a>00368 
<a name="l00369" id="l00369"></a>00369         incomplete = 0;
<a name="l00370" id="l00370"></a>00370         tbl_req_info = <a class="code" href=
"group__table.html#ga0f2aa788814b909e3e3003b63b1dbd3a" title=
"Extracts the processed table information from a given request.">netsnmp_extract_table_info</a>(request);
<a name="l00371" id="l00371"></a>00371         <span class="keywordflow">if</span> (NULL == tbl_req_info) {
<a name="l00372" id="l00372"></a>00372             tbl_req_info = <a class="code" href=
"group__util.html#ga9cd013bb193de5048149afeb9d94e424" title=
"Mallocs memory of sizeof(t), zeros it and returns a pointer to it.">SNMP_MALLOC_TYPEDEF</a>(<a class="code" href=
"structnetsnmp__table__request__info__s.html" title="The table request info structure.">netsnmp_table_request_info</a>);
<a name="l00373" id="l00373"></a>00373             <span class="keywordflow">if</span> (tbl_req_info == NULL) {
<a name="l00374" id="l00374"></a>00374                 table_helper_cleanup(reqinfo, request,
<a name="l00375" id="l00375"></a>00375                                      SNMP_ERR_GENERR);
<a name="l00376" id="l00376"></a>00376                 <span class="keywordflow">continue</span>;
<a name="l00377" id="l00377"></a>00377             }
<a name="l00378" id="l00378"></a>00378             tbl_req_info-&gt;reg_info = tbl_info;
<a name="l00379" id="l00379"></a>00379             tbl_req_info-&gt;<a class="code" href=
"structnetsnmp__table__request__info__s.html#a585f93b117d282e0c857e7b3670f85af" title=
"contents freed by helper upon exit">indexes</a> = snmp_clone_varbind(tbl_info-&gt;<a class="code" href=
"structnetsnmp__table__registration__info__s.html#a3045fe8e402e974d840af4084b88dc2a" title=
"list of varbinds with only &amp;#39;type&amp;#39; set">indexes</a>);
<a name="l00380" id="l00380"></a>00380             tbl_req_info-&gt;<a class="code" href=
"structnetsnmp__table__request__info__s.html#a7a5309fb5e3d994e4ccd4986b6a90bfd" title=
"0 if failure to parse any">number_indexes</a> = 0;       <span class="comment">/* none yet */</span>
<a name="l00381" id="l00381"></a>00381             <a class="code" href="group__handler.html#gacc092f27f7c4203fe20665c8341023c8"
title="add data to a request that can be extracted later by submodules">netsnmp_request_add_list_data</a>(request,
<a name="l00382" id="l00382"></a>00382                                           <a class="code" href=
"group__data__list.html#ga3dc286b678474c6adb610460ea71b03e" title=
"adds creates a data_list node given a name, data and a free function ptr.">netsnmp_create_data_list</a>
<a name="l00383" id="l00383"></a>00383                                           (TABLE_HANDLER_NAME,
<a name="l00384" id="l00384"></a>00384                                            (<span class=
"keywordtype">void</span> *) tbl_req_info,
<a name="l00385" id="l00385"></a>00385                                            table_data_free_func));
<a name="l00386" id="l00386"></a>00386         } <span class="keywordflow">else</span> {
<a name="l00387" id="l00387"></a>00387             DEBUGMSGTL((<span class="stringliteral">"helper:table"</span>, <span class=
"stringliteral">"  using existing tbl_req_info\n "</span>));
<a name="l00388" id="l00388"></a>00388         }
<a name="l00389" id="l00389"></a>00389 
<a name="l00390" id="l00390"></a>00390         <span class="comment">/*</span>
<a name="l00391" id="l00391"></a>00391 <span class="comment">         * do we have a column?</span>
<a name="l00392" id="l00392"></a>00392 <span class="comment">         */</span>
<a name="l00393" id="l00393"></a>00393         <span class="keywordflow">if</span> (var-&gt;<a class="code" href=
"structvariable__list.html#a089e5b1a422bf8e693510ff5408a57a7" title=
"number of subid&amp;#39;s in name">name_length</a> &gt; oid_column_pos) {
<a name="l00394" id="l00394"></a>00394             <span class="comment">/*</span>
<a name="l00395" id="l00395"></a>00395 <span class="comment">             * oid is long enough to contain COLUMN info</span>
<a name="l00396" id="l00396"></a>00396 <span class="comment">             */</span>
<a name="l00397" id="l00397"></a>00397             DEBUGMSGTL((<span class=
"stringliteral">"helper:table:col"</span>, <span class="stringliteral">"  have at least a column (%ld)\n"</span>,
<a name="l00398" id="l00398"></a>00398                         var-&gt;<a class="code" href=
"structvariable__list.html#a7b5bdda01921550d24ea53033ce76146" title="Object identifier of variable.">name</a>[oid_column_pos]));
<a name="l00399" id="l00399"></a>00399             <span class="keywordflow">if</span> (var-&gt;<a class="code" href=
"structvariable__list.html#a7b5bdda01921550d24ea53033ce76146" title=
"Object identifier of variable.">name</a>[oid_column_pos] &lt; tbl_info-&gt;<a class="code" href=
"structnetsnmp__table__registration__info__s.html#ae48fd51376f573a4c4e5aede809f7092" title=
"the minimum columns number.">min_column</a>) {
<a name="l00400" id="l00400"></a>00400                 DEBUGMSGTL((<span class="stringliteral">"helper:table:col"</span>,
<a name="l00401" id="l00401"></a>00401                             <span class=
"stringliteral">"    but it's less than min (%d)\n"</span>,
<a name="l00402" id="l00402"></a>00402                             tbl_info-&gt;<a class="code" href=
"structnetsnmp__table__registration__info__s.html#ae48fd51376f573a4c4e5aede809f7092" title=
"the minimum columns number.">min_column</a>));
<a name="l00403" id="l00403"></a>00403                 <span class="keywordflow">if</span> (reqinfo-&gt;mode == MODE_GETNEXT) {
<a name="l00404" id="l00404"></a>00404                     <span class="comment">/*</span>
<a name="l00405" id="l00405"></a>00405 <span class=
"comment">                     * fix column, truncate useless column info </span>
<a name="l00406" id="l00406"></a>00406 <span class="comment">                     */</span>
<a name="l00407" id="l00407"></a>00407                     var-&gt;<a class="code" href=
"structvariable__list.html#a089e5b1a422bf8e693510ff5408a57a7" title=
"number of subid&amp;#39;s in name">name_length</a> = oid_column_pos;
<a name="l00408" id="l00408"></a>00408                     tbl_req_info-&gt;<a class="code" href=
"structnetsnmp__table__request__info__s.html#afbed55ce9b6c75a98fafc84559462b34" title=
"0 if OID not long enough">colnum</a> = tbl_info-&gt;<a class="code" href=
"structnetsnmp__table__registration__info__s.html#ae48fd51376f573a4c4e5aede809f7092" title=
"the minimum columns number.">min_column</a>;
<a name="l00409" id="l00409"></a>00409                 } <span class="keywordflow">else</span>
<a name="l00410" id="l00410"></a>00410                     out_of_range = 1;
<a name="l00411" id="l00411"></a>00411             } <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (var-&gt;<a class="code" href="structvariable__list.html#a7b5bdda01921550d24ea53033ce76146" title=
"Object identifier of variable.">name</a>[oid_column_pos] &gt; tbl_info-&gt;<a class="code" href=
"structnetsnmp__table__registration__info__s.html#a4b7f37faafced959b943e974ba58e008" title=
"the maximum columns number">max_column</a>)
<a name="l00412" id="l00412"></a>00412                 out_of_range = 1;
<a name="l00413" id="l00413"></a>00413             <span class="keywordflow">else</span>
<a name="l00414" id="l00414"></a>00414                 tbl_req_info-&gt;<a class="code" href=
"structnetsnmp__table__request__info__s.html#afbed55ce9b6c75a98fafc84559462b34" title=
"0 if OID not long enough">colnum</a> = var-&gt;<a class="code" href=
"structvariable__list.html#a7b5bdda01921550d24ea53033ce76146" title="Object identifier of variable.">name</a>[oid_column_pos];
<a name="l00415" id="l00415"></a>00415 
<a name="l00416" id="l00416"></a>00416             <span class="keywordflow">if</span> (out_of_range) {
<a name="l00417" id="l00417"></a>00417                 <span class="comment">/*</span>
<a name="l00418" id="l00418"></a>00418 <span class=
"comment">                 * this is out of range...  remove from requests, free</span>
<a name="l00419" id="l00419"></a>00419 <span class="comment">                 * memory </span>
<a name="l00420" id="l00420"></a>00420 <span class="comment">                 */</span>
<a name="l00421" id="l00421"></a>00421                 DEBUGMSGTL((<span class="stringliteral">"helper:table"</span>,
<a name="l00422" id="l00422"></a>00422                             <span class=
"stringliteral">"    oid is out of range. Not processed: "</span>));
<a name="l00423" id="l00423"></a>00423                 DEBUGMSGOID((<span class=
"stringliteral">"helper:table"</span>, var-&gt;<a class="code" href="structvariable__list.html#a7b5bdda01921550d24ea53033ce76146"
title="Object identifier of variable.">name</a>, var-&gt;<a class="code" href=
"structvariable__list.html#a089e5b1a422bf8e693510ff5408a57a7" title="number of subid&amp;#39;s in name">name_length</a>));
<a name="l00424" id="l00424"></a>00424                 DEBUGMSG((<span class="stringliteral">"helper:table"</span>, <span class=
"stringliteral">"\n"</span>));
<a name="l00425" id="l00425"></a>00425 
<a name="l00426" id="l00426"></a>00426                 <span class="comment">/*</span>
<a name="l00427" id="l00427"></a>00427 <span class=
"comment">                 *  Reject requests of the form 'myEntry.N'   (invalid N)</span>
<a name="l00428" id="l00428"></a>00428 <span class="comment">                 */</span>
<a name="l00429" id="l00429"></a>00429                 <span class=
"keywordflow">if</span> (reqinfo-&gt;mode == MODE_SET_RESERVE1)
<a name="l00430" id="l00430"></a>00430                     table_helper_cleanup(reqinfo, request,
<a name="l00431" id="l00431"></a>00431                                          SNMP_ERR_NOTWRITABLE);
<a name="l00432" id="l00432"></a>00432                 <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (reqinfo-&gt;mode == MODE_GET)
<a name="l00433" id="l00433"></a>00433                     table_helper_cleanup(reqinfo, request,
<a name="l00434" id="l00434"></a>00434                                          SNMP_NOSUCHOBJECT);
<a name="l00435" id="l00435"></a>00435                 <span class="keywordflow">continue</span>;
<a name="l00436" id="l00436"></a>00436             }
<a name="l00437" id="l00437"></a>00437             <span class="comment">/*</span>
<a name="l00438" id="l00438"></a>00438 <span class="comment">             * use column verification </span>
<a name="l00439" id="l00439"></a>00439 <span class="comment">             */</span>
<a name="l00440" id="l00440"></a>00440             <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (tbl_info-&gt;<a class="code" href=
"structnetsnmp__table__registration__info__s.html#aaedf72ed4f760e9926f739553da49835" title=
"more details on columns">valid_columns</a>) {
<a name="l00441" id="l00441"></a>00441                 tbl_req_info-&gt;<a class="code" href=
"structnetsnmp__table__request__info__s.html#afbed55ce9b6c75a98fafc84559462b34" title="0 if OID not long enough">colnum</a> =
<a name="l00442" id="l00442"></a>00442                     netsnmp_closest_column(var-&gt;<a class="code" href=
"structvariable__list.html#a7b5bdda01921550d24ea53033ce76146" title="Object identifier of variable.">name</a>[oid_column_pos],
<a name="l00443" id="l00443"></a>00443                                            tbl_info-&gt;<a class="code" href=
"structnetsnmp__table__registration__info__s.html#aaedf72ed4f760e9926f739553da49835" title=
"more details on columns">valid_columns</a>);
<a name="l00444" id="l00444"></a>00444                 DEBUGMSGTL((<span class=
"stringliteral">"helper:table:col"</span>, <span class="stringliteral">"    closest column is %d\n"</span>,
<a name="l00445" id="l00445"></a>00445                             tbl_req_info-&gt;<a class="code" href=
"structnetsnmp__table__request__info__s.html#afbed55ce9b6c75a98fafc84559462b34" title="0 if OID not long enough">colnum</a>));
<a name="l00446" id="l00446"></a>00446                 <span class="comment">/*</span>
<a name="l00447" id="l00447"></a>00447 <span class="comment">                 * xxx-rks: document why the continue...</span>
<a name="l00448" id="l00448"></a>00448 <span class="comment">                 */</span>
<a name="l00449" id="l00449"></a>00449                 <span class="keywordflow">if</span> (tbl_req_info-&gt;<a class="code"
href="structnetsnmp__table__request__info__s.html#afbed55ce9b6c75a98fafc84559462b34" title=
"0 if OID not long enough">colnum</a> == 0)
<a name="l00450" id="l00450"></a>00450                     <span class="keywordflow">continue</span>;
<a name="l00451" id="l00451"></a>00451                 <span class="keywordflow">if</span> (tbl_req_info-&gt;<a class="code"
href="structnetsnmp__table__request__info__s.html#afbed55ce9b6c75a98fafc84559462b34" title=
"0 if OID not long enough">colnum</a> != var-&gt;<a class="code" href=
"structvariable__list.html#a7b5bdda01921550d24ea53033ce76146" title="Object identifier of variable.">name</a>[oid_column_pos]) {
<a name="l00452" id="l00452"></a>00452                     DEBUGMSGTL((<span class="stringliteral">"helper:table:col"</span>,
<a name="l00453" id="l00453"></a>00453                                 <span class=
"stringliteral">"    which doesn't match req %ld - truncating index info\n"</span>,
<a name="l00454" id="l00454"></a>00454                                    var-&gt;<a class="code" href=
"structvariable__list.html#a7b5bdda01921550d24ea53033ce76146" title="Object identifier of variable.">name</a>[oid_column_pos]));
<a name="l00455" id="l00455"></a>00455                     <span class="comment">/*</span>
<a name="l00456" id="l00456"></a>00456 <span class=
"comment">                     * different column! truncate useless index info </span>
<a name="l00457" id="l00457"></a>00457 <span class="comment">                     */</span>
<a name="l00458" id="l00458"></a>00458                     var-&gt;<a class="code" href=
"structvariable__list.html#a089e5b1a422bf8e693510ff5408a57a7" title=
"number of subid&amp;#39;s in name">name_length</a> = oid_column_pos + 1; <span class="comment">/* pos is 0 based */</span>
<a name="l00459" id="l00459"></a>00459                 }
<a name="l00460" id="l00460"></a>00460             }
<a name="l00461" id="l00461"></a>00461             <span class="comment">/*</span>
<a name="l00462" id="l00462"></a>00462 <span class=
"comment">             * var-&gt;name_length may have changed - check again </span>
<a name="l00463" id="l00463"></a>00463 <span class="comment">             */</span>
<a name="l00464" id="l00464"></a>00464             <span class="keywordflow">if</span> ((<span class=
"keywordtype">int</span>)var-&gt;<a class="code" href="structvariable__list.html#a089e5b1a422bf8e693510ff5408a57a7" title=
"number of subid&amp;#39;s in name">name_length</a> &lt;= oid_index_pos) { <span class="comment">/* pos is 0 based */</span>
<a name="l00465" id="l00465"></a>00465                 DEBUGMSGTL((<span class=
"stringliteral">"helper:table"</span>, <span class="stringliteral">"    not enough for indexes\n"</span>));
<a name="l00466" id="l00466"></a>00466                 tbl_req_info-&gt;index_oid_len = 0; 
<a name="l00467" id="l00467"></a>00467             } <span class="keywordflow">else</span> {
<a name="l00468" id="l00468"></a>00468                 <span class="comment">/*</span>
<a name="l00469" id="l00469"></a>00469 <span class="comment">                 * oid is long enough to contain INDEX info</span>
<a name="l00470" id="l00470"></a>00470 <span class="comment">                 */</span>
<a name="l00471" id="l00471"></a>00471                 tbl_req_info-&gt;index_oid_len =
<a name="l00472" id="l00472"></a>00472                     var-&gt;<a class="code" href=
"structvariable__list.html#a089e5b1a422bf8e693510ff5408a57a7" title=
"number of subid&amp;#39;s in name">name_length</a> - oid_index_pos;
<a name="l00473" id="l00473"></a>00473                 DEBUGMSGTL((<span class=
"stringliteral">"helper:table"</span>, <span class="stringliteral">"    have %lu bytes of index\n"</span>,
<a name="l00474" id="l00474"></a>00474                             (<span class="keywordtype">unsigned</span> <span class=
"keywordtype">long</span>)tbl_req_info-&gt;index_oid_len));
<a name="l00475" id="l00475"></a>00475                 netsnmp_assert(tbl_req_info-&gt;index_oid_len &lt; MAX_OID_LEN);
<a name="l00476" id="l00476"></a>00476                 memcpy(tbl_req_info-&gt;index_oid, &amp;var-&gt;<a class="code" href=
"structvariable__list.html#a7b5bdda01921550d24ea53033ce76146" title="Object identifier of variable.">name</a>[oid_index_pos],
<a name="l00477" id="l00477"></a>00477                        tbl_req_info-&gt;index_oid_len * <span class=
"keyword">sizeof</span>(oid));
<a name="l00478" id="l00478"></a>00478                 tmp_name = tbl_req_info-&gt;index_oid;
<a name="l00479" id="l00479"></a>00479             }
<a name="l00480" id="l00480"></a>00480         } <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (reqinfo-&gt;mode == MODE_GETNEXT ||
<a name="l00481" id="l00481"></a>00481                    reqinfo-&gt;mode == MODE_GETBULK) {
<a name="l00482" id="l00482"></a>00482             <span class="comment">/*</span>
<a name="l00483" id="l00483"></a>00483 <span class=
"comment">             * oid is NOT long enough to contain column or index info, so start</span>
<a name="l00484" id="l00484"></a>00484 <span class=
"comment">             * at the minimum column. Set index oid len to 0 because we don't</span>
<a name="l00485" id="l00485"></a>00485 <span class="comment">             * have any index info in the OID.</span>
<a name="l00486" id="l00486"></a>00486 <span class="comment">             */</span>
<a name="l00487" id="l00487"></a>00487             DEBUGMSGTL((<span class="stringliteral">"helper:table"</span>, <span class=
"stringliteral">"  no column/index in request\n"</span>));
<a name="l00488" id="l00488"></a>00488             tbl_req_info-&gt;index_oid_len = 0;
<a name="l00489" id="l00489"></a>00489             tbl_req_info-&gt;<a class="code" href=
"structnetsnmp__table__request__info__s.html#afbed55ce9b6c75a98fafc84559462b34" title=
"0 if OID not long enough">colnum</a> = tbl_info-&gt;<a class="code" href=
"structnetsnmp__table__registration__info__s.html#ae48fd51376f573a4c4e5aede809f7092" title=
"the minimum columns number.">min_column</a>;
<a name="l00490" id="l00490"></a>00490         } <span class="keywordflow">else</span> {
<a name="l00491" id="l00491"></a>00491             <span class="comment">/*</span>
<a name="l00492" id="l00492"></a>00492 <span class="comment">             * oid is NOT long enough to contain index info,</span>
<a name="l00493" id="l00493"></a>00493 <span class="comment">             * so we can't do anything with it.</span>
<a name="l00494" id="l00494"></a>00494 <span class="comment">             *</span>
<a name="l00495" id="l00495"></a>00495 <span class=
"comment">             * Reject requests of the form 'myTable' or 'myEntry'</span>
<a name="l00496" id="l00496"></a>00496 <span class="comment">             */</span>
<a name="l00497" id="l00497"></a>00497             <span class="keywordflow">if</span> (reqinfo-&gt;mode == MODE_GET ) {
<a name="l00498" id="l00498"></a>00498                 table_helper_cleanup(reqinfo, request, SNMP_NOSUCHOBJECT);
<a name="l00499" id="l00499"></a>00499             } <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (reqinfo-&gt;mode == MODE_SET_RESERVE1 ) {
<a name="l00500" id="l00500"></a>00500                 table_helper_cleanup(reqinfo, request, SNMP_ERR_NOTWRITABLE);
<a name="l00501" id="l00501"></a>00501             }
<a name="l00502" id="l00502"></a>00502             <span class="keywordflow">continue</span>;
<a name="l00503" id="l00503"></a>00503         }
<a name="l00504" id="l00504"></a>00504 
<a name="l00505" id="l00505"></a>00505         <span class="comment">/*</span>
<a name="l00506" id="l00506"></a>00506 <span class=
"comment">         * set up tmp_len to be the number of OIDs we have beyond the column;</span>
<a name="l00507" id="l00507"></a>00507 <span class=
"comment">         * these should be the index(s) for the table. If the index_oid_len</span>
<a name="l00508" id="l00508"></a>00508 <span class=
"comment">         * is 0, set tmp_len to -1 so that when we try to parse the index below,</span>
<a name="l00509" id="l00509"></a>00509 <span class="comment">         * we just zero fill everything.</span>
<a name="l00510" id="l00510"></a>00510 <span class="comment">         */</span>
<a name="l00511" id="l00511"></a>00511         <span class="keywordflow">if</span> (tbl_req_info-&gt;index_oid_len == 0) {
<a name="l00512" id="l00512"></a>00512             incomplete = 1;
<a name="l00513" id="l00513"></a>00513             tmp_len = -1;
<a name="l00514" id="l00514"></a>00514         } <span class="keywordflow">else</span>
<a name="l00515" id="l00515"></a>00515             tmp_len = tbl_req_info-&gt;index_oid_len;
<a name="l00516" id="l00516"></a>00516 
<a name="l00517" id="l00517"></a>00517 
<a name="l00518" id="l00518"></a>00518         <span class="comment">/*</span>
<a name="l00519" id="l00519"></a>00519 <span class=
"comment">         * for each index type, try to extract the index from var-&gt;name</span>
<a name="l00520" id="l00520"></a>00520 <span class="comment">         */</span>
<a name="l00521" id="l00521"></a>00521         DEBUGMSGTL((<span class="stringliteral">"helper:table"</span>, <span class=
"stringliteral">"  looking for %d indexes\n"</span>,
<a name="l00522" id="l00522"></a>00522                     tbl_info-&gt;<a class="code" href=
"structnetsnmp__table__registration__info__s.html#a31ac0da11dbc52abe401401df065020a" title=
"calculated automatically">number_indexes</a>));
<a name="l00523" id="l00523"></a>00523         <span class="keywordflow">for</span> (tmp_idx = 0, vb = tbl_req_info-&gt;<a class=
"code" href="structnetsnmp__table__request__info__s.html#a585f93b117d282e0c857e7b3670f85af" title=
"contents freed by helper upon exit">indexes</a>;
<a name="l00524" id="l00524"></a>00524              tmp_idx &lt; tbl_info-&gt;number_indexes;
<a name="l00525" id="l00525"></a>00525              ++tmp_idx, vb = vb-&gt;<a class="code" href=
"structvariable__list.html#a036af3c8c73da042622a58afa452d76e" title="NULL for last variable.">next_variable</a>) {
<a name="l00526" id="l00526"></a>00526             <span class="keywordflow">if</span> (incomplete &amp;&amp; tmp_len) {
<a name="l00527" id="l00527"></a>00527                 <span class="comment">/*</span>
<a name="l00528" id="l00528"></a>00528 <span class=
"comment">                 * incomplete/illegal OID, set up dummy 0 to parse </span>
<a name="l00529" id="l00529"></a>00529 <span class="comment">                 */</span>
<a name="l00530" id="l00530"></a>00530                 DEBUGMSGTL((<span class="stringliteral">"helper:table"</span>,
<a name="l00531" id="l00531"></a>00531                             <span class=
"stringliteral">"  oid indexes not complete: "</span>));
<a name="l00532" id="l00532"></a>00532                 DEBUGMSGOID((<span class=
"stringliteral">"helper:table"</span>, var-&gt;<a class="code" href="structvariable__list.html#a7b5bdda01921550d24ea53033ce76146"
title="Object identifier of variable.">name</a>, var-&gt;<a class="code" href=
"structvariable__list.html#a089e5b1a422bf8e693510ff5408a57a7" title="number of subid&amp;#39;s in name">name_length</a>));
<a name="l00533" id="l00533"></a>00533                 DEBUGMSG((<span class="stringliteral">"helper:table"</span>, <span class=
"stringliteral">"\n"</span>));
<a name="l00534" id="l00534"></a>00534 
<a name="l00535" id="l00535"></a>00535                 <span class="comment">/*</span>
<a name="l00536" id="l00536"></a>00536 <span class=
"comment">                 * no sense in trying anymore if this is a GET/SET. </span>
<a name="l00537" id="l00537"></a>00537 <span class="comment">                 *</span>
<a name="l00538" id="l00538"></a>00538 <span class=
"comment">                 * Reject requests of the form 'myObject'   (no instance)</span>
<a name="l00539" id="l00539"></a>00539 <span class="comment">                 */</span>
<a name="l00540" id="l00540"></a>00540                 <span class="keywordflow">if</span> (reqinfo-&gt;mode != MODE_GETNEXT) {
<a name="l00541" id="l00541"></a>00541                     table_helper_cleanup(reqinfo, requests,
<a name="l00542" id="l00542"></a>00542                                          SNMP_NOSUCHINSTANCE);
<a name="l00543" id="l00543"></a>00543                     cleaned_up = 1;
<a name="l00544" id="l00544"></a>00544                 }
<a name="l00545" id="l00545"></a>00545                 tmp_len = 0;
<a name="l00546" id="l00546"></a>00546                 tmp_name = (oid *) &amp; tmp_len;
<a name="l00547" id="l00547"></a>00547                 <span class="keywordflow">break</span>;
<a name="l00548" id="l00548"></a>00548             }
<a name="l00549" id="l00549"></a>00549             <span class="comment">/*</span>
<a name="l00550" id="l00550"></a>00550 <span class="comment">             * try and parse current index </span>
<a name="l00551" id="l00551"></a>00551 <span class="comment">             */</span>
<a name="l00552" id="l00552"></a>00552             <span class=
"keywordflow">if</span> (parse_one_oid_index(&amp;tmp_name, &amp;tmp_len,
<a name="l00553" id="l00553"></a>00553                                     vb, 1) != SNMPERR_SUCCESS) {
<a name="l00554" id="l00554"></a>00554                 incomplete = 1;
<a name="l00555" id="l00555"></a>00555                 tmp_len = -1;   <span class=
"comment">/* is this necessary? Better safe than</span>
<a name="l00556" id="l00556"></a>00556 <span class="comment">                                 * sorry */</span>
<a name="l00557" id="l00557"></a>00557             } <span class="keywordflow">else</span> {
<a name="l00558" id="l00558"></a>00558                 <span class="comment">/*</span>
<a name="l00559" id="l00559"></a>00559 <span class="comment">                 * do not count incomplete indexes </span>
<a name="l00560" id="l00560"></a>00560 <span class="comment">                 */</span>
<a name="l00561" id="l00561"></a>00561                 DEBUGMSGTL((<span class=
"stringliteral">"helper:table"</span>, <span class="stringliteral">"  got 1 (incomplete=%d)\n"</span>,
<a name="l00562" id="l00562"></a>00562                             incomplete));
<a name="l00563" id="l00563"></a>00563                 <span class="keywordflow">if</span> (incomplete)
<a name="l00564" id="l00564"></a>00564                     <span class="keywordflow">continue</span>;
<a name="l00565" id="l00565"></a>00565                 ++tbl_req_info-&gt;<a class="code" href=
"structnetsnmp__table__request__info__s.html#a7a5309fb5e3d994e4ccd4986b6a90bfd" title=
"0 if failure to parse any">number_indexes</a>; 
<a name="l00566" id="l00566"></a>00566                 <span class="keywordflow">if</span> (tmp_len &lt;= 0) {
<a name="l00567" id="l00567"></a>00567                     incomplete = 1;
<a name="l00568" id="l00568"></a>00568                     tmp_len = -1;       <span class=
"comment">/* is this necessary? Better safe</span>
<a name="l00569" id="l00569"></a>00569 <span class="comment">                                         * than sorry */</span>
<a name="l00570" id="l00570"></a>00570                 }
<a name="l00571" id="l00571"></a>00571             }
<a name="l00572" id="l00572"></a>00572         }                       
<a name="l00574" id="l00574"></a>00574         DEBUGIF(<span class="stringliteral">"helper:table:results"</span>) {
<a name="l00575" id="l00575"></a>00575             DEBUGMSGTL((<span class=
"stringliteral">"helper:table:results"</span>, <span class="stringliteral">"  found %d indexes\n"</span>,
<a name="l00576" id="l00576"></a>00576                         tbl_req_info-&gt;<a class="code" href=
"structnetsnmp__table__request__info__s.html#a7a5309fb5e3d994e4ccd4986b6a90bfd" title=
"0 if failure to parse any">number_indexes</a>));
<a name="l00577" id="l00577"></a>00577             <span class="keywordflow">if</span> (!cleaned_up) {
<a name="l00578" id="l00578"></a>00578                 <span class="keywordtype">unsigned</span> <span class=
"keywordtype">int</span>    count;
<a name="l00579" id="l00579"></a>00579                 u_char         *buf = NULL;
<a name="l00580" id="l00580"></a>00580                 <span class="keywordtype">size_t</span>          buf_len = 0, out_len = 0;
<a name="l00581" id="l00581"></a>00581                 DEBUGMSGTL((<span class="stringliteral">"helper:table:results"</span>,
<a name="l00582" id="l00582"></a>00582                             <span class=
"stringliteral">"  column: %d, indexes: %d"</span>,
<a name="l00583" id="l00583"></a>00583                             tbl_req_info-&gt;<a class="code" href=
"structnetsnmp__table__request__info__s.html#afbed55ce9b6c75a98fafc84559462b34" title="0 if OID not long enough">colnum</a>,
<a name="l00584" id="l00584"></a>00584                             tbl_req_info-&gt;<a class="code" href=
"structnetsnmp__table__request__info__s.html#a7a5309fb5e3d994e4ccd4986b6a90bfd" title=
"0 if failure to parse any">number_indexes</a>));
<a name="l00585" id="l00585"></a>00585                 <span class="keywordflow">for</span> (vb = tbl_req_info-&gt;<a class=
"code" href="structnetsnmp__table__request__info__s.html#a585f93b117d282e0c857e7b3670f85af" title=
"contents freed by helper upon exit">indexes</a>, count = 0;
<a name="l00586" id="l00586"></a>00586                      vb &amp;&amp; count &lt; tbl_req_info-&gt;number_indexes;
<a name="l00587" id="l00587"></a>00587                      count++, vb = vb-&gt;<a class="code" href=
"structvariable__list.html#a036af3c8c73da042622a58afa452d76e" title="NULL for last variable.">next_variable</a>) {
<a name="l00588" id="l00588"></a>00588                     out_len = 0;
<a name="l00589" id="l00589"></a>00589                     <span class="keywordflow">if</span> (<a class="code" href=
"group__mib__utilities.html#gaabc12c361abdca75234c11dccb34871b" title=
"Universal print routine, prints a variable into a buffer according to the variable...">sprint_realloc_by_type</a>(&amp;buf, &amp;buf_len, &amp;out_len, 1,
<a name="l00590" id="l00590"></a>00590                                                vb, NULL, NULL, NULL)) {
<a name="l00591" id="l00591"></a>00591                         DEBUGMSG((<span class=
"stringliteral">"helper:table:results"</span>,
<a name="l00592" id="l00592"></a>00592                                   <span class=
"stringliteral">"   index: type=%d(%02x), value=%s"</span>,
<a name="l00593" id="l00593"></a>00593                                   vb-&gt;<a class="code" href=
"structvariable__list.html#a8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a>, vb-&gt;<a class="code"
href="structvariable__list.html#a8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a>, buf));
<a name="l00594" id="l00594"></a>00594                     } <span class="keywordflow">else</span> {
<a name="l00595" id="l00595"></a>00595                         <span class="keywordflow">if</span> (buf != NULL) {
<a name="l00596" id="l00596"></a>00596                             DEBUGMSG((<span class=
"stringliteral">"helper:table:results"</span>,
<a name="l00597" id="l00597"></a>00597                                       <span class=
"stringliteral">"   index: type=%d(%02x), value=%s [TRUNCATED]"</span>,
<a name="l00598" id="l00598"></a>00598                                       vb-&gt;<a class="code" href=
"structvariable__list.html#a8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a>, vb-&gt;<a class="code"
href="structvariable__list.html#a8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a>, buf));
<a name="l00599" id="l00599"></a>00599                         } <span class="keywordflow">else</span> {
<a name="l00600" id="l00600"></a>00600                             DEBUGMSG((<span class=
"stringliteral">"helper:table:results"</span>,
<a name="l00601" id="l00601"></a>00601                                       <span class=
"stringliteral">"   index: type=%d(%02x), value=[NIL] [TRUNCATED]"</span>,
<a name="l00602" id="l00602"></a>00602                                       vb-&gt;<a class="code" href=
"structvariable__list.html#a8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a>, vb-&gt;<a class="code"
href="structvariable__list.html#a8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a>));
<a name="l00603" id="l00603"></a>00603                         }
<a name="l00604" id="l00604"></a>00604                     }
<a name="l00605" id="l00605"></a>00605                 }
<a name="l00606" id="l00606"></a>00606                 <span class="keywordflow">if</span> (buf != NULL) {
<a name="l00607" id="l00607"></a>00607                     free(buf);
<a name="l00608" id="l00608"></a>00608                 }
<a name="l00609" id="l00609"></a>00609                 DEBUGMSG((<span class=
"stringliteral">"helper:table:results"</span>, <span class="stringliteral">"\n"</span>));
<a name="l00610" id="l00610"></a>00610             }
<a name="l00611" id="l00611"></a>00611         }
<a name="l00612" id="l00612"></a>00612 
<a name="l00613" id="l00613"></a>00613 
<a name="l00614" id="l00614"></a>00614         <span class="comment">/*</span>
<a name="l00615" id="l00615"></a>00615 <span class="comment">         * do we have sufficent index info to continue?</span>
<a name="l00616" id="l00616"></a>00616 <span class="comment">         */</span>
<a name="l00617" id="l00617"></a>00617 
<a name="l00618" id="l00618"></a>00618         <span class="keywordflow">if</span> ((reqinfo-&gt;mode != MODE_GETNEXT) &amp;&amp;
<a name="l00619" id="l00619"></a>00619             ((tbl_req_info-&gt;<a class="code" href=
"structnetsnmp__table__request__info__s.html#a7a5309fb5e3d994e4ccd4986b6a90bfd" title=
"0 if failure to parse any">number_indexes</a> != tbl_info-&gt;<a class="code" href=
"structnetsnmp__table__registration__info__s.html#a31ac0da11dbc52abe401401df065020a" title=
"calculated automatically">number_indexes</a>) ||
<a name="l00620" id="l00620"></a>00620              (tmp_len != -1))) {
<a name="l00621" id="l00621"></a>00621             DEBUGMSGTL((<span class="stringliteral">"helper:table"</span>,
<a name="l00622" id="l00622"></a>00622                         <span class=
"stringliteral">"invalid index(es) for table - skipping\n"</span>));
<a name="l00623" id="l00623"></a>00623             table_helper_cleanup(reqinfo, request, SNMP_NOSUCHINSTANCE);
<a name="l00624" id="l00624"></a>00624             <span class="keywordflow">continue</span>;
<a name="l00625" id="l00625"></a>00625         }
<a name="l00626" id="l00626"></a>00626         netsnmp_assert(request-&gt;status == SNMP_ERR_NOERROR);
<a name="l00627" id="l00627"></a>00627         
<a name="l00628" id="l00628"></a>00628         ++need_processing;
<a name="l00629" id="l00629"></a>00629 
<a name="l00630" id="l00630"></a>00630     }                           <span class="comment">/* for each request */</span>
<a name="l00631" id="l00631"></a>00631     }
<a name="l00632" id="l00632"></a>00632 
<a name="l00633" id="l00633"></a>00633     <span class="comment">/*</span>
<a name="l00634" id="l00634"></a>00634 <span class="comment">     * bail if there is nothing for our child handlers</span>
<a name="l00635" id="l00635"></a>00635 <span class="comment">     */</span>
<a name="l00636" id="l00636"></a>00636     <span class="keywordflow">if</span> (0 == need_processing)
<a name="l00637" id="l00637"></a>00637         <span class="keywordflow">return</span> status;
<a name="l00638" id="l00638"></a>00638 
<a name="l00639" id="l00639"></a>00639     <span class="comment">/*</span>
<a name="l00640" id="l00640"></a>00640 <span class="comment">     * call our child access function </span>
<a name="l00641" id="l00641"></a>00641 <span class="comment">     */</span>
<a name="l00642" id="l00642"></a>00642     status =
<a name="l00643" id="l00643"></a>00643         <a class="code" href="group__handler.html#gae45d1dbf0999b242f4f45714c7a63c1b"
title=
"calls the next handler in the chain after the current one with with appropriate NULL...">netsnmp_call_next_handler</a>(handler, reginfo, reqinfo, requests);
<a name="l00644" id="l00644"></a>00644 
<a name="l00645" id="l00645"></a>00645     <span class="comment">/*</span>
<a name="l00646" id="l00646"></a>00646 <span class="comment">     * check for sparse tables</span>
<a name="l00647" id="l00647"></a>00647 <span class="comment">     */</span>
<a name="l00648" id="l00648"></a>00648     <span class="keywordflow">if</span> (reqinfo-&gt;mode == MODE_GETNEXT)
<a name="l00649" id="l00649"></a>00649         sparse_table_helper_handler( handler, reginfo, reqinfo, requests );
<a name="l00650" id="l00650"></a>00650 
<a name="l00651" id="l00651"></a>00651     <span class="keywordflow">return</span> status;
<a name="l00652" id="l00652"></a>00652 }
<a name="l00653" id="l00653"></a>00653 
<a name="l00654" id="l00654"></a>00654 <span class="preprocessor">#define SPARSE_TABLE_HANDLER_NAME "sparse_table"</span>
<a name="l00655" id="l00655"></a>00655 
<a name="l00664" id="l00664"></a>00664 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00665" id="l00665"></a>00665 sparse_table_helper_handler(<a class="code" href="structnetsnmp__mib__handler__s.html"
title="the mib handler structure to be registered">netsnmp_mib_handler</a> *handler,
<a name="l00666" id="l00666"></a>00666                      <a class="code" href="structnetsnmp__handler__registration__s.html"
title="Root registration info.">netsnmp_handler_registration</a> *reginfo,
<a name="l00667" id="l00667"></a>00667                      <a class="code" href="structnetsnmp__agent__request__info__s.html"
title="The agent transaction request structure.">netsnmp_agent_request_info</a> *reqinfo,
<a name="l00668" id="l00668"></a>00668                      <a class="code" href="structnetsnmp__request__info__s.html" title=
"The netsnmp request info structure.">netsnmp_request_info</a> *requests)
<a name="l00669" id="l00669"></a>00669 {
<a name="l00670" id="l00670"></a>00670     <span class="keywordtype">int</span>             status = SNMP_ERR_NOERROR;
<a name="l00671" id="l00671"></a>00671     <a class="code" href="structnetsnmp__request__info__s.html" title=
"The netsnmp request info structure.">netsnmp_request_info</a> *request;
<a name="l00672" id="l00672"></a>00672     oid             coloid[MAX_OID_LEN];
<a name="l00673" id="l00673"></a>00673     <a class="code" href="structnetsnmp__table__request__info__s.html" title=
"The table request info structure.">netsnmp_table_request_info</a> *table_info;
<a name="l00674" id="l00674"></a>00674 
<a name="l00675" id="l00675"></a>00675     <span class="comment">/*</span>
<a name="l00676" id="l00676"></a>00676 <span class=
"comment">     * since we don't call child handlers, warn if one was registered</span>
<a name="l00677" id="l00677"></a>00677 <span class=
"comment">     * beneath us. A special exception for the table helper, which calls</span>
<a name="l00678" id="l00678"></a>00678 <span class=
"comment">     * the handler directly. Use handle custom flag to only log once.</span>
<a name="l00679" id="l00679"></a>00679 <span class="comment">     */</span>
<a name="l00680" id="l00680"></a>00680     <span class="keywordflow">if</span>((<a class="code" href=
"group__table.html#ga571606b4d4e705a4420ff73ce3ac6b00" title=
"implements the table helper handler">table_helper_handler</a> != handler-&gt;<a class="code" href=
"structnetsnmp__mib__handler__s.html#ae75b8ace28cb246887fa85d410fc844b" title=
"if you add more members, you probably also want to update">access_method</a>) &amp;&amp;
<a name="l00681" id="l00681"></a>00681        (NULL != handler-&gt;next)) {
<a name="l00682" id="l00682"></a>00682         <span class="comment">/*</span>
<a name="l00683" id="l00683"></a>00683 <span class=
"comment">         * always warn if called without our own handler. If we</span>
<a name="l00684" id="l00684"></a>00684 <span class=
"comment">         * have our own handler, use custom bit 1 to only log once.</span>
<a name="l00685" id="l00685"></a>00685 <span class="comment">         */</span>
<a name="l00686" id="l00686"></a>00686         <span class=
"keywordflow">if</span>((sparse_table_helper_handler != handler-&gt;<a class="code" href=
"structnetsnmp__mib__handler__s.html#ae75b8ace28cb246887fa85d410fc844b" title=
"if you add more members, you probably also want to update">access_method</a>) ||
<a name="l00687" id="l00687"></a>00687            !(handler-&gt;<a class="code" href=
"structnetsnmp__mib__handler__s.html#a320fa53cc0c6edac56c54d6dcf17dfe9" title=
"for agent_handler&amp;#39;s internal use">flags</a> &amp; MIB_HANDLER_CUSTOM1)) {
<a name="l00688" id="l00688"></a>00688             <a class="code" href=
"group__snmp__logging.html#ga9ba905368ea1c551b969af44b13e37c2" title=
"This snmp logging function allows variable argument list given the specified format...">snmp_log</a>(LOG_WARNING, <span class=
"stringliteral">"handler (%s) registered after sparse table "</span>
<a name="l00689" id="l00689"></a>00689                      <span class="stringliteral">"hander will not be called\n"</span>,
<a name="l00690" id="l00690"></a>00690                      handler-&gt;next-&gt;handler_name ?
<a name="l00691" id="l00691"></a>00691                      handler-&gt;next-&gt;handler_name : <span class=
"stringliteral">""</span> );
<a name="l00692" id="l00692"></a>00692             <span class=
"keywordflow">if</span>(sparse_table_helper_handler == handler-&gt;<a class="code" href=
"structnetsnmp__mib__handler__s.html#ae75b8ace28cb246887fa85d410fc844b" title=
"if you add more members, you probably also want to update">access_method</a>)
<a name="l00693" id="l00693"></a>00693                 handler-&gt;<a class="code" href=
"structnetsnmp__mib__handler__s.html#a320fa53cc0c6edac56c54d6dcf17dfe9" title=
"for agent_handler&amp;#39;s internal use">flags</a> |= MIB_HANDLER_CUSTOM1;
<a name="l00694" id="l00694"></a>00694         }
<a name="l00695" id="l00695"></a>00695     }
<a name="l00696" id="l00696"></a>00696 
<a name="l00697" id="l00697"></a>00697     <span class="keywordflow">if</span> (reqinfo-&gt;mode == MODE_GETNEXT) {
<a name="l00698" id="l00698"></a>00698         <span class=
"keywordflow">for</span>(request = requests ; request; request = request-&gt;next) {
<a name="l00699" id="l00699"></a>00699             <span class="keywordflow">if</span> ((request-&gt;<a class="code" href=
"structnetsnmp__request__info__s.html#a455d87f6b7178fe19ea564c60c0ccb6f" title="variable bindings">requestvb</a>-&gt;<a class=
"code" href="structvariable__list.html#a8bd719974b3554116631ea80dc88b6aa" title=
"ASN type of variable.">type</a> == ASN_NULL &amp;&amp; request-&gt;processed) ||
<a name="l00700" id="l00700"></a>00700                 request-&gt;delegated)
<a name="l00701" id="l00701"></a>00701                 <span class="keywordflow">continue</span>;
<a name="l00702" id="l00702"></a>00702             <span class="keywordflow">if</span> (request-&gt;<a class="code" href=
"structnetsnmp__request__info__s.html#a455d87f6b7178fe19ea564c60c0ccb6f" title="variable bindings">requestvb</a>-&gt;<a class=
"code" href="structvariable__list.html#a8bd719974b3554116631ea80dc88b6aa" title=
"ASN type of variable.">type</a> == SNMP_NOSUCHINSTANCE) {
<a name="l00703" id="l00703"></a>00703                 <span class="comment">/*</span>
<a name="l00704" id="l00704"></a>00704 <span class=
"comment">                 * get next skipped this value for this column, we</span>
<a name="l00705" id="l00705"></a>00705 <span class="comment">                 * need to keep searching forward </span>
<a name="l00706" id="l00706"></a>00706 <span class="comment">                 */</span>
<a name="l00707" id="l00707"></a>00707                 DEBUGMSGT((<span class="stringliteral">"sparse"</span>, <span class=
"stringliteral">"retry for NOSUCHINSTANCE\n"</span>));
<a name="l00708" id="l00708"></a>00708                 request-&gt;<a class="code" href=
"structnetsnmp__request__info__s.html#a455d87f6b7178fe19ea564c60c0ccb6f" title="variable bindings">requestvb</a>-&gt;<a class=
"code" href="structvariable__list.html#a8bd719974b3554116631ea80dc88b6aa" title=
"ASN type of variable.">type</a> = ASN_PRIV_RETRY;
<a name="l00709" id="l00709"></a>00709             }
<a name="l00710" id="l00710"></a>00710             <span class="keywordflow">if</span> (request-&gt;<a class="code" href=
"structnetsnmp__request__info__s.html#a455d87f6b7178fe19ea564c60c0ccb6f" title="variable bindings">requestvb</a>-&gt;<a class=
"code" href="structvariable__list.html#a8bd719974b3554116631ea80dc88b6aa" title=
"ASN type of variable.">type</a> == SNMP_NOSUCHOBJECT ||
<a name="l00711" id="l00711"></a>00711                 request-&gt;<a class="code" href=
"structnetsnmp__request__info__s.html#a455d87f6b7178fe19ea564c60c0ccb6f" title="variable bindings">requestvb</a>-&gt;<a class=
"code" href="structvariable__list.html#a8bd719974b3554116631ea80dc88b6aa" title=
"ASN type of variable.">type</a> == SNMP_ENDOFMIBVIEW) {
<a name="l00712" id="l00712"></a>00712                 <span class="comment">/*</span>
<a name="l00713" id="l00713"></a>00713 <span class=
"comment">                 * get next has completely finished with this column,</span>
<a name="l00714" id="l00714"></a>00714 <span class=
"comment">                 * so we need to try with the next column (if any)</span>
<a name="l00715" id="l00715"></a>00715 <span class="comment">                 */</span>
<a name="l00716" id="l00716"></a>00716                 DEBUGMSGT((<span class="stringliteral">"sparse"</span>, <span class=
"stringliteral">"retry for NOSUCHOBJECT\n"</span>));
<a name="l00717" id="l00717"></a>00717                 table_info = <a class="code" href=
"group__table.html#ga0f2aa788814b909e3e3003b63b1dbd3a" title=
"Extracts the processed table information from a given request.">netsnmp_extract_table_info</a>(request);
<a name="l00718" id="l00718"></a>00718                 table_info-&gt;<a class="code" href=
"structnetsnmp__table__request__info__s.html#afbed55ce9b6c75a98fafc84559462b34" title=
"0 if OID not long enough">colnum</a> = netsnmp_table_next_column(table_info);
<a name="l00719" id="l00719"></a>00719                 <span class="keywordflow">if</span> (0 != table_info-&gt;<a class="code"
href="structnetsnmp__table__request__info__s.html#afbed55ce9b6c75a98fafc84559462b34" title=
"0 if OID not long enough">colnum</a>) {
<a name="l00720" id="l00720"></a>00720                     memcpy(coloid, reginfo-&gt;<a class="code" href=
"structnetsnmp__handler__registration__s.html#a264722b6b9385237fbcb5f8bc144d470" title="where are we registered at?">rootoid</a>,
<a name="l00721" id="l00721"></a>00721                            reginfo-&gt;rootoid_len * <span class=
"keyword">sizeof</span>(oid));
<a name="l00722" id="l00722"></a>00722                     coloid[reginfo-&gt;rootoid_len]   = 1;   <span class=
"comment">/* table.entry node */</span>
<a name="l00723" id="l00723"></a>00723                     coloid[reginfo-&gt;rootoid_len+1] = table_info-&gt;<a class="code"
href="structnetsnmp__table__request__info__s.html#afbed55ce9b6c75a98fafc84559462b34" title="0 if OID not long enough">colnum</a>;
<a name="l00724" id="l00724"></a>00724                     snmp_set_var_objid(request-&gt;<a class="code" href=
"structnetsnmp__request__info__s.html#a455d87f6b7178fe19ea564c60c0ccb6f" title="variable bindings">requestvb</a>,
<a name="l00725" id="l00725"></a>00725                                        coloid, reginfo-&gt;rootoid_len + 2);
<a name="l00726" id="l00726"></a>00726                     
<a name="l00727" id="l00727"></a>00727                     request-&gt;<a class="code" href=
"structnetsnmp__request__info__s.html#a455d87f6b7178fe19ea564c60c0ccb6f" title="variable bindings">requestvb</a>-&gt;<a class=
"code" href="structvariable__list.html#a8bd719974b3554116631ea80dc88b6aa" title=
"ASN type of variable.">type</a> = ASN_PRIV_RETRY;
<a name="l00728" id="l00728"></a>00728                 }
<a name="l00729" id="l00729"></a>00729                 <span class="keywordflow">else</span> {
<a name="l00730" id="l00730"></a>00730                     <span class="comment">/*</span>
<a name="l00731" id="l00731"></a>00731 <span class=
"comment">                     * If we don't have column info, reset to null so</span>
<a name="l00732" id="l00732"></a>00732 <span class=
"comment">                     * the agent will move on to the next table.</span>
<a name="l00733" id="l00733"></a>00733 <span class="comment">                     */</span>
<a name="l00734" id="l00734"></a>00734                     request-&gt;<a class="code" href=
"structnetsnmp__request__info__s.html#a455d87f6b7178fe19ea564c60c0ccb6f" title="variable bindings">requestvb</a>-&gt;<a class=
"code" href="structvariable__list.html#a8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a> = ASN_NULL;
<a name="l00735" id="l00735"></a>00735                 }
<a name="l00736" id="l00736"></a>00736             }
<a name="l00737" id="l00737"></a>00737         }
<a name="l00738" id="l00738"></a>00738     }
<a name="l00739" id="l00739"></a>00739     <span class="keywordflow">return</span> status;
<a name="l00740" id="l00740"></a>00740 }
<a name="l00741" id="l00741"></a>00741 
<a name="l00744" id="l00744"></a>00744 <a class="code" href="structnetsnmp__mib__handler__s.html" title=
"the mib handler structure to be registered">netsnmp_mib_handler</a> *
<a name="l00745" id="l00745"></a><a class="code" href="group__table.html#ga2ea65cc682cad5695f16c6eabef4489b">00745</a> <a class=
"code" href="group__table.html#ga2ea65cc682cad5695f16c6eabef4489b" title=
"create sparse table handler">netsnmp_sparse_table_handler_get</a>(<span class="keywordtype">void</span>)
<a name="l00746" id="l00746"></a>00746 {
<a name="l00747" id="l00747"></a>00747     <span class="keywordflow">return</span> <a class="code" href=
"group__handler.html#ga169c1653d481ed3d7df0c1795d99ca0c" title=
"creates a netsnmp_mib_handler structure given a name and a access method.">netsnmp_create_handler</a>(SPARSE_TABLE_HANDLER_NAME,
<a name="l00748" id="l00748"></a>00748                                   sparse_table_helper_handler);
<a name="l00749" id="l00749"></a>00749 }
<a name="l00750" id="l00750"></a>00750 
<a name="l00755" id="l00755"></a>00755 <span class="keywordtype">int</span>
<a name="l00756" id="l00756"></a><a class="code" href="group__table.html#ga82f2d76b366b08edb76e93ddba44849d">00756</a> <a class=
"code" href="group__table.html#ga82f2d76b366b08edb76e93ddba44849d" title=
"creates a table handler given the netsnmp_table_registration_info object, inserts...">netsnmp_sparse_table_register</a>(<a class="code"
href="structnetsnmp__handler__registration__s.html" title="Root registration info.">netsnmp_handler_registration</a> *reginfo,
<a name="l00757" id="l00757"></a>00757                        <a class="code" href=
"structnetsnmp__table__registration__info__s.html" title=
"Table registration structure.">netsnmp_table_registration_info</a> *tabreq)
<a name="l00758" id="l00758"></a>00758 {
<a name="l00759" id="l00759"></a>00759     <a class="code" href="structnetsnmp__mib__handler__s.html" title=
"the mib handler structure to be registered">netsnmp_mib_handler</a> *handler1, *handler2;
<a name="l00760" id="l00760"></a>00760     <span class="keywordtype">int</span> rc;
<a name="l00761" id="l00761"></a>00761 
<a name="l00762" id="l00762"></a>00762     handler1 = <a class="code" href=
"group__handler.html#ga169c1653d481ed3d7df0c1795d99ca0c" title=
"creates a netsnmp_mib_handler structure given a name and a access method.">netsnmp_create_handler</a>(SPARSE_TABLE_HANDLER_NAME,
<a name="l00763" id="l00763"></a>00763                                      sparse_table_helper_handler);
<a name="l00764" id="l00764"></a>00764     <span class="keywordflow">if</span> (NULL == handler1)
<a name="l00765" id="l00765"></a>00765         <span class="keywordflow">return</span> SNMP_ERR_GENERR;
<a name="l00766" id="l00766"></a>00766 
<a name="l00767" id="l00767"></a>00767     handler2 = <a class="code" href="group__table.html#gad675c0b9450afaf9f67d93e738319cf3"
title="Given a netsnmp_table_registration_info object, creates a table handler.">netsnmp_get_table_handler</a>(tabreq);
<a name="l00768" id="l00768"></a>00768     <span class="keywordflow">if</span> (NULL == handler2 ) {
<a name="l00769" id="l00769"></a>00769         <a class="code" href="group__handler.html#gac0eb7f89dee961df2d09084fd7925952"
title="free&amp;#39;s the resourceses associated with a given handler">netsnmp_handler_free</a>(handler1);
<a name="l00770" id="l00770"></a>00770         <span class="keywordflow">return</span> SNMP_ERR_GENERR;
<a name="l00771" id="l00771"></a>00771     }
<a name="l00772" id="l00772"></a>00772 
<a name="l00773" id="l00773"></a>00773     rc = <a class="code" href="group__handler.html#ga6649d75b3eaf98d70704754d3d8235f3"
title=
"inject a new handler into the calling chain of the handlers definedy by the netsnmp_handler_registra...">netsnmp_inject_handler</a>(reginfo, handler1);
<a name="l00774" id="l00774"></a>00774     <span class="keywordflow">if</span> (SNMPERR_SUCCESS != rc) {
<a name="l00775" id="l00775"></a>00775         <a class="code" href="group__handler.html#gac0eb7f89dee961df2d09084fd7925952"
title="free&amp;#39;s the resourceses associated with a given handler">netsnmp_handler_free</a>(handler1);
<a name="l00776" id="l00776"></a>00776         <a class="code" href="group__handler.html#gac0eb7f89dee961df2d09084fd7925952"
title="free&amp;#39;s the resourceses associated with a given handler">netsnmp_handler_free</a>(handler2);
<a name="l00777" id="l00777"></a>00777         <span class="keywordflow">return</span> rc;
<a name="l00778" id="l00778"></a>00778     }
<a name="l00779" id="l00779"></a>00779 
<a name="l00780" id="l00780"></a>00780     rc = <a class="code" href="group__handler.html#ga6649d75b3eaf98d70704754d3d8235f3"
title=
"inject a new handler into the calling chain of the handlers definedy by the netsnmp_handler_registra...">netsnmp_inject_handler</a>(reginfo, handler2);
<a name="l00781" id="l00781"></a>00781     <span class="keywordflow">if</span> (SNMPERR_SUCCESS != rc) {
<a name="l00783" id="l00783"></a>00783         <a class="code" href="group__handler.html#gac0eb7f89dee961df2d09084fd7925952"
title="free&amp;#39;s the resourceses associated with a given handler">netsnmp_handler_free</a>(handler2);
<a name="l00784" id="l00784"></a>00784         <span class="keywordflow">return</span> rc;
<a name="l00785" id="l00785"></a>00785     }
<a name="l00786" id="l00786"></a>00786 
<a name="l00788" id="l00788"></a>00788     <span class="keywordflow">return</span> <a class="code" href=
"group__handler.html#gacdbdb9d74898a5bf04b0992ea0316aa4" title=
"register a handler, as defined by the netsnmp_handler_registration pointer.">netsnmp_register_handler</a>(reginfo);
<a name="l00789" id="l00789"></a>00789 }
<a name="l00790" id="l00790"></a>00790 
<a name="l00791" id="l00791"></a>00791 
<a name="l00798" id="l00798"></a>00798 <span class="keywordtype">int</span>
<a name="l00799" id="l00799"></a><a class="code" href="group__table.html#ga841d2e015ff873f9e0110309f316c5f4">00799</a> <a class=
"code" href="group__table.html#ga841d2e015ff873f9e0110309f316c5f4" title=
"Builds the result to be returned to the agent given the table information.">netsnmp_table_build_result</a>(<a class="code" href=
"structnetsnmp__handler__registration__s.html" title="Root registration info.">netsnmp_handler_registration</a> *reginfo,
<a name="l00800" id="l00800"></a>00800                            <a class="code" href="structnetsnmp__request__info__s.html"
title="The netsnmp request info structure.">netsnmp_request_info</a> *reqinfo,
<a name="l00801" id="l00801"></a>00801                            <a class="code" href=
"structnetsnmp__table__request__info__s.html" title=
"The table request info structure.">netsnmp_table_request_info</a> *table_info,
<a name="l00802" id="l00802"></a>00802                            u_char type, u_char * result, <span class=
"keywordtype">size_t</span> result_len)
<a name="l00803" id="l00803"></a>00803 {
<a name="l00804" id="l00804"></a>00804 
<a name="l00805" id="l00805"></a>00805     <a class="code" href="structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> *var;
<a name="l00806" id="l00806"></a>00806 
<a name="l00807" id="l00807"></a>00807     <span class="keywordflow">if</span> (!reqinfo || !table_info)
<a name="l00808" id="l00808"></a>00808         <span class="keywordflow">return</span> SNMPERR_GENERR;
<a name="l00809" id="l00809"></a>00809 
<a name="l00810" id="l00810"></a>00810     var = reqinfo-&gt;<a class="code" href=
"structnetsnmp__request__info__s.html#a455d87f6b7178fe19ea564c60c0ccb6f" title="variable bindings">requestvb</a>;
<a name="l00811" id="l00811"></a>00811 
<a name="l00812" id="l00812"></a>00812     <span class="keywordflow">if</span> (var-&gt;<a class="code" href=
"structvariable__list.html#a7b5bdda01921550d24ea53033ce76146" title=
"Object identifier of variable.">name</a> != var-&gt;<a class="code" href=
"structvariable__list.html#a5b8071f7514fb530c9b596791bca6813" title="90 percentile &amp;lt; 24.">name_loc</a>)
<a name="l00813" id="l00813"></a>00813         free(var-&gt;<a class="code" href=
"structvariable__list.html#a7b5bdda01921550d24ea53033ce76146" title="Object identifier of variable.">name</a>);
<a name="l00814" id="l00814"></a>00814     var-&gt;<a class="code" href=
"structvariable__list.html#a7b5bdda01921550d24ea53033ce76146" title="Object identifier of variable.">name</a> = NULL;
<a name="l00815" id="l00815"></a>00815 
<a name="l00816" id="l00816"></a>00816     <span class="keywordflow">if</span> (<a class="code" href=
"group__table.html#ga872f2b0efe5bd631441de780ecdb6e34" title=
"given a registration info object, a request object and the table info object it builds...">netsnmp_table_build_oid</a>(reginfo, reqinfo, table_info) !=
<a name="l00817" id="l00817"></a>00817         SNMPERR_SUCCESS)
<a name="l00818" id="l00818"></a>00818         <span class="keywordflow">return</span> SNMPERR_GENERR;
<a name="l00819" id="l00819"></a>00819 
<a name="l00820" id="l00820"></a>00820     <a class="code" href="group__snmp__client.html#gae3f88533cfdd61ec2b603963ef8a3394"
title=
"snmp_set_var_typed_value is used to set data into the netsnmp_variable_list structure...">snmp_set_var_typed_value</a>(var, type, result, result_len);
<a name="l00821" id="l00821"></a>00821 
<a name="l00822" id="l00822"></a>00822     <span class="keywordflow">return</span> SNMPERR_SUCCESS;
<a name="l00823" id="l00823"></a>00823 }
<a name="l00824" id="l00824"></a>00824 
<a name="l00825" id="l00825"></a>00825 
<a name="l00831" id="l00831"></a>00831 <span class="keywordtype">int</span>
<a name="l00832" id="l00832"></a><a class="code" href="group__table.html#ga872f2b0efe5bd631441de780ecdb6e34">00832</a> <a class=
"code" href="group__table.html#ga872f2b0efe5bd631441de780ecdb6e34" title=
"given a registration info object, a request object and the table info object it builds...">netsnmp_table_build_oid</a>(<a class=
"code" href="structnetsnmp__handler__registration__s.html" title=
"Root registration info.">netsnmp_handler_registration</a> *reginfo,
<a name="l00833" id="l00833"></a>00833                         <a class="code" href="structnetsnmp__request__info__s.html" title=
"The netsnmp request info structure.">netsnmp_request_info</a> *reqinfo,
<a name="l00834" id="l00834"></a>00834                         <a class="code" href="structnetsnmp__table__request__info__s.html"
title="The table request info structure.">netsnmp_table_request_info</a> *table_info)
<a name="l00835" id="l00835"></a>00835 {
<a name="l00836" id="l00836"></a>00836     oid             tmpoid[MAX_OID_LEN];
<a name="l00837" id="l00837"></a>00837     <a class="code" href="structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> *var;
<a name="l00838" id="l00838"></a>00838 
<a name="l00839" id="l00839"></a>00839     <span class="keywordflow">if</span> (!reginfo || !reqinfo || !table_info)
<a name="l00840" id="l00840"></a>00840         <span class="keywordflow">return</span> SNMPERR_GENERR;
<a name="l00841" id="l00841"></a>00841 
<a name="l00842" id="l00842"></a>00842     <span class="comment">/*</span>
<a name="l00843" id="l00843"></a>00843 <span class=
"comment">     * xxx-rks: inefficent. we do a copy here, then build_oid does it</span>
<a name="l00844" id="l00844"></a>00844 <span class=
"comment">     *          again. either come up with a new utility routine, or</span>
<a name="l00845" id="l00845"></a>00845 <span class="comment">     *          do some hijinks here to eliminate extra copy.</span>
<a name="l00846" id="l00846"></a>00846 <span class="comment">     *          Probably could make sure all callers have the</span>
<a name="l00847" id="l00847"></a>00847 <span class="comment">     *          index &amp; variable list updated, and use</span>
<a name="l00848" id="l00848"></a>00848 <span class=
"comment">     *          netsnmp_table_build_oid_from_index() instead of all this.</span>
<a name="l00849" id="l00849"></a>00849 <span class="comment">     */</span>
<a name="l00850" id="l00850"></a>00850     memcpy(tmpoid, reginfo-&gt;<a class="code" href=
"structnetsnmp__handler__registration__s.html#a264722b6b9385237fbcb5f8bc144d470" title=
"where are we registered at?">rootoid</a>, reginfo-&gt;rootoid_len * <span class="keyword">sizeof</span>(oid));
<a name="l00851" id="l00851"></a>00851     tmpoid[reginfo-&gt;rootoid_len] = 1;   
<a name="l00852" id="l00852"></a>00852     tmpoid[reginfo-&gt;rootoid_len + 1] = table_info-&gt;<a class="code" href=
"structnetsnmp__table__request__info__s.html#afbed55ce9b6c75a98fafc84559462b34" title="0 if OID not long enough">colnum</a>; 
<a name="l00854" id="l00854"></a>00854     var = reqinfo-&gt;<a class="code" href=
"structnetsnmp__request__info__s.html#a455d87f6b7178fe19ea564c60c0ccb6f" title="variable bindings">requestvb</a>;
<a name="l00855" id="l00855"></a>00855     <span class="keywordflow">if</span> (<a class="code" href=
"group__mib__utilities.html#ga438e30e7500b071916fec5592384f956">build_oid</a>(&amp;var-&gt;<a class="code" href=
"structvariable__list.html#a7b5bdda01921550d24ea53033ce76146" title=
"Object identifier of variable.">name</a>, &amp;var-&gt;<a class="code" href=
"structvariable__list.html#a089e5b1a422bf8e693510ff5408a57a7" title="number of subid&amp;#39;s in name">name_length</a>,
<a name="l00856" id="l00856"></a>00856                   tmpoid, reginfo-&gt;rootoid_len + 2, table_info-&gt;<a class="code"
href="structnetsnmp__table__request__info__s.html#a585f93b117d282e0c857e7b3670f85af" title=
"contents freed by helper upon exit">indexes</a>)
<a name="l00857" id="l00857"></a>00857         != SNMPERR_SUCCESS)
<a name="l00858" id="l00858"></a>00858         <span class="keywordflow">return</span> SNMPERR_GENERR;
<a name="l00859" id="l00859"></a>00859 
<a name="l00860" id="l00860"></a>00860     <span class="keywordflow">return</span> SNMPERR_SUCCESS;
<a name="l00861" id="l00861"></a>00861 }
<a name="l00862" id="l00862"></a>00862 
<a name="l00868" id="l00868"></a>00868 <span class="keywordtype">int</span>
<a name="l00869" id="l00869"></a><a class="code" href="group__table.html#ga7450b303b9bdbbc05bfdac6a6f2aba61">00869</a> <a class=
"code" href="group__table.html#ga7450b303b9bdbbc05bfdac6a6f2aba61" title=
"given a registration info object, a request object and the table info object it builds...">netsnmp_table_build_oid_from_index</a>(<a class="code"
href="structnetsnmp__handler__registration__s.html" title="Root registration info.">netsnmp_handler_registration</a> *reginfo,
<a name="l00870" id="l00870"></a>00870                                    <a class="code" href=
"structnetsnmp__request__info__s.html" title="The netsnmp request info structure.">netsnmp_request_info</a> *reqinfo,
<a name="l00871" id="l00871"></a>00871                                    <a class="code" href=
"structnetsnmp__table__request__info__s.html" title=
"The table request info structure.">netsnmp_table_request_info</a> *table_info)
<a name="l00872" id="l00872"></a>00872 {
<a name="l00873" id="l00873"></a>00873     oid             tmpoid[MAX_OID_LEN];
<a name="l00874" id="l00874"></a>00874     <a class="code" href="structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> *var;
<a name="l00875" id="l00875"></a>00875     <span class="keywordtype">int</span>             len;
<a name="l00876" id="l00876"></a>00876 
<a name="l00877" id="l00877"></a>00877     <span class="keywordflow">if</span> (!reginfo || !reqinfo || !table_info)
<a name="l00878" id="l00878"></a>00878         <span class="keywordflow">return</span> SNMPERR_GENERR;
<a name="l00879" id="l00879"></a>00879 
<a name="l00880" id="l00880"></a>00880     var = reqinfo-&gt;<a class="code" href=
"structnetsnmp__request__info__s.html#a455d87f6b7178fe19ea564c60c0ccb6f" title="variable bindings">requestvb</a>;
<a name="l00881" id="l00881"></a>00881     len = reginfo-&gt;rootoid_len;
<a name="l00882" id="l00882"></a>00882     memcpy(tmpoid, reginfo-&gt;<a class="code" href=
"structnetsnmp__handler__registration__s.html#a264722b6b9385237fbcb5f8bc144d470" title=
"where are we registered at?">rootoid</a>, len * <span class="keyword">sizeof</span>(oid));
<a name="l00883" id="l00883"></a>00883     tmpoid[len++] = 1;          <span class="comment">/* .Entry */</span>
<a name="l00884" id="l00884"></a>00884     tmpoid[len++] = table_info-&gt;<a class="code" href=
"structnetsnmp__table__request__info__s.html#afbed55ce9b6c75a98fafc84559462b34" title=
"0 if OID not long enough">colnum</a>; <span class="comment">/* .column */</span>
<a name="l00885" id="l00885"></a>00885     memcpy(&amp;tmpoid[len], table_info-&gt;index_oid,
<a name="l00886" id="l00886"></a>00886            table_info-&gt;index_oid_len * <span class="keyword">sizeof</span>(oid));
<a name="l00887" id="l00887"></a>00887     len += table_info-&gt;index_oid_len;
<a name="l00888" id="l00888"></a>00888     <span class="keywordflow">if</span> (var-&gt;<a class="code" href=
"structvariable__list.html#a7b5bdda01921550d24ea53033ce76146" title=
"Object identifier of variable.">name</a> &amp;&amp; var-&gt;<a class="code" href=
"structvariable__list.html#a7b5bdda01921550d24ea53033ce76146" title=
"Object identifier of variable.">name</a> != var-&gt;<a class="code" href=
"structvariable__list.html#a5b8071f7514fb530c9b596791bca6813" title="90 percentile &amp;lt; 24.">name_loc</a>)
<a name="l00889" id="l00889"></a>00889         <a class="code" href="group__util.html#ga951e93edb6f0ea941e26155e3f8912a6" title=
"Frees a pointer only if it is !NULL and sets its value to NULL.">SNMP_FREE</a>(var-&gt;<a class="code" href=
"structvariable__list.html#a7b5bdda01921550d24ea53033ce76146" title="Object identifier of variable.">name</a>);
<a name="l00890" id="l00890"></a>00890     snmp_clone_mem((<span class="keywordtype">void</span> **) &amp;var-&gt;<a class="code"
href="structvariable__list.html#a7b5bdda01921550d24ea53033ce76146" title=
"Object identifier of variable.">name</a>, tmpoid, len * <span class="keyword">sizeof</span>(oid));
<a name="l00891" id="l00891"></a>00891     var-&gt;<a class="code" href=
"structvariable__list.html#a089e5b1a422bf8e693510ff5408a57a7" title="number of subid&amp;#39;s in name">name_length</a> = len;
<a name="l00892" id="l00892"></a>00892 
<a name="l00893" id="l00893"></a>00893     <span class="keywordflow">return</span> SNMPERR_SUCCESS;
<a name="l00894" id="l00894"></a>00894 }
<a name="l00895" id="l00895"></a>00895 
<a name="l00897" id="l00897"></a>00897 <span class="keywordtype">int</span>
<a name="l00898" id="l00898"></a><a class="code" href="group__table.html#ga6df6b6d782cc85a5b980acb2c4197725">00898</a> <a class=
"code" href="group__table.html#ga6df6b6d782cc85a5b980acb2c4197725" title=
"parses an OID into table indexses">netsnmp_update_variable_list_from_index</a>(<a class="code" href=
"structnetsnmp__table__request__info__s.html" title="The table request info structure.">netsnmp_table_request_info</a> *tri)
<a name="l00899" id="l00899"></a>00899 {
<a name="l00900" id="l00900"></a>00900     <span class="keywordflow">if</span> (!tri)
<a name="l00901" id="l00901"></a>00901         <span class="keywordflow">return</span> SNMPERR_GENERR;
<a name="l00902" id="l00902"></a>00902 
<a name="l00903" id="l00903"></a>00903     <span class="comment">/*</span>
<a name="l00904" id="l00904"></a>00904 <span class=
"comment">     * free any existing allocated memory, then parse oid into varbinds</span>
<a name="l00905" id="l00905"></a>00905 <span class="comment">     */</span>
<a name="l00906" id="l00906"></a>00906     snmp_reset_var_buffers( tri-&gt;<a class="code" href=
"structnetsnmp__table__request__info__s.html#a585f93b117d282e0c857e7b3670f85af" title=
"contents freed by helper upon exit">indexes</a>);
<a name="l00907" id="l00907"></a>00907 
<a name="l00908" id="l00908"></a>00908     <span class=
"keywordflow">return</span> parse_oid_indexes(tri-&gt;index_oid, tri-&gt;index_oid_len,
<a name="l00909" id="l00909"></a>00909                              tri-&gt;<a class="code" href=
"structnetsnmp__table__request__info__s.html#a585f93b117d282e0c857e7b3670f85af" title=
"contents freed by helper upon exit">indexes</a>);
<a name="l00910" id="l00910"></a>00910 }
<a name="l00911" id="l00911"></a>00911 
<a name="l00913" id="l00913"></a>00913 <span class="keywordtype">int</span>
<a name="l00914" id="l00914"></a><a class="code" href="group__table.html#gaa41463715fe95923d767ae7472e547c3">00914</a> <a class=
"code" href="group__table.html#gaa41463715fe95923d767ae7472e547c3" title=
"builds an oid given a set of indexes.">netsnmp_update_indexes_from_variable_list</a>(<a class="code" href=
"structnetsnmp__table__request__info__s.html" title="The table request info structure.">netsnmp_table_request_info</a> *tri)
<a name="l00915" id="l00915"></a>00915 {
<a name="l00916" id="l00916"></a>00916     <span class="keywordflow">if</span> (!tri)
<a name="l00917" id="l00917"></a>00917         <span class="keywordflow">return</span> SNMPERR_GENERR;
<a name="l00918" id="l00918"></a>00918 
<a name="l00919" id="l00919"></a>00919     <span class=
"keywordflow">return</span> build_oid_noalloc(tri-&gt;index_oid, <span class="keyword">sizeof</span>(tri-&gt;index_oid),
<a name="l00920" id="l00920"></a>00920                              &amp;tri-&gt;index_oid_len, NULL, 0, tri-&gt;<a class="code"
href="structnetsnmp__table__request__info__s.html#a585f93b117d282e0c857e7b3670f85af" title=
"contents freed by helper upon exit">indexes</a>);
<a name="l00921" id="l00921"></a>00921 }
<a name="l00922" id="l00922"></a>00922 
<a name="l00931" id="l00931"></a>00931 <span class="keywordtype">int</span>
<a name="l00932" id="l00932"></a><a class="code" href="group__table.html#gaa28a07930d1248645af1f2e9fbf337e7">00932</a> <a class=
"code" href="group__table.html#gaa28a07930d1248645af1f2e9fbf337e7" title=
"checks the original request against the current data being passed in if its greater...">netsnmp_check_getnext_reply</a>(<a class="code"
href="structnetsnmp__request__info__s.html" title="The netsnmp request info structure.">netsnmp_request_info</a> *request,
<a name="l00933" id="l00933"></a>00933                             oid * prefix,
<a name="l00934" id="l00934"></a>00934                             <span class="keywordtype">size_t</span> prefix_len,
<a name="l00935" id="l00935"></a>00935                             <a class="code" href="structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> * newvar,
<a name="l00936" id="l00936"></a>00936                             <a class="code" href="structvariable__list.html" title=
"The netsnmp variable list binding structure, it&amp;#39;s typedef&amp;#39;d to netsnmp_variable_list...">netsnmp_variable_list</a> ** outvar)
<a name="l00937" id="l00937"></a>00937 {
<a name="l00938" id="l00938"></a>00938     oid      myname[MAX_OID_LEN];
<a name="l00939" id="l00939"></a>00939     <span class="keywordtype">size_t</span>   myname_len;
<a name="l00940" id="l00940"></a>00940 
<a name="l00941" id="l00941"></a>00941     build_oid_noalloc(myname, MAX_OID_LEN, &amp;myname_len,
<a name="l00942" id="l00942"></a>00942                       prefix, prefix_len, newvar);
<a name="l00943" id="l00943"></a>00943     <span class="comment">/*</span>
<a name="l00944" id="l00944"></a>00944 <span class=
"comment">     * is the build of the new indexes less than our current result </span>
<a name="l00945" id="l00945"></a>00945 <span class="comment">     */</span>
<a name="l00946" id="l00946"></a>00946     <span class="keywordflow">if</span> ((!(*outvar) || <a class="code" href=
"group__library.html#gab5b48a42c19a801547e025ed40b4561e" title=
"lexicographical compare two object identifiers.">snmp_oid_compare</a>(myname + prefix_len,
<a name="l00947" id="l00947"></a>00947                                         myname_len - prefix_len,
<a name="l00948" id="l00948"></a>00948                                         (*outvar)-&gt;name + prefix_len,
<a name="l00949" id="l00949"></a>00949                                         (*outvar)-&gt;name_length -
<a name="l00950" id="l00950"></a>00950                                         prefix_len) &lt; 0)) {
<a name="l00951" id="l00951"></a>00951         <span class="comment">/*</span>
<a name="l00952" id="l00952"></a>00952 <span class="comment">         * and greater than the requested oid </span>
<a name="l00953" id="l00953"></a>00953 <span class="comment">         */</span>
<a name="l00954" id="l00954"></a>00954         <span class="keywordflow">if</span> (<a class="code" href=
"group__library.html#gab5b48a42c19a801547e025ed40b4561e" title=
"lexicographical compare two object identifiers.">snmp_oid_compare</a>(myname, myname_len,
<a name="l00955" id="l00955"></a>00955                              request-&gt;<a class="code" href=
"structnetsnmp__request__info__s.html#a455d87f6b7178fe19ea564c60c0ccb6f" title="variable bindings">requestvb</a>-&gt;<a class=
"code" href="structvariable__list.html#a7b5bdda01921550d24ea53033ce76146" title="Object identifier of variable.">name</a>,
<a name="l00956" id="l00956"></a>00956                              request-&gt;<a class="code" href=
"structnetsnmp__request__info__s.html#a455d87f6b7178fe19ea564c60c0ccb6f" title="variable bindings">requestvb</a>-&gt;<a class=
"code" href="structvariable__list.html#a089e5b1a422bf8e693510ff5408a57a7" title=
"number of subid&amp;#39;s in name">name_length</a>) &gt; 0) {
<a name="l00957" id="l00957"></a>00957             <span class="comment">/*</span>
<a name="l00958" id="l00958"></a>00958 <span class="comment">             * the new result must be better than the old </span>
<a name="l00959" id="l00959"></a>00959 <span class="comment">             */</span>
<a name="l00960" id="l00960"></a>00960 <span class="preprocessor">#ifdef ONLY_WORKS_WITH_ONE_VARBIND</span>
<a name="l00961" id="l00961"></a>00961             <span class="keywordflow">if</span> (!*outvar)
<a name="l00962" id="l00962"></a>00962                 *outvar = snmp_clone_varbind(newvar);
<a name="l00963" id="l00963"></a>00963             <span class="keywordflow">else</span>
<a name="l00964" id="l00964"></a>00964                 <span class="comment">/* </span>
<a name="l00965" id="l00965"></a>00965 <span class="comment">                 * TODO: walk the full varbind list, setting</span>
<a name="l00966" id="l00966"></a>00966 <span class=
"comment">                 *       *all* the values - not just the first.</span>
<a name="l00967" id="l00967"></a>00967 <span class="comment">                 */</span>
<a name="l00968" id="l00968"></a>00968                 <a class="code" href=
"group__snmp__client.html#gae3f88533cfdd61ec2b603963ef8a3394" title=
"snmp_set_var_typed_value is used to set data into the netsnmp_variable_list structure...">snmp_set_var_typed_value</a>(*outvar, newvar-&gt;<a class="code"
href="structvariable__list.html#a8bd719974b3554116631ea80dc88b6aa" title="ASN type of variable.">type</a>,
<a name="l00969" id="l00969"></a>00969                                 newvar-&gt;<a class="code" href=
"structvariable__list.html#a6ed7c00d712b83c174823b1cff6e9e29" title="value of variable">val</a>.string, newvar-&gt;<a class=
"code" href="structvariable__list.html#a17aaa6b445178fc39aba69642247d3e9" title=
"the length of the value to be copied into buf">val_len</a>);
<a name="l00970" id="l00970"></a>00970 <span class="preprocessor">#else  </span><span class=
"comment">/* Interim replacement approach - less efficient, but it works! */</span>
<a name="l00971" id="l00971"></a>00971             <span class="keywordflow">if</span> (*outvar)
<a name="l00972" id="l00972"></a>00972                 snmp_free_varbind(*outvar);
<a name="l00973" id="l00973"></a>00973             *outvar = snmp_clone_varbind(newvar);
<a name="l00974" id="l00974"></a>00974 <span class="preprocessor">#endif</span>
<a name="l00975" id="l00975"></a>00975             snmp_set_var_objid(*outvar, myname, myname_len);
<a name="l00976" id="l00976"></a>00976 
<a name="l00977" id="l00977"></a>00977             <span class="keywordflow">return</span> 1;
<a name="l00978" id="l00978"></a>00978         }
<a name="l00979" id="l00979"></a>00979     }
<a name="l00980" id="l00980"></a>00980     <span class="keywordflow">return</span> 0;
<a name="l00981" id="l00981"></a>00981 }
<a name="l00982" id="l00982"></a>00982 
<a name="l00983" id="l00983"></a>00983 <span class="keywordtype">void</span>
<a name="l00984" id="l00984"></a>00984 netsnmp_table_registration_info_free(<a class="code" href=
"structnetsnmp__table__registration__info__s.html" title=
"Table registration structure.">netsnmp_table_registration_info</a> *tri)
<a name="l00985" id="l00985"></a>00985 {
<a name="l00986" id="l00986"></a>00986     <span class="keywordflow">if</span> (NULL == tri)
<a name="l00987" id="l00987"></a>00987         <span class="keywordflow">return</span>;
<a name="l00988" id="l00988"></a>00988 
<a name="l00989" id="l00989"></a>00989     <span class="keywordflow">if</span> (NULL != tri-&gt;<a class="code" href=
"structnetsnmp__table__registration__info__s.html#a3045fe8e402e974d840af4084b88dc2a" title=
"list of varbinds with only &amp;#39;type&amp;#39; set">indexes</a>)
<a name="l00990" id="l00990"></a>00990         snmp_free_varbind(tri-&gt;<a class="code" href=
"structnetsnmp__table__registration__info__s.html#a3045fe8e402e974d840af4084b88dc2a" title=
"list of varbinds with only &amp;#39;type&amp;#39; set">indexes</a>);
<a name="l00991" id="l00991"></a>00991 
<a name="l00992" id="l00992"></a>00992 <span class="preprocessor">#if 0</span>
<a name="l00993" id="l00993"></a>00993     <span class="comment">/*</span>
<a name="l00994" id="l00994"></a>00994 <span class=
"comment">     * sigh... example use of valid_columns points to static memory,</span>
<a name="l00995" id="l00995"></a>00995 <span class=
"comment">     * so freeing it would be bad... we'll just have to live with any</span>
<a name="l00996" id="l00996"></a>00996 <span class="comment">     * leaks, for now...</span>
<a name="l00997" id="l00997"></a>00997 <span class="comment">     */</span>
<a name="l00998" id="l00998"></a>00998 <span class="preprocessor">#endif</span>
<a name="l00999" id="l00999"></a>00999 
<a name="l01000" id="l01000"></a>01000     free(tri);
<a name="l01001" id="l01001"></a>01001 }
<a name="l01002" id="l01002"></a>01002 
<a name="l01005" id="l01005"></a>01005 <span class="comment">/*</span>
<a name="l01006" id="l01006"></a>01006 <span class="comment"> * internal routines </span>
<a name="l01007" id="l01007"></a>01007 <span class="comment"> */</span>
<a name="l01008" id="l01008"></a>01008 <span class="keywordtype">void</span>
<a name="l01009" id="l01009"></a>01009 table_data_free_func(<span class="keywordtype">void</span> *data)
<a name="l01010" id="l01010"></a>01010 {
<a name="l01011" id="l01011"></a>01011     <a class="code" href="structnetsnmp__table__request__info__s.html" title=
"The table request info structure.">netsnmp_table_request_info</a> *info = (<a class="code" href=
"structnetsnmp__table__request__info__s.html" title="The table request info structure.">netsnmp_table_request_info</a> *) data;
<a name="l01012" id="l01012"></a>01012     <span class="keywordflow">if</span> (!info)
<a name="l01013" id="l01013"></a>01013         <span class="keywordflow">return</span>;
<a name="l01014" id="l01014"></a>01014     snmp_free_varbind(info-&gt;<a class="code" href=
"structnetsnmp__table__request__info__s.html#a585f93b117d282e0c857e7b3670f85af" title=
"contents freed by helper upon exit">indexes</a>);
<a name="l01015" id="l01015"></a>01015     free(info);
<a name="l01016" id="l01016"></a>01016 }
<a name="l01017" id="l01017"></a>01017 
<a name="l01018" id="l01018"></a>01018 
<a name="l01019" id="l01019"></a>01019 
<a name="l01020" id="l01020"></a>01020 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01021" id="l01021"></a>01021 table_helper_cleanup(<a class="code" href="structnetsnmp__agent__request__info__s.html"
title="The agent transaction request structure.">netsnmp_agent_request_info</a> *reqinfo,
<a name="l01022" id="l01022"></a>01022                      <a class="code" href="structnetsnmp__request__info__s.html" title=
"The netsnmp request info structure.">netsnmp_request_info</a> *request, <span class="keywordtype">int</span> status)
<a name="l01023" id="l01023"></a>01023 {
<a name="l01024" id="l01024"></a>01024     <a class="code" href="group__snmp__agent.html#gac0668f1fd9036ebc88a734d9d4a6a59b"
title="set error for a request">netsnmp_set_request_error</a>(reqinfo, request, status);
<a name="l01025" id="l01025"></a>01025     <a class="code" href="group__handler.html#ga14d1a9eeb19594f07d4cb70de8a89145" title=
"Free the extra data stored in a bunch of requests (all data in the chain).">netsnmp_free_request_data_sets</a>(request);
<a name="l01026" id="l01026"></a>01026     <span class="keywordflow">if</span> (!request)
<a name="l01027" id="l01027"></a>01027         <span class="keywordflow">return</span>;
<a name="l01028" id="l01028"></a>01028     request-&gt;<a class="code" href=
"structnetsnmp__request__info__s.html#a6420dc3c100f91dc2c8bb6a383dbb4bd" title=
"can be used to pass information on a per-request basis from a helper to the later...">parent_data</a> = NULL;
<a name="l01029" id="l01029"></a>01029 }
<a name="l01030" id="l01030"></a>01030 
<a name="l01031" id="l01031"></a>01031 
<a name="l01032" id="l01032"></a>01032 <span class="comment">/*</span>
<a name="l01033" id="l01033"></a>01033 <span class="comment"> * find the closest column to current (which may be current).</span>
<a name="l01034" id="l01034"></a>01034 <span class="comment"> *</span>
<a name="l01035" id="l01035"></a>01035 <span class="comment"> * called when a table runs out of rows for column X. This</span>
<a name="l01036" id="l01036"></a>01036 <span class="comment"> * function is called with current = X + 1, to verify that</span>
<a name="l01037" id="l01037"></a>01037 <span class=
"comment"> * X + 1 is a valid column, or find the next closest column if not.</span>
<a name="l01038" id="l01038"></a>01038 <span class="comment"> *</span>
<a name="l01039" id="l01039"></a>01039 <span class="comment"> * All list types should be sorted, lowest to highest.</span>
<a name="l01040" id="l01040"></a>01040 <span class="comment"> */</span>
<a name="l01041" id="l01041"></a>01041 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>
<a name="l01042" id="l01042"></a>01042 netsnmp_closest_column(<span class="keywordtype">unsigned</span> <span class=
"keywordtype">int</span> current,
<a name="l01043" id="l01043"></a>01043                        <a class="code" href="structnetsnmp__column__info__t.html" title=
"column info struct.">netsnmp_column_info</a> *valid_columns)
<a name="l01044" id="l01044"></a>01044 {
<a name="l01045" id="l01045"></a>01045     <span class="keywordtype">unsigned</span> <span class=
"keywordtype">int</span>    closest = 0;
<a name="l01046" id="l01046"></a>01046     <span class="keywordtype">int</span>             idx;
<a name="l01047" id="l01047"></a>01047 
<a name="l01048" id="l01048"></a>01048     <span class="keywordflow">if</span> (valid_columns == NULL)
<a name="l01049" id="l01049"></a>01049         <span class="keywordflow">return</span> 0;
<a name="l01050" id="l01050"></a>01050 
<a name="l01051" id="l01051"></a>01051     <span class=
"keywordflow">for</span>( ; valid_columns; valid_columns = valid_columns-&gt;next) {
<a name="l01052" id="l01052"></a>01052 
<a name="l01053" id="l01053"></a>01053         <span class="keywordflow">if</span> (valid_columns-&gt;isRange) {
<a name="l01054" id="l01054"></a>01054             <span class="comment">/*</span>
<a name="l01055" id="l01055"></a>01055 <span class=
"comment">             * if current &lt; low range, it might be closest.</span>
<a name="l01056" id="l01056"></a>01056 <span class=
"comment">             * otherwise, if it's &lt; high range, current is in</span>
<a name="l01057" id="l01057"></a>01057 <span class="comment">             * the range, and thus is an exact match.</span>
<a name="l01058" id="l01058"></a>01058 <span class="comment">             */</span>
<a name="l01059" id="l01059"></a>01059             <span class=
"keywordflow">if</span> (current &lt; valid_columns-&gt;details.range[0]) {
<a name="l01060" id="l01060"></a>01060                 <span class=
"keywordflow">if</span> ( (valid_columns-&gt;details.range[0] &lt; closest) ||
<a name="l01061" id="l01061"></a>01061                      (0 == closest)) {
<a name="l01062" id="l01062"></a>01062                     closest = valid_columns-&gt;details.range[0];
<a name="l01063" id="l01063"></a>01063                 }
<a name="l01064" id="l01064"></a>01064             } <span class="keywordflow">else</span> <span class=
"keywordflow">if</span> (current &lt;= valid_columns-&gt;details.range[1]) {
<a name="l01065" id="l01065"></a>01065                 closest = current;
<a name="l01066" id="l01066"></a>01066                 <span class="keywordflow">break</span>;       <span class=
"comment">/* can not get any closer! */</span>
<a name="l01067" id="l01067"></a>01067             }
<a name="l01068" id="l01068"></a>01068 
<a name="l01069" id="l01069"></a>01069         } <span class="comment">/* range */</span>
<a name="l01070" id="l01070"></a>01070         <span class="keywordflow">else</span> {                  <span class=
"comment">/* list */</span>
<a name="l01071" id="l01071"></a>01071             <span class="comment">/*</span>
<a name="l01072" id="l01072"></a>01072 <span class=
"comment">             * if current &lt; first item, no need to iterate over list.</span>
<a name="l01073" id="l01073"></a>01073 <span class="comment">             * that item is either closest, or not.</span>
<a name="l01074" id="l01074"></a>01074 <span class="comment">             */</span>
<a name="l01075" id="l01075"></a>01075             <span class=
"keywordflow">if</span> (current &lt; valid_columns-&gt;details.list[0]) {
<a name="l01076" id="l01076"></a>01076                 <span class=
"keywordflow">if</span> ((valid_columns-&gt;details.list[0] &lt; closest) ||
<a name="l01077" id="l01077"></a>01077                     (0 == closest))
<a name="l01078" id="l01078"></a>01078                     closest = valid_columns-&gt;details.list[0];
<a name="l01079" id="l01079"></a>01079                 <span class="keywordflow">continue</span>;
<a name="l01080" id="l01080"></a>01080             }
<a name="l01081" id="l01081"></a>01081 
<a name="l01083" id="l01083"></a>01083             <span class="keywordflow">if</span> (current &gt;
<a name="l01084" id="l01084"></a>01084                 valid_columns-&gt;details.list[(<span class=
"keywordtype">int</span>)valid_columns-&gt;<a class="code" href=
"structnetsnmp__column__info__t.html#aad98f438ae02538e4df763022006e259" title="only useful if isRange == 0">list_count</a> - 1])
<a name="l01085" id="l01085"></a>01085                 <span class="keywordflow">continue</span>;       <span class=
"comment">/* not in list range. */</span>
<a name="l01086" id="l01086"></a>01086 
<a name="l01088" id="l01088"></a>01088             <span class=
"keywordflow">for</span> (idx = 0; valid_columns-&gt;details.list[idx] &lt; current; ++idx)
<a name="l01089" id="l01089"></a>01089                 ;
<a name="l01090" id="l01090"></a>01090             
<a name="l01092" id="l01092"></a>01092             <span class=
"keywordflow">if</span> (current == valid_columns-&gt;details.list[idx]) {
<a name="l01093" id="l01093"></a>01093                 closest = current;
<a name="l01094" id="l01094"></a>01094                 <span class="keywordflow">break</span>;      <span class=
"comment">/* can not get any closer! */</span>
<a name="l01095" id="l01095"></a>01095             }
<a name="l01096" id="l01096"></a>01096             
<a name="l01098" id="l01098"></a>01098             <span class=
"keywordflow">if</span> ((valid_columns-&gt;details.list[idx] &lt; closest) ||
<a name="l01099" id="l01099"></a>01099                 (0 == closest))
<a name="l01100" id="l01100"></a>01100                 closest = valid_columns-&gt;details.list[idx];
<a name="l01101" id="l01101"></a>01101 
<a name="l01102" id="l01102"></a>01102         }                       <span class="comment">/* list */</span>
<a name="l01103" id="l01103"></a>01103     }                           <span class="comment">/* for */</span>
<a name="l01104" id="l01104"></a>01104 
<a name="l01105" id="l01105"></a>01105     <span class="keywordflow">return</span> closest;
<a name="l01106" id="l01106"></a>01106 }
<a name="l01107" id="l01107"></a>01107 
<a name="l01127" id="l01127"></a>01127 <span class="keywordtype">void</span>
<a name="l01128" id="l01128"></a>01128 netsnmp_table_helper_add_indexes(<a class="code" href=
"structnetsnmp__table__registration__info__s.html" title=
"Table registration structure.">netsnmp_table_registration_info</a> *tinfo,
<a name="l01129" id="l01129"></a>01129                                  ...)
<a name="l01130" id="l01130"></a>01130 {
<a name="l01131" id="l01131"></a>01131     va_list         debugargs;
<a name="l01132" id="l01132"></a>01132     <span class="keywordtype">int</span>             type;
<a name="l01133" id="l01133"></a>01133 
<a name="l01134" id="l01134"></a>01134     va_start(debugargs, tinfo);
<a name="l01135" id="l01135"></a>01135     <span class="keywordflow">while</span> ((type = va_arg(debugargs, <span class=
"keywordtype">int</span>)) != 0) {
<a name="l01136" id="l01136"></a>01136         netsnmp_table_helper_add_index(tinfo, type);
<a name="l01137" id="l01137"></a>01137     }
<a name="l01138" id="l01138"></a>01138     va_end(debugargs);
<a name="l01139" id="l01139"></a>01139 }
<a name="l01140" id="l01140"></a>01140 
<a name="l01141" id="l01141"></a>01141 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01142" id="l01142"></a>01142 _row_stash_data_list_free(<span class="keywordtype">void</span> *ptr) {
<a name="l01143" id="l01143"></a>01143     <a class="code" href=
"structnetsnmp__oid__stash__node__s.html">netsnmp_oid_stash_node</a> **tmp = (<a class="code" href=
"structnetsnmp__oid__stash__node__s.html">netsnmp_oid_stash_node</a> **)ptr;
<a name="l01144" id="l01144"></a>01144     <a class="code" href="group__oid__stash.html#ga8b3ab7792cfc2014af022a6eb2ecabc0"
title="Frees the contents of a netsnmp_oid_stash tree.">netsnmp_oid_stash_free</a>(tmp, NULL);
<a name="l01145" id="l01145"></a>01145     free(ptr);
<a name="l01146" id="l01146"></a>01146 }
<a name="l01147" id="l01147"></a>01147 
<a name="l01150" id="l01150"></a>01150 <a class="code" href=
"structnetsnmp__oid__stash__node__s.html">netsnmp_oid_stash_node</a> **
<a name="l01151" id="l01151"></a>01151 netsnmp_table_get_or_create_row_stash(<a class="code" href=
"structnetsnmp__agent__request__info__s.html" title=
"The agent transaction request structure.">netsnmp_agent_request_info</a> *reqinfo,
<a name="l01152" id="l01152"></a>01152                                       <span class=
"keyword">const</span> u_char * storage_name)
<a name="l01153" id="l01153"></a>01153 {
<a name="l01154" id="l01154"></a>01154     <a class="code" href=
"structnetsnmp__oid__stash__node__s.html">netsnmp_oid_stash_node</a> **stashp = NULL;
<a name="l01155" id="l01155"></a>01155     stashp = (<a class="code" href=
"structnetsnmp__oid__stash__node__s.html">netsnmp_oid_stash_node</a> **)
<a name="l01156" id="l01156"></a>01156         netsnmp_agent_get_list_data(reqinfo, storage_name);
<a name="l01157" id="l01157"></a>01157 
<a name="l01158" id="l01158"></a>01158     <span class="keywordflow">if</span> (!stashp) {
<a name="l01159" id="l01159"></a>01159         <span class="comment">/*</span>
<a name="l01160" id="l01160"></a>01160 <span class="comment">         * hasn't be created yet.  we create it here. </span>
<a name="l01161" id="l01161"></a>01161 <span class="comment">         */</span>
<a name="l01162" id="l01162"></a>01162         stashp = <a class="code" href=
"group__util.html#ga9cd013bb193de5048149afeb9d94e424" title=
"Mallocs memory of sizeof(t), zeros it and returns a pointer to it.">SNMP_MALLOC_TYPEDEF</a>(<a class="code" href=
"structnetsnmp__oid__stash__node__s.html">netsnmp_oid_stash_node</a> *);
<a name="l01163" id="l01163"></a>01163 
<a name="l01164" id="l01164"></a>01164         <span class="keywordflow">if</span> (!stashp)
<a name="l01165" id="l01165"></a>01165             <span class="keywordflow">return</span> NULL;        <span class=
"comment">/* ack. out of mem */</span>
<a name="l01166" id="l01166"></a>01166 
<a name="l01167" id="l01167"></a>01167         netsnmp_agent_add_list_data(reqinfo,
<a name="l01168" id="l01168"></a>01168                                     <a class="code" href=
"group__data__list.html#ga3dc286b678474c6adb610460ea71b03e" title=
"adds creates a data_list node given a name, data and a free function ptr.">netsnmp_create_data_list</a>(storage_name,
<a name="l01169" id="l01169"></a>01169                                                              stashp,
<a name="l01170" id="l01170"></a>01170                                                              _row_stash_data_list_free));
<a name="l01171" id="l01171"></a>01171     }
<a name="l01172" id="l01172"></a>01172     <span class="keywordflow">return</span> stashp;
<a name="l01173" id="l01173"></a>01173 }
<a name="l01174" id="l01174"></a>01174 
<a name="l01175" id="l01175"></a>01175 <span class="comment">/*</span>
<a name="l01176" id="l01176"></a>01176 <span class=
"comment"> * advance the table info colnum to the next column, or 0 if there are no more</span>
<a name="l01177" id="l01177"></a>01177 <span class="comment"> *</span>
<a name="l01178" id="l01178"></a>01178 <span class="comment"> * @return new column, or 0 if there are no more</span>
<a name="l01179" id="l01179"></a>01179 <span class="comment"> */</span>
<a name="l01180" id="l01180"></a>01180 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>
<a name="l01181" id="l01181"></a>01181 netsnmp_table_next_column(<a class="code" href=
"structnetsnmp__table__request__info__s.html" title=
"The table request info structure.">netsnmp_table_request_info</a> *table_info)
<a name="l01182" id="l01182"></a>01182 {
<a name="l01183" id="l01183"></a>01183     <span class="keywordflow">if</span> (NULL == table_info)
<a name="l01184" id="l01184"></a>01184         <span class="keywordflow">return</span> 0;
<a name="l01185" id="l01185"></a>01185 
<a name="l01186" id="l01186"></a>01186     <span class="comment">/*</span>
<a name="l01187" id="l01187"></a>01187 <span class="comment">     * try and validate next column</span>
<a name="l01188" id="l01188"></a>01188 <span class="comment">     */</span>
<a name="l01189" id="l01189"></a>01189     <span class="keywordflow">if</span> (table_info-&gt;reg_info-&gt;<a class="code" href=
"structnetsnmp__table__registration__info__s.html#aaedf72ed4f760e9926f739553da49835" title=
"more details on columns">valid_columns</a>)
<a name="l01190" id="l01190"></a>01190         <span class=
"keywordflow">return</span> netsnmp_closest_column(table_info-&gt;<a class="code" href=
"structnetsnmp__table__request__info__s.html#afbed55ce9b6c75a98fafc84559462b34" title="0 if OID not long enough">colnum</a> + 1,
<a name="l01191" id="l01191"></a>01191                                       table_info-&gt;reg_info-&gt;<a class="code" href=
"structnetsnmp__table__registration__info__s.html#aaedf72ed4f760e9926f739553da49835" title=
"more details on columns">valid_columns</a>);
<a name="l01192" id="l01192"></a>01192     
<a name="l01193" id="l01193"></a>01193     <span class="comment">/*</span>
<a name="l01194" id="l01194"></a>01194 <span class="comment">     * can't validate. assume 1..max_column are valid</span>
<a name="l01195" id="l01195"></a>01195 <span class="comment">     */</span>
<a name="l01196" id="l01196"></a>01196     <span class="keywordflow">if</span> (table_info-&gt;<a class="code" href=
"structnetsnmp__table__request__info__s.html#afbed55ce9b6c75a98fafc84559462b34" title=
"0 if OID not long enough">colnum</a> &lt; table_info-&gt;reg_info-&gt;<a class="code" href=
"structnetsnmp__table__registration__info__s.html#a4b7f37faafced959b943e974ba58e008" title=
"the maximum columns number">max_column</a>)
<a name="l01197" id="l01197"></a>01197         <span class="keywordflow">return</span> table_info-&gt;<a class="code" href=
"structnetsnmp__table__request__info__s.html#afbed55ce9b6c75a98fafc84559462b34" title="0 if OID not long enough">colnum</a> + 1;
<a name="l01198" id="l01198"></a>01198     
<a name="l01199" id="l01199"></a>01199     <span class="keywordflow">return</span> 0; <span class=
"comment">/* out of range */</span>
<a name="l01200" id="l01200"></a>01200 }
</pre>
    </div>
  </div>
  <hr size="1" />

  <address style="text-align: right;">
    <small>Generated on 28 Sep 2009 for net-snmp by  <a href="http://www.doxygen.org/index.html"><img class="footer" src=
    "doxygen.png" alt="doxygen" /></a> 1.6.1</small>
<!-- CONTENT END -->
<!--#include virtual="/page-bottom.html" -->

