<!--#set var="section" value="development" -->
<!--#include virtual="/page-top.html" -->
<!-- CONTENT START -->
  <div class="qindex">
    <a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class=
    "qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class=
    "qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a> | <a class=
    "qindex" href="examples.html">Examples</a>
  </div>

  <div class="nav">
    <a class="el" href="dir_000000.html">include</a>&nbsp;/&nbsp;<a class="el" href=
    "dir_000001.html">net-snmp</a>&nbsp;/&nbsp;<a class="el" href="dir_000006.html">library</a>
  </div>

  <h1>tools.h</h1>

  <div class="fragment">
    <pre class="fragment">
00001 
00008 <span class="preprocessor">#ifndef _TOOLS_H</span>
00009 <span class="preprocessor">#define _TOOLS_H</span>
00010 
00011 <span class="preprocessor">#ifdef __cplusplus</span>
00012 <span class="keyword">extern</span>          <span class="stringliteral">"C"</span> {
00013 <span class="preprocessor">#endif</span>
00014 
00015 
00016 
00017     <span class="comment">/*</span>
00018 <span class="comment">     * General acros and constants.</span>
00019 <span class="comment">     */</span>
00020 <span class="preprocessor">#ifdef WIN32</span>
00021 <span class="preprocessor">#  define SNMP_MAXPATH MAX_PATH</span>
00022 <span class="preprocessor">#else</span>
00023 <span class="preprocessor">#  ifdef PATH_MAX</span>
00024 <span class="preprocessor">#    define SNMP_MAXPATH PATH_MAX</span>
00025 <span class="preprocessor">#  else</span>
00026 <span class="preprocessor">#    ifdef MAXPATHLEN</span>
00027 <span class="preprocessor">#      define SNMP_MAXPATH MAXPATHLEN</span>
00028 <span class="preprocessor">#    else</span>
00029 <span class="preprocessor">#      define SNMP_MAXPATH 1024         </span><span class=
"comment">/* Should be safe enough */</span>
00030 <span class="preprocessor">#    endif</span>
00031 <span class="preprocessor">#  endif</span>
00032 <span class="preprocessor">#endif</span>
00033 
00034 <span class="preprocessor">#define SNMP_MAXBUF             (1024 * 4)</span>
00035 <span class="preprocessor">#define SNMP_MAXBUF_MEDIUM      1024</span>
00036 <span class="preprocessor">#define SNMP_MAXBUF_SMALL       512</span>
00037 
00038 <span class="preprocessor">#define SNMP_MAXBUF_MESSAGE     1500</span>
00039 
00040 <span class="preprocessor">#define SNMP_MAXOID             64</span>
00041 <span class="preprocessor">#define SNMP_MAX_CMDLINE_OIDS   128</span>
00042 
00043 <span class="preprocessor">#define SNMP_FILEMODE_CLOSED    0600</span>
00044 <span class="preprocessor">#define SNMP_FILEMODE_OPEN      0644</span>
00045 
00046 <span class="preprocessor">#define BYTESIZE(bitsize)       ((bitsize + 7) &gt;&gt; 3)</span>
00047 <span class="preprocessor">#define ROUNDUP8(x)             ( ( (x+7) &gt;&gt; 3 ) * 8 )</span>
00048 
00049 
00050 
<a name="l00053" id="l00053"></a><a class="code" href="group__util.html#ga36">00053</a> <span class=
"preprocessor">#define SNMP_FREE(s)    do { if (s) { free((void *)s); s=NULL; } } while(0)</span>
00054 
<a name="l00057" id="l00057"></a><a class="code" href="group__util.html#ga37">00057</a> <span class=
"preprocessor">#define SNMP_SWIPE_MEM(n,s) do { if (n) free((void *)n); n = s; s=NULL; } while(0)</span>
00058 
00059     <span class="comment">/*</span>
00060 <span class="comment">     * XXX Not optimal everywhere. </span>
00061 <span class="comment">     */</span>
<a name="l00064" id="l00064"></a><a class="code" href="group__util.html#ga38">00064</a> <span class=
"preprocessor">#define SNMP_MALLOC_STRUCT(s)   (struct s *) calloc(1, sizeof(struct s))</span>
00065 
<a name="l00068" id="l00068"></a><a class="code" href="group__util.html#ga39">00068</a> <span class=
"preprocessor">#define SNMP_MALLOC_TYPEDEF(td)  (td *) calloc(1, sizeof(td))</span>
00069 
<a name="l00072" id="l00072"></a><a class="code" href="group__util.html#ga40">00072</a> <span class=
"preprocessor">#define SNMP_ZERO(s,l)  do { if (s) memset(s, 0, l); } while(0)</span>
00073 
00074 
00075 <span class="preprocessor">#define TOUPPER(c)      (c &gt;= 'a' &amp;&amp; c &lt;= 'z' ? c - ('a' - 'A') : c)</span>
00076 <span class="preprocessor">#define TOLOWER(c)      (c &gt;= 'A' &amp;&amp; c &lt;= 'Z' ? c + ('a' - 'A') : c)</span>
00077 
00078 <span class="preprocessor">#define HEX2VAL(s) \</span>
00079 <span class="preprocessor">        ((isalpha(s) ? (TOLOWER(s)-'a'+10) : (TOLOWER(s)-'0')) &amp; 0xf)</span>
00080 <span class="preprocessor">#define VAL2HEX(s)      ( (s) + (((s) &gt;= 10) ? ('a'-10) : '0') )</span>
00081 
00082 
<a name="l00085" id="l00085"></a><a class="code" href="group__util.html#ga45">00085</a> <span class=
"preprocessor">#define SNMP_MAX(a,b) ((a) &gt; (b) ? (a) : (b))</span>
00086 
<a name="l00089" id="l00089"></a><a class="code" href="group__util.html#ga46">00089</a> <span class=
"preprocessor">#define SNMP_MIN(a,b) ((a) &gt; (b) ? (b) : (a))</span>
00090 
00091 <span class="preprocessor">#ifndef FALSE</span>
00092 <span class="preprocessor">#define FALSE 0</span>
00093 <span class="preprocessor">#endif</span>
00094 <span class="preprocessor">#ifndef TRUE</span>
00095 <span class="preprocessor">#define TRUE  1</span>
00096 <span class="preprocessor">#endif</span>
00097 
00098     <span class="comment">/*</span>
00099 <span class="comment">     * QUIT the FUNction:</span>
00100 <span class="comment">     *      e       Error code variable</span>
00101 <span class="comment">     *      l       Label to goto to cleanup and get out of the function.</span>
00102 <span class="comment">     *</span>
00103 <span class="comment">     * XXX  It would be nice if the label could be constructed by the</span>
00104 <span class="comment">     *      preprocessor in context.  Limited to a single error return value.</span>
00105 <span class="comment">     *      Temporary hack at best.</span>
00106 <span class="comment">     */</span>
00107 <span class="preprocessor">#define QUITFUN(e, l)                   \</span>
00108 <span class="preprocessor">        if ( (e) != SNMPERR_SUCCESS) {  \</span>
00109 <span class="preprocessor">                rval = SNMPERR_GENERR;  \</span>
00110 <span class="preprocessor">                goto l ;                \</span>
00111 <span class="preprocessor">        }</span>
00112 
00113     <span class="comment">/*</span>
00114 <span class="comment">     * DIFFTIMEVAL</span>
00115 <span class=
"comment">     *      Set &lt;diff&gt; to the difference between &lt;now&gt; (current) and &lt;then&gt; (past).</span>
00116 <span class="comment">     *</span>
00117 <span class="comment">     * ASSUMES that all inputs are (struct timeval)'s.</span>
00118 <span class="comment">     * Cf. system.c:calculate_time_diff().</span>
00119 <span class="comment">     */</span>
00120 <span class="preprocessor">#define DIFFTIMEVAL(now, then, diff)                    \</span>
00121 <span class="preprocessor">{                                                       \</span>
00122 <span class="preprocessor">        now.tv_sec--;                                   \</span>
00123 <span class="preprocessor">        now.tv_usec += 1000000L;                        \</span>
00124 <span class="preprocessor">        diff.tv_sec  = now.tv_sec  - then.tv_sec;       \</span>
00125 <span class="preprocessor">        diff.tv_usec = now.tv_usec - then.tv_usec;      \</span>
00126 <span class="preprocessor">        if (diff.tv_usec &gt; 1000000L){                   \</span>
00127 <span class="preprocessor">                diff.tv_usec -= 1000000L;               \</span>
00128 <span class="preprocessor">                diff.tv_sec++;                          \</span>
00129 <span class="preprocessor">        }                                               \</span>
00130 <span class="preprocessor">}</span>
00131 
00132 
00133     <span class="comment">/*</span>
00134 <span class="comment">     * ISTRANSFORM</span>
00135 <span class="comment">     * ASSUMES the minimum length for ttype and toid.</span>
00136 <span class="comment">     */</span>
00137 <span class="preprocessor">#define USM_LENGTH_OID_TRANSFORM        10</span>
00138 
00139 <span class="preprocessor">#define ISTRANSFORM(ttype, toid)                                        \</span>
00140 <span class="preprocessor">        !snmp_oid_compare(ttype, USM_LENGTH_OID_TRANSFORM,              \</span>
00141 <span class="preprocessor">                usm ## toid ## Protocol, USM_LENGTH_OID_TRANSFORM)</span>
00142 
00143 <span class="preprocessor">#define ENGINETIME_MAX  2147483647      </span><span class="comment">/* ((2^31)-1) */</span>
00144 <span class="preprocessor">#define ENGINEBOOT_MAX  2147483647      </span><span class="comment">/* ((2^31)-1) */</span>
00145 
00146 
00147 
00148 
00149     <span class="comment">/*</span>
00150 <span class="comment">     * Prototypes.</span>
00151 <span class="comment">     */</span>
00152 
00153     <span class="keywordtype">int</span>             <a class="code" href=
"group__util.html#ga1">snmp_realloc</a>(u_char ** buf, size_t * buf_len);
00154 
00155     <span class="keywordtype">void</span>            <a class="code" href="group__util.html#ga2">free_zero</a>(<span class=
"keywordtype">void</span> *buf, size_t size);
00156 
00157     u_char         *<a class="code" href="group__util.html#ga3">malloc_random</a>(size_t * size);
00158     u_char         *malloc_zero(size_t size);
00159     <span class="keywordtype">int</span>             <a class="code" href=
"group__util.html#ga5">memdup</a>(u_char ** to, <span class="keyword">const</span> u_char * from, size_t size);
00160 
00161     u_int           <a class="code" href="group__util.html#ga6">binary_to_hex</a>(<span class=
"keyword">const</span> u_char * input, size_t len,
00162                                   <span class="keywordtype">char</span> **output);
00163                     <span class="comment">/* preferred */</span>
00164     <span class="keywordtype">int</span>             <a class="code" href=
"group__util.html#ga7">netsnmp_hex_to_binary</a>(u_char ** buf, size_t * buf_len,
00165                                          size_t * out_len, <span class="keywordtype">int</span> allow_realloc,
00166                                          <span class="keyword">const</span> <span class=
"keywordtype">char</span> *hex, <span class="keyword">const</span> <span class="keywordtype">char</span> *delim);
00167                     <span class="comment">/* calls netsnmp_hex_to_binary w/delim of " " */</span>
00168     <span class="keywordtype">int</span>             <a class="code" href=
"group__util.html#ga8">snmp_hex_to_binary</a>(u_char ** buf, size_t * buf_len,
00169                                        size_t * out_len, <span class="keywordtype">int</span> allow_realloc,
00170                                        <span class="keyword">const</span> <span class="keywordtype">char</span> *hex);
00171                     <span class="comment">/* handles odd lengths */</span>
00172     <span class="keywordtype">int</span>             <a class="code" href=
"group__util.html#ga9">hex_to_binary2</a>(<span class="keyword">const</span> u_char * input, size_t len,
00173                                    <span class="keywordtype">char</span> **output);
00174 
00175     <span class="keywordtype">int</span>             snmp_decimal_to_binary(u_char ** buf, size_t * buf_len,
00176                                            size_t * out_len,
00177                                            <span class="keywordtype">int</span> allow_realloc,
00178                                            <span class="keyword">const</span> <span class=
"keywordtype">char</span> *decimal);
00179     <span class="keywordtype">int</span>             snmp_strcat(u_char ** buf, size_t * buf_len,
00180                                 size_t * out_len, <span class="keywordtype">int</span> allow_realloc,
00181                                 <span class="keyword">const</span> u_char * s);
00182     <span class="keywordtype">char</span>           *<a class="code" href=
"group__util.html#ga12">netsnmp_strdup_and_null</a>(<span class="keyword">const</span> u_char * from,
00183                                             size_t from_len);
00184 
00185     <span class="keywordtype">void</span>            dump_chunk(<span class="keyword">const</span> <span class=
"keywordtype">char</span> *debugtoken, <span class="keyword">const</span> <span class="keywordtype">char</span> *title,
00186                                <span class="keyword">const</span> u_char * buf, <span class="keywordtype">int</span> size);
00187     <span class="keywordtype">char</span>           *dump_snmpEngineID(<span class=
"keyword">const</span> u_char * buf, size_t * buflen);
00188 
00189     <span class="keyword">typedef</span> <span class="keywordtype">void</span>   *marker_t;
00190     marker_t        <a class="code" href="group__util.html#ga15">atime_newMarker</a>(<span class=
"keywordtype">void</span>);
00191     <span class="keywordtype">void</span>            <a class="code" href=
"group__util.html#ga16">atime_setMarker</a>(marker_t pm);
00192     <span class="keywordtype">long</span>            <a class="code" href=
"group__util.html#ga17">atime_diff</a>(marker_t first, marker_t second);
00193     u_long          <a class="code" href=
"group__util.html#ga18">uatime_diff</a>(marker_t first, marker_t second);       <span class="comment">/* 1/1000th sec */</span>
00194     u_long          <a class="code" href=
"group__util.html#ga19">uatime_hdiff</a>(marker_t first, marker_t second);      <span class="comment">/* 1/100th sec */</span>
00195     <span class="keywordtype">int</span>             <a class="code" href=
"group__util.html#ga20">atime_ready</a>(marker_t pm, <span class="keywordtype">int</span> deltaT);
00196     <span class="keywordtype">int</span>             <a class="code" href=
"group__util.html#ga21">uatime_ready</a>(marker_t pm, <span class="keywordtype">unsigned</span> <span class=
"keywordtype">int</span> deltaT);
00197 
00198     <span class="keywordtype">int</span>             <a class="code" href=
"group__util.html#ga22">marker_tticks</a>(marker_t pm);
00199     <span class="keywordtype">int</span>             timeval_tticks(<span class="keyword">struct</span> timeval *tv);
00200     <span class="keywordtype">char</span>            *<a class="code" href=
"group__util.html#ga24">netsnmp_getenv</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name);
00201     
00202 <span class="preprocessor">#ifdef __cplusplus</span>
00203 }
00204 <span class="preprocessor">#endif</span>
00205 <span class="preprocessor">#endif                          </span><span class="comment">/* _TOOLS_H */</span>
00206 <span class="comment">/* @} */</span>
</pre>
  </div>
  <hr size="1" />

  <address style="align: right;">
    <small><!--#include virtual="/sfbutton.html" --><br />
    Generated on Thu Oct 28 21:47:02 2004 for net-snmp by&nbsp; <a href="http://www.doxygen.org/index.html"><img src=
    "doxygen.png" alt="doxygen" align="middle" border="0" /></a> 1.3.9.1</small>
<!-- CONTENT END -->
<!--#include virtual="/page-bottom.html" -->

