<!--#set var="section" value="development" -->
<!--#include virtual="/page-top.html" -->
<!-- CONTENT START -->
  <!-- Generated by Doxygen 1.3.9.1 -->

  <div class="qindex">
    <a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class=
    "qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class=
    "qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a> | <a class=
    "qindex" href="examples.html">Examples</a>
  </div>

  <div class="nav">
    <a class="el" href="dir_000003.html">agent</a>&nbsp;/&nbsp;<a class="el" href="dir_000004.html">helpers</a>
  </div>

  <h1>table_tdata.c</h1>

  <div class="fragment">
    <pre class="fragment">
00001 <span class="preprocessor">#include &lt;net-snmp/net-snmp-config.h&gt;</span>
00002 
00003 <span class="preprocessor">#if HAVE_STRING_H</span>
00004 <span class="preprocessor">#include &lt;string.h&gt;</span>
00005 <span class="preprocessor">#else</span>
00006 <span class="preprocessor">#include &lt;strings.h&gt;</span>
00007 <span class="preprocessor">#endif</span>
00008 
00009 <span class="preprocessor">#include &lt;net-snmp/net-snmp-includes.h&gt;</span>
00010 <span class="preprocessor">#include &lt;net-snmp/agent/net-snmp-agent-includes.h&gt;</span>
00011 
00012 <span class="preprocessor">#include &lt;net-snmp/agent/table.h&gt;</span>
00013 <span class="preprocessor">#include &lt;net-snmp/agent/table_tdata.h&gt;</span>
00014 <span class="preprocessor">#include &lt;net-snmp/agent/table_container.h&gt;</span>
00015 <span class="preprocessor">#include &lt;net-snmp/agent/read_only.h&gt;</span>
00016 
00017 <span class="preprocessor">#if HAVE_DMALLOC_H</span>
00018 <span class="preprocessor">#include &lt;dmalloc.h&gt;</span>
00019 <span class="preprocessor">#endif</span>
00020 
00036 <span class="comment">/* ==================================</span>
00037 <span class="comment"> *</span>
00038 <span class="comment"> * TData API: Table maintenance</span>
00039 <span class="comment"> *</span>
00040 <span class="comment"> * ================================== */</span>
00041 
00042 <span class="comment">/*</span>
00043 <span class="comment"> * generates the index portion of an table oid from a varlist.</span>
00044 <span class="comment"> */</span>
00045 <span class="keywordtype">void</span>
00046 _netsnmp_tdata_generate_index_oid(netsnmp_tdata_row *row)
00047 {
00048     <a class="code" href=
"group__mib__utilities.html#ga79">build_oid</a>(&amp;row-&gt;oid_index.oids, &amp;row-&gt;oid_index.len, NULL, 0, row-&gt;indexes);
00049 }
00050 
00052 netsnmp_tdata *
<a name="l00053" id="l00053"></a><a class="code" href="group__tdata.html#ga2">00053</a> <a class="code" href=
"group__tdata.html#ga2">netsnmp_tdata_create_table</a>(<span class="keyword">const</span> <span class=
"keywordtype">char</span> *name, <span class="keywordtype">long</span> flags)
00054 {
00055     netsnmp_tdata *table = <a class="code" href="group__util.html#ga39">SNMP_MALLOC_TYPEDEF</a>(netsnmp_tdata);
00056     <span class="keywordflow">if</span> ( !table )
00057         <span class="keywordflow">return</span> NULL;
00058 
00059     <span class="keywordflow">if</span> (name)
00060         table-&gt;name = strdup(name);
00061     table-&gt;container = netsnmp_container_find( <span class="stringliteral">"table_container"</span> );
00062     <span class="keywordflow">return</span> table;
00063 }
00064 
00066 <span class="keywordtype">void</span>
<a name="l00067" id="l00067"></a><a class="code" href="group__tdata.html#ga3">00067</a> <a class="code" href=
"group__tdata.html#ga3">netsnmp_tdata_delete_table</a>(netsnmp_tdata *table)
00068 {
00069     <span class="keywordflow">if</span> (!table)
00070        <span class="keywordflow">return</span>;
00071 
00072     <span class="keywordflow">if</span> (table-&gt;name)
00073        free(table-&gt;name);
00074     <span class="keywordflow">if</span> (table-&gt;container)
00075        CONTAINER_FREE(table-&gt;container);
00076     
00077     <a class="code" href="group__util.html#ga36">SNMP_FREE</a>(table);
00078     <span class="keywordflow">return</span>;
00079 }
00080 
00082 netsnmp_tdata_row *
<a name="l00083" id="l00083"></a><a class="code" href="group__tdata.html#ga4">00083</a> <a class="code" href=
"group__tdata.html#ga4">netsnmp_tdata_create_row</a>(<span class="keywordtype">void</span>)
00084 {
00085     netsnmp_tdata_row *row = <a class="code" href="group__util.html#ga39">SNMP_MALLOC_TYPEDEF</a>(netsnmp_tdata_row);
00086     <span class="keywordflow">return</span> row;
00087 }
00088 
00090 netsnmp_tdata_row *
<a name="l00091" id="l00091"></a><a class="code" href="group__tdata.html#ga5">00091</a> <a class="code" href=
"group__tdata.html#ga5">netsnmp_tdata_clone_row</a>(netsnmp_tdata_row *row)
00092 {
00093     netsnmp_tdata_row *newrow = NULL;
00094     <span class="keywordflow">if</span> (!row)
00095         <span class="keywordflow">return</span> NULL;
00096 
00097     <a class="code" href="group__util.html#ga5">memdup</a>((u_char **) &amp; newrow, (u_char *) row,
00098            <span class="keyword">sizeof</span>(netsnmp_tdata_row));
00099     <span class="keywordflow">if</span> (!newrow)
00100         <span class="keywordflow">return</span> NULL;
00101 
00102     <span class="keywordflow">if</span> (row-&gt;indexes) {
00103         newrow-&gt;indexes = snmp_clone_varbind(newrow-&gt;indexes);
00104         <span class="keywordflow">if</span> (!newrow-&gt;indexes)
00105             <span class="keywordflow">return</span> NULL;
00106     }
00107 
00108     <span class="keywordflow">if</span> (row-&gt;oid_index.oids) {
00109         <a class="code" href="group__util.html#ga5">memdup</a>((u_char **) &amp; newrow-&gt;oid_index.oids,
00110                (u_char *) row-&gt;oid_index.oids,
00111                row-&gt;oid_index.len * <span class="keyword">sizeof</span>(oid));
00112         <span class="keywordflow">if</span> (!newrow-&gt;oid_index.oids)
00113             <span class="keywordflow">return</span> NULL;
00114     }
00115 
00116     <span class="keywordflow">return</span> newrow;
00117 }
00118 
00121 <span class="keywordtype">int</span>
<a name="l00122" id="l00122"></a><a class="code" href="group__tdata.html#ga6">00122</a> <a class="code" href=
"group__tdata.html#ga6">netsnmp_tdata_copy_row</a>(netsnmp_tdata_row *dst_row, netsnmp_tdata_row *src_row)
00123 {
00124      <span class="keywordflow">if</span> ( !src_row || !dst_row )
00125          <span class="keywordflow">return</span> -1;
00126 
00127     memcpy((u_char *) dst_row, (u_char *) src_row,
00128            <span class="keyword">sizeof</span>(netsnmp_tdata_row));
00129     <span class="keywordflow">if</span> (src_row-&gt;indexes) {
00130         dst_row-&gt;indexes = snmp_clone_varbind(src_row-&gt;indexes);
00131         <span class="keywordflow">if</span> (!dst_row-&gt;indexes)
00132             <span class="keywordflow">return</span> -1;
00133     }
00134 
00135     <span class="keywordflow">if</span> (src_row-&gt;oid_index.oids) {
00136         <a class="code" href="group__util.html#ga5">memdup</a>((u_char **) &amp;dst_row-&gt;oid_index.oids,
00137                (u_char  *)  src_row-&gt;oid_index.oids,
00138                src_row-&gt;oid_index.len * <span class="keyword">sizeof</span>(oid));
00139         <span class="keywordflow">if</span> (!dst_row-&gt;oid_index.oids)
00140             <span class="keywordflow">return</span> -1;
00141     }
00142 
00143     <span class="keywordflow">return</span> 0;
00144 }
00145 
00149 <span class="keywordtype">void</span>           *
<a name="l00150" id="l00150"></a><a class="code" href="group__tdata.html#ga7">00150</a> <a class="code" href=
"group__tdata.html#ga7">netsnmp_tdata_delete_row</a>(netsnmp_tdata_row *row)
00151 {
00152     <span class="keywordtype">void</span>           *data;
00153 
00154     <span class="keywordflow">if</span> (!row)
00155         <span class="keywordflow">return</span> NULL;
00156 
00157     <span class="comment">/*</span>
00158 <span class="comment">     * free the memory we can </span>
00159 <span class="comment">     */</span>
00160     <span class="keywordflow">if</span> (row-&gt;indexes)
00161         snmp_free_varbind(row-&gt;indexes);
00162     <a class="code" href="group__util.html#ga36">SNMP_FREE</a>(row-&gt;oid_index.oids);
00163     data = row-&gt;<a class="code" href="structvariable__list.html#o8">data</a>;
00164     free(row);
00165 
00166     <span class="comment">/*</span>
00167 <span class="comment">     * return the void * pointer </span>
00168 <span class="comment">     */</span>
00169     <span class="keywordflow">return</span> data;
00170 }
00171 
00178 <span class="keywordtype">int</span>
<a name="l00179" id="l00179"></a><a class="code" href="group__tdata.html#ga8">00179</a> <a class="code" href=
"group__tdata.html#ga8">netsnmp_tdata_add_row</a>(netsnmp_tdata     *table,
00180                       netsnmp_tdata_row *row)
00181 {
00182     <span class="keywordflow">if</span> (!row || !table)
00183         <span class="keywordflow">return</span> SNMPERR_GENERR;
00184 
00185     <span class="keywordflow">if</span> (row-&gt;indexes)
00186         _netsnmp_tdata_generate_index_oid(row);
00187 
00188     <span class="keywordflow">if</span> (!row-&gt;oid_index.oids) {
00189         <a class="code" href="group__snmp__logging.html#ga41">snmp_log</a>(LOG_ERR,
00190                  <span class="stringliteral">"illegal data attempted to be added to table %s (no index)\n"</span>,
00191                  table-&gt;name);
00192         <span class="keywordflow">return</span> SNMPERR_GENERR;
00193     }
00194 
00195     <span class="comment">/*</span>
00196 <span class="comment">     * The individual index values probably won't be needed,</span>
00197 <span class="comment">     *    so this memory can be released.</span>
00198 <span class="comment">     * Note that this is purely internal to the helper.</span>
00199 <span class="comment">     * The calling application can set this flag as</span>
00200 <span class="comment">     *    a hint to the helper that these values aren't</span>
00201 <span class="comment">     *    required, but it's up to the helper as to</span>
00202 <span class="comment">     *    whether it takes any notice or not!</span>
00203 <span class="comment">     */</span>
00204     <span class="keywordflow">if</span> (table-&gt;flags &amp; TDATA_FLAG_NO_STORE_INDEXES) {
00205         snmp_free_varbind(row-&gt;indexes);
00206         row-&gt;indexes = NULL;
00207     }
00208 
00209     <span class="comment">/*</span>
00210 <span class="comment">     * add this row to the stored table</span>
00211 <span class="comment">     */</span>
00212     CONTAINER_INSERT( table-&gt;container, row );
00213     DEBUGMSGTL((<span class="stringliteral">"tdata_add_row"</span>, <span class=
"stringliteral">"added row (%x)\n"</span>, row));
00214 
00215     <span class="keywordflow">return</span> SNMPERR_SUCCESS;
00216 }
00217 
00219 <span class="keywordtype">void</span>
<a name="l00220" id="l00220"></a><a class="code" href="group__tdata.html#ga9">00220</a> <a class="code" href=
"group__tdata.html#ga9">netsnmp_tdata_replace_row</a>(netsnmp_tdata *table,
00221                                netsnmp_tdata_row *origrow,
00222                                netsnmp_tdata_row *newrow)
00223 {
00224     <a class="code" href="group__tdata.html#ga10">netsnmp_tdata_remove_row</a>(table, origrow);
00225     <a class="code" href="group__tdata.html#ga8">netsnmp_tdata_add_row</a>(table, newrow);
00226 }
00227 
00234 netsnmp_tdata_row *
<a name="l00235" id="l00235"></a><a class="code" href="group__tdata.html#ga10">00235</a> <a class="code" href=
"group__tdata.html#ga10">netsnmp_tdata_remove_row</a>(netsnmp_tdata *table,
00236                               netsnmp_tdata_row *row)
00237 {
00238     <span class="keywordflow">if</span> (!row || !table)
00239         <span class="keywordflow">return</span> NULL;
00240 
00241     CONTAINER_REMOVE( table-&gt;container, row );
00242     <span class="keywordflow">return</span> row;
00243 }
00244 
00252 <span class="keywordtype">void</span>           *
<a name="l00253" id="l00253"></a><a class="code" href="group__tdata.html#ga11">00253</a> <a class="code" href=
"group__tdata.html#ga11">netsnmp_tdata_remove_and_delete_row</a>(netsnmp_tdata     *table,
00254                                     netsnmp_tdata_row *row)
00255 {
00256     <span class="keywordflow">if</span> (!row || !table)
00257         <span class="keywordflow">return</span> NULL;
00258 
00259     <span class="comment">/*</span>
00260 <span class="comment">     * remove it from the list </span>
00261 <span class="comment">     */</span>
00262     <a class="code" href="group__tdata.html#ga10">netsnmp_tdata_remove_row</a>(table, row);
00263     <span class="keywordflow">return</span> <a class="code" href="group__tdata.html#ga7">netsnmp_tdata_delete_row</a>(row);
00264 }
00265 
00266 
00267 <span class="comment">/* ==================================</span>
00268 <span class="comment"> *</span>
00269 <span class="comment"> * TData API: MIB maintenance</span>
00270 <span class="comment"> *</span>
00271 <span class="comment"> * ================================== */</span>
00272 
00273 Netsnmp_Node_Handler _netsnmp_tdata_helper_handler;
00274 
00276 <a class="code" href="structnetsnmp__mib__handler__s.html">netsnmp_mib_handler</a> *
<a name="l00277" id="l00277"></a><a class="code" href="group__tdata.html#ga12">00277</a> <a class="code" href=
"group__tdata.html#ga12">netsnmp_get_tdata_handler</a>(netsnmp_tdata *table)
00278 {
00279     <a class="code" href="structnetsnmp__mib__handler__s.html">netsnmp_mib_handler</a> *ret = NULL;
00280 
00281     <span class="keywordflow">if</span> (!table) {
00282         <a class="code" href="group__snmp__logging.html#ga41">snmp_log</a>(LOG_INFO,
00283                  <span class="stringliteral">"netsnmp_get_tdata_handler(NULL) called\n"</span>);
00284         <span class="keywordflow">return</span> NULL;
00285     }
00286 
00287     ret = <a class="code" href="group__handler.html#ga7">netsnmp_create_handler</a>(TABLE_TDATA_NAME,
00288                                _netsnmp_tdata_helper_handler);
00289     <span class="keywordflow">if</span> (ret) {
00290         ret-&gt;<a class="code" href="structnetsnmp__mib__handler__s.html#o2">flags</a> |= MIB_HANDLER_AUTO_NEXT;
00291         ret-&gt;<a class="code" href="structnetsnmp__mib__handler__s.html#o1">myvoid</a> = (<span class=
"keywordtype">void</span> *) table;
00292     }
00293     <span class="keywordflow">return</span> ret;
00294 }
00295 
00296 <span class="comment">/*</span>
00297 <span class="comment"> * The helper handler that takes care of passing a specific row of</span>
00298 <span class="comment"> * data down to the lower handler(s).  The table_container helper</span>
00299 <span class="comment"> * has already taken care of identifying the appropriate row of the</span>
00300 <span class="comment"> * table (and converting GETNEXT requests into an equivalent GET request)</span>
00301 <span class="comment"> * So all we need to do here is make sure that the row is accessible</span>
00302 <span class="comment"> * using tdata-style retrieval techniques as well.</span>
00303 <span class="comment"> */</span>
00304 <span class="keywordtype">int</span>
00305 _netsnmp_tdata_helper_handler(<a class="code" href="structnetsnmp__mib__handler__s.html">netsnmp_mib_handler</a> *handler,
00306                                   <a class="code" href=
"structnetsnmp__handler__registration__s.html">netsnmp_handler_registration</a> *reginfo,
00307                                   <a class="code" href=
"structnetsnmp__agent__request__info__s.html">netsnmp_agent_request_info</a> *reqinfo,
00308                                   <a class="code" href=
"structnetsnmp__request__info__s.html">netsnmp_request_info</a> *requests)
00309 {
00310     netsnmp_tdata *table = (netsnmp_tdata *) handler-&gt;<a class="code" href=
"structnetsnmp__mib__handler__s.html#o1">myvoid</a>;
00311     <a class="code" href="structnetsnmp__request__info__s.html">netsnmp_request_info</a>       *request;
00312     <a class="code" href="structnetsnmp__table__request__info__s.html">netsnmp_table_request_info</a> *table_info;
00313     netsnmp_tdata_row          *row;
00314 
00315     <span class="keywordflow">switch</span> ( reqinfo-&gt;<a class="code" href=
"structnetsnmp__agent__request__info__s.html#o0">mode</a> ) {
00316     <span class="keywordflow">case</span> MODE_GET:
00317     <span class="keywordflow">case</span> MODE_SET_RESERVE1:
00318 
00319         <span class="keywordflow">for</span> (request = requests; request; request = request-&gt;<a class="code" href=
"structnetsnmp__request__info__s.html#o13">next</a>) {
00320             <span class="keywordflow">if</span> (request-&gt;<a class="code" href=
"structnetsnmp__request__info__s.html#o6">processed</a>)
00321                 <span class="keywordflow">continue</span>;
00322     
00323             table_info = <a class="code" href="group__table.html#ga2">netsnmp_extract_table_info</a>(request);
00324             <span class="keywordflow">if</span> (!table_info)
00325                 <span class="keywordflow">continue</span>;           <span class="comment">/* ack */</span>
00326             row = <a class="code" href=
"group__table__container.html#ga10">netsnmp_container_table_row_extract</a>( request );
00327 
00328             <a class="code" href="group__handler.html#ga27">netsnmp_request_add_list_data</a>(request,
00329                                       <a class="code" href="group__data__list.html#ga3">netsnmp_create_data_list</a>(
00330                                           TABLE_TDATA_TABLE, table, NULL));
00331             <a class="code" href="group__handler.html#ga27">netsnmp_request_add_list_data</a>(request,
00332                                       <a class="code" href="group__data__list.html#ga3">netsnmp_create_data_list</a>(
00333                                           TABLE_TDATA_ROW,   row,   NULL));
00334         }
00335     }
00336 
00337     <span class="comment">/* next handler called automatically - 'AUTO_NEXT' */</span>
00338     <span class="keywordflow">return</span> SNMP_ERR_NOERROR;
00339 }
00340 
00341 
00343 <span class="keywordtype">int</span>
<a name="l00344" id="l00344"></a><a class="code" href="group__tdata.html#ga14">00344</a> <a class="code" href=
"group__tdata.html#ga14">netsnmp_tdata_register</a>(<a class="code" href=
"structnetsnmp__handler__registration__s.html">netsnmp_handler_registration</a>    *reginfo,
00345                        netsnmp_tdata                   *table,
00346                        <a class="code" href=
"structnetsnmp__table__registration__info__s.html">netsnmp_table_registration_info</a> *table_info)
00347 {
00348     <a class="code" href="group__handler.html#ga14">netsnmp_inject_handler</a>(reginfo, <a class="code" href=
"group__tdata.html#ga12">netsnmp_get_tdata_handler</a>(table));
00349     <span class="keywordflow">return</span> netsnmp_container_table_register(reginfo, table_info,
00350                   table-&gt;container, TABLE_CONTAINER_KEY_NETSNMP_INDEX);
00351 }
00352 
00354 netsnmp_tdata *
<a name="l00355" id="l00355"></a><a class="code" href="group__tdata.html#ga15">00355</a> <a class="code" href=
"group__tdata.html#ga15">netsnmp_tdata_extract_table</a>(<a class="code" href=
"structnetsnmp__request__info__s.html">netsnmp_request_info</a> *request)
00356 {
00357     <span class="keywordflow">return</span> (netsnmp_tdata *) <a class="code" href=
"group__handler.html#ga29">netsnmp_request_get_list_data</a>(request,
00358                                                            TABLE_TDATA_TABLE);
00359 }
00360 
00362 netsnmp_container *
<a name="l00363" id="l00363"></a><a class="code" href="group__tdata.html#ga16">00363</a> <a class="code" href=
"group__tdata.html#ga16">netsnmp_tdata_extract_container</a>(<a class="code" href=
"structnetsnmp__request__info__s.html">netsnmp_request_info</a> *request)
00364 {
00365     netsnmp_tdata *tdata = <a class="code" href="group__handler.html#ga29">netsnmp_request_get_list_data</a>(request,
00366                                                          TABLE_TDATA_TABLE);
00367     <span class="keywordflow">return</span> ( tdata ? tdata-&gt;container : NULL );
00368 }
00369 
00371 netsnmp_tdata_row *
<a name="l00372" id="l00372"></a><a class="code" href="group__tdata.html#ga17">00372</a> <a class="code" href=
"group__tdata.html#ga17">netsnmp_tdata_extract_row</a>(<a class="code" href=
"structnetsnmp__request__info__s.html">netsnmp_request_info</a> *request)
00373 {
00374     <span class="keywordflow">return</span> (netsnmp_tdata_row *) <a class="code" href=
"group__table__container.html#ga10">netsnmp_container_table_row_extract</a>(request);
00375 }
00376 
00379 <span class="keywordtype">void</span>           *
<a name="l00380" id="l00380"></a><a class="code" href="group__tdata.html#ga18">00380</a> <a class="code" href=
"group__tdata.html#ga18">netsnmp_tdata_extract_entry</a>(<a class="code" href=
"structnetsnmp__request__info__s.html">netsnmp_request_info</a> *request)
00381 {
00382     netsnmp_tdata_row *row =
00383         (netsnmp_tdata_row *) <a class="code" href="group__tdata.html#ga17">netsnmp_tdata_extract_row</a>(request);
00384     <span class="keywordflow">if</span> (row)
00385         <span class="keywordflow">return</span> row-&gt;data;
00386     <span class="keywordflow">else</span>
00387         <span class="keywordflow">return</span> NULL;
00388 }
00389 
00391 NETSNMP_INLINE <span class="keywordtype">void</span>
<a name="l00392" id="l00392"></a><a class="code" href="group__tdata.html#ga19">00392</a> <a class="code" href=
"group__tdata.html#ga19">netsnmp_insert_tdata_row</a>(<a class="code" href=
"structnetsnmp__request__info__s.html">netsnmp_request_info</a> *request,
00393                          netsnmp_tdata_row *row)
00394 {
00395     <a class="code" href=
"group__table__container.html#ga12">netsnmp_container_table_row_insert</a>(request, (netsnmp_index *)row);
00396 }
00397 
00398 
00399 <span class="comment">/* ==================================</span>
00400 <span class="comment"> *</span>
00401 <span class="comment"> * Generic API: Row operations</span>
00402 <span class="comment"> *</span>
00403 <span class="comment"> * ================================== */</span>
00404 
00406 <span class="keywordtype">void</span> *
<a name="l00407" id="l00407"></a><a class="code" href="group__tdata.html#ga20">00407</a> <a class="code" href=
"group__tdata.html#ga20">netsnmp_tdata_row_entry</a>( netsnmp_tdata_row *row )
00408 {
00409     <span class="keywordflow">if</span> (row)
00410         <span class="keywordflow">return</span> row-&gt;data;
00411     <span class="keywordflow">else</span>
00412         <span class="keywordflow">return</span> NULL;
00413 }
00414 
00416 netsnmp_tdata_row *
<a name="l00417" id="l00417"></a><a class="code" href="group__tdata.html#ga21">00417</a> <a class="code" href=
"group__tdata.html#ga21">netsnmp_tdata_row_first</a>(netsnmp_tdata *table)
00418 {
00419     <span class="keywordflow">return</span> (netsnmp_tdata_row *)CONTAINER_FIRST( table-&gt;container );
00420 }
00421 
00423 netsnmp_tdata_row *
<a name="l00424" id="l00424"></a><a class="code" href="group__tdata.html#ga22">00424</a> <a class="code" href=
"group__tdata.html#ga22">netsnmp_tdata_row_get</a>(  netsnmp_tdata     *table,
00425                         netsnmp_tdata_row *row)
00426 {
00427     <span class="keywordflow">return</span> CONTAINER_FIND( table-&gt;container, row );
00428 }
00429 
00431 netsnmp_tdata_row *
<a name="l00432" id="l00432"></a><a class="code" href="group__tdata.html#ga23">00432</a> <a class="code" href=
"group__tdata.html#ga23">netsnmp_tdata_row_next</a>( netsnmp_tdata      *table,
00433                         netsnmp_tdata_row  *row)
00434 {
00435     <span class="keywordflow">return</span> (netsnmp_tdata_row *)CONTAINER_NEXT( table-&gt;container, row  );
00436 }
00437 
00439 netsnmp_tdata_row *
<a name="l00440" id="l00440"></a><a class="code" href="group__tdata.html#ga24">00440</a> <a class="code" href=
"group__tdata.html#ga24">netsnmp_tdata_row_get_byidx</a>(netsnmp_tdata         *table,
00441                             <a class="code" href="structvariable__list.html">netsnmp_variable_list</a> *indexes)
00442 {
00443     oid             searchfor[      MAX_OID_LEN];
00444     size_t          searchfor_len = MAX_OID_LEN;
00445 
00446     build_oid_noalloc(searchfor, MAX_OID_LEN, &amp;searchfor_len, NULL, 0,
00447                       indexes);
00448     <span class="keywordflow">return</span> <a class="code" href=
"group__tdata.html#ga25">netsnmp_tdata_row_get_byoid</a>(table, searchfor, searchfor_len);
00449 }
00450 
00452 netsnmp_tdata_row *
<a name="l00453" id="l00453"></a><a class="code" href="group__tdata.html#ga25">00453</a> <a class="code" href=
"group__tdata.html#ga25">netsnmp_tdata_row_get_byoid</a>(netsnmp_tdata *table,
00454                             oid * searchfor, size_t searchfor_len)
00455 {
00456     netsnmp_index index;
00457     <span class="keywordflow">if</span> (!table)
00458         <span class="keywordflow">return</span> NULL;
00459 
00460     index.oids = searchfor;
00461     index.len  = searchfor_len;
00462     <span class="keywordflow">return</span> CONTAINER_FIND( table-&gt;container, &amp;index );
00463 }
00464 
00467 netsnmp_tdata_row *
<a name="l00468" id="l00468"></a><a class="code" href="group__tdata.html#ga26">00468</a> <a class="code" href=
"group__tdata.html#ga26">netsnmp_tdata_row_next_byidx</a>(netsnmp_tdata         *table,
00469                              <a class="code" href="structvariable__list.html">netsnmp_variable_list</a> *indexes)
00470 {
00471     oid             searchfor[      MAX_OID_LEN];
00472     size_t          searchfor_len = MAX_OID_LEN;
00473 
00474     build_oid_noalloc(searchfor, MAX_OID_LEN, &amp;searchfor_len, NULL, 0,
00475                       indexes);
00476     <span class="keywordflow">return</span> <a class="code" href=
"group__tdata.html#ga27">netsnmp_tdata_row_next_byoid</a>(table, searchfor, searchfor_len);
00477 }
00478 
00481 netsnmp_tdata_row *
<a name="l00482" id="l00482"></a><a class="code" href="group__tdata.html#ga27">00482</a> <a class="code" href=
"group__tdata.html#ga27">netsnmp_tdata_row_next_byoid</a>(netsnmp_tdata *table,
00483                              oid * searchfor, size_t searchfor_len)
00484 {
00485     netsnmp_index index;
00486     <span class="keywordflow">if</span> (!table)
00487         <span class="keywordflow">return</span> NULL;
00488 
00489     index.oids = searchfor;
00490     index.len  = searchfor_len;
00491     <span class="keywordflow">return</span> CONTAINER_NEXT( table-&gt;container, &amp;index );
00492 }
00493 
00494 <span class="keywordtype">int</span>
00495 netsnmp_tdata_row_count(netsnmp_tdata *table)
00496 {
00497     <span class="keywordflow">if</span> (!table)
00498         <span class="keywordflow">return</span> 0;
00499     <span class="keywordflow">return</span> CONTAINER_SIZE( table-&gt;container );
00500 }
00501 
00502 <span class="comment">/* ==================================</span>
00503 <span class="comment"> *</span>
00504 <span class="comment"> * Generic API: Index operations on a 'tdata' table</span>
00505 <span class="comment"> *</span>
00506 <span class="comment"> * ================================== */</span>
00507 
00508 
00510 <span class="keywordtype">int</span>
<a name="l00511" id="l00511"></a><a class="code" href="group__tdata.html#ga29">00511</a> <a class="code" href=
"group__tdata.html#ga29">netsnmp_tdata_compare_idx</a>(netsnmp_tdata_row     *row,
00512                           <a class="code" href="structvariable__list.html">netsnmp_variable_list</a> *indexes)
00513 {
00514     oid             searchfor[      MAX_OID_LEN];
00515     size_t          searchfor_len = MAX_OID_LEN;
00516 
00517     build_oid_noalloc(searchfor, MAX_OID_LEN, &amp;searchfor_len, NULL, 0,
00518                       indexes);
00519     <span class="keywordflow">return</span> <a class="code" href=
"group__tdata.html#ga30">netsnmp_tdata_compare_oid</a>(row, searchfor, searchfor_len);
00520 }
00521 
00523 <span class="keywordtype">int</span>
<a name="l00524" id="l00524"></a><a class="code" href="group__tdata.html#ga30">00524</a> <a class="code" href=
"group__tdata.html#ga30">netsnmp_tdata_compare_oid</a>(netsnmp_tdata_row     *row,
00525                           oid * compareto, size_t compareto_len)
00526 {
00527     netsnmp_index *index = (netsnmp_index *)row;
00528     <span class="keywordflow">return</span> <a class="code" href=
"group__library.html#ga103">snmp_oid_compare</a>( index-&gt;oids, index-&gt;len,
00529                              compareto,   compareto_len);
00530 }
00531 
00532 <span class="keywordtype">int</span>
00533 netsnmp_tdata_compare_subtree_idx(netsnmp_tdata_row     *row,
00534                                   <a class="code" href="structvariable__list.html">netsnmp_variable_list</a> *indexes)
00535 {
00536     oid             searchfor[      MAX_OID_LEN];
00537     size_t          searchfor_len = MAX_OID_LEN;
00538 
00539     build_oid_noalloc(searchfor, MAX_OID_LEN, &amp;searchfor_len, NULL, 0,
00540                       indexes);
00541     <span class="keywordflow">return</span> netsnmp_tdata_compare_subtree_oid(row, searchfor, searchfor_len);
00542 }
00543 
00544 <span class="keywordtype">int</span>
00545 netsnmp_tdata_compare_subtree_oid(netsnmp_tdata_row     *row,
00546                                   oid * compareto, size_t compareto_len)
00547 {
00548     netsnmp_index *index = (netsnmp_index *)row;
00549     <span class="keywordflow">return</span> <a class="code" href=
"group__library.html#ga105">snmp_oidtree_compare</a>( index-&gt;oids, index-&gt;len,
00550                                  compareto,   compareto_len);
00551 }
00552 
00553 <span class="comment">/*</span>
00554 <span class="comment"> * @} </span>
00555 <span class="comment"> */</span>
</pre>
  </div>
  <hr size="1" />

  <address style="align: right;">
    <small>Generated on Fri Dec 30 13:47:51 2005 for net-snmp by&nbsp; <a href="http://www.doxygen.org/index.html"><img src=
    "doxygen.png" alt="doxygen" align="middle" border="0" /></a> 1.3.9.1</small>
  </address>
<!-- CONTENT END -->
<!--#include virtual="/page-bottom.html" -->

