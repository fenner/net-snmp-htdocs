<!--#set var="section" value="development" -->
<!--#include virtual="/page-top.html" -->
<!-- CONTENT START -->
  <!-- Generated by Doxygen 1.3.9.1 -->

  <div class="qindex">
    <a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class=
    "qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class=
    "qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a> | <a class=
    "qindex" href="examples.html">Examples</a>
  </div>

  <div class="nav">
    <a class="el" href="dir_000000.html">include</a>&nbsp;/&nbsp;<a class="el" href=
    "dir_000001.html">net-snmp</a>&nbsp;/&nbsp;<a class="el" href="dir_000006.html">library</a>
  </div>

  <h1>vacm.h</h1>

  <div class="fragment">
    <pre class="fragment">
00001 <span class="comment">/*</span>
00002 <span class="comment"> * vacm.h</span>
00003 <span class="comment"> *</span>
00004 <span class="comment"> * SNMPv3 View-based Access Control Model</span>
00005 <span class="comment"> */</span>
00006 
00007 <span class="preprocessor">#ifndef VACM_H</span>
00008 <span class="preprocessor">#define VACM_H</span>
00009 
00010 <span class="preprocessor">#ifdef __cplusplus</span>
00011 <span class="keyword">extern</span>          <span class="stringliteral">"C"</span> {
00012 <span class="preprocessor">#endif</span>
00013 
00014 <span class="preprocessor">#define VACM_SUCCESS       0</span>
00015 <span class="preprocessor">#define VACM_NOSECNAME     1</span>
00016 <span class="preprocessor">#define VACM_NOGROUP       2</span>
00017 <span class="preprocessor">#define VACM_NOACCESS      3</span>
00018 <span class="preprocessor">#define VACM_NOVIEW        4</span>
00019 <span class="preprocessor">#define VACM_NOTINVIEW     5</span>
00020 <span class="preprocessor">#define VACM_NOSUCHCONTEXT 6</span>
00021 <span class="preprocessor">#define VACM_SUBTREE_UNKNOWN 7</span>
00022 
00023 <span class="preprocessor">#define SECURITYMODEL   1</span>
00024 <span class="preprocessor">#define SECURITYNAME    2</span>
00025 <span class="preprocessor">#define SECURITYGROUP   3</span>
00026 <span class="preprocessor">#define SECURITYSTORAGE 4</span>
00027 <span class="preprocessor">#define SECURITYSTATUS  5</span>
00028 
00029 <span class="preprocessor">#define ACCESSPREFIX    1</span>
00030 <span class="preprocessor">#define ACCESSMODEL     2</span>
00031 <span class="preprocessor">#define ACCESSLEVEL     3</span>
00032 <span class="preprocessor">#define ACCESSMATCH     4</span>
00033 <span class="preprocessor">#define ACCESSREAD      5</span>
00034 <span class="preprocessor">#define ACCESSWRITE     6</span>
00035 <span class="preprocessor">#define ACCESSNOTIFY    7</span>
00036 <span class="preprocessor">#define ACCESSSTORAGE   8</span>
00037 <span class="preprocessor">#define ACCESSSTATUS    9</span>
00038 
00039 <span class="preprocessor">#define VACMVIEWSPINLOCK 1</span>
00040 <span class="preprocessor">#define VIEWNAME        2</span>
00041 <span class="preprocessor">#define VIEWSUBTREE     3</span>
00042 <span class="preprocessor">#define VIEWMASK        4</span>
00043 <span class="preprocessor">#define VIEWTYPE        5</span>
00044 <span class="preprocessor">#define VIEWSTORAGE     6</span>
00045 <span class="preprocessor">#define VIEWSTATUS      7</span>
00046 
00047 <span class="preprocessor">#define VACM_MAX_STRING 32</span>
00048 <span class="preprocessor">#define VACMSTRINGLEN   34      </span><span class="comment">/* VACM_MAX_STRING + 2 */</span>
00049 
00050     <span class="keyword">struct </span>vacm_groupEntry {
00051         <span class="keywordtype">int</span>             securityModel;
00052         <span class="keywordtype">char</span>            securityName[VACMSTRINGLEN];
00053         <span class="keywordtype">char</span>            groupName[VACMSTRINGLEN];
00054         <span class="keywordtype">int</span>             storageType;
00055         <span class="keywordtype">int</span>             status;
00056 
00057         u_long          bitMask;
00058         <span class="keyword">struct </span>vacm_groupEntry *reserved;
00059         <span class="keyword">struct </span>vacm_groupEntry *next;
00060     };
00061 
00062 <span class="preprocessor">#define CONTEXT_MATCH_EXACT  1</span>
00063 <span class="preprocessor">#define CONTEXT_MATCH_PREFIX 2</span>
00064 
00065 <span class="comment">/* VIEW ENUMS ---------------------------------------- */</span>
00066 
00067 <span class="comment">/* SNMPD usage: get/set/send-notification views */</span>
00068 <span class="preprocessor">#define VACM_VIEW_READ     0</span>
00069 <span class="preprocessor">#define VACM_VIEW_WRITE    1</span>
00070 <span class="preprocessor">#define VACM_VIEW_NOTIFY   2</span>
00071 
00072 <span class="comment">/* SNMPTRAPD usage: log execute and net-access (forward) usage */</span>
00073 <span class="preprocessor">#define VACM_VIEW_LOG      3</span>
00074 <span class="preprocessor">#define VACM_VIEW_EXECUTE  4</span>
00075 <span class="preprocessor">#define VACM_VIEW_NET      5</span>
00076 
00077 <span class="comment">/* VIEW BIT MASK VALUES-------------------------------- */</span>
00078 
00079 <span class="comment">/* SNMPD usage: get/set/send-notification views */</span>
00080 <span class="preprocessor">#define VACM_VIEW_READ_BIT      (1 &lt;&lt; VACM_VIEW_READ)</span>
00081 <span class="preprocessor">#define VACM_VIEW_WRITE_BIT     (1 &lt;&lt; VACM_VIEW_WRITE)</span>
00082 <span class="preprocessor">#define VACM_VIEW_NOTIFY_BIT    (1 &lt;&lt; VACM_VIEW_NOTIFY)</span>
00083 
00084 <span class="comment">/* SNMPTRAPD usage: log execute and net-access (forward) usage */</span>
00085 <span class="preprocessor">#define VACM_VIEW_LOG_BIT      (1 &lt;&lt; VACM_VIEW_LOG)</span>
00086 <span class="preprocessor">#define VACM_VIEW_EXECUTE_BIT  (1 &lt;&lt; VACM_VIEW_EXECUTE)</span>
00087 <span class="preprocessor">#define VACM_VIEW_NET_BIT      (1 &lt;&lt; VACM_VIEW_NET)</span>
00088     
00089 <span class="preprocessor">#define VACM_VIEW_NO_BITS      0</span>
00090 
00091 <span class="comment">/* Maximum number of views in the view array */</span>
00092 <span class="preprocessor">#define VACM_MAX_VIEWS     8</span>
00093 
00094 <span class="preprocessor">#define VACM_VIEW_ENUM_NAME "vacmviews"</span>
00095     
00096     <span class="keywordtype">void</span> init_vacm(<span class="keywordtype">void</span>);
00097     
00098     <span class="keyword">struct </span>vacm_accessEntry {
00099         <span class="keywordtype">char</span>            groupName[VACMSTRINGLEN];
00100         <span class="keywordtype">char</span>            contextPrefix[VACMSTRINGLEN];
00101         <span class="keywordtype">int</span>             securityModel;
00102         <span class="keywordtype">int</span>             securityLevel;
00103         <span class="keywordtype">int</span>             contextMatch;
00104         <span class="keywordtype">char</span>            views[VACM_MAX_VIEWS][VACMSTRINGLEN];
00105         <span class="keywordtype">int</span>             storageType;
00106         <span class="keywordtype">int</span>             status;
00107 
00108         u_long          bitMask;
00109         <span class="keyword">struct </span>vacm_accessEntry *reserved;
00110         <span class="keyword">struct </span>vacm_accessEntry *next;
00111     };
00112 
00113     <span class="keyword">struct </span>vacm_viewEntry {
00114         <span class="keywordtype">char</span>            viewName[VACMSTRINGLEN];
00115         oid             viewSubtree[MAX_OID_LEN];
00116         size_t          viewSubtreeLen;
00117         u_char          viewMask[VACMSTRINGLEN];
00118         size_t          viewMaskLen;
00119         <span class="keywordtype">int</span>             viewType;
00120         <span class="keywordtype">int</span>             viewStorageType;
00121         <span class="keywordtype">int</span>             viewStatus;
00122 
00123         u_long          bitMask;
00124 
00125         <span class="keyword">struct </span>vacm_viewEntry *reserved;
00126         <span class="keyword">struct </span>vacm_viewEntry *next;
00127     };
00128 
00129     <span class="keywordtype">void</span>            vacm_destroyViewEntry(<span class="keyword">const</span> <span class=
"keywordtype">char</span> *, oid *, size_t);
00130     <span class="keywordtype">void</span>            vacm_destroyAllViewEntries(<span class="keywordtype">void</span>);
00131 
00132 <span class="preprocessor">#define VACM_MODE_FIND                0</span>
00133 <span class="preprocessor">#define VACM_MODE_IGNORE_MASK         1</span>
00134 <span class="preprocessor">#define VACM_MODE_CHECK_SUBTREE       2</span>
00135     <span class="keyword">struct </span>vacm_viewEntry *vacm_getViewEntry(<span class="keyword">const</span> <span class=
"keywordtype">char</span> *, oid *, size_t,
00136                                              <span class="keywordtype">int</span>);
00137     <span class="comment">/*</span>
00138 <span class="comment">     * Returns a pointer to the viewEntry with the</span>
00139 <span class="comment">     * same viewName and viewSubtree</span>
00140 <span class="comment">     * Returns NULL if that entry does not exist.</span>
00141 <span class="comment">     */</span>
00142 
00143     <span class="keywordtype">int</span> vacm_checkSubtree(<span class="keyword">const</span> <span class=
"keywordtype">char</span> *, oid *, size_t);
00144 
00145     <span class="comment">/*</span>
00146 <span class="comment">     * Check to see if everything within a subtree is in view, not in view,</span>
00147 <span class="comment">     * or possibly both.</span>
00148 <span class="comment">     *</span>
00149 <span class="comment">     * Returns:</span>
00150 <span class="comment">     *   VACM_SUCCESS          The OID is included in the view.</span>
00151 <span class="comment">     *   VACM_NOTINVIEW        If no entry in the view list includes the</span>
00152 <span class="comment">     *                         provided OID, or the OID is explicitly excluded</span>
00153 <span class="comment">     *                         from the view. </span>
00154 <span class="comment">     *   VACM_SUBTREE_UNKNOWN  The entire subtree has both allowed and</span>
00155 <span class="comment">     *                         disallowed portions.</span>
00156 <span class="comment">     */</span>
00157 
00158     <span class="keywordtype">void</span>
00159                     vacm_scanViewInit(<span class="keywordtype">void</span>);
00160     <span class="comment">/*</span>
00161 <span class="comment">     * Initialized the scan routines so that they will begin at the</span>
00162 <span class="comment">     * beginning of the list of viewEntries.</span>
00163 <span class="comment">     *</span>
00164 <span class="comment">     */</span>
00165 
00166 
00167     <span class="keyword">struct </span>vacm_viewEntry *vacm_scanViewNext(<span class="keywordtype">void</span>);
00168     <span class="comment">/*</span>
00169 <span class="comment">     * Returns a pointer to the next viewEntry.</span>
00170 <span class="comment">     * These entries are returned in no particular order,</span>
00171 <span class="comment">     * but if N entries exist, N calls to view_scanNext() will</span>
00172 <span class="comment">     * return all N entries once.</span>
00173 <span class="comment">     * Returns NULL if all entries have been returned.</span>
00174 <span class="comment">     * view_scanInit() starts the scan over.</span>
00175 <span class="comment">     */</span>
00176 
00177     <span class="keyword">struct </span>vacm_viewEntry *vacm_createViewEntry(<span class=
"keyword">const</span> <span class="keywordtype">char</span> *, oid *,
00178                                                 size_t);
00179     <span class="comment">/*</span>
00180 <span class="comment">     * Creates a viewEntry with the given index</span>
00181 <span class="comment">     * and returns a pointer to it.</span>
00182 <span class="comment">     * The status of this entry is created as invalid.</span>
00183 <span class="comment">     */</span>
00184 
00185     <span class="keywordtype">void</span>            vacm_destroyGroupEntry(<span class=
"keywordtype">int</span>, <span class="keyword">const</span> <span class="keywordtype">char</span> *);
00186     <span class="keywordtype">void</span>            vacm_destroyAllGroupEntries(<span class="keywordtype">void</span>);
00187     <span class="keyword">struct </span>vacm_groupEntry *vacm_createGroupEntry(<span class=
"keywordtype">int</span>, <span class="keyword">const</span> <span class="keywordtype">char</span> *);
00188     <span class="keyword">struct </span>vacm_groupEntry *vacm_getGroupEntry(<span class=
"keywordtype">int</span>, <span class="keyword">const</span> <span class="keywordtype">char</span> *);
00189     <span class="keywordtype">void</span>            vacm_scanGroupInit(<span class="keywordtype">void</span>);
00190     <span class="keyword">struct </span>vacm_groupEntry *vacm_scanGroupNext(<span class="keywordtype">void</span>);
00191 
00192     <span class="keywordtype">void</span>            vacm_destroyAccessEntry(<span class=
"keyword">const</span> <span class="keywordtype">char</span> *, <span class="keyword">const</span> <span class=
"keywordtype">char</span> *,
00193                                             <span class="keywordtype">int</span>, <span class="keywordtype">int</span>);
00194     <span class="keywordtype">void</span>            vacm_destroyAllAccessEntries(<span class="keywordtype">void</span>);
00195     <span class="keyword">struct </span>vacm_accessEntry *vacm_createAccessEntry(<span class=
"keyword">const</span> <span class="keywordtype">char</span> *,
00196                                                     <span class="keyword">const</span> <span class=
"keywordtype">char</span> *, <span class="keywordtype">int</span>,
00197                                                     <span class="keywordtype">int</span>);
00198     <span class="keyword">struct </span>vacm_accessEntry *vacm_getAccessEntry(<span class=
"keyword">const</span> <span class="keywordtype">char</span> *,
00199                                                  <span class="keyword">const</span> <span class=
"keywordtype">char</span> *, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>);
00200     <span class="keywordtype">void</span>            vacm_scanAccessInit(<span class="keywordtype">void</span>);
00201     <span class="keyword">struct </span>vacm_accessEntry *vacm_scanAccessNext(<span class="keywordtype">void</span>);
00202 
00203     <span class="keywordtype">void</span>            vacm_destroySecurityEntry(<span class=
"keyword">const</span> <span class="keywordtype">char</span> *);
00204     <span class="keyword">struct </span>vacm_securityEntry *vacm_createSecurityEntry(<span class=
"keyword">const</span> <span class="keywordtype">char</span> *);
00205     <span class="keyword">struct </span>vacm_securityEntry *vacm_getSecurityEntry(<span class=
"keyword">const</span> <span class="keywordtype">char</span> *);
00206     <span class="keywordtype">void</span>            vacm_scanSecurityInit(<span class="keywordtype">void</span>);
00207     <span class="keyword">struct </span>vacm_securityEntry *vacm_scanSecurityEntry(<span class="keywordtype">void</span>);
00208     <span class="keywordtype">int</span>             vacm_is_configured(<span class="keywordtype">void</span>);
00209 
00210     <span class="keywordtype">void</span>            vacm_save(<span class="keyword">const</span> <span class=
"keywordtype">char</span> *token, <span class="keyword">const</span> <span class="keywordtype">char</span> *type);
00211     <span class="keywordtype">void</span>            vacm_save_view(<span class=
"keyword">struct</span> vacm_viewEntry *view,
00212                                    <span class="keyword">const</span> <span class=
"keywordtype">char</span> *token, <span class="keyword">const</span> <span class="keywordtype">char</span> *type);
00213     <span class="keywordtype">void</span>            vacm_save_access(<span class=
"keyword">struct</span> vacm_accessEntry *access_entry,
00214                                      <span class="keyword">const</span> <span class=
"keywordtype">char</span> *token, <span class="keyword">const</span> <span class="keywordtype">char</span> *type);
00215     <span class="keywordtype">void</span>            vacm_save_group(<span class=
"keyword">struct</span> vacm_groupEntry *group_entry,
00216                                     <span class="keyword">const</span> <span class=
"keywordtype">char</span> *token, <span class="keyword">const</span> <span class="keywordtype">char</span> *type);
00217 
00218     <span class="keywordtype">void</span>            vacm_parse_config_view(<span class="keyword">const</span> <span class=
"keywordtype">char</span> *token, <span class="keywordtype">char</span> *line);
00219     <span class="keywordtype">void</span>            vacm_parse_config_group(<span class=
"keyword">const</span> <span class="keywordtype">char</span> *token, <span class="keywordtype">char</span> *line);
00220     <span class="keywordtype">void</span>            vacm_parse_config_access(<span class=
"keyword">const</span> <span class="keywordtype">char</span> *token,
00221                                              <span class="keywordtype">char</span> *line);
00222 
00223     <span class="keywordtype">int</span>             store_vacm(<span class="keywordtype">int</span> majorID, <span class=
"keywordtype">int</span> minorID, <span class="keywordtype">void</span> *serverarg,
00224                                <span class="keywordtype">void</span> *clientarg);
00225 
00226     <span class="keyword">struct </span>vacm_viewEntry *netsnmp_view_get(<span class=
"keyword">struct</span> vacm_viewEntry *head,
00227                                             <span class="keyword">const</span> <span class=
"keywordtype">char</span> *viewName,
00228                                             oid * viewSubtree,
00229                                             size_t viewSubtreeLen, <span class="keywordtype">int</span> mode);
00230 
00231 
00232 <span class="preprocessor">#ifdef __cplusplus</span>
00233 }
00234 <span class="preprocessor">#endif</span>
00235 <span class="preprocessor">#endif                          </span><span class="comment">/* VACM_H */</span>
</pre>
  </div>
  <hr size="1" />

  <address style="align: right;">
    <small>Generated on Fri Dec 30 13:47:51 2005 for net-snmp by&nbsp; <a href="http://www.doxygen.org/index.html"><img src=
    "doxygen.png" alt="doxygen" align="middle" border="0" /></a> 1.3.9.1</small>
  </address>
<!-- CONTENT END -->
<!--#include virtual="/page-bottom.html" -->

