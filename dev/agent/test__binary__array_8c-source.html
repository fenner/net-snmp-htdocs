<!--#set var="section" value="development" -->
<!--#include virtual="/page-top.html" -->
<!-- CONTENT START -->
  <!-- Generated by Doxygen 1.3.9.1 -->

  <div class="qindex">
    <a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class=
    "qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class=
    "qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a> | <a class=
    "qindex" href="examples.html">Examples</a>
  </div>

  <div class="nav">
    <a class="el" href="dir_000005.html">snmplib</a>
  </div>

  <h1>test_binary_array.c</h1>

  <div class="fragment">
    <pre class="fragment">
00001 <span class="preprocessor">#include &lt;net-snmp/net-snmp-config.h&gt;</span>
00002 
00003 <span class="preprocessor">#if HAVE_IO_H</span>
00004 <span class="preprocessor">#include &lt;io.h&gt;</span>
00005 <span class="preprocessor">#endif</span>
00006 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
00007 <span class="preprocessor">#if HAVE_STDLIB_H</span>
00008 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
00009 <span class="preprocessor">#endif</span>
00010 <span class="preprocessor">#if HAVE_MALLOC_H</span>
00011 <span class="preprocessor">#include &lt;malloc.h&gt;</span>
00012 <span class="preprocessor">#endif</span>
00013 <span class="preprocessor">#include &lt;sys/types.h&gt;</span>
00014 <span class="preprocessor">#if HAVE_STRING_H</span>
00015 <span class="preprocessor">#include &lt;string.h&gt;</span>
00016 <span class="preprocessor">#else</span>
00017 <span class="preprocessor">#include &lt;strings.h&gt;</span>
00018 <span class="preprocessor">#endif</span>
00019 
00020 <span class="preprocessor">#include &lt;net-snmp/net-snmp-includes.h&gt;</span>
00021 <span class="preprocessor">#include &lt;net-snmp/types.h&gt;</span>
00022 <span class="preprocessor">#include &lt;net-snmp/library/snmp_api.h&gt;</span>
00023 <span class="preprocessor">#include &lt;net-snmp/library/container.h&gt;</span>
00024 <span class="preprocessor">#include &lt;net-snmp/library/container_binary_array.h&gt;</span>
00025 <span class="preprocessor">#include &lt;net-snmp/library/tools.h&gt;</span>
00026 <span class="preprocessor">#include &lt;net-snmp/library/snmp_assert.h&gt;</span>
00027 
00028 <span class="preprocessor">#define TEST_SIZE 7</span>
00029 
00030 <span class="keywordtype">void</span>
00031 print_int(netsnmp_index *i, <span class="keywordtype">void</span> *v)
00032 {
00033     printf(<span class="stringliteral">"item %p = %ld\n"</span>, i, i-&gt;oids[0]);
00034 }
00035 
00036 <span class="keywordtype">int</span>
00037 test_int(<span class="keywordtype">void</span>)
00038 {
00039     oid o1 = 1;
00040     oid o2 = 2;
00041     oid o3 = 6;
00042     oid o4 = 8;
00043     oid o5 = 9;
00044     oid ox = 7;
00045     oid oy = 10;
00046     netsnmp_index i1,i2,i3,i4,i5,ix,iy, *ip;
00047     netsnmp_index *a[TEST_SIZE] = { &amp;i1, &amp;i2, &amp;i3, &amp;ix, &amp;i4, &amp;i5, &amp;iy };
00048     netsnmp_container *c = netsnmp_container_get_binary_array();
00049     <span class="keywordtype">int</span> i;
00050 
00051     c-&gt;compare = netsnmp_compare_netsnmp_index;
00052     
00053     i1.oids = &amp;o1;
00054     i2.oids = &amp;o2;
00055     i3.oids = &amp;o3;
00056     i4.oids = &amp;o4;
00057     i5.oids = &amp;o5;
00058     ix.oids = &amp;ox;
00059     iy.oids = &amp;oy;
00060     i1.len = i2.len = i3.len = i4.len = i5.len = ix.len = iy.len = 1;
00061 
00062     printf(<span class="stringliteral">"Creating container...\n"</span>);
00063 
00064     printf(<span class="stringliteral">"Inserting data...\n"</span>);
00065     CONTAINER_INSERT(c,&amp;i4);
00066     CONTAINER_INSERT(c,&amp;i2);
00067     CONTAINER_INSERT(c,&amp;i3);
00068     CONTAINER_INSERT(c,&amp;i1);
00069     CONTAINER_INSERT(c,&amp;i5);
00070 
00071     printf(<span class="stringliteral">"For each...\n"</span>);
00072     CONTAINER_FOR_EACH(c, print_int, NULL);
00073     printf(<span class="stringliteral">"Done.\n"</span>);
00074 
00075     printf(<span class="stringliteral">"\n"</span>);
00076     ip = CONTAINER_FIRST(c);
00077     printf(<span class="stringliteral">"Find first = %p %ld\n"</span>,ip, ip-&gt;oids[0]);
00078     <span class="keywordflow">while</span>( ip ) {
00079         ip = CONTAINER_NEXT(c,ip);
00080         <span class="keywordflow">if</span>(ip)
00081             printf(<span class="stringliteral">"Find next = %p %ld\n"</span>,ip, ip-&gt;oids[0]);
00082         <span class="keywordflow">else</span>
00083             printf(<span class="stringliteral">"Find next = %s\n"</span>,ip);
00084     }
00085 
00086     <span class="keywordflow">for</span>( i=0; i &lt; TEST_SIZE; ++i) {
00087         printf(<span class="stringliteral">"\n"</span>);
00088         ip = CONTAINER_FIND(c,a[i]);
00089         printf(<span class="stringliteral">"Find %ld = %p %ld\n"</span>, a[i]-&gt;oids[0], ip, ip ? ip-&gt;oids[0] : 0);
00090         ip = CONTAINER_NEXT(c,a[i]);
00091         printf(<span class="stringliteral">"Next %ld = %p %ld\n"</span>, a[i]-&gt;oids[0], ip, ip ? ip-&gt;oids[0] : 0);
00092     }
00093 
00094     printf(<span class="stringliteral">"Done.\n"</span>);
00095 
00096     <span class="keywordflow">return</span> 0;
00097 }
00098 
00099 <span class="keywordtype">void</span>
00100 print_string(<span class="keywordtype">char</span> *i, <span class="keywordtype">void</span> *v)
00101 {
00102     printf(<span class="stringliteral">"item %s\n"</span>, i);
00103 }
00104 
00105 <span class="keywordtype">int</span>
00106 my_strcmp(<span class="keywordtype">char</span> *lhs, <span class="keywordtype">char</span> *rhs)
00107 {
00108     <span class="keywordtype">int</span> rc = strcmp(lhs,rhs);
00109 <span class="comment">/*      printf("%s %d %s\n",lhs, rc, rhs); */</span>
00110     <span class="keywordflow">return</span> rc;
00111 }
00112 
00113 <span class="keywordtype">int</span>
00114 test_string()
00115 {
00116     <span class="keyword">const</span> <span class="keywordtype">char</span> *o1 = <span class=
"stringliteral">"zebra"</span>;
00117     <span class="keyword">const</span> <span class="keywordtype">char</span> *o2 = <span class=
"stringliteral">"b-two"</span>;
00118     <span class="keyword">const</span> <span class="keywordtype">char</span> *o3 = <span class="stringliteral">"b"</span>;
00119     <span class="keyword">const</span> <span class="keywordtype">char</span> *o4 = <span class=
"stringliteral">"cedar"</span>;
00120     <span class="keyword">const</span> <span class="keywordtype">char</span> *o5 = <span class=
"stringliteral">"alpha"</span>;
00121     <span class="keyword">const</span> <span class="keywordtype">char</span> *ox = <span class=
"stringliteral">"dev"</span>;
00122     <span class="keyword">const</span> <span class="keywordtype">char</span> *oy = <span class="stringliteral">"aa"</span>;
00123     <span class="keyword">const</span> <span class="keywordtype">char</span> * ip;
00124     
00125     <span class="keyword">const</span> <span class=
"keywordtype">char</span> *a[TEST_SIZE] = { o1, o2, o3, ox, o4, o5, oy };
00126     netsnmp_container *c = netsnmp_container_get_binary_array();
00127     <span class="keywordtype">int</span> i;
00128 
00129     c-&gt;compare = my_strcmp;
00130     
00131     printf(<span class="stringliteral">"Creating container...\n"</span>);
00132 
00133     printf(<span class="stringliteral">"Inserting data...\n"</span>);
00134     CONTAINER_INSERT(c,o4);
00135     CONTAINER_INSERT(c,o2);
00136     CONTAINER_INSERT(c,o3);
00137     CONTAINER_INSERT(c,o1);
00138     CONTAINER_INSERT(c,o5);
00139     printf(<span class="stringliteral">"\n"</span>);
00140     printf(<span class="stringliteral">"For each...\n"</span>);
00141     CONTAINER_FOR_EACH(c, print_string, NULL);
00142     printf(<span class="stringliteral">"Done.\n"</span>);
00143 
00144     printf(<span class="stringliteral">"\n"</span>);
00145     ip = CONTAINER_FIRST(c);
00146     printf(<span class="stringliteral">"Find first = %s\n"</span>,ip);
00147     <span class="keywordflow">while</span>( ip ) {
00148         ip = CONTAINER_NEXT(c,ip);
00149         printf(<span class="stringliteral">"Find next = %s\n"</span>,ip);
00150     }
00151 
00152     <span class="keywordflow">for</span>( i=0; i &lt; TEST_SIZE; ++i) {
00153         printf(<span class="stringliteral">"\n"</span>);
00154         ip = CONTAINER_FIND(c,a[i]);
00155         printf(<span class="stringliteral">"Find %s = %s\n"</span>, a[i], ip);
00156         ip = CONTAINER_NEXT(c,a[i]);
00157         printf(<span class="stringliteral">"Next %s = %s\n"</span>, a[i], ip);
00158     }
00159 
00160     printf(<span class="stringliteral">"Done.\n"</span>);
00161 
00162     <span class="keywordflow">return</span> 0;
00163 }
00164 
00165 <span class="keywordtype">int</span>
00166 main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv)
00167 {
00168 
00169     test_int();
00170     test_string();
00171 }
</pre>
  </div>
  <hr size="1" />

  <address style="align: right;">
    <small>Generated on Fri Dec 30 13:47:51 2005 for net-snmp by&nbsp; <a href="http://www.doxygen.org/index.html"><img src=
    "doxygen.png" alt="doxygen" align="middle" border="0" /></a> 1.3.9.1</small>
  </address>
<!-- CONTENT END -->
<!--#include virtual="/page-bottom.html" -->

