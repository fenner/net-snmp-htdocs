<!--#set var="section" value="development" -->
<!--#include virtual="/page-top.html" -->
<!-- CONTENT START -->
  <!-- Generated by Doxygen 1.3.9.1 -->

  <div class="qindex">
    <a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class=
    "qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class=
    "qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a> | <a class=
    "qindex" href="examples.html">Examples</a>
  </div>

  <div class="nav">
    <a class="el" href="dir_000003.html">agent</a>&nbsp;/&nbsp;<a class="el" href="dir_000004.html">helpers</a>
  </div>

  <h1>table_array.c</h1>

  <div class="fragment">
    <pre class="fragment">
00001 <span class="comment">/*</span>
00002 <span class="comment"> * table_array.c</span>
00003 <span class="comment"> * $Id$</span>
00004 <span class="comment"> */</span>
00005 
00006 <span class="preprocessor">#include &lt;net-snmp/net-snmp-config.h&gt;</span>
00007 
00008 <span class="preprocessor">#if HAVE_STRING_H</span>
00009 <span class="preprocessor">#include &lt;string.h&gt;</span>
00010 <span class="preprocessor">#else</span>
00011 <span class="preprocessor">#include &lt;strings.h&gt;</span>
00012 <span class="preprocessor">#endif</span>
00013 
00014 <span class="preprocessor">#include &lt;net-snmp/net-snmp-includes.h&gt;</span>
00015 <span class="preprocessor">#include &lt;net-snmp/agent/net-snmp-agent-includes.h&gt;</span>
00016 
00017 <span class="preprocessor">#include &lt;net-snmp/agent/table.h&gt;</span>
00018 <span class="preprocessor">#include &lt;net-snmp/agent/table_array.h&gt;</span>
00019 <span class="preprocessor">#include &lt;net-snmp/library/container.h&gt;</span>
00020 <span class="preprocessor">#include &lt;net-snmp/library/snmp_assert.h&gt;</span>
00021 
00022 <span class="comment">/*</span>
00023 <span class="comment"> * snmp.h:#define SNMP_MSG_INTERNAL_SET_BEGIN        -1 </span>
00024 <span class="comment"> * snmp.h:#define SNMP_MSG_INTERNAL_SET_RESERVE1     0 </span>
00025 <span class="comment"> * snmp.h:#define SNMP_MSG_INTERNAL_SET_RESERVE2     1 </span>
00026 <span class="comment"> * snmp.h:#define SNMP_MSG_INTERNAL_SET_ACTION       2 </span>
00027 <span class="comment"> * snmp.h:#define SNMP_MSG_INTERNAL_SET_COMMIT       3 </span>
00028 <span class="comment"> * snmp.h:#define SNMP_MSG_INTERNAL_SET_FREE         4 </span>
00029 <span class="comment"> * snmp.h:#define SNMP_MSG_INTERNAL_SET_UNDO         5 </span>
00030 <span class="comment"> */</span>
00031 
00032 <span class="keyword">static</span> <span class="keyword">const</span> <span class=
"keywordtype">char</span> *mode_name[] = {
00033     <span class="stringliteral">"Reserve 1"</span>,
00034     <span class="stringliteral">"Reserve 2"</span>,
00035     <span class="stringliteral">"Action"</span>,
00036     <span class="stringliteral">"Commit"</span>,
00037     <span class="stringliteral">"Free"</span>,
00038     <span class="stringliteral">"Undo"</span>
00039 };
00040 
00041 <span class="comment">/*</span>
00042 <span class="comment"> * PRIVATE structure for holding important info for each table.</span>
00043 <span class="comment"> */</span>
00044 <span class="keyword">typedef</span> <span class="keyword">struct </span>table_container_data_s {
00045 
00047     <a class="code" href=
"structnetsnmp__table__registration__info__s.html">netsnmp_table_registration_info</a> *tblreg_info;
00048 
00050    netsnmp_container          *table;
00051 
00052     <span class="comment">/*</span>
00053 <span class="comment">     * mutex_type                lock;</span>
00054 <span class="comment">     */</span>
00055 
00058     <span class="keywordtype">int</span>             group_rows;
00059 
00061     netsnmp_table_array_callbacks *cb;
00062 
00063 } table_container_data;
00064 
00133 <span class="comment">/**********************************************************************</span>
00134 <span class="comment"> **********************************************************************</span>
00135 <span class="comment"> *                                                                    *</span>
00136 <span class="comment"> *                                                                    *</span>
00137 <span class="comment"> * PUBLIC Registration functions                                      *</span>
00138 <span class="comment"> *                                                                    *</span>
00139 <span class="comment"> *                                                                    *</span>
00140 <span class="comment"> **********************************************************************</span>
00141 <span class="comment"> **********************************************************************/</span>
00147 <span class="keywordtype">int</span>
<a name="l00148" id="l00148"></a><a class="code" href="group__table__array.html#ga0">00148</a> <a class="code" href=
"group__table__array.html#ga0">netsnmp_table_container_register</a>(<a class="code" href=
"structnetsnmp__handler__registration__s.html">netsnmp_handler_registration</a> *reginfo,
00149                              <a class="code" href=
"structnetsnmp__table__registration__info__s.html">netsnmp_table_registration_info</a> *tabreg,
00150                              netsnmp_table_array_callbacks *cb,
00151                              netsnmp_container *container,
00152                              <span class="keywordtype">int</span> group_rows)
00153 {
00154     table_container_data *tad = <a class="code" href="group__util.html#ga39">SNMP_MALLOC_TYPEDEF</a>(table_container_data);
00155     <span class="keywordflow">if</span> (!tad)
00156         <span class="keywordflow">return</span> SNMPERR_GENERR;
00157     tad-&gt;tblreg_info = tabreg;  <span class="comment">/* we need it too, but it really is not ours */</span>
00158 
00159     <span class="keywordflow">if</span> (!cb) {
00160         <a class="code" href="group__snmp__logging.html#ga41">snmp_log</a>(LOG_ERR, <span class=
"stringliteral">"table_array registration with no callbacks\n"</span> );
00161         <span class="keywordflow">return</span> SNMPERR_GENERR;
00162     }
00163     <span class="comment">/*</span>
00164 <span class="comment">     * check for required callbacks</span>
00165 <span class="comment">     */</span>
00166     <span class="keywordflow">if</span> ((cb-&gt;can_set &amp;&amp;
00167          ((NULL==cb-&gt;duplicate_row) || (NULL==cb-&gt;delete_row) ||
00168           (NULL==cb-&gt;row_copy)) )) {
00169         <a class="code" href="group__snmp__logging.html#ga41">snmp_log</a>(LOG_ERR, <span class=
"stringliteral">"table_array registration with incomplete "</span>
00170                  <span class="stringliteral">"callback structure.\n"</span>);
00171         <span class="keywordflow">return</span> SNMPERR_GENERR;
00172     }
00173 
00174     <span class="keywordflow">if</span> (NULL==container)
00175         tad-&gt;table = netsnmp_container_find(<span class="stringliteral">"table_array"</span>);
00176     <span class="keywordflow">else</span>
00177         tad-&gt;table = container;
00178     <span class="keywordflow">if</span> (NULL==container-&gt;compare)
00179         container-&gt;compare = netsnmp_compare_netsnmp_index;
00180     <span class="keywordflow">if</span> (NULL==container-&gt;ncompare)
00181         container-&gt;ncompare = netsnmp_ncompare_netsnmp_index;
00182     
00183     tad-&gt;cb = cb;
00184 
00185     reginfo-&gt;<a class="code" href="structnetsnmp__handler__registration__s.html#o4">handler</a>-&gt;<a class="code"
href="structnetsnmp__mib__handler__s.html#o1">myvoid</a> = tad;
00186 
00187     <span class="keywordflow">return</span> <a class="code" href=
"group__table.html#ga1">netsnmp_register_table</a>(reginfo, tabreg);
00188 }
00189 
00190 <span class="keywordtype">int</span>
00191 netsnmp_table_array_register(<a class="code" href=
"structnetsnmp__handler__registration__s.html">netsnmp_handler_registration</a> *reginfo,
00192                              <a class="code" href=
"structnetsnmp__table__registration__info__s.html">netsnmp_table_registration_info</a> *tabreg,
00193                              netsnmp_table_array_callbacks *cb,
00194                              netsnmp_container *container,
00195                              <span class="keywordtype">int</span> group_rows)
00196 {
00197     <a class="code" href="group__handler.html#ga14">netsnmp_inject_handler</a>(reginfo,
00198                            <a class="code" href="group__handler.html#ga7">netsnmp_create_handler</a>(reginfo-&gt;<a class=
"code" href="structnetsnmp__handler__registration__s.html#o0">handlerName</a>,
00199                                netsnmp_table_array_helper_handler));
00200     <span class="keywordflow">return</span> <a class="code" href=
"group__table__array.html#ga0">netsnmp_table_container_register</a>(reginfo, tabreg, cb,
00201                                             container, group_rows);
00202 }
00203 
00205 <a class="code" href="structnetsnmp__mib__handler__s.html">netsnmp_mib_handler</a> *
<a name="l00206" id="l00206"></a><a class="code" href="group__table__array.html#ga2">00206</a> <a class="code" href=
"group__table__array.html#ga2">netsnmp_find_table_array_handler</a>(<a class="code" href=
"structnetsnmp__handler__registration__s.html">netsnmp_handler_registration</a> *reginfo)
00207 {
00208     <a class="code" href="structnetsnmp__mib__handler__s.html">netsnmp_mib_handler</a> *mh;
00209     <span class="keywordflow">if</span> (!reginfo)
00210         <span class="keywordflow">return</span> NULL;
00211     mh = reginfo-&gt;<a class="code" href="structnetsnmp__handler__registration__s.html#o4">handler</a>;
00212     <span class="keywordflow">while</span> (mh) {
00213         <span class="keywordflow">if</span> (mh-&gt;<a class="code" href=
"structnetsnmp__mib__handler__s.html#o3">access_method</a> == netsnmp_table_array_helper_handler)
00214             <span class="keywordflow">break</span>;
00215         mh = mh-&gt;<a class="code" href="structnetsnmp__mib__handler__s.html#o4">next</a>;
00216     }
00217 
00218     <span class="keywordflow">return</span> mh;
00219 }
00220 
00222 netsnmp_container      *
<a name="l00223" id="l00223"></a><a class="code" href="group__table__array.html#ga3">00223</a> <a class="code" href=
"group__table__array.html#ga3">netsnmp_extract_array_context</a>(<a class="code" href=
"structnetsnmp__request__info__s.html">netsnmp_request_info</a> *request)
00224 {
00225     <span class="keywordflow">return</span> <a class="code" href=
"group__handler.html#ga29">netsnmp_request_get_list_data</a>(request, TABLE_ARRAY_NAME);
00226 }
00227 
00229 <span class="keywordtype">int</span>
<a name="l00230" id="l00230"></a><a class="code" href="group__table__array.html#ga4">00230</a> <a class="code" href=
"group__table__array.html#ga4">netsnmp_table_array_check_row_status</a>(netsnmp_table_array_callbacks *cb,
00231                                      netsnmp_request_group *ag,
00232                                      <span class="keywordtype">long</span> *rs_new, <span class=
"keywordtype">long</span> *rs_old)
00233 {
00234     netsnmp_index *row_ctx;
00235     netsnmp_index *undo_ctx;
00236     <span class="keywordflow">if</span> (!ag || !cb)
00237         <span class="keywordflow">return</span> SNMPERR_GENERR;
00238     row_ctx  = ag-&gt;existing_row;
00239     undo_ctx = ag-&gt;undo_info;
00240     
00241     <span class="comment">/*</span>
00242 <span class="comment">     * xxx-rks: revisit row delete scenario</span>
00243 <span class="comment">     */</span>
00244     <span class="keywordflow">if</span> (row_ctx) {
00245         <span class="comment">/*</span>
00246 <span class="comment">         * either a new row, or change to old row</span>
00247 <span class="comment">         */</span>
00248         <span class="comment">/*</span>
00249 <span class="comment">         * is it set to active?</span>
00250 <span class="comment">         */</span>
00251         <span class="keywordflow">if</span> (RS_IS_GOING_ACTIVE(*rs_new)) {
00252             <span class="comment">/*</span>
00253 <span class="comment">             * is it ready to be active?</span>
00254 <span class="comment">             */</span>
00255             <span class="keywordflow">if</span> ((NULL==cb-&gt;can_activate) ||
00256                 cb-&gt;can_activate(undo_ctx, row_ctx, ag))
00257                 *rs_new = RS_ACTIVE;
00258             <span class="keywordflow">else</span>
00259                 <span class="keywordflow">return</span> SNMP_ERR_INCONSISTENTVALUE;
00260         } <span class="keywordflow">else</span> {
00261             <span class="comment">/*</span>
00262 <span class="comment">             * not going active</span>
00263 <span class="comment">             */</span>
00264             <span class="keywordflow">if</span> (undo_ctx) {
00265                 <span class="comment">/*</span>
00266 <span class="comment">                 * change</span>
00267 <span class="comment">                 */</span>
00268                 <span class="keywordflow">if</span> (RS_IS_ACTIVE(*rs_old)) {
00269                     <span class="comment">/*</span>
00270 <span class="comment">                     * check pre-reqs for deactivation</span>
00271 <span class="comment">                     */</span>
00272                     <span class="keywordflow">if</span> (cb-&gt;can_deactivate &amp;&amp;
00273                         !cb-&gt;can_deactivate(undo_ctx, row_ctx, ag)) {
00274                         <span class="keywordflow">return</span> SNMP_ERR_INCONSISTENTVALUE;
00275                     }
00276                 }
00277             } <span class="keywordflow">else</span> {
00278                 <span class="comment">/*</span>
00279 <span class="comment">                 * new row</span>
00280 <span class="comment">                 */</span>
00281             }
00282 
00283             <span class="keywordflow">if</span> (*rs_new != RS_DESTROY) {
00284                 <span class="keywordflow">if</span> ((NULL==cb-&gt;can_activate) ||
00285                     cb-&gt;can_activate(undo_ctx, row_ctx, ag))
00286                     *rs_new = RS_NOTINSERVICE;
00287                 <span class="keywordflow">else</span>
00288                     *rs_new = RS_NOTREADY;
00289             } <span class="keywordflow">else</span> {
00290                 <span class=
"keywordflow">if</span> (cb-&gt;can_delete &amp;&amp; !cb-&gt;can_delete(undo_ctx, row_ctx, ag)) {
00291                     <span class="keywordflow">return</span> SNMP_ERR_INCONSISTENTVALUE;
00292                 }
00293                 ag-&gt;row_deleted = 1;
00294             }
00295         }
00296     } <span class="keywordflow">else</span> {
00297         <span class="comment">/*</span>
00298 <span class="comment">         * check pre-reqs for delete row</span>
00299 <span class="comment">         */</span>
00300         <span class="keywordflow">if</span> (cb-&gt;can_delete &amp;&amp; !cb-&gt;can_delete(undo_ctx, row_ctx, ag)) {
00301             <span class="keywordflow">return</span> SNMP_ERR_INCONSISTENTVALUE;
00302         }
00303     }
00304 
00305     <span class="keywordflow">return</span> SNMP_ERR_NOERROR;
00306 }
00307 
00310 <span class="preprocessor">#ifndef DOXYGEN_SHOULD_SKIP_THIS</span>
00311 <span class="comment">/**********************************************************************</span>
00312 <span class="comment"> **********************************************************************</span>
00313 <span class="comment"> **********************************************************************</span>
00314 <span class="comment"> **********************************************************************</span>
00315 <span class="comment"> *                                                                    *</span>
00316 <span class="comment"> *                                                                    *</span>
00317 <span class="comment"> *                                                                    *</span>
00318 <span class="comment"> *                                                                    *</span>
00319 <span class="comment"> * EVERYTHING BELOW THIS IS PRIVATE IMPLEMENTATION DETAILS.           *</span>
00320 <span class="comment"> *                                                                    *</span>
00321 <span class="comment"> *                                                                    *</span>
00322 <span class="comment"> *                                                                    *</span>
00323 <span class="comment"> *                                                                    *</span>
00324 <span class="comment"> **********************************************************************</span>
00325 <span class="comment"> **********************************************************************</span>
00326 <span class="comment"> **********************************************************************</span>
00327 <span class="comment"> **********************************************************************/</span>
00328 
00329 <span class="comment">/**********************************************************************</span>
00330 <span class="comment"> **********************************************************************</span>
00331 <span class="comment"> *                                                                    *</span>
00332 <span class="comment"> *                                                                    *</span>
00333 <span class="comment"> * Structures, Utility/convenience functions                          *</span>
00334 <span class="comment"> *                                                                    *</span>
00335 <span class="comment"> *                                                                    *</span>
00336 <span class="comment"> **********************************************************************</span>
00337 <span class="comment"> **********************************************************************/</span>
00338 <span class="comment">/*</span>
00339 <span class="comment"> * context info for SET requests</span>
00340 <span class="comment"> */</span>
00341 <span class="keyword">typedef</span> <span class="keyword">struct </span>set_context_s {
00342     <a class="code" href="structnetsnmp__agent__request__info__s.html">netsnmp_agent_request_info</a> *agtreq_info;
00343     table_container_data *tad;
00344     <span class="keywordtype">int</span>             status;
00345 } set_context;
00346 
00347 <span class="keyword">static</span> <span class="keywordtype">void</span>
00348 release_netsnmp_request_group(netsnmp_index *g, <span class="keywordtype">void</span> *v)
00349 {
00350     netsnmp_request_group_item *tmp;
00351     netsnmp_request_group *group = (netsnmp_request_group *) g;
00352 
00353     <span class="keywordflow">if</span> (!g)
00354         <span class="keywordflow">return</span>;
00355     <span class="keywordflow">while</span> (group-&gt;list) {
00356         tmp = group-&gt;list;
00357         group-&gt;list = tmp-&gt;<a class="code" href="structnetsnmp__mib__handler__s.html#o4">next</a>;
00358         free(tmp);
00359     }
00360 
00361     free(group);
00362 }
00363 
00364 <span class="keyword">static</span> <span class="keywordtype">void</span>
00365 release_netsnmp_request_groups(<span class="keywordtype">void</span> *vp)
00366 {
00367     netsnmp_container *c = (netsnmp_container*)vp;
00368     CONTAINER_FOR_EACH(c, (netsnmp_container_obj_func*)
00369                        release_netsnmp_request_group, NULL);
00370     CONTAINER_FREE(c);
00371 }
00372 
00373 <span class="keywordtype">void</span>
00374 build_new_oid(<a class="code" href=
"structnetsnmp__handler__registration__s.html">netsnmp_handler_registration</a> *reginfo,
00375               <a class="code" href=
"structnetsnmp__table__request__info__s.html">netsnmp_table_request_info</a> *tblreq_info,
00376               netsnmp_index *row, <a class="code" href=
"structnetsnmp__request__info__s.html">netsnmp_request_info</a> *current)
00377 {
00378     oid             coloid[MAX_OID_LEN];
00379     <span class="keywordtype">int</span>             coloid_len;
00380 
00381     <span class="keywordflow">if</span> (!tblreq_info || !reginfo || !row || !current)
00382         <span class="keywordflow">return</span>;
00383 
00384     coloid_len = reginfo-&gt;<a class="code" href="structnetsnmp__handler__registration__s.html#o3">rootoid_len</a> + 2;
00385     memcpy(coloid, reginfo-&gt;<a class="code" href=
"structnetsnmp__handler__registration__s.html#o2">rootoid</a>, reginfo-&gt;<a class="code" href=
"structnetsnmp__handler__registration__s.html#o3">rootoid_len</a> * <span class="keyword">sizeof</span>(oid));
00386 
00388     coloid[reginfo-&gt;<a class="code" href="structnetsnmp__handler__registration__s.html#o3">rootoid_len</a>] = 1;
00389 
00391     coloid[reginfo-&gt;<a class="code" href=
"structnetsnmp__handler__registration__s.html#o3">rootoid_len</a> + 1] = tblreq_info-&gt;<a class="code" href=
"structnetsnmp__table__request__info__s.html#o0">colnum</a>;
00392 
00394     memcpy(&amp;coloid[reginfo-&gt;<a class="code" href=
"structnetsnmp__handler__registration__s.html#o3">rootoid_len</a> + 2], row-&gt;oids,
00395            row-&gt;len * <span class="keyword">sizeof</span>(oid));
00396 
00397     snmp_set_var_objid(current-&gt;<a class="code" href="structnetsnmp__request__info__s.html#o0">requestvb</a>, coloid,
00398                        reginfo-&gt;<a class="code" href=
"structnetsnmp__handler__registration__s.html#o3">rootoid_len</a> + 2 + row-&gt;len);
00399 }
00400 
00401 <span class="comment">/**********************************************************************</span>
00402 <span class="comment"> **********************************************************************</span>
00403 <span class="comment"> *                                                                    *</span>
00404 <span class="comment"> *                                                                    *</span>
00405 <span class="comment"> * GET procession functions                                           *</span>
00406 <span class="comment"> *                                                                    *</span>
00407 <span class="comment"> *                                                                    *</span>
00408 <span class="comment"> **********************************************************************</span>
00409 <span class="comment"> **********************************************************************/</span>
00410 <span class="keywordtype">int</span>
00411 process_get_requests(<a class="code" href=
"structnetsnmp__handler__registration__s.html">netsnmp_handler_registration</a> *reginfo,
00412                      <a class="code" href=
"structnetsnmp__agent__request__info__s.html">netsnmp_agent_request_info</a> *agtreq_info,
00413                      <a class="code" href="structnetsnmp__request__info__s.html">netsnmp_request_info</a> *requests,
00414                      table_container_data * tad)
00415 {
00416     <span class="keywordtype">int</span>             rc = SNMP_ERR_NOERROR;
00417     <a class="code" href="structnetsnmp__request__info__s.html">netsnmp_request_info</a> *current;
00418     netsnmp_index *row = NULL;
00419     <a class="code" href="structnetsnmp__table__request__info__s.html">netsnmp_table_request_info</a> *tblreq_info;
00420     <a class="code" href="structvariable__list.html">netsnmp_variable_list</a> *var;
00421 
00422     <span class="comment">/*</span>
00423 <span class="comment">     * Loop through each of the requests, and</span>
00424 <span class="comment">     * try to find the appropriate row from the container.</span>
00425 <span class="comment">     */</span>
00426     <span class="keywordflow">for</span> (current = requests; current; current = current-&gt;<a class="code" href=
"structnetsnmp__request__info__s.html#o13">next</a>) {
00427 
00428         var = current-&gt;<a class="code" href="structnetsnmp__request__info__s.html#o0">requestvb</a>;
00429         DEBUGMSGTL((<span class="stringliteral">"table_array:get"</span>,
00430                     <span class="stringliteral">"  process_get_request oid:"</span>));
00431         DEBUGMSGOID((<span class="stringliteral">"table_array:get"</span>, var-&gt;<a class="code" href=
"structvariable__list.html#o1">name</a>,
00432                      var-&gt;<a class="code" href="structvariable__list.html#o2">name_length</a>));
00433         DEBUGMSG((<span class="stringliteral">"table_array:get"</span>, <span class="stringliteral">"\n"</span>));
00434 
00435         <span class="comment">/*</span>
00436 <span class="comment">         * skip anything that doesn't need processing.</span>
00437 <span class="comment">         */</span>
00438         <span class="keywordflow">if</span> (current-&gt;<a class="code" href=
"structnetsnmp__request__info__s.html#o6">processed</a> != 0) {
00439             DEBUGMSGTL((<span class="stringliteral">"table_array:get"</span>, <span class=
"stringliteral">"already processed\n"</span>));
00440             <span class="keywordflow">continue</span>;
00441         }
00442 
00443         <span class="comment">/*</span>
00444 <span class="comment">         * Get pointer to the table information for this request. This</span>
00445 <span class="comment">         * information was saved by table_helper_handler. When</span>
00446 <span class="comment">         * debugging, we double check a few assumptions. For example,</span>
00447 <span class="comment">         * the table_helper_handler should enforce column boundaries.</span>
00448 <span class="comment">         */</span>
00449         tblreq_info = <a class="code" href="group__table.html#ga2">netsnmp_extract_table_info</a>(current);
00450         netsnmp_assert(tblreq_info-&gt;<a class="code" href=
"structnetsnmp__table__request__info__s.html#o0">colnum</a> &lt;= tad-&gt;tblreg_info-&gt;max_column);
00451 
00452         <span class="keywordflow">if</span> ((agtreq_info-&gt;<a class="code" href=
"structnetsnmp__agent__request__info__s.html#o0">mode</a> == MODE_GETNEXT) ||
00453             (agtreq_info-&gt;<a class="code" href=
"structnetsnmp__agent__request__info__s.html#o0">mode</a> == MODE_GETBULK)) {
00454             <span class="comment">/*</span>
00455 <span class="comment">             * find the row</span>
00456 <span class="comment">             */</span>
00457             row = <a class="code" href=
"group__table__container.html#ga15">netsnmp_table_index_find_next_row</a>(tad-&gt;table, tblreq_info);
00458             <span class="keywordflow">if</span> (!row) {
00459                 <span class="comment">/*</span>
00460 <span class="comment">                 * no results found.</span>
00461 <span class="comment">                 *</span>
00462 <span class="comment">                 * xxx-rks: how do we skip this entry for the next handler,</span>
00463 <span class="comment">                 * but still allow it a chance to hit another handler?</span>
00464 <span class="comment">                 */</span>
00465                 DEBUGMSGTL((<span class="stringliteral">"table_array:get"</span>, <span class=
"stringliteral">"no row found\n"</span>));
00466                 <a class="code" href="group__snmp__agent.html#ga83">netsnmp_set_request_error</a>(agtreq_info, current,
00467                                           SNMP_ENDOFMIBVIEW);
00468                 <span class="keywordflow">continue</span>;
00469             }
00470 
00471             <span class="comment">/*</span>
00472 <span class="comment">             * * if data was found, make sure it has the column we want</span>
00473 <span class="comment">             */</span>
00474 <span class="comment">/* xxx-rks: add suport for sparse tables */</span>
00475 
00476             <span class="comment">/*</span>
00477 <span class="comment">             * build new oid</span>
00478 <span class="comment">             */</span>
00479             build_new_oid(reginfo, tblreq_info, row, current);
00480 
00481         } 
00482         <span class="keywordflow">else</span> {
00483             netsnmp_index index;
00484             index.oids = tblreq_info-&gt;<a class="code" href=
"structnetsnmp__table__request__info__s.html#o3">index_oid</a>;
00485             index.len = tblreq_info-&gt;<a class="code" href=
"structnetsnmp__table__request__info__s.html#o4">index_oid_len</a>;
00486 
00487             row = CONTAINER_FIND(tad-&gt;table, &amp;index);
00488             <span class="keywordflow">if</span> (!row) {
00489                 DEBUGMSGTL((<span class="stringliteral">"table_array:get"</span>, <span class=
"stringliteral">"no row found\n"</span>));
00490                 <a class="code" href="group__snmp__agent.html#ga83">netsnmp_set_request_error</a>(agtreq_info, current,
00491                                           SNMP_NOSUCHINSTANCE);
00492                 <span class="keywordflow">continue</span>;
00493             }
00494         } 
00496         <span class="comment">/*</span>
00497 <span class="comment">         * get the data</span>
00498 <span class="comment">         */</span>
00499         rc = tad-&gt;cb-&gt;get_value(current, row, tblreq_info);
00500 
00501     } 
00503     <span class="keywordflow">return</span> rc;
00504 }
00505 
00506 <span class="comment">/**********************************************************************</span>
00507 <span class="comment"> **********************************************************************</span>
00508 <span class="comment"> *                                                                    *</span>
00509 <span class="comment"> *                                                                    *</span>
00510 <span class="comment"> * SET procession functions                                           *</span>
00511 <span class="comment"> *                                                                    *</span>
00512 <span class="comment"> *                                                                    *</span>
00513 <span class="comment"> **********************************************************************</span>
00514 <span class="comment"> **********************************************************************/</span>
00515 
00516 <span class="keywordtype">void</span>
00517 group_requests(<a class="code" href=
"structnetsnmp__agent__request__info__s.html">netsnmp_agent_request_info</a> *agtreq_info,
00518                <a class="code" href="structnetsnmp__request__info__s.html">netsnmp_request_info</a> *requests,
00519                netsnmp_container *request_group, table_container_data * tad)
00520 {
00521     <a class="code" href="structnetsnmp__table__request__info__s.html">netsnmp_table_request_info</a> *tblreq_info;
00522     <a class="code" href="structvariable__list.html">netsnmp_variable_list</a> *var;
00523     netsnmp_index *row, *tmp, index;
00524     <a class="code" href="structnetsnmp__request__info__s.html">netsnmp_request_info</a> *current;
00525     netsnmp_request_group *g;
00526     netsnmp_request_group_item *i;
00527 
00528     <span class="keywordflow">for</span> (current = requests; current; current = current-&gt;<a class="code" href=
"structnetsnmp__request__info__s.html#o13">next</a>) {
00529 
00530         var = current-&gt;<a class="code" href="structnetsnmp__request__info__s.html#o0">requestvb</a>;
00531 
00532         <span class="comment">/*</span>
00533 <span class="comment">         * skip anything that doesn't need processing.</span>
00534 <span class="comment">         */</span>
00535         <span class="keywordflow">if</span> (current-&gt;<a class="code" href=
"structnetsnmp__request__info__s.html#o6">processed</a> != 0) {
00536             DEBUGMSGTL((<span class="stringliteral">"table_array:group"</span>,
00537                         <span class="stringliteral">"already processed\n"</span>));
00538             <span class="keywordflow">continue</span>;
00539         }
00540 
00541         <span class="comment">/*</span>
00542 <span class="comment">         * 3.2.1 Setup and paranoia</span>
00543 <span class="comment">         * *</span>
00544 <span class="comment">         * * Get pointer to the table information for this request. This</span>
00545 <span class="comment">         * * information was saved by table_helper_handler. When</span>
00546 <span class="comment">         * * debugging, we double check a few assumptions. For example,</span>
00547 <span class="comment">         * * the table_helper_handler should enforce column boundaries.</span>
00548 <span class="comment">         */</span>
00549         row = NULL;
00550         tblreq_info = <a class="code" href="group__table.html#ga2">netsnmp_extract_table_info</a>(current);
00551         netsnmp_assert(tblreq_info-&gt;<a class="code" href=
"structnetsnmp__table__request__info__s.html#o0">colnum</a> &lt;= tad-&gt;tblreg_info-&gt;max_column);
00552 
00553         <span class="comment">/*</span>
00554 <span class="comment">         * search for index</span>
00555 <span class="comment">         */</span>
00556         index.oids = tblreq_info-&gt;<a class="code" href="structnetsnmp__table__request__info__s.html#o3">index_oid</a>;
00557         index.len = tblreq_info-&gt;<a class="code" href=
"structnetsnmp__table__request__info__s.html#o4">index_oid_len</a>;
00558         tmp = CONTAINER_FIND(request_group, &amp;index);
00559         <span class="keywordflow">if</span> (tmp) {
00560             DEBUGMSGTL((<span class="stringliteral">"table_array:group"</span>,
00561                         <span class="stringliteral">"    existing group:"</span>));
00562             DEBUGMSGOID((<span class="stringliteral">"table_array:group"</span>, index.oids,
00563                          index.len));
00564             DEBUGMSG((<span class="stringliteral">"table_array:group"</span>, <span class="stringliteral">"\n"</span>));
00565             g = (netsnmp_request_group *) tmp;
00566             i = <a class="code" href="group__util.html#ga39">SNMP_MALLOC_TYPEDEF</a>(netsnmp_request_group_item);
00567             i-&gt;ri = current;
00568             i-&gt;tri = tblreq_info;
00569             i-&gt;next = g-&gt;list;
00570             g-&gt;list = i;
00571 
00573             <span class="keywordflow">continue</span>;
00574         }
00575 
00576         DEBUGMSGTL((<span class="stringliteral">"table_array:group"</span>, <span class=
"stringliteral">"    new group"</span>));
00577         DEBUGMSGOID((<span class="stringliteral">"table_array:group"</span>, index.oids,
00578                      index.len));
00579         DEBUGMSG((<span class="stringliteral">"table_array:group"</span>, <span class="stringliteral">"\n"</span>));
00580         g = <a class="code" href="group__util.html#ga39">SNMP_MALLOC_TYPEDEF</a>(netsnmp_request_group);
00581         i = <a class="code" href="group__util.html#ga39">SNMP_MALLOC_TYPEDEF</a>(netsnmp_request_group_item);
00582         g-&gt;list = i;
00583         g-&gt;table = tad-&gt;table;
00584         i-&gt;ri = current;
00585         i-&gt;tri = tblreq_info;
00588         <span class="comment">/*</span>
00589 <span class="comment">         * search for row. all changes are made to the original row,</span>
00590 <span class="comment">         * later, we'll make a copy in undo_info before we start processing.</span>
00591 <span class="comment">         */</span>
00592         row = g-&gt;existing_row = CONTAINER_FIND(tad-&gt;table, &amp;index);
00593         <span class="keywordflow">if</span> (!g-&gt;existing_row) {
00594             <span class="keywordflow">if</span> (!tad-&gt;cb-&gt;create_row) {
00595                 <span class="keywordflow">if</span>(MODE_IS_SET(agtreq_info-&gt;<a class="code" href=
"structnetsnmp__agent__request__info__s.html#o0">mode</a>))
00596                     <a class="code" href="group__snmp__agent.html#ga83">netsnmp_set_request_error</a>(agtreq_info, current,
00597                                               SNMP_ERR_NOTWRITABLE);
00598                 <span class="keywordflow">else</span>
00599                     <a class="code" href="group__snmp__agent.html#ga83">netsnmp_set_request_error</a>(agtreq_info, current,
00600                                               SNMP_NOSUCHINSTANCE);
00601                 free(g);
00602                 free(i);
00603                 <span class="keywordflow">continue</span>;
00604             }
00606             row = g-&gt;existing_row = tad-&gt;cb-&gt;create_row(&amp;index);
00607             <span class="keywordflow">if</span> (!row) {
00608                 <span class="comment">/* xxx-rks : parameter to create_row to allow</span>
00609 <span class="comment">                 * for better error reporting. */</span>
00610                 <a class="code" href="group__snmp__agent.html#ga83">netsnmp_set_request_error</a>(agtreq_info, current,
00611                                           SNMP_ERR_GENERR);
00612                 free(g);
00613                 free(i);
00614                 <span class="keywordflow">continue</span>;
00615             }
00616             g-&gt;row_created = 1;
00617         }
00618 
00619         g-&gt;index.oids = row-&gt;oids;
00620         g-&gt;index.len = row-&gt;len;
00621 
00622         CONTAINER_INSERT(request_group, g);
00623 
00624     } 
00625 }
00626 
00627 <span class="keyword">static</span> <span class="keywordtype">void</span>
00628 process_set_group(netsnmp_index *o, <span class="keywordtype">void</span> *c)
00629 {
00630     <span class="comment">/* xxx-rks: should we continue processing after an error?? */</span>
00631     set_context           *context = (set_context *) c;
00632     netsnmp_request_group *ag = (netsnmp_request_group *) o;
00633     <span class="keywordtype">int</span>                    rc = SNMP_ERR_NOERROR;
00634 
00635     <span class="keywordflow">switch</span> (context-&gt;agtreq_info-&gt;mode) {
00636 
00637     <span class="keywordflow">case</span> MODE_SET_RESERVE1:
00639         <span class="comment">/*</span>
00640 <span class="comment">         * if not a new row, save undo info</span>
00641 <span class="comment">         */</span>
00642         <span class="keywordflow">if</span> (ag-&gt;row_created == 0) {
00643             <span class="keywordflow">if</span> (context-&gt;tad-&gt;cb-&gt;duplicate_row)
00644                 ag-&gt;undo_info = context-&gt;tad-&gt;cb-&gt;duplicate_row(ag-&gt;existing_row);
00645             <span class="keywordflow">else</span>
00646                 ag-&gt;undo_info = NULL;
00647             <span class="keywordflow">if</span> (NULL == ag-&gt;undo_info) {
00648                 rc = SNMP_ERR_RESOURCEUNAVAILABLE;
00649                 <span class="keywordflow">break</span>;
00650             }
00651         }
00652         
00653         <span class="keywordflow">if</span> (context-&gt;tad-&gt;cb-&gt;set_reserve1)
00654             context-&gt;tad-&gt;cb-&gt;set_reserve1(ag);
00655         <span class="keywordflow">break</span>;
00656 
00657     <span class="keywordflow">case</span> MODE_SET_RESERVE2:
00658         <span class="keywordflow">if</span> (context-&gt;tad-&gt;cb-&gt;set_reserve2)
00659             context-&gt;tad-&gt;cb-&gt;set_reserve2(ag);
00660         <span class="keywordflow">break</span>;
00661 
00662     <span class="keywordflow">case</span> MODE_SET_ACTION:
00663         <span class="keywordflow">if</span> (context-&gt;tad-&gt;cb-&gt;set_action)
00664             context-&gt;tad-&gt;cb-&gt;set_action(ag);
00665         <span class="keywordflow">break</span>;
00666 
00667     <span class="keywordflow">case</span> MODE_SET_COMMIT:
00668         <span class="keywordflow">if</span> (ag-&gt;row_created == 0) {
00669             <span class="comment">/*</span>
00670 <span class="comment">             * this is an existing row, has it been deleted?</span>
00671 <span class="comment">             */</span>
00672             <span class="keywordflow">if</span> (ag-&gt;row_deleted == 1) {
00673                 DEBUGMSGT((TABLE_ARRAY_NAME, <span class="stringliteral">"action: deleting row\n"</span>));
00674                 <span class="keywordflow">if</span> (CONTAINER_REMOVE(ag-&gt;table, ag-&gt;existing_row) != 0) {
00675                     rc = SNMP_ERR_COMMITFAILED;
00676                     <span class="keywordflow">break</span>;
00677                 }
00678             }
00679         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ag-&gt;row_deleted == 0) {
00680             <span class="comment">/*</span>
00681 <span class="comment">             * new row (that hasn't been deleted) should be inserted</span>
00682 <span class="comment">             */</span>
00683             DEBUGMSGT((TABLE_ARRAY_NAME, <span class="stringliteral">"action: inserting row\n"</span>));
00684             <span class="keywordflow">if</span> (CONTAINER_INSERT(ag-&gt;table, ag-&gt;existing_row) != 0) {
00685                 rc = SNMP_ERR_COMMITFAILED;
00686                 <span class="keywordflow">break</span>;
00687             }
00688         }
00689 
00690         <span class="keywordflow">if</span> (context-&gt;tad-&gt;cb-&gt;set_commit)
00691             context-&gt;tad-&gt;cb-&gt;set_commit(ag);
00692 
00694         <span class="keywordflow">if</span> (ag-&gt;undo_info) {
00695             context-&gt;tad-&gt;cb-&gt;delete_row(ag-&gt;undo_info);
00696             ag-&gt;undo_info = NULL;
00697         }
00698 
00699 <span class="preprocessor">#if 0</span>
00700         <span class="comment">/* XXX-rks: finish row cooperative notifications</span>
00701 <span class="comment">         * if the table has requested it, send cooperative notifications</span>
00702 <span class="comment">         * for row operations.</span>
00703 <span class="comment">         */</span>
00704         <span class="keywordflow">if</span> (context-&gt;tad-&gt;notifications) {
00705             <span class="keywordflow">if</span> (ag-&gt;undo_info) {
00706                 <span class="keywordflow">if</span> (!ag-&gt;existing_row)
00707                     netsnmp_monitor_notify(EVENT_ROW_DEL);
00708                 <span class="keywordflow">else</span>
00709                     netsnmp_monitor_notify(EVENT_ROW_MOD);
00710             }
00711             <span class="keywordflow">else</span>
00712                 netsnmp_monitor_notify(EVENT_ROW_ADD);
00713         }
00714 <span class="preprocessor">#endif</span>
00715 
00716         <span class="keywordflow">if</span> ((ag-&gt;row_created == 0) &amp;&amp; (ag-&gt;row_deleted == 1)) {
00717             context-&gt;tad-&gt;cb-&gt;delete_row(ag-&gt;existing_row);
00718             ag-&gt;existing_row = NULL;
00719         }
00720         <span class="keywordflow">break</span>;
00721 
00722     <span class="keywordflow">case</span> MODE_SET_FREE:
00723         <span class="keywordflow">if</span> (context-&gt;tad-&gt;cb-&gt;set_free)
00724             context-&gt;tad-&gt;cb-&gt;set_free(ag);
00725 
00727         <span class="keywordflow">if</span> (ag-&gt;row_created == 1) {
00728             <span class="keywordflow">if</span> (context-&gt;tad-&gt;cb-&gt;delete_row)
00729                 context-&gt;tad-&gt;cb-&gt;delete_row(ag-&gt;existing_row);
00730             ag-&gt;existing_row = NULL;
00731         }
00732         <span class="keywordflow">else</span> {
00733             <span class="keywordflow">if</span> (context-&gt;tad-&gt;cb-&gt;delete_row)
00734                 context-&gt;tad-&gt;cb-&gt;delete_row(ag-&gt;undo_info);
00735             ag-&gt;undo_info = NULL;
00736         }
00737         <span class="keywordflow">break</span>;
00738 
00739     <span class="keywordflow">case</span> MODE_SET_UNDO:
00740         <span class="comment">/*</span>
00741 <span class="comment">         * status already set - don't change it now</span>
00742 <span class="comment">         */</span>
00743         <span class="keywordflow">if</span> (context-&gt;tad-&gt;cb-&gt;set_undo)
00744             context-&gt;tad-&gt;cb-&gt;set_undo(ag);
00745 
00746         <span class="comment">/*</span>
00747 <span class="comment">         * no more use for undo_info, so free it</span>
00748 <span class="comment">         */</span>
00749         <span class="keywordflow">if</span> (ag-&gt;row_created == 0) {
00750             <span class="comment">/*</span>
00751 <span class="comment">             * restore old values</span>
00752 <span class="comment">             */</span>
00753             context-&gt;tad-&gt;cb-&gt;row_copy(ag-&gt;existing_row, ag-&gt;undo_info);
00754             context-&gt;tad-&gt;cb-&gt;delete_row(ag-&gt;undo_info);
00755             ag-&gt;undo_info = NULL;
00756         }
00757         <span class="keywordflow">else</span> {
00758             context-&gt;tad-&gt;cb-&gt;delete_row(ag-&gt;existing_row);
00759             ag-&gt;existing_row = NULL;
00760         }
00761         <span class="keywordflow">break</span>;
00762 
00763     <span class="keywordflow">default</span>:
00764         <a class="code" href="group__snmp__logging.html#ga41">snmp_log</a>(LOG_ERR, <span class=
"stringliteral">"unknown mode processing SET for "</span>
00765                  <span class="stringliteral">"netsnmp_table_array_helper_handler\n"</span>);
00766         rc = SNMP_ERR_GENERR;
00767         <span class="keywordflow">break</span>;
00768     }
00769     
00770     <span class="keywordflow">if</span> (rc)
00771         <a class="code" href="group__snmp__agent.html#ga83">netsnmp_set_request_error</a>(context-&gt;agtreq_info,
00772                                   ag-&gt;list-&gt;ri, rc);
00773                                                
00774 }
00775 
00776 <span class="keywordtype">int</span>
00777 process_set_requests(<a class="code" href=
"structnetsnmp__agent__request__info__s.html">netsnmp_agent_request_info</a> *agtreq_info,
00778                      <a class="code" href="structnetsnmp__request__info__s.html">netsnmp_request_info</a> *requests,
00779                      table_container_data * tad, <span class="keywordtype">char</span> *handler_name)
00780 {
00781     set_context         context;
00782     netsnmp_container  *request_group;
00783 
00784     <span class="comment">/*</span>
00785 <span class="comment">     * create and save structure for set info</span>
00786 <span class="comment">     */</span>
00787     request_group = (netsnmp_container*) netsnmp_agent_get_list_data
00788         (agtreq_info, handler_name);
00789     <span class="keywordflow">if</span> (request_group == NULL) {
00790         <a class="code" href="structnetsnmp__data__list__s.html">netsnmp_data_list</a> *tmp;
00791         request_group = netsnmp_container_find(<span class="stringliteral">"request_group:"</span>
00792                                                <span class="stringliteral">"table_container"</span>);
00793         request_group-&gt;compare = netsnmp_compare_netsnmp_index;
00794         request_group-&gt;ncompare = netsnmp_ncompare_netsnmp_index;
00795 
00796         DEBUGMSGTL((<span class="stringliteral">"table_array"</span>, <span class=
"stringliteral">"Grouping requests by oid\n"</span>));
00797 
00798         tmp = <a class="code" href="group__data__list.html#ga3">netsnmp_create_data_list</a>(handler_name,
00799                                        request_group,
00800                                        release_netsnmp_request_groups);
00801         netsnmp_agent_add_list_data(agtreq_info, tmp);
00802         <span class="comment">/*</span>
00803 <span class="comment">         * group requests.</span>
00804 <span class="comment">         */</span>
00805         group_requests(agtreq_info, requests, request_group, tad);
00806     }
00807 
00808     <span class="comment">/*</span>
00809 <span class="comment">     * process each group one at a time</span>
00810 <span class="comment">     */</span>
00811     context.agtreq_info = agtreq_info;
00812     context.tad = tad;
00813     context.status = SNMP_ERR_NOERROR;
00814     CONTAINER_FOR_EACH(request_group,
00815                        (netsnmp_container_obj_func*)process_set_group,
00816                        &amp;context);
00817 
00818     <span class="keywordflow">return</span> context.status;
00819 }
00820 
00821 
00822 <span class="comment">/**********************************************************************</span>
00823 <span class="comment"> **********************************************************************</span>
00824 <span class="comment"> *                                                                    *</span>
00825 <span class="comment"> *                                                                    *</span>
00826 <span class="comment"> * netsnmp_table_array_helper_handler()                               *</span>
00827 <span class="comment"> *                                                                    *</span>
00828 <span class="comment"> *                                                                    *</span>
00829 <span class="comment"> **********************************************************************</span>
00830 <span class="comment"> **********************************************************************/</span>
00831 <span class="keywordtype">int</span>
00832 netsnmp_table_array_helper_handler(<a class="code" href=
"structnetsnmp__mib__handler__s.html">netsnmp_mib_handler</a> *handler,
00833                                    <a class="code" href=
"structnetsnmp__handler__registration__s.html">netsnmp_handler_registration</a> *reginfo,
00834                                    <a class="code" href=
"structnetsnmp__agent__request__info__s.html">netsnmp_agent_request_info</a> *agtreq_info,
00835                                    <a class="code" href=
"structnetsnmp__request__info__s.html">netsnmp_request_info</a> *requests)
00836 {
00837 
00838     <span class="comment">/*</span>
00839 <span class="comment">     * First off, get our pointer from the handler. This</span>
00840 <span class="comment">     * lets us get to the table registration information we</span>
00841 <span class="comment">     * saved in get_table_array_handler(), as well as the</span>
00842 <span class="comment">     * container where the actual table data is stored.</span>
00843 <span class="comment">     */</span>
00844     <span class="keywordtype">int</span>             rc = SNMP_ERR_NOERROR;
00845     table_container_data *tad = (table_container_data *)handler-&gt;<a class="code" href=
"structnetsnmp__mib__handler__s.html#o1">myvoid</a>;
00846 
00847     <span class="keywordflow">if</span> (agtreq_info-&gt;<a class="code" href=
"structnetsnmp__agent__request__info__s.html#o0">mode</a> &lt; 0 || agtreq_info-&gt;<a class="code" href=
"structnetsnmp__agent__request__info__s.html#o0">mode</a> &gt; 5) {
00848         DEBUGMSGTL((<span class="stringliteral">"table_array"</span>, <span class=
"stringliteral">"Mode %d, Got request:\n"</span>,
00849                     agtreq_info-&gt;<a class="code" href="structnetsnmp__agent__request__info__s.html#o0">mode</a>));
00850     } <span class="keywordflow">else</span> {
00851         DEBUGMSGTL((<span class="stringliteral">"table_array"</span>, <span class=
"stringliteral">"Mode %s, Got request:\n"</span>,
00852                     mode_name[agtreq_info-&gt;<a class="code" href=
"structnetsnmp__agent__request__info__s.html#o0">mode</a>]));
00853     }
00854 
00855     <span class="keywordflow">if</span> (MODE_IS_SET(agtreq_info-&gt;<a class="code" href=
"structnetsnmp__agent__request__info__s.html#o0">mode</a>)) {
00856         <span class="comment">/*</span>
00857 <span class="comment">         * netsnmp_mutex_lock(&amp;tad-&gt;lock);</span>
00858 <span class="comment">         */</span>
00859         rc = process_set_requests(agtreq_info, requests,
00860                                   tad, handler-&gt;<a class="code" href=
"structnetsnmp__mib__handler__s.html#o0">handler_name</a>);
00861         <span class="comment">/*</span>
00862 <span class="comment">         * netsnmp_mutex_unlock(&amp;tad-&gt;lock);</span>
00863 <span class="comment">         */</span>
00864     } <span class="keywordflow">else</span>
00865         rc = process_get_requests(reginfo, agtreq_info, requests, tad);
00866 
00867     <span class="keywordflow">if</span> (rc != SNMP_ERR_NOERROR) {
00868         DEBUGMSGTL((<span class="stringliteral">"table_array"</span>, <span class=
"stringliteral">"processing returned rc %d\n"</span>, rc));
00869     }
00870     
00871     <span class="comment">/*</span>
00872 <span class="comment">     * Now we've done our processing. If there is another handler below us,</span>
00873 <span class="comment">     * call them.</span>
00874 <span class="comment">     */</span>
00875     <span class="keywordflow">if</span> (handler-&gt;<a class="code" href=
"structnetsnmp__mib__handler__s.html#o4">next</a>) {
00876         rc = <a class="code" href=
"group__handler.html#ga17">netsnmp_call_next_handler</a>(handler, reginfo, agtreq_info, requests);
00877         <span class="keywordflow">if</span> (rc != SNMP_ERR_NOERROR) {
00878             DEBUGMSGTL((<span class="stringliteral">"table_array"</span>, <span class=
"stringliteral">"next handler returned rc %d\n"</span>, rc));
00879         }
00880     }
00881     
00882     <span class="keywordflow">return</span> rc;
00883 }
00884 <span class="preprocessor">#endif </span>
</pre>
  </div>
  <hr size="1" />

  <address style="align: right;">
    <small>Generated on Fri Dec 30 13:47:50 2005 for net-snmp by&nbsp; <a href="http://www.doxygen.org/index.html"><img src=
    "doxygen.png" alt="doxygen" align="middle" border="0" /></a> 1.3.9.1</small>
  </address>
<!-- CONTENT END -->
<!--#include virtual="/page-bottom.html" -->

