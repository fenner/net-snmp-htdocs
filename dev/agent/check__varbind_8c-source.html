<!--#set var="section" value="development" -->
<!--#include virtual="/page-top.html" -->
<!-- CONTENT START -->
  <div class="qindex">
    <a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class=
    "qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class=
    "qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a> | <a class=
    "qindex" href="examples.html">Examples</a>
  </div>

  <div class="nav">
    <a class="el" href="dir_000005.html">snmplib</a>
  </div>

  <h1>check_varbind.c</h1>

  <div class="fragment">
    <pre class="fragment">
00001 <span class="preprocessor">#include &lt;net-snmp/net-snmp-config.h&gt;</span>
00002 
00003 <span class="preprocessor">#include &lt;net-snmp/net-snmp-includes.h&gt;</span>
00004 
00005 <span class="preprocessor">#include &lt;net-snmp/library/check_varbind.h&gt;</span>
00006 
00007 NETSNMP_INLINE <span class="keywordtype">int</span>
00008 netsnmp_check_vb_type(<span class="keyword">const</span> <a class="code" href=
"structvariable__list.html">netsnmp_variable_list</a> *var, <span class="keywordtype">int</span> type )
00009 {
00010     <span class="keyword">register</span> <span class="keywordtype">int</span> rc = SNMP_ERR_NOERROR;
00011 
00012     <span class="keywordflow">if</span> (NULL == var)
00013         <span class="keywordflow">return</span> SNMP_ERR_GENERR;
00014     
00015     <span class="keywordflow">if</span> (var-&gt;<a class="code" href="structvariable__list.html#o3">type</a> != type) {
00016         rc = SNMP_ERR_WRONGTYPE;
00017     }
00018 
00019     <span class="keywordflow">return</span> rc;
00020 }
00021 
00022 NETSNMP_INLINE <span class="keywordtype">int</span>
00023 netsnmp_check_vb_size(<span class="keyword">const</span> <a class="code" href=
"structvariable__list.html">netsnmp_variable_list</a> *var, size_t size )
00024 {
00025     <span class="keyword">register</span> <span class="keywordtype">int</span> rc = SNMP_ERR_NOERROR;
00026 
00027     <span class="keywordflow">if</span> (NULL == var)
00028         <span class="keywordflow">return</span> SNMP_ERR_GENERR;
00029     
00030     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (var-&gt;<a class="code" href=
"structvariable__list.html#o5">val_len</a> != size) {
00031         rc = SNMP_ERR_WRONGLENGTH;
00032     }
00033 
00034     <span class="keywordflow">return</span> rc;
00035 }
00036 
00037 NETSNMP_INLINE <span class="keywordtype">int</span>
00038 netsnmp_check_vb_size_range(<span class="keyword">const</span> <a class="code" href=
"structvariable__list.html">netsnmp_variable_list</a> *var,
00039                             size_t low, size_t high )
00040 {
00041     <span class="keyword">register</span> <span class="keywordtype">int</span> rc = SNMP_ERR_NOERROR;
00042 
00043     <span class="keywordflow">if</span> (NULL == var)
00044         <span class="keywordflow">return</span> SNMP_ERR_GENERR;
00045     
00046     <span class="keywordflow">if</span> ((var-&gt;<a class="code" href=
"structvariable__list.html#o5">val_len</a> &lt; low) || (var-&gt;<a class="code" href=
"structvariable__list.html#o5">val_len</a> &gt; high)) {
00047         rc = SNMP_ERR_WRONGLENGTH;
00048     }
00049 
00050     <span class="keywordflow">return</span> rc;
00051 }
00052 
00053 NETSNMP_INLINE <span class="keywordtype">int</span>
00054 netsnmp_check_vb_type_and_size(<span class="keyword">const</span> <a class="code" href=
"structvariable__list.html">netsnmp_variable_list</a> *var,
00055                                <span class="keywordtype">int</span> type, size_t size)
00056 {
00057     <span class="keyword">register</span> <span class="keywordtype">int</span> rc = SNMP_ERR_NOERROR;
00058 
00059     <span class="keywordflow">if</span> (NULL == var)
00060         <span class="keywordflow">return</span> SNMP_ERR_GENERR;
00061     
00062     <span class="keywordflow">if</span> ((rc = netsnmp_check_vb_type(var,type)))
00063         ;
00064     <span class="keywordflow">else</span>
00065         rc = netsnmp_check_vb_size(var, size);
00066 
00067     <span class="keywordflow">return</span> rc;
00068 }
00069 
00070 NETSNMP_INLINE <span class="keywordtype">int</span>
00071 netsnmp_check_vb_int_range(<span class="keyword">const</span> <a class="code" href=
"structvariable__list.html">netsnmp_variable_list</a> *var, <span class="keywordtype">int</span> low, <span class=
"keywordtype">int</span> high)
00072 {
00073     <span class="keyword">register</span> <span class="keywordtype">int</span> rc = SNMP_ERR_NOERROR;
00074     
00075     <span class="keywordflow">if</span> (NULL == var)
00076         <span class="keywordflow">return</span> SNMP_ERR_GENERR;
00077     
00078     <span class="keywordflow">if</span> ((rc = netsnmp_check_vb_type_and_size(var, ASN_INTEGER, <span class=
"keyword">sizeof</span>(<span class="keywordtype">int</span>))))
00079         <span class="keywordflow">return</span> rc;
00080     
00081     <span class="keywordflow">if</span> ((*var-&gt;<a class="code" href=
"structvariable__list.html#o4">val</a>.integer &lt; low) || (*var-&gt;<a class="code" href=
"structvariable__list.html#o4">val</a>.integer &gt; high)) {
00082         rc = SNMP_ERR_BADVALUE;
00083     }
00084 
00085     <span class="keywordflow">return</span> rc;
00086 }
00087 
00088 <span class="keywordtype">int</span>
00089 netsnmp_check_vb_truthvalue(<span class="keyword">const</span> <a class="code" href=
"structvariable__list.html">netsnmp_variable_list</a> *var)
00090 {
00091     <span class="keyword">register</span> <span class="keywordtype">int</span> rc = SNMP_ERR_NOERROR;
00092     
00093     <span class="keywordflow">if</span> (NULL == var)
00094         <span class="keywordflow">return</span> SNMP_ERR_GENERR;
00095     
00096     <span class="keywordflow">if</span> ((rc = netsnmp_check_vb_type_and_size(var, ASN_INTEGER, <span class=
"keyword">sizeof</span>(<span class="keywordtype">int</span>))))
00097         <span class="keywordflow">return</span> rc;
00098     
00099     <span class="keywordflow">return</span> netsnmp_check_vb_int_range(var, 1, 2);
00100 }
00101 
00102 NETSNMP_INLINE <span class="keywordtype">int</span>
00103 netsnmp_check_vb_rowstatus_value(<span class="keyword">const</span> <a class="code" href=
"structvariable__list.html">netsnmp_variable_list</a> *var)
00104 {
00105     <span class="keyword">register</span> <span class="keywordtype">int</span> rc = SNMP_ERR_NOERROR;
00106 
00107     <span class="keywordflow">if</span> (NULL == var)
00108         <span class="keywordflow">return</span> SNMP_ERR_GENERR;
00109     
00110     <span class="keywordflow">if</span> ((rc = netsnmp_check_vb_type_and_size(var, ASN_INTEGER, <span class=
"keyword">sizeof</span>(<span class="keywordtype">int</span>))))
00111         <span class="keywordflow">return</span> rc;
00112     
00113     <span class="keywordflow">return</span> netsnmp_check_vb_int_range(var, SNMP_ROW_NONEXISTENT,
00114                                       SNMP_ROW_DESTROY);
00115 }
00116 
00117 <span class="keywordtype">int</span>
00118 netsnmp_check_vb_rowstatus(<span class="keyword">const</span> <a class="code" href=
"structvariable__list.html">netsnmp_variable_list</a> *var, <span class="keywordtype">int</span> old_value)
00119 {
00120     <span class="keyword">register</span> <span class="keywordtype">int</span> rc = SNMP_ERR_NOERROR;
00121 
00122     <span class="keywordflow">if</span> (NULL == var)
00123         <span class="keywordflow">return</span> SNMP_ERR_GENERR;
00124     
00125     <span class="keywordflow">if</span> ((rc = netsnmp_check_vb_rowstatus_value(var)))
00126         <span class="keywordflow">return</span> rc;
00127 
00128     <span class="keywordflow">return</span> check_rowstatus_transition(old_value, *var-&gt;<a class="code" href=
"structvariable__list.html#o4">val</a>.integer);
00129 }
00130 
00131 <span class="keywordtype">int</span>
00132 netsnmp_check_vb_storagetype(<span class="keyword">const</span> <a class="code" href=
"structvariable__list.html">netsnmp_variable_list</a> *var, <span class="keywordtype">int</span> old_value)
00133 {
00134     <span class="keywordtype">int</span> rc = SNMP_ERR_NOERROR;
00135 
00136     <span class="keywordflow">if</span> (NULL == var)
00137         <span class="keywordflow">return</span> SNMP_ERR_GENERR;
00138     
00139     <span class="keywordflow">if</span> ((rc = netsnmp_check_vb_type_and_size(var, ASN_INTEGER, <span class=
"keyword">sizeof</span>(<span class="keywordtype">int</span>))))
00140         <span class="keywordflow">return</span> rc;
00141     
00142     <span class="keywordflow">if</span> ((rc = netsnmp_check_vb_int_range(var, SNMP_STORAGE_NONE,
00143                                         SNMP_STORAGE_READONLY)))
00144         <span class="keywordflow">return</span> rc;
00145         
00146     <span class="keywordflow">return</span> check_storage_transition(old_value, *var-&gt;<a class="code" href=
"structvariable__list.html#o4">val</a>.integer);
00147 }
</pre>
  </div>
  <hr size="1" />

  <address style="align: right;">
    <small><!--#include virtual="/sfbutton.html" --><br />
    Generated on Thu Oct 28 21:46:56 2004 for net-snmp by&nbsp; <a href="http://www.doxygen.org/index.html"><img src=
    "doxygen.png" alt="doxygen" align="middle" border="0" /></a> 1.3.9.1</small>
<!-- CONTENT END -->
<!--#include virtual="/page-bottom.html" -->

