<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>net-snmp: Trap generation routines for mib modules to use</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">net-snmp&#160;<span id="projectnumber">5.7</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Trap generation routines for mib modules to use</div>  </div>
<div class="ingroups"><a class="el" href="group__agent.html">The Net-SNMP agent</a></div></div>
<div class="contents">
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga970eef8963291e3b2511981ed5b05899"></a><!-- doxytag: member="agent_trap::SNMPV2_TRAPS_PREFIX" ref="ga970eef8963291e3b2511981ed5b05899" args="" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SNMPV2_TRAPS_PREFIX</b>&#160;&#160;&#160;SNMP_OID_SNMPMODULES,1,1,5</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga50eb924d8bfc77a4095123f06ec2d46c"></a><!-- doxytag: member="agent_trap::SNMPV2_TRAP_OBJS_PREFIX" ref="ga50eb924d8bfc77a4095123f06ec2d46c" args="" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SNMPV2_TRAP_OBJS_PREFIX</b>&#160;&#160;&#160;SNMP_OID_SNMPMODULES,1,1,4</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga62cee70a24c029dd5392a98354541d18"></a><!-- doxytag: member="agent_trap::SNMPV2_COMM_OBJS_PREFIX" ref="ga62cee70a24c029dd5392a98354541d18" args="" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SNMPV2_COMM_OBJS_PREFIX</b>&#160;&#160;&#160;SNMP_OID_SNMPMODULES,18,1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaf6f935400ebb88292be30654445e34ab"></a><!-- doxytag: member="agent_trap::SNMP_AUTHENTICATED_TRAPS_ENABLED" ref="gaf6f935400ebb88292be30654445e34ab" args="" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SNMP_AUTHENTICATED_TRAPS_ENABLED</b>&#160;&#160;&#160;1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gab6dd9683b00b4c02d259b0c2e03df6c8"></a><!-- doxytag: member="agent_trap::SNMP_AUTHENTICATED_TRAPS_DISABLED" ref="gab6dd9683b00b4c02d259b0c2e03df6c8" args="" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SNMP_AUTHENTICATED_TRAPS_DISABLED</b>&#160;&#160;&#160;2</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga29b7451465deac204c5f7cb1f9c6e1fc"></a><!-- doxytag: member="agent_trap::MAX_ARGS" ref="ga29b7451465deac204c5f7cb1f9c6e1fc" args="" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_ARGS</b>&#160;&#160;&#160;128</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga08b9b8b2be5b3f323452ed0ff2ac18ab"></a><!-- doxytag: member="agent_trap::netsnmp_feature_child_of" ref="ga08b9b8b2be5b3f323452ed0ff2ac18ab" args="(agent_trap_all, libnetsnmpagent)" -->
&#160;</td><td class="memItemRight" valign="bottom"><b>netsnmp_feature_child_of</b> (agent_trap_all, libnetsnmpagent)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga7c0c5dd82ecd3376fdbb697fc97e19d5"></a><!-- doxytag: member="agent_trap::init_traps" ref="ga7c0c5dd82ecd3376fdbb697fc97e19d5" args="(void)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>init_traps</b> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gabf501cd747da64ccdec6ca518cb61ad3"></a><!-- doxytag: member="agent_trap::add_trap_session" ref="gabf501cd747da64ccdec6ca518cb61ad3" args="(netsnmp_session *ss, int pdutype, int confirm, int version)" -->
int&#160;</td><td class="memItemRight" valign="bottom"><b>add_trap_session</b> (<a class="el" href="structsnmp__session.html">netsnmp_session</a> *ss, int pdutype, int confirm, int version)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga3b9c87a6c8d9b3091a2c03421b18a455"></a><!-- doxytag: member="agent_trap::remove_trap_session" ref="ga3b9c87a6c8d9b3091a2c03421b18a455" args="(netsnmp_session *ss)" -->
int&#160;</td><td class="memItemRight" valign="bottom"><b>remove_trap_session</b> (<a class="el" href="structsnmp__session.html">netsnmp_session</a> *ss)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaa95325abda0b7baff25267035092f23f"></a><!-- doxytag: member="agent_trap::create_trap_session" ref="gaa95325abda0b7baff25267035092f23f" args="(char *sink, u_short sinkport, char *com, int version, int pdutype)" -->
int&#160;</td><td class="memItemRight" valign="bottom"><b>create_trap_session</b> (char *sink, u_short sinkport, char *com, int version, int pdutype)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gae5f277be309228a9b72fb54c12a9ee41"></a><!-- doxytag: member="agent_trap::snmpd_free_trapsinks" ref="gae5f277be309228a9b72fb54c12a9ee41" args="(void)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>snmpd_free_trapsinks</b> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga235d92fe56dfa36be4e260f12de2f0d2"></a><!-- doxytag: member="agent_trap::convert_v2pdu_to_v1" ref="ga235d92fe56dfa36be4e260f12de2f0d2" args="(netsnmp_pdu *template_v2pdu)" -->
<a class="el" href="structsnmp__pdu.html">netsnmp_pdu</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>convert_v2pdu_to_v1</b> (<a class="el" href="structsnmp__pdu.html">netsnmp_pdu</a> *template_v2pdu)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga4aa648318fa8007f6acc2948735fc372"></a><!-- doxytag: member="agent_trap::convert_v1pdu_to_v2" ref="ga4aa648318fa8007f6acc2948735fc372" args="(netsnmp_pdu *template_v1pdu)" -->
<a class="el" href="structsnmp__pdu.html">netsnmp_pdu</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>convert_v1pdu_to_v2</b> (<a class="el" href="structsnmp__pdu.html">netsnmp_pdu</a> *template_v1pdu)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__agent__trap.html#ga614968539bb4a96e61d1c28245c9f353">netsnmp_send_traps</a> (int trap, int specific, const oid *enterprise, int enterprise_length, <a class="el" href="structvariable__list.html">netsnmp_variable_list</a> *vars, const char *context, int flags)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows you to make a distinction between generic traps from different classes of equipment.  <a href="#ga614968539bb4a96e61d1c28245c9f353"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga45cb31759e0dea1327445680f90bc2c7"></a><!-- doxytag: member="agent_trap::send_enterprise_trap_vars" ref="ga45cb31759e0dea1327445680f90bc2c7" args="(int trap, int specific, const oid *enterprise, int enterprise_length, netsnmp_variable_list *vars)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>send_enterprise_trap_vars</b> (int trap, int specific, const oid *enterprise, int enterprise_length, <a class="el" href="structvariable__list.html">netsnmp_variable_list</a> *vars)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__agent__trap.html#ga26012335e2c13a961b268c180caf98bb">handle_inform_response</a> (int op, <a class="el" href="structsnmp__session.html">netsnmp_session</a> *session, int reqid, <a class="el" href="structsnmp__pdu.html">netsnmp_pdu</a> *pdu, void *magic)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Captures responses or the lack there of from INFORMs that were sent 1) a response is received from an INFORM 2) one isn't received and the retries/timeouts have failed.  <a href="#ga26012335e2c13a961b268c180caf98bb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gab0710cb092e37b5131606d928d919eae"></a><!-- doxytag: member="agent_trap::send_trap_to_sess" ref="gab0710cb092e37b5131606d928d919eae" args="(netsnmp_session *sess, netsnmp_pdu *template_pdu)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>send_trap_to_sess</b> (<a class="el" href="structsnmp__session.html">netsnmp_session</a> *sess, <a class="el" href="structsnmp__pdu.html">netsnmp_pdu</a> *template_pdu)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga02d1213632f9f3fb14161e792f9345d8"></a><!-- doxytag: member="agent_trap::send_trap_vars" ref="ga02d1213632f9f3fb14161e792f9345d8" args="(int trap, int specific, netsnmp_variable_list *vars)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>send_trap_vars</b> (int trap, int specific, <a class="el" href="structvariable__list.html">netsnmp_variable_list</a> *vars)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga8e617edc685937e26d1c5cc54d2d4269"></a><!-- doxytag: member="agent_trap::send_trap_vars_with_context" ref="ga8e617edc685937e26d1c5cc54d2d4269" args="(int trap, int specific, netsnmp_variable_list *vars, const char *context)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>send_trap_vars_with_context</b> (int trap, int specific, <a class="el" href="structvariable__list.html">netsnmp_variable_list</a> *vars, const char *context)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__agent__trap.html#ga86b1bcdaed1156316838acd02a276dc8">send_easy_trap</a> (int trap, int specific)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends an SNMPv1 trap (or the SNMPv2 equivalent) to the list of configured trap destinations (or "sinks"), using the provided values for the generic trap type and specific trap value.  <a href="#ga86b1bcdaed1156316838acd02a276dc8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__agent__trap.html#gac9fa0228d574f715b60cd93b87968a15">send_v2trap</a> (<a class="el" href="structvariable__list.html">netsnmp_variable_list</a> *vars)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Uses the supplied list of variable bindings to form an SNMPv2 trap, which is sent to SNMPv2-capable sinks on the configured list.  <a href="#gac9fa0228d574f715b60cd93b87968a15"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__agent__trap.html#ga581450e8276c43665beb8d15eea92a34">send_v3trap</a> (<a class="el" href="structvariable__list.html">netsnmp_variable_list</a> *vars, const char *context)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Similar to <a class="el" href="group__agent__trap.html#gac9fa0228d574f715b60cd93b87968a15" title="Uses the supplied list of variable bindings to form an SNMPv2 trap, which is sent to SNMPv2-capable s...">send_v2trap()</a>, with the added ability to specify a context.  <a href="#ga581450e8276c43665beb8d15eea92a34"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gae20f7a0a58e5180514e2eb7be23c9dce"></a><!-- doxytag: member="agent_trap::send_trap_pdu" ref="gae20f7a0a58e5180514e2eb7be23c9dce" args="(netsnmp_pdu *pdu)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>send_trap_pdu</b> (<a class="el" href="structsnmp__pdu.html">netsnmp_pdu</a> *pdu)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga600552c79f9392425bd448171811e0a3"></a><!-- doxytag: member="agent_trap::snmpd_parse_config_authtrap" ref="ga600552c79f9392425bd448171811e0a3" args="(const char *token, char *cptr)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>snmpd_parse_config_authtrap</b> (const char *token, char *cptr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaa2947b323b4daad4659486e53ea4ee63"></a><!-- doxytag: member="agent_trap::snmpd_parse_config_trapsink" ref="gaa2947b323b4daad4659486e53ea4ee63" args="(const char *token, char *cptr)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>snmpd_parse_config_trapsink</b> (const char *token, char *cptr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga4c293d3f06d3f0de7b3590d88e17bd4b"></a><!-- doxytag: member="agent_trap::snmpd_parse_config_trap2sink" ref="ga4c293d3f06d3f0de7b3590d88e17bd4b" args="(const char *word, char *cptr)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>snmpd_parse_config_trap2sink</b> (const char *word, char *cptr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaa30ad02e47b295e28ea74da5b8da5400"></a><!-- doxytag: member="agent_trap::snmpd_parse_config_informsink" ref="gaa30ad02e47b295e28ea74da5b8da5400" args="(const char *word, char *cptr)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>snmpd_parse_config_informsink</b> (const char *word, char *cptr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga1899f70fed84e77bb26250d82531350c"></a><!-- doxytag: member="agent_trap::snmpd_parse_config_trapsess" ref="ga1899f70fed84e77bb26250d82531350c" args="(const char *word, char *cptr)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>snmpd_parse_config_trapsess</b> (const char *word, char *cptr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gabc594dbf40b4c54bf1617cae9e7e0c8d"></a><!-- doxytag: member="agent_trap::snmpd_parse_config_trapcommunity" ref="gabc594dbf40b4c54bf1617cae9e7e0c8d" args="(const char *word, char *cptr)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>snmpd_parse_config_trapcommunity</b> (const char *word, char *cptr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaaaa73dda5a2f3af046f1439bbefeb3b1"></a><!-- doxytag: member="agent_trap::snmpd_free_trapcommunity" ref="gaaaa73dda5a2f3af046f1439bbefeb3b1" args="(void)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>snmpd_free_trapcommunity</b> (void)</td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gafe1c01d6089ff627d008e62903dc5bc4"></a><!-- doxytag: member="agent_trap::sinks" ref="gafe1c01d6089ff627d008e62903dc5bc4" args="" -->
struct trap_sink *&#160;</td><td class="memItemRight" valign="bottom"><b>sinks</b> = NULL</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga44aebd9cbf8c0d61887c68a0ade0444f"></a><!-- doxytag: member="agent_trap::objid_enterprisetrap" ref="ga44aebd9cbf8c0d61887c68a0ade0444f" args="[]" -->
const oid&#160;</td><td class="memItemRight" valign="bottom"><b>objid_enterprisetrap</b> [] = { NETSNMP_NOTIFICATION_MIB }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga166eff849d4bd8c6b6648f86f7b85ef8"></a><!-- doxytag: member="agent_trap::trap_version_id" ref="ga166eff849d4bd8c6b6648f86f7b85ef8" args="[]" -->
const oid&#160;</td><td class="memItemRight" valign="bottom"><b>trap_version_id</b> [] = { NETSNMP_SYSTEM_MIB }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga054e97608aad9f0736eaf3156ceb4542"></a><!-- doxytag: member="agent_trap::enterprisetrap_len" ref="ga054e97608aad9f0736eaf3156ceb4542" args="" -->
const int&#160;</td><td class="memItemRight" valign="bottom"><b>enterprisetrap_len</b> = OID_LENGTH(objid_enterprisetrap)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga99670a99de3df7381af1b095db2209ed"></a><!-- doxytag: member="agent_trap::trap_version_id_len" ref="ga99670a99de3df7381af1b095db2209ed" args="" -->
const int&#160;</td><td class="memItemRight" valign="bottom"><b>trap_version_id_len</b> = OID_LENGTH(trap_version_id)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaa79d5025ad8f907f01d11afe176bcae4"></a><!-- doxytag: member="agent_trap::trap_prefix" ref="gaa79d5025ad8f907f01d11afe176bcae4" args="[]" -->
const oid&#160;</td><td class="memItemRight" valign="bottom"><b>trap_prefix</b> [] = { SNMPV2_TRAPS_PREFIX }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gadcc22224703ceecf745d11c76cc672b7"></a><!-- doxytag: member="agent_trap::cold_start_oid" ref="gadcc22224703ceecf745d11c76cc672b7" args="[]" -->
const oid&#160;</td><td class="memItemRight" valign="bottom"><b>cold_start_oid</b> [] = { SNMPV2_TRAPS_PREFIX, 1 }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaf7a3211b9c4c50eb30372d1cfad7b2f9"></a><!-- doxytag: member="agent_trap::snmptrap_oid" ref="gaf7a3211b9c4c50eb30372d1cfad7b2f9" args="[]" -->
const oid&#160;</td><td class="memItemRight" valign="bottom"><b>snmptrap_oid</b> [] = { SNMPV2_TRAP_OBJS_PREFIX, 1, 0 }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga63c200c2ef04e9dd1cb43702be0be5ed"></a><!-- doxytag: member="agent_trap::snmptrapenterprise_oid" ref="ga63c200c2ef04e9dd1cb43702be0be5ed" args="[]" -->
const oid&#160;</td><td class="memItemRight" valign="bottom"><b>snmptrapenterprise_oid</b> [] = { SNMPV2_TRAP_OBJS_PREFIX, 3, 0 }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga8811c4c5434c0886f160347bd3a0f572"></a><!-- doxytag: member="agent_trap::sysuptime_oid" ref="ga8811c4c5434c0886f160347bd3a0f572" args="[]" -->
const oid&#160;</td><td class="memItemRight" valign="bottom"><b>sysuptime_oid</b> [] = { SNMP_OID_MIB2, 1, 3, 0 }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga5a7f87cb24365520450a1911237b6615"></a><!-- doxytag: member="agent_trap::snmptrap_oid_len" ref="ga5a7f87cb24365520450a1911237b6615" args="" -->
const size_t&#160;</td><td class="memItemRight" valign="bottom"><b>snmptrap_oid_len</b> = OID_LENGTH(snmptrap_oid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gadd21a3237b344596f6c32796579ce414"></a><!-- doxytag: member="agent_trap::snmptrapenterprise_oid_len" ref="gadd21a3237b344596f6c32796579ce414" args="" -->
const size_t&#160;</td><td class="memItemRight" valign="bottom"><b>snmptrapenterprise_oid_len</b> = OID_LENGTH(snmptrapenterprise_oid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga284b6bdd45ab4ef9d62f049505ec85cb"></a><!-- doxytag: member="agent_trap::sysuptime_oid_len" ref="ga284b6bdd45ab4ef9d62f049505ec85cb" args="" -->
const size_t&#160;</td><td class="memItemRight" valign="bottom"><b>sysuptime_oid_len</b> = OID_LENGTH(sysuptime_oid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaf98c9868d67fda895e1f7128d0061931"></a><!-- doxytag: member="agent_trap::agentaddr_oid" ref="gaf98c9868d67fda895e1f7128d0061931" args="[]" -->
const oid&#160;</td><td class="memItemRight" valign="bottom"><b>agentaddr_oid</b> [] = { SNMPV2_COMM_OBJS_PREFIX, 3, 0 }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga9187e3d1999d0b7b91111ab260daa46e"></a><!-- doxytag: member="agent_trap::agentaddr_oid_len" ref="ga9187e3d1999d0b7b91111ab260daa46e" args="" -->
const size_t&#160;</td><td class="memItemRight" valign="bottom"><b>agentaddr_oid_len</b> = OID_LENGTH(agentaddr_oid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gab877e6acd9e5a19cdb49ac3c3bb68e5b"></a><!-- doxytag: member="agent_trap::community_oid" ref="gab877e6acd9e5a19cdb49ac3c3bb68e5b" args="[]" -->
const oid&#160;</td><td class="memItemRight" valign="bottom"><b>community_oid</b> [] = { SNMPV2_COMM_OBJS_PREFIX, 4, 0 }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga48500b4f6701a6163e038533b775931d"></a><!-- doxytag: member="agent_trap::community_oid_len" ref="ga48500b4f6701a6163e038533b775931d" args="" -->
const size_t&#160;</td><td class="memItemRight" valign="bottom"><b>community_oid_len</b> = OID_LENGTH(community_oid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaaebd0e3a9af9da819a4b3c64dc84cc04"></a><!-- doxytag: member="agent_trap::snmp_trapcommunity" ref="gaaebd0e3a9af9da819a4b3c64dc84cc04" args="" -->
char *&#160;</td><td class="memItemRight" valign="bottom"><b>snmp_trapcommunity</b> = NULL</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gac378bac42e9377a38d1d5a4ae3f49800"></a><!-- doxytag: member="agent_trap::snmp_enableauthentraps" ref="gac378bac42e9377a38d1d5a4ae3f49800" args="" -->
int&#160;</td><td class="memItemRight" valign="bottom"><b>snmp_enableauthentraps</b> = SNMP_AUTHENTICATED_TRAPS_DISABLED</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gae906ea0364a6a20c3559a77ac3f2f38c"></a><!-- doxytag: member="agent_trap::snmp_enableauthentrapsset" ref="gae906ea0364a6a20c3559a77ac3f2f38c" args="" -->
int&#160;</td><td class="memItemRight" valign="bottom"><b>snmp_enableauthentrapsset</b> = 0</td></tr>
</table>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ga26012335e2c13a961b268c180caf98bb"></a><!-- doxytag: member="agent_trap.c::handle_inform_response" ref="ga26012335e2c13a961b268c180caf98bb" args="(int op, netsnmp_session *session, int reqid, netsnmp_pdu *pdu, void *magic)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int handle_inform_response </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsnmp__session.html">netsnmp_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>reqid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsnmp__pdu.html">netsnmp_pdu</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>magic</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Captures responses or the lack there of from INFORMs that were sent 1) a response is received from an INFORM 2) one isn't received and the retries/timeouts have failed. </p>

<p>Definition at line <a class="el" href="agent__trap_8c_source.html#l00865">865</a> of file <a class="el" href="agent__trap_8c_source.html">agent_trap.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga614968539bb4a96e61d1c28245c9f353"></a><!-- doxytag: member="agent_trap.c::netsnmp_send_traps" ref="ga614968539bb4a96e61d1c28245c9f353" args="(int trap, int specific, const oid *enterprise, int enterprise_length, netsnmp_variable_list *vars, const char *context, int flags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int netsnmp_send_traps </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>trap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>specific</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const oid *&#160;</td>
          <td class="paramname"><em>enterprise</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>enterprise_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structvariable__list.html">netsnmp_variable_list</a> *&#160;</td>
          <td class="paramname"><em>vars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This function allows you to make a distinction between generic traps from different classes of equipment. </p>
<p>For example, you may want to handle a SNMP_TRAP_LINKDOWN trap for a particular device in a different manner to a generic system SNMP_TRAP_LINKDOWN trap.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">trap</td><td>is the generic trap type. The trap types are:<ul>
<li>SNMP_TRAP_COLDSTART: cold start</li>
<li>SNMP_TRAP_WARMSTART: warm start</li>
<li>SNMP_TRAP_LINKDOWN: link down</li>
<li>SNMP_TRAP_LINKUP: link up</li>
<li>SNMP_TRAP_AUTHFAIL: authentication failure</li>
<li>SNMP_TRAP_EGPNEIGHBORLOSS: egp neighbor loss</li>
<li>SNMP_TRAP_ENTERPRISESPECIFIC: enterprise specific</li>
</ul>
</td></tr>
    <tr><td class="paramname">specific</td><td>is the specific trap value.</td></tr>
    <tr><td class="paramname">enterprise</td><td>is an enterprise oid in which you want to send specific traps from.</td></tr>
    <tr><td class="paramname">enterprise_length</td><td>is the length of the enterprise oid, use macro, OID_LENGTH, to compute length.</td></tr>
    <tr><td class="paramname">vars</td><td>is used to supply list of variable bindings to form an SNMPv2 trap.</td></tr>
    <tr><td class="paramname">context</td><td>currently unused</td></tr>
    <tr><td class="paramname">flags</td><td>currently unused</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>void</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__agent__trap.html#ga86b1bcdaed1156316838acd02a276dc8" title="Sends an SNMPv1 trap (or the SNMPv2 equivalent) to the list of configured trap destinations (or &quot;sink...">send_easy_trap</a> </dd>
<dd>
<a class="el" href="group__agent__trap.html#gac9fa0228d574f715b60cd93b87968a15" title="Uses the supplied list of variable bindings to form an SNMPv2 trap, which is sent to SNMPv2-capable s...">send_v2trap</a> </dd></dl>

<p>Definition at line <a class="el" href="agent__trap_8c_source.html#l00624">624</a> of file <a class="el" href="agent__trap_8c_source.html">agent_trap.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga86b1bcdaed1156316838acd02a276dc8"></a><!-- doxytag: member="agent_trap.c::send_easy_trap" ref="ga86b1bcdaed1156316838acd02a276dc8" args="(int trap, int specific)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void send_easy_trap </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>trap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>specific</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sends an SNMPv1 trap (or the SNMPv2 equivalent) to the list of configured trap destinations (or "sinks"), using the provided values for the generic trap type and specific trap value. </p>
<p>This function eventually calls send_enterprise_trap_vars. If the trap type is not set to SNMP_TRAP_ENTERPRISESPECIFIC the enterprise and enterprise_length paramater is set to the pre defined NETSNMP_SYSTEM_MIB oid and length respectively. If the trap type is set to SNMP_TRAP_ENTERPRISESPECIFIC the enterprise and enterprise_length parameters are set to the pre-defined NETSNMP_NOTIFICATION_MIB oid and length respectively.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">trap</td><td>is the generic trap type.</td></tr>
    <tr><td class="paramname">specific</td><td>is the specific trap value.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>void</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd>send_enterprise_trap_vars </dd>
<dd>
<a class="el" href="group__agent__trap.html#gac9fa0228d574f715b60cd93b87968a15" title="Uses the supplied list of variable bindings to form an SNMPv2 trap, which is sent to SNMPv2-capable s...">send_v2trap</a> </dd></dl>

<p>Definition at line <a class="el" href="agent__trap_8c_source.html#l01009">1009</a> of file <a class="el" href="agent__trap_8c_source.html">agent_trap.c</a>.</p>

</div>
</div>
<a class="anchor" id="gac9fa0228d574f715b60cd93b87968a15"></a><!-- doxytag: member="agent_trap.c::send_v2trap" ref="gac9fa0228d574f715b60cd93b87968a15" args="(netsnmp_variable_list *vars)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void send_v2trap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvariable__list.html">netsnmp_variable_list</a> *&#160;</td>
          <td class="paramname"><em>vars</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Uses the supplied list of variable bindings to form an SNMPv2 trap, which is sent to SNMPv2-capable sinks on the configured list. </p>
<p>An equivalent INFORM is sent to the configured list of inform sinks. Sinks that can only handle SNMPv1 traps are skipped.</p>
<p>This function eventually calls send_enterprise_trap_vars. If the trap type is not set to SNMP_TRAP_ENTERPRISESPECIFIC the enterprise and enterprise_length paramater is set to the pre defined NETSNMP_SYSTEM_MIB oid and length respectively. If the trap type is set to SNMP_TRAP_ENTERPRISESPECIFIC the enterprise and enterprise_length parameters are set to the pre-defined NETSNMP_NOTIFICATION_MIB oid and length respectively.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">vars</td><td>is used to supply list of variable bindings to form an SNMPv2 trap.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>void</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__agent__trap.html#ga86b1bcdaed1156316838acd02a276dc8" title="Sends an SNMPv1 trap (or the SNMPv2 equivalent) to the list of configured trap destinations (or &quot;sink...">send_easy_trap</a> </dd>
<dd>
send_enterprise_trap_vars </dd></dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="notification_8c-example.html#a2">notification.c</a>.</dd>
</dl>
<p>Definition at line <a class="el" href="agent__trap_8c_source.html#l01038">1038</a> of file <a class="el" href="agent__trap_8c_source.html">agent_trap.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga581450e8276c43665beb8d15eea92a34"></a><!-- doxytag: member="agent_trap.c::send_v3trap" ref="ga581450e8276c43665beb8d15eea92a34" args="(netsnmp_variable_list *vars, const char *context)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void send_v3trap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvariable__list.html">netsnmp_variable_list</a> *&#160;</td>
          <td class="paramname"><em>vars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Similar to <a class="el" href="group__agent__trap.html#gac9fa0228d574f715b60cd93b87968a15" title="Uses the supplied list of variable bindings to form an SNMPv2 trap, which is sent to SNMPv2-capable s...">send_v2trap()</a>, with the added ability to specify a context. </p>
<p>If the last parameter is NULL, then this call is equivalent to <a class="el" href="group__agent__trap.html#gac9fa0228d574f715b60cd93b87968a15" title="Uses the supplied list of variable bindings to form an SNMPv2 trap, which is sent to SNMPv2-capable s...">send_v2trap()</a>.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">vars</td><td>is used to supply the list of variable bindings for the trap.</td></tr>
    <tr><td class="paramname">context</td><td>is used to specify the context of the trap.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>void</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__agent__trap.html#gac9fa0228d574f715b60cd93b87968a15" title="Uses the supplied list of variable bindings to form an SNMPv2 trap, which is sent to SNMPv2-capable s...">send_v2trap</a> </dd></dl>

<p>Definition at line <a class="el" href="agent__trap_8c_source.html#l01056">1056</a> of file <a class="el" href="agent__trap_8c_source.html">agent_trap.c</a>.</p>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Thu Jul 14 2011 for net-snmp by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
