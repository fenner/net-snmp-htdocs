<!--#set var="section" value="development" -->
<!--#include virtual="/page-top.html" -->
<!-- CONTENT START -->
  <!-- Generated by Doxygen 1.3.9.1 -->

  <div class="qindex">
    <a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class=
    "qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class=
    "qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a> | <a class=
    "qindex" href="examples.html">Examples</a>
  </div>

  <div class="nav">
    <a class="el" href="dir_000000.html">include</a>&nbsp;/&nbsp;<a class="el" href=
    "dir_000001.html">net-snmp</a>&nbsp;/&nbsp;<a class="el" href="dir_000006.html">library</a>
  </div>

  <h1>fd_event_manager.h</h1>

  <div class="fragment">
    <pre class="fragment">
00001 <span class="comment">/**************************************************************************</span>
00002 <span class="comment"> * UNIT: File Descriptor (FD) Event Manager</span>
00003 <span class="comment"> *</span>
00004 <span class="comment"> * OVERVIEW: This unit contains functions to register a FD with the FD</span>
00005 <span class="comment"> *           event manager for callbacks when activity is received on that</span>
00006 <span class="comment"> *           FD.  Notification of read, write, and exception activity can </span>
00007 <span class="comment"> *           all be registered for individually.  Once a registered FD is</span>
00008 <span class="comment"> *           closed by the user, the FD must be unregistered.  To use</span>
00009 <span class="comment"> *           the FD Event manager you need to make calls to </span>
00010 <span class="comment"> *           netsnmp_external_event_info() and </span>
00011 <span class="comment"> *           netsnmp_dispatch_external_events() in your event loop to receive</span>
00012 <span class="comment"> *           callbacks for registered events.  See snmpd.c and snmptrapd.c </span>
00013 <span class="comment"> *           for examples.</span>
00014 <span class="comment"> *</span>
00015 <span class="comment"> * LIMITATIONS:</span>
00016 <span class="comment"> **************************************************************************/</span>
00017 <span class="preprocessor">#ifndef FD_EVENT_MANAGER_H</span>
00018 <span class="preprocessor">#define FD_EVENT_MANAGER_H</span>
00019 
00020 <span class="preprocessor">#ifdef HAVE_SYS_SELECT_H</span>
00021 <span class="preprocessor">#include &lt;sys/select.h&gt;</span>
00022 <span class="preprocessor">#endif</span>
00023 
00024 <span class="preprocessor">#ifdef __cplusplus</span>
00025 <span class="keyword">extern</span>          <span class="stringliteral">"C"</span> {
00026 <span class="preprocessor">#endif</span>
00027 
00028 <span class="preprocessor">#define NUM_EXTERNAL_FDS 32</span>
00029 <span class="preprocessor">#define FD_REGISTERED_OK                 0</span>
00030 <span class="preprocessor">#define FD_REGISTRATION_FAILED          -2</span>
00031 <span class="preprocessor">#define FD_UNREGISTERED_OK               0</span>
00032 <span class="preprocessor">#define FD_NO_SUCH_REGISTRATION         -1</span>
00033 
00034 <span class="comment">/* Since the inception of netsnmp_external_event_info and </span>
00035 <span class="comment"> * netsnmp_dispatch_external_events, there is no longer a need for the data </span>
00036 <span class="comment"> * below to be globally visible.  We will leave it global for now for </span>
00037 <span class="comment"> * compatibility purposes. */</span>
00038 <span class="keyword">extern</span> <span class=
"keywordtype">int</span>      external_readfd[NUM_EXTERNAL_FDS],   external_readfdlen;
00039 <span class="keyword">extern</span> <span class=
"keywordtype">int</span>      external_writefd[NUM_EXTERNAL_FDS],  external_writefdlen;
00040 <span class="keyword">extern</span> <span class=
"keywordtype">int</span>      external_exceptfd[NUM_EXTERNAL_FDS], external_exceptfdlen;
00041 
00042 <span class="keyword">extern</span> void     (*external_readfdfunc[NUM_EXTERNAL_FDS])   (int, <span class=
"keywordtype">void</span> *);
00043 <span class="keyword">extern</span> void     (*external_writefdfunc[NUM_EXTERNAL_FDS])  (int, <span class=
"keywordtype">void</span> *);
00044 <span class="keyword">extern</span> void     (*external_exceptfdfunc[NUM_EXTERNAL_FDS]) (int, <span class=
"keywordtype">void</span> *);
00045 
00046 <span class="keyword">extern</span> <span class="keywordtype">void</span>    *external_readfd_data[NUM_EXTERNAL_FDS];
00047 <span class="keyword">extern</span> <span class="keywordtype">void</span>    *external_writefd_data[NUM_EXTERNAL_FDS];
00048 <span class="keyword">extern</span> <span class="keywordtype">void</span>    *external_exceptfd_data[NUM_EXTERNAL_FDS];
00049 
00050 <span class="comment">/* Here are the key functions of this unit.  Use register_xfd to register</span>
00051 <span class="comment"> * a callback to be called when there is x activity on the register fd.  </span>
00052 <span class="comment"> * x can be read, write, or except (for exception).  When registering,</span>
00053 <span class="comment"> * you can pass in a pointer to some data that you have allocated that</span>
00054 <span class="comment"> * you would like to have back when the callback is called. */</span>
00055 <span class="keywordtype">int</span>             register_readfd(<span class="keywordtype">int</span>, <span class=
"keywordtype">void</span> (*func)(<span class="keywordtype">int</span>, <span class="keywordtype">void</span> *),   <span class=
"keywordtype">void</span> *);
00056 <span class="keywordtype">int</span>             register_writefd(<span class="keywordtype">int</span>, <span class=
"keywordtype">void</span> (*func)(<span class="keywordtype">int</span>, <span class="keywordtype">void</span> *),  <span class=
"keywordtype">void</span> *);
00057 <span class="keywordtype">int</span>             register_exceptfd(<span class="keywordtype">int</span>, <span class=
"keywordtype">void</span> (*func)(<span class="keywordtype">int</span>, <span class="keywordtype">void</span> *), <span class=
"keywordtype">void</span> *);
00058 
00059 <span class="comment">/* Unregisters a given fd for events */</span>
00060 <span class="keywordtype">int</span>             unregister_readfd(<span class="keywordtype">int</span>);
00061 <span class="keywordtype">int</span>             unregister_writefd(<span class="keywordtype">int</span>);
00062 <span class="keywordtype">int</span>             unregister_exceptfd(<span class="keywordtype">int</span>);
00063 
00064 <span class="comment">/*</span>
00065 <span class="comment"> * External Event Info</span>
00066 <span class="comment"> *</span>
00067 <span class="comment"> * Description:</span>
00068 <span class="comment"> *   Call this function to add an external event fds to your read, write, </span>
00069 <span class="comment"> *   exception fds that your application already has.  When this function</span>
00070 <span class="comment"> *   returns, your fd_sets will be ready for select().  It returns the</span>
00071 <span class="comment"> *   biggest fd in the fd_sets so far.</span>
00072 <span class="comment"> *</span>
00073 <span class="comment"> * Input Parameters: None</span>
00074 <span class="comment"> *</span>
00075 <span class="comment"> * Output Parameters: None</span>
00076 <span class="comment"> *</span>
00077 <span class="comment"> * In/Out Parameters: </span>
00078 <span class="comment"> *   numfds - The biggest fd so far.  On exit to this function, numfds</span>
00079 <span class="comment"> *            could of changed since we pass out the new biggest fd.</span>
00080 <span class="comment"> *   readfds - Set of read FDs that we are monitoring.  This function</span>
00081 <span class="comment"> *             can modify this set to have more FDs that we are monitoring.</span>
00082 <span class="comment"> *   writefds - Set of write FDs that we are monitoring.  This function</span>
00083 <span class="comment"> *             can modify this set to have more FDs that we are monitoring.</span>
00084 <span class="comment"> *   exceptfds - Set of exception FDs that we are monitoring.  This function</span>
00085 <span class="comment"> *             can modify this set to have more FDs that we are monitoring.</span>
00086 <span class="comment"> *</span>
00087 <span class="comment"> * Return Value: None</span>
00088 <span class="comment"> *</span>
00089 <span class="comment"> * Side Effects: None</span>
00090 <span class="comment"> */</span>
00091 <span class="keywordtype">void</span> netsnmp_external_event_info(<span class=
"keywordtype">int</span> *numfds, fd_set *readfds, fd_set *writefds, fd_set *exceptfds);
00092 
00093 <span class="comment">/*</span>
00094 <span class="comment"> * Dispatch External Events</span>
00095 <span class="comment"> *</span>
00096 <span class="comment"> * Description:</span>
00097 <span class="comment"> *   Call this function after select returns with pending events.  If any of</span>
00098 <span class="comment"> *   them were NETSNMP external events, the registered callback will be called.</span>
00099 <span class="comment"> *   The corresponding fd_set will have the FD cleared after the event is</span>
00100 <span class="comment"> *   dispatched.</span>
00101 <span class="comment"> *</span>
00102 <span class="comment"> * Input Parameters: None</span>
00103 <span class="comment"> *</span>
00104 <span class="comment"> * Output Parameters: None</span>
00105 <span class="comment"> *</span>
00106 <span class="comment"> * In/Out Parameters: </span>
00107 <span class="comment"> *   count - Number of FDs that have activity.  In this function, we decrement</span>
00108 <span class="comment"> *           count as we dispatch an event.</span>
00109 <span class="comment"> *   readfds - Set of read FDs that have activity</span>
00110 <span class="comment"> *   writefds - Set of write FDs that have activity</span>
00111 <span class="comment"> *   exceptfds - Set of exception FDs that have activity </span>
00112 <span class="comment"> *</span>
00113 <span class="comment"> * Return Value: None</span>
00114 <span class="comment"> *</span>
00115 <span class="comment"> * Side Effects: None</span>
00116 <span class="comment"> */</span>
00117 <span class="keywordtype">void</span> netsnmp_dispatch_external_events(<span class=
"keywordtype">int</span> *count, fd_set *readfds, fd_set *writefds, fd_set *exceptfds);
00118 <span class="preprocessor">#ifdef __cplusplus</span>
00119 }
00120 <span class="preprocessor">#endif</span>
00121 <span class="preprocessor">#endif</span>
</pre>
  </div>
  <hr size="1" />

  <address style="align: right;">
    <small>Generated on Fri Dec 30 13:47:44 2005 for net-snmp by&nbsp; <a href="http://www.doxygen.org/index.html"><img src=
    "doxygen.png" alt="doxygen" align="middle" border="0" /></a> 1.3.9.1</small>
  </address>
<!-- CONTENT END -->
<!--#include virtual="/page-bottom.html" -->

