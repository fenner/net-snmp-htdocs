<!--#set var="section" value="development" -->
<!--#include virtual="/page-top.html" -->
<!-- CONTENT START -->
  <!-- Generated by Doxygen 1.3.9.1 -->

  <div class="qindex">
    <a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class=
    "qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class=
    "qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a> | <a class=
    "qindex" href="examples.html">Examples</a>
  </div>

  <div class="nav">
    <a class="el" href="dir_000000.html">include</a>&nbsp;/&nbsp;<a class="el" href=
    "dir_000001.html">net-snmp</a>&nbsp;/&nbsp;<a class="el" href="dir_000006.html">library</a>
  </div>

  <h1>lcd_time.h</h1>

  <div class="fragment">
    <pre class="fragment">
00001 <span class="comment">/*</span>
00002 <span class="comment"> * lcd_time.h</span>
00003 <span class="comment"> */</span>
00004 
00005 <span class="preprocessor">#ifndef _LCD_TIME_H</span>
00006 <span class="preprocessor">#define _LCD_TIME_H</span>
00007 
00008 <span class="preprocessor">#ifdef __cplusplus</span>
00009 <span class="keyword">extern</span>          <span class="stringliteral">"C"</span> {
00010 <span class="preprocessor">#endif</span>
00011 
00012 
00013     <span class="comment">/*</span>
00014 <span class="comment">     * undefine to enable time synchronization only on authenticated packets </span>
00015 <span class="comment">     */</span>
00016 <span class="preprocessor">#define LCD_TIME_SYNC_OPT 1</span>
00017 
00018     <span class="comment">/*</span>
00019 <span class="comment">     * Macros and definitions.</span>
00020 <span class="comment">     */</span>
00021 <span class="preprocessor">#define ETIMELIST_SIZE  23</span>
00022 
00023 
00024 
00025     <span class="keyword">typedef</span> <span class="keyword">struct </span>enginetime_struct {
00026         u_char         *engineID;
00027         u_int           engineID_len;
00028 
00029         u_int           engineTime;
00030         u_int           engineBoot;
00031         <span class="comment">/*</span>
00032 <span class="comment">         * Time &amp; boots values received from last authenticated</span>
00033 <span class="comment">         * *   message within the previous time window.</span>
00034 <span class="comment">         */</span>
00035 
00036         time_t          lastReceivedEngineTime;
00037         <span class="comment">/*</span>
00038 <span class="comment">         * Timestamp made when engineTime/engineBoots was last</span>
00039 <span class="comment">         * *   updated.  Measured in seconds.</span>
00040 <span class="comment">         */</span>
00041 
00042 <span class="preprocessor">#ifdef LCD_TIME_SYNC_OPT</span>
00043         u_int           authenticatedFlag;
00044 <span class="preprocessor">#endif</span>
00045         <span class="keyword">struct </span>enginetime_struct *next;
00046     } enginetime   , *Enginetime;
00047 
00048 
00049 
00050 
00051     <span class="comment">/*</span>
00052 <span class="comment">     * Macros for streamlined engineID existence checks --</span>
00053 <span class="comment">     *</span>
00054 <span class="comment">     *      e       is char *engineID,</span>
00055 <span class="comment">     *      e_l     is u_int engineID_len.</span>
00056 <span class="comment">     *</span>
00057 <span class="comment">     *</span>
00058 <span class="comment">     *  ISENGINEKNOWN(e, e_l)</span>
00059 <span class="comment">     *      Returns:</span>
00060 <span class="comment">     *              TRUE    If engineID is recoreded in the EngineID List;</span>
00061 <span class="comment">     *              FALSE   Otherwise.</span>
00062 <span class="comment">     *</span>
00063 <span class="comment">     *  ENSURE_ENGINE_RECORD(e, e_l)</span>
00064 <span class="comment">     *      Adds the given engineID to the EngineID List if it does not exist</span>
00065 <span class="comment">     *              already.  engineID is added with a &lt;enginetime, engineboots&gt;</span>
00066 <span class="comment">     *              tuple of &lt;0,0&gt;.  ALWAYS succeeds -- except in case of a</span>
00067 <span class="comment">     *              fatal internal error.</span>
00068 <span class="comment">     *      Returns:</span>
00069 <span class="comment">     *              SNMPERR_SUCCESS On success;</span>
00070 <span class="comment">     *              SNMPERR_GENERR  Otherwise.</span>
00071 <span class="comment">     *</span>
00072 <span class="comment">     *  MAKENEW_ENGINE_RECORD(e, e_l)</span>
00073 <span class="comment">     *      Returns:</span>
00074 <span class="comment">     *              SNMPERR_SUCCESS If engineID already exists in the EngineID List;</span>
00075 <span class="comment">     *              SNMPERR_GENERR  Otherwise -and- invokes ENSURE_ENGINE_RECORD()</span>
00076 <span class="comment">     *                                      to add an entry to the EngineID List.</span>
00077 <span class="comment">     *</span>
00078 <span class="comment">     * XXX  Requres the following declaration in modules calling ISENGINEKNOWN():</span>
00079 <span class="comment">     *      static u_int    dummy_etime, dummy_eboot;</span>
00080 <span class="comment">     */</span>
00081 <span class="preprocessor">#define ISENGINEKNOWN(e, e_l)                                   \</span>
00082 <span class="preprocessor">        ( (get_enginetime(e, e_l,                               \</span>
00083 <span class="preprocessor">                &amp;dummy_eboot, &amp;dummy_etime, TRUE) == SNMPERR_SUCCESS)   \</span>
00084 <span class="preprocessor">                ? TRUE                                          \</span>
00085 <span class="preprocessor">                : FALSE )</span>
00086 
00087 <span class="preprocessor">#define ENSURE_ENGINE_RECORD(e, e_l)                            \</span>
00088 <span class="preprocessor">        ( (set_enginetime(e, e_l, 0, 0, FALSE) == SNMPERR_SUCCESS)      \</span>
00089 <span class="preprocessor">                ? SNMPERR_SUCCESS                               \</span>
00090 <span class="preprocessor">                : SNMPERR_GENERR )</span>
00091 
00092 <span class="preprocessor">#define MAKENEW_ENGINE_RECORD(e, e_l)                           \</span>
00093 <span class="preprocessor">        ( (ISENGINEKNOWN(e, e_l) == TRUE)                       \</span>
00094 <span class="preprocessor">                ? SNMPERR_SUCCESS                               \</span>
00095 <span class="preprocessor">                : (ENSURE_ENGINE_RECORD(e, e_l), SNMPERR_GENERR) )</span>
00096 
00097 
00098 
00099     <span class="comment">/*</span>
00100 <span class="comment">     * Prototypes.</span>
00101 <span class="comment">     */</span>
00102     <span class="keywordtype">int</span>             get_enginetime(u_char * engineID, u_int engineID_len,
00103                                    u_int * engine_boot,
00104                                    u_int * engine_time,
00105                                    u_int authenticated);
00106 
00107     <span class="keywordtype">int</span>             get_enginetime_ex(u_char * engineID,
00108                                       u_int engineID_len,
00109                                       u_int * engine_boot,
00110                                       u_int * engine_time,
00111                                       u_int * last_engine_time,
00112                                       u_int authenticated);
00113 
00114     <span class="keywordtype">int</span>             set_enginetime(u_char * engineID, u_int engineID_len,
00115                                    u_int engine_boot, u_int engine_time,
00116                                    u_int authenticated);
00117 
00118          
00119          
00120          
00121          
00122          
00123          
00124         Enginetime
00125         search_enginetime_list(u_char * engineID, u_int engineID_len);
00126 
00127     <span class="keywordtype">int</span>             hash_engineID(u_char * engineID, u_int engineID_len);
00128 
00129     <span class="keywordtype">void</span>            dump_etimelist_entry(Enginetime e, <span class=
"keywordtype">int</span> count);
00130     <span class="keywordtype">void</span>            dump_etimelist(<span class="keywordtype">void</span>);
00131     <span class="keywordtype">void</span>            free_enginetime(<span class="keywordtype">unsigned</span> <span class=
"keywordtype">char</span> *engineID, size_t engineID_len);
00132 
00133 <span class="preprocessor">#ifdef __cplusplus</span>
00134 }
00135 <span class="preprocessor">#endif</span>
00136 <span class="preprocessor">#endif                          </span><span class="comment">/* _LCD_TIME_H */</span>
</pre>
  </div>
  <hr size="1" />

  <address style="align: right;">
    <small>Generated on Fri Dec 30 13:47:45 2005 for net-snmp by&nbsp; <a href="http://www.doxygen.org/index.html"><img src=
    "doxygen.png" alt="doxygen" align="middle" border="0" /></a> 1.3.9.1</small>
  </address>
<!-- CONTENT END -->
<!--#include virtual="/page-bottom.html" -->

