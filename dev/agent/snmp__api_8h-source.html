<!--#set var="section" value="development" -->
<!--#include virtual="/page-top.html" -->
<!-- CONTENT START -->
  <!-- Generated by Doxygen 1.3.9.1 -->

  <div class="qindex">
    <a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class=
    "qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class=
    "qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a> | <a class=
    "qindex" href="examples.html">Examples</a>
  </div>

  <div class="nav">
    <a class="el" href="dir_000000.html">include</a>&nbsp;/&nbsp;<a class="el" href=
    "dir_000001.html">net-snmp</a>&nbsp;/&nbsp;<a class="el" href="dir_000006.html">library</a>
  </div>

  <h1>snmp_api.h</h1>

  <div class="fragment">
    <pre class="fragment">
00001 <span class="comment">/* Portions of this file are subject to the following copyright(s).  See</span>
00002 <span class="comment"> * the Net-SNMP's COPYING file for more details and other copyrights</span>
00003 <span class="comment"> * that may apply:</span>
00004 <span class="comment"> */</span>
00005 <span class="comment">/*</span>
00006 <span class="comment"> * Portions of this file are copyrighted by:</span>
00007 <span class="comment"> * Copyright &copy; 2003 Sun Microsystems, Inc. All rights reserved.</span>
00008 <span class="comment"> * Use is subject to license terms specified in the COPYING file</span>
00009 <span class="comment"> * distributed with the Net-SNMP package.</span>
00010 <span class="comment"> */</span>
00011 <span class="preprocessor">#ifndef SNMP_API_H</span>
00012 <span class="preprocessor">#define SNMP_API_H</span>
00013 
00014 <span class="comment">/*</span>
00015 <span class="comment"> * @file snmp_api.h - API for access to snmp.</span>
00016 <span class="comment"> * </span>
00017 <span class="comment"> * @addtogroup library</span>
00018 <span class="comment"> *</span>
00019 <span class="comment"> * Caution: when using this library in a multi-threaded application,</span>
00020 <span class="comment"> * the values of global variables "snmp_errno" and "snmp_detail"</span>
00021 <span class="comment"> * cannot be reliably determined.  Suggest using snmp_error()</span>
00022 <span class="comment"> * to obtain the library error codes.</span>
00023 <span class="comment"> *</span>
00024 <span class="comment"> * @{</span>
00025 <span class="comment"> */</span>
00026 
00027 <span class="preprocessor">#ifndef DONT_SHARE_ERROR_WITH_OTHER_THREADS</span>
00028 <span class="preprocessor">#define SET_SNMP_ERROR(x) snmp_errno=(x)</span>
00029 <span class="preprocessor">#else</span>
00030 <span class="preprocessor">#define SET_SNMP_ERROR(x)</span>
00031 <span class="preprocessor">#endif</span>
00032 
00033 
00034 <span class="preprocessor">#ifdef __cplusplus</span>
00035 <span class="keyword">extern</span>          <span class="stringliteral">"C"</span> {
00036 <span class="preprocessor">#endif</span>
00037 
00038 <span class="comment">/***********************************************************</span>
00039 <span class="comment">        Copyright 1989 by Carnegie Mellon University</span>
00040 
00041 <span class="comment">                      All Rights Reserved</span>
00042 
00043 <span class="comment">Permission to use, copy, modify, and distribute this software and its</span>
00044 <span class="comment">documentation for any purpose and without fee is hereby granted,</span>
00045 <span class="comment">provided that the above copyright notice appear in all copies and that</span>
00046 <span class="comment">both that copyright notice and this permission notice appear in</span>
00047 <span class="comment">supporting documentation, and that the name of CMU not be</span>
00048 <span class="comment">used in advertising or publicity pertaining to distribution of the</span>
00049 <span class="comment">software without specific, written prior permission.</span>
00050 
00051 <span class="comment">CMU DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE, INCLUDING</span>
00052 <span class="comment">ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS, IN NO EVENT SHALL</span>
00053 <span class="comment">CMU BE LIABLE FOR ANY SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR</span>
00054 <span class="comment">ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS,</span>
00055 <span class="comment">WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION,</span>
00056 <span class="comment">ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS</span>
00057 <span class="comment">SOFTWARE.</span>
00058 <span class="comment">******************************************************************/</span>
00059 
00062 <span class="keyword">struct </span><a class="code" href="structvariable__list.html">variable_list</a>;
00063 <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href=
"structvariable__list.html">variable_list</a> netsnmp_variable_list;
00064 <span class="keyword">struct </span>timeval;
00065 <span class="keyword">struct </span>netsnmp_transport_s;
00066 
00067 <span class="preprocessor">#define USM_AUTH_KU_LEN     32</span>
00068 <span class="preprocessor">#define USM_PRIV_KU_LEN     32</span>
00069 
<a name="l00075" id="l00075"></a><a class="code" href="structsnmp__pdu.html">00075</a> <span class=
"keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structsnmp__pdu.html">snmp_pdu</a> {
00076 
00077     <span class="comment">/*</span>
00078 <span class="comment">     * Protocol-version independent fields</span>
00079 <span class="comment">     */</span>
<a name="l00081" id="l00081"></a><a class="code" href="structsnmp__pdu.html#o0">00081</a>     <span class=
"keywordtype">long</span>            version;
<a name="l00083" id="l00083"></a><a class="code" href="structsnmp__pdu.html#o1">00083</a>     <span class=
"keywordtype">int</span>             command;
<a name="l00085" id="l00085"></a><a class="code" href="structsnmp__pdu.html#o2">00085</a>     <span class=
"keywordtype">long</span>            reqid;  
<a name="l00087" id="l00087"></a><a class="code" href="structsnmp__pdu.html#o3">00087</a>     <span class=
"keywordtype">long</span>            msgid;
<a name="l00089" id="l00089"></a><a class="code" href="structsnmp__pdu.html#o4">00089</a>     <span class=
"keywordtype">long</span>            transid;
<a name="l00091" id="l00091"></a><a class="code" href="structsnmp__pdu.html#o5">00091</a>     <span class=
"keywordtype">long</span>            sessid;
<a name="l00093" id="l00093"></a><a class="code" href="structsnmp__pdu.html#o6">00093</a>     <span class=
"keywordtype">long</span>            errstat;
<a name="l00095" id="l00095"></a><a class="code" href="structsnmp__pdu.html#o7">00095</a>     <span class=
"keywordtype">long</span>            errindex;       
<a name="l00097" id="l00097"></a><a class="code" href="structsnmp__pdu.html#o8">00097</a>     u_long          time;   
00098     u_long          flags;
00099 
00100     <span class="keywordtype">int</span>             securityModel;
<a name="l00102" id="l00102"></a><a class="code" href="structsnmp__pdu.html#o11">00102</a>     <span class=
"keywordtype">int</span>             securityLevel;  
00103     <span class="keywordtype">int</span>             msgParseModel;
00104 
<a name="l00110" id="l00110"></a><a class="code" href="structsnmp__pdu.html#o13">00110</a>     <span class=
"keywordtype">void</span>           *transport_data;
00111     <span class="keywordtype">int</span>             transport_data_length;
00112 
<a name="l00117" id="l00117"></a><a class="code" href="structsnmp__pdu.html#o15">00117</a>     <span class=
"keyword">const</span> oid      *tDomain;
00118     size_t          tDomainLen;
00119 
00120     netsnmp_variable_list *variables;
00121 
00122 
00123     <span class="comment">/*</span>
00124 <span class="comment">     * SNMPv1 &amp; SNMPv2c fields</span>
00125 <span class="comment">     */</span>
<a name="l00127" id="l00127"></a><a class="code" href="structsnmp__pdu.html#o18">00127</a>     u_char         *community;
<a name="l00129" id="l00129"></a><a class="code" href="structsnmp__pdu.html#o19">00129</a>     size_t          community_len;  
00130 
00131     <span class="comment">/*</span>
00132 <span class="comment">     * Trap information</span>
00133 <span class="comment">     */</span>
<a name="l00135" id="l00135"></a><a class="code" href="structsnmp__pdu.html#o20">00135</a>     oid            *enterprise;     
00136     size_t          enterprise_length;
<a name="l00138" id="l00138"></a><a class="code" href="structsnmp__pdu.html#o22">00138</a>     <span class=
"keywordtype">long</span>            trap_type;
<a name="l00140" id="l00140"></a><a class="code" href="structsnmp__pdu.html#o23">00140</a>     <span class=
"keywordtype">long</span>            specific_type;
<a name="l00142" id="l00142"></a><a class="code" href="structsnmp__pdu.html#o24">00142</a>     <span class=
"keywordtype">unsigned</span> <span class="keywordtype">char</span>   agent_addr[4];  
00143 
00144     <span class="comment">/*</span>
00145 <span class="comment">     *  SNMPv3 fields</span>
00146 <span class="comment">     */</span>
<a name="l00148" id="l00148"></a><a class="code" href="structsnmp__pdu.html#o25">00148</a>     u_char         *contextEngineID;
<a name="l00150" id="l00150"></a><a class="code" href=
"structsnmp__pdu.html#o26">00150</a>     size_t          contextEngineIDLen;     
<a name="l00152" id="l00152"></a><a class="code" href="structsnmp__pdu.html#o27">00152</a>     <span class=
"keywordtype">char</span>           *contextName;
<a name="l00154" id="l00154"></a><a class="code" href="structsnmp__pdu.html#o28">00154</a>     size_t          contextNameLen;
<a name="l00156" id="l00156"></a><a class="code" href="structsnmp__pdu.html#o29">00156</a>     u_char         *securityEngineID;
<a name="l00158" id="l00158"></a><a class="code" href=
"structsnmp__pdu.html#o30">00158</a>     size_t          securityEngineIDLen;    
<a name="l00160" id="l00160"></a><a class="code" href="structsnmp__pdu.html#o31">00160</a>     <span class=
"keywordtype">char</span>           *securityName;
<a name="l00162" id="l00162"></a><a class="code" href=
"structsnmp__pdu.html#o32">00162</a>     size_t          securityNameLen;        
00163     
00164     <span class="comment">/*</span>
00165 <span class="comment">     * AgentX fields</span>
00166 <span class="comment">     *      (also uses SNMPv1 community field)</span>
00167 <span class="comment">     */</span>
00168     <span class="keywordtype">int</span>             priority;
00169     <span class="keywordtype">int</span>             range_subid;
00170     
00171     <span class="keywordtype">void</span>           *securityStateRef;
00172 } <a class="code" href="structsnmp__pdu.html">netsnmp_pdu</a>;
00173 
00174 <span class="keyword">struct </span><a class="code" href="structsnmp__session.html">snmp_session</a>;
00175 
00178 <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href=
"structsnmp__session.html">snmp_session</a> netsnmp_session;
00179 
00180 <span class="keyword">typedef</span> int     (*snmp_callback) (int, netsnmp_session *, int,
00181                                       <a class="code" href="structsnmp__pdu.html">netsnmp_pdu</a> *, <span class=
"keywordtype">void</span> *);
00182 <span class="keyword">typedef</span> int     (*netsnmp_callback) (int, netsnmp_session *, int,
00183                                          netsnmp_pdu *, <span class="keywordtype">void</span> *);
<a name="l00187" id="l00187"></a><a class="code" href="structsnmp__session.html">00187</a> <span class=
"keyword">struct </span><a class="code" href="structsnmp__session.html">snmp_session</a> {
00188     <span class="comment">/*</span>
00189 <span class="comment">     * Protocol-version independent fields</span>
00190 <span class="comment">     */</span>
<a name="l00192" id="l00192"></a><a class="code" href="structsnmp__session.html#o0">00192</a>     <span class=
"keywordtype">long</span>            version;
<a name="l00194" id="l00194"></a><a class="code" href="structsnmp__session.html#o1">00194</a>     <span class=
"keywordtype">int</span>             retries;
<a name="l00196" id="l00196"></a><a class="code" href="structsnmp__session.html#o2">00196</a>     <span class=
"keywordtype">long</span>            timeout;        
00197     u_long          flags;
00198     <span class="keyword">struct </span><a class="code" href="structsnmp__session.html">snmp_session</a> *subsession;
00199     <span class="keyword">struct </span><a class="code" href="structsnmp__session.html">snmp_session</a> *next;
00200 
<a name="l00202" id="l00202"></a><a class="code" href="structsnmp__session.html#o6">00202</a>     <span class=
"keywordtype">char</span>           *peername;
<a name="l00204" id="l00204"></a><a class="code" href="structsnmp__session.html#o7">00204</a>     u_short         remote_port;
<a name="l00206" id="l00206"></a><a class="code" href="structsnmp__session.html#o8">00206</a>     <span class=
"keywordtype">char</span>           *localname;
<a name="l00208" id="l00208"></a><a class="code" href=
"structsnmp__session.html#o9">00208</a>     u_short         local_port;     
00212     u_char         *(*authenticator) (u_char *, size_t *, u_char *, size_t);
<a name="l00214" id="l00214"></a><a class="code" href=
"structsnmp__session.html#o11">00214</a>     netsnmp_callback callback;      
<a name="l00218" id="l00218"></a><a class="code" href="structsnmp__session.html#o12">00218</a>     <span class=
"keywordtype">void</span>           *callback_magic;
<a name="l00220" id="l00220"></a><a class="code" href="structsnmp__session.html#o13">00220</a>     <span class=
"keywordtype">int</span>             s_errno;
<a name="l00222" id="l00222"></a><a class="code" href="structsnmp__session.html#o14">00222</a>     <span class=
"keywordtype">int</span>             s_snmp_errno;   
<a name="l00224" id="l00224"></a><a class="code" href="structsnmp__session.html#o15">00224</a>     <span class=
"keywordtype">long</span>            sessid; 
00225 
00226     <span class="comment">/*</span>
00227 <span class="comment">     * SNMPv1 &amp; SNMPv2c fields</span>
00228 <span class="comment">     */</span>
<a name="l00230" id="l00230"></a><a class="code" href="structsnmp__session.html#o16">00230</a>     u_char         *community;
<a name="l00232" id="l00232"></a><a class="code" href=
"structsnmp__session.html#o17">00232</a>     size_t          community_len;  
<a name="l00234" id="l00234"></a><a class="code" href="structsnmp__session.html#o18">00234</a>     size_t          rcvMsgMaxSize;
<a name="l00236" id="l00236"></a><a class="code" href=
"structsnmp__session.html#o19">00236</a>     size_t          sndMsgMaxSize;  
00237 
00238     <span class="comment">/*</span>
00239 <span class="comment">     * SNMPv3 fields</span>
00240 <span class="comment">     */</span>
<a name="l00242" id="l00242"></a><a class="code" href=
"structsnmp__session.html#o20">00242</a>     u_char          isAuthoritative;
<a name="l00244" id="l00244"></a><a class="code" href=
"structsnmp__session.html#o21">00244</a>     u_char         *contextEngineID;
<a name="l00246" id="l00246"></a><a class="code" href=
"structsnmp__session.html#o22">00246</a>     size_t          contextEngineIDLen;     
<a name="l00248" id="l00248"></a><a class="code" href="structsnmp__session.html#o23">00248</a>     u_int           engineBoots;
<a name="l00250" id="l00250"></a><a class="code" href="structsnmp__session.html#o24">00250</a>     u_int           engineTime;
<a name="l00252" id="l00252"></a><a class="code" href="structsnmp__session.html#o25">00252</a>     <span class=
"keywordtype">char</span>           *contextName;
<a name="l00254" id="l00254"></a><a class="code" href=
"structsnmp__session.html#o26">00254</a>     size_t          contextNameLen;
<a name="l00256" id="l00256"></a><a class="code" href=
"structsnmp__session.html#o27">00256</a>     u_char         *securityEngineID;
<a name="l00258" id="l00258"></a><a class="code" href=
"structsnmp__session.html#o28">00258</a>     size_t          securityEngineIDLen;    
<a name="l00260" id="l00260"></a><a class="code" href="structsnmp__session.html#o29">00260</a>     <span class=
"keywordtype">char</span>           *securityName;
<a name="l00262" id="l00262"></a><a class="code" href=
"structsnmp__session.html#o30">00262</a>     size_t          securityNameLen;
00263 
<a name="l00265" id="l00265"></a><a class="code" href=
"structsnmp__session.html#o31">00265</a>     oid            *securityAuthProto;
<a name="l00267" id="l00267"></a><a class="code" href=
"structsnmp__session.html#o32">00267</a>     size_t          securityAuthProtoLen;
<a name="l00269" id="l00269"></a><a class="code" href=
"structsnmp__session.html#o33">00269</a>     u_char          securityAuthKey[USM_AUTH_KU_LEN];       
<a name="l00271" id="l00271"></a><a class="code" href=
"structsnmp__session.html#o34">00271</a>     size_t          securityAuthKeyLen;
<a name="l00273" id="l00273"></a><a class="code" href=
"structsnmp__session.html#o35">00273</a>     u_char          *securityAuthLocalKey;       
<a name="l00275" id="l00275"></a><a class="code" href=
"structsnmp__session.html#o36">00275</a>     size_t          securityAuthLocalKeyLen;       
00276 
<a name="l00278" id="l00278"></a><a class="code" href=
"structsnmp__session.html#o37">00278</a>     oid            *securityPrivProto;
<a name="l00280" id="l00280"></a><a class="code" href=
"structsnmp__session.html#o38">00280</a>     size_t          securityPrivProtoLen;
<a name="l00282" id="l00282"></a><a class="code" href=
"structsnmp__session.html#o39">00282</a>     u_char          securityPrivKey[USM_PRIV_KU_LEN];       
<a name="l00284" id="l00284"></a><a class="code" href=
"structsnmp__session.html#o40">00284</a>     size_t          securityPrivKeyLen;
<a name="l00286" id="l00286"></a><a class="code" href=
"structsnmp__session.html#o41">00286</a>     u_char          *securityPrivLocalKey;       
<a name="l00288" id="l00288"></a><a class="code" href=
"structsnmp__session.html#o42">00288</a>     size_t          securityPrivLocalKeyLen;       
00289 
<a name="l00291" id="l00291"></a><a class="code" href="structsnmp__session.html#o43">00291</a>     <span class=
"keywordtype">int</span>             securityModel;
<a name="l00293" id="l00293"></a><a class="code" href="structsnmp__session.html#o44">00293</a>     <span class=
"keywordtype">int</span>             securityLevel;  
<a name="l00295" id="l00295"></a><a class="code" href="structsnmp__session.html#o45">00295</a>     <span class=
"keywordtype">char</span>           *paramName;
00296 
<a name="l00300" id="l00300"></a><a class="code" href="structsnmp__session.html#o46">00300</a>     <span class=
"keywordtype">void</span>           *securityInfo;
00301 
<a name="l00305" id="l00305"></a><a class="code" href="structsnmp__session.html#o47">00305</a>     <span class=
"keywordtype">void</span>           *myvoid;
00306 };
00307 
00308 <span class="comment">/*</span>
00309 <span class="comment"> * A list of all the outstanding requests for a particular session.</span>
00310 <span class="comment"> */</span>
00311 <span class="preprocessor">#ifdef SNMP_NEED_REQUEST_LIST</span>
00312 <span class="keyword">typedef</span> <span class="keyword">struct </span>request_list {
00313     <span class="keyword">struct </span>request_list *next_request;
00314     <span class="keywordtype">long</span>            request_id;     <span class="comment">/* request id */</span>
00315     <span class="keywordtype">long</span>            message_id;     <span class="comment">/* message id */</span>
00316     netsnmp_callback callback;      <span class="comment">/* user callback per request (NULL if unused) */</span>
00317     <span class="keywordtype">void</span>           *cb_data;        <span class=
"comment">/* user callback data per request (NULL if unused) */</span>
00318     <span class="keywordtype">int</span>             retries;        <span class="comment">/* Number of retries */</span>
00319     u_long          timeout;        <span class="comment">/* length to wait for timeout */</span>
00320     <span class="keyword">struct </span>timeval  time;   <span class="comment">/* Time this request was made */</span>
00321     <span class="keyword">struct </span>timeval  expire; <span class=
"comment">/* time this request is due to expire */</span>
00322     <span class="keyword">struct </span><a class="code" href="structsnmp__session.html">snmp_session</a> *session;
00323     netsnmp_pdu    *pdu;    <span class="comment">/* The pdu for this request</span>
00324 <span class="comment">                             * (saved so it can be retransmitted */</span>
00325 } netsnmp_request_list;
00326 <span class="preprocessor">#endif                          </span><span class="comment">/* SNMP_NEED_REQUEST_LIST */</span>
00327 
00328     <span class="comment">/*</span>
00329 <span class="comment">     * Set fields in session and pdu to the following to get a default or unconfigured value.</span>
00330 <span class="comment">     */</span>
00331 <span class="preprocessor">#define SNMP_DEFAULT_COMMUNITY_LEN  0   </span><span class=
"comment">/* to get a default community name */</span>
00332 <span class="preprocessor">#define SNMP_DEFAULT_RETRIES        -1</span>
00333 <span class="preprocessor">#define SNMP_DEFAULT_TIMEOUT        -1</span>
00334 <span class="preprocessor">#define SNMP_DEFAULT_REMPORT        0</span>
00335 <span class="preprocessor">#define SNMP_DEFAULT_REQID          -1</span>
00336 <span class="preprocessor">#define SNMP_DEFAULT_MSGID          -1</span>
00337 <span class="preprocessor">#define SNMP_DEFAULT_ERRSTAT        -1</span>
00338 <span class="preprocessor">#define SNMP_DEFAULT_ERRINDEX       -1</span>
00339 <span class="preprocessor">#define SNMP_DEFAULT_ADDRESS        0</span>
00340 <span class="preprocessor">#define SNMP_DEFAULT_PEERNAME       NULL</span>
00341 <span class="preprocessor">#define SNMP_DEFAULT_ENTERPRISE_LENGTH  0</span>
00342 <span class="preprocessor">#define SNMP_DEFAULT_TIME           0</span>
00343 <span class="preprocessor">#define SNMP_DEFAULT_VERSION        -1</span>
00344 <span class="preprocessor">#define SNMP_DEFAULT_SECMODEL       -1</span>
00345 <span class="preprocessor">#define SNMP_DEFAULT_CONTEXT        ""</span>
00346 <span class="preprocessor">#ifndef DISABLE_MD5</span>
00347 <span class="preprocessor">#define SNMP_DEFAULT_AUTH_PROTO     usmHMACMD5AuthProtocol</span>
00348 <span class="preprocessor">#else</span>
00349 <span class="preprocessor">#define SNMP_DEFAULT_AUTH_PROTO     usmHMACSHA1AuthProtocol</span>
00350 <span class="preprocessor">#endif</span>
00351 <span class="preprocessor">#define SNMP_DEFAULT_AUTH_PROTOLEN  USM_LENGTH_OID_TRANSFORM</span>
00352 <span class="preprocessor">#ifndef DISABLE_DES</span>
00353 <span class="preprocessor">#define SNMP_DEFAULT_PRIV_PROTO     usmDESPrivProtocol</span>
00354 <span class="preprocessor">#else</span>
00355 <span class="preprocessor">#define SNMP_DEFAULT_PRIV_PROTO     usmAESPrivProtocol</span>
00356 <span class="preprocessor">#endif</span>
00357 <span class="preprocessor">#define SNMP_DEFAULT_PRIV_PROTOLEN  USM_LENGTH_OID_TRANSFORM</span>
00358 
00359     <span class="keyword">extern</span> <span class="keyword">const</span> <span class=
"keywordtype">char</span> *snmp_api_errstring(<span class="keywordtype">int</span>);
00360     <span class="keyword">extern</span> <span class="keywordtype">void</span>     snmp_perror(<span class=
"keyword">const</span> <span class="keywordtype">char</span> *);
00361     <span class="keyword">extern</span> <span class="keywordtype">void</span>     snmp_set_detail(<span class=
"keyword">const</span> <span class="keywordtype">char</span> *);
00362 
00363 <span class="preprocessor">#define SNMP_MAX_MSG_SIZE          1472 </span><span class=
"comment">/* ethernet MTU minus IP/UDP header */</span>
00364 <span class="preprocessor">#define SNMP_MAX_MSG_V3_HDRS       (4+3+4+7+7+3+7+16)   </span><span class=
"comment">/* fudge factor=16 */</span>
00365 <span class="preprocessor">#define SNMP_MAX_ENG_SIZE          32</span>
00366 <span class="preprocessor">#define SNMP_MAX_SEC_NAME_SIZE     256</span>
00367 <span class="preprocessor">#define SNMP_MAX_CONTEXT_SIZE      256</span>
00368 <span class="preprocessor">#define SNMP_SEC_PARAM_BUF_SIZE    256</span>
00369 
00370     <span class="comment">/*</span>
00371 <span class="comment">     * set to one to ignore unauthenticated Reports </span>
00372 <span class="comment">     */</span>
00373 <span class="preprocessor">#define SNMPV3_IGNORE_UNAUTH_REPORTS 0</span>
00374 
00375     <span class="comment">/*</span>
00376 <span class="comment">     * authoritative engine definitions </span>
00377 <span class="comment">     */</span>
00378 <span class="preprocessor">#define SNMP_SESS_NONAUTHORITATIVE 0    </span><span class=
"comment">/* should be 0 to default to this */</span>
00379 <span class="preprocessor">#define SNMP_SESS_AUTHORITATIVE    1    </span><span class=
"comment">/* don't learn engineIDs */</span>
00380 <span class="preprocessor">#define SNMP_SESS_UNKNOWNAUTH      2    </span><span class=
"comment">/* sometimes (like NRs) */</span>
00381 
00382     <span class="comment">/*</span>
00383 <span class="comment">     * to determine type of Report from varbind_list </span>
00384 <span class="comment">     */</span>
00385 <span class="preprocessor">#define REPORT_STATS_LEN 9</span>
00386 <span class="preprocessor">#define REPORT_snmpUnknownSecurityModels_NUM 1</span>
00387 <span class="preprocessor">#define REPORT_snmpInvalidMsgs_NUM 2</span>
00388 <span class="preprocessor">#define REPORT_usmStatsUnsupportedSecLevels_NUM 1</span>
00389 <span class="preprocessor">#define REPORT_usmStatsNotInTimeWindows_NUM 2</span>
00390 <span class="preprocessor">#define REPORT_usmStatsUnknownUserNames_NUM 3</span>
00391 <span class="preprocessor">#define REPORT_usmStatsUnknownEngineIDs_NUM 4</span>
00392 <span class="preprocessor">#define REPORT_usmStatsWrongDigests_NUM 5</span>
00393 <span class="preprocessor">#define REPORT_usmStatsDecryptionErrors_NUM 6</span>
00394 
00395 <span class="preprocessor">#define SNMP_DETAIL_SIZE        512</span>
00396 
00397 <span class="preprocessor">#define SNMP_FLAGS_USER_CREATED    0x200      </span><span class=
"comment">/* USM user has been created */</span>
00398 <span class="preprocessor">#define SNMP_FLAGS_DONT_PROBE      0x100      </span><span class=
"comment">/* don't probe for an engineID */</span>
00399 <span class="preprocessor">#define SNMP_FLAGS_STREAM_SOCKET   0x80</span>
00400 <span class="preprocessor">#define SNMP_FLAGS_LISTENING       0x40 </span><span class=
"comment">/* Server stream sockets only */</span>
00401 <span class="preprocessor">#define SNMP_FLAGS_SUBSESSION      0x20</span>
00402 <span class="preprocessor">#define SNMP_FLAGS_STRIKE2         0x02</span>
00403 <span class="preprocessor">#define SNMP_FLAGS_STRIKE1         0x01</span>
00404 
00405 <span class="preprocessor">#define CLEAR_SNMP_STRIKE_FLAGS(x) \</span>
00406 <span class="preprocessor">        x &amp;= ~(SNMP_FLAGS_STRIKE2|SNMP_FLAGS_STRIKE1)</span>
00407 
00408     <span class="comment">/*</span>
00409 <span class="comment">     * returns '1' if the session is to be regarded as dead,</span>
00410 <span class="comment">     * otherwise set the strike flags appropriately, and return 0</span>
00411 <span class="comment">     */</span>
00412 <span class="preprocessor">#define SET_SNMP_STRIKE_FLAGS(x) \</span>
00413 <span class="preprocessor">        ((   x &amp; SNMP_FLAGS_STRIKE2 ) ? 1 :                             \</span>
00414 <span class="preprocessor">         ((( x &amp; SNMP_FLAGS_STRIKE1 ) ? ( x |= SNMP_FLAGS_STRIKE2 ) :   \</span>
00415 <span class="preprocessor">                                        ( x |= SNMP_FLAGS_STRIKE1 )),   \</span>
00416 <span class="preprocessor">                                        0))</span>
00417 
00418     <span class="comment">/*</span>
00419 <span class="comment">     * Error return values.</span>
00420 <span class="comment">     *</span>
00421 <span class="comment">     * SNMPERR_SUCCESS is the non-PDU "success" code.</span>
00422 <span class="comment">     *</span>
00423 <span class="comment">     * XXX  These should be merged with SNMP_ERR_* defines and confined</span>
00424 <span class="comment">     *      to values &lt; 0.  ???</span>
00425 <span class="comment">     */</span>
00426 <span class="preprocessor">#define SNMPERR_SUCCESS                 (0)     </span><span class=
"comment">/* XXX  Non-PDU "success" code. */</span>
00427 <span class="preprocessor">#define SNMPERR_GENERR                  (-1)</span>
00428 <span class="preprocessor">#define SNMPERR_BAD_LOCPORT             (-2)</span>
00429 <span class="preprocessor">#define SNMPERR_BAD_ADDRESS             (-3)</span>
00430 <span class="preprocessor">#define SNMPERR_BAD_SESSION             (-4)</span>
00431 <span class="preprocessor">#define SNMPERR_TOO_LONG                (-5)</span>
00432 <span class="preprocessor">#define SNMPERR_NO_SOCKET               (-6)</span>
00433 <span class="preprocessor">#define SNMPERR_V2_IN_V1                (-7)</span>
00434 <span class="preprocessor">#define SNMPERR_V1_IN_V2                (-8)</span>
00435 <span class="preprocessor">#define SNMPERR_BAD_REPEATERS           (-9)</span>
00436 <span class="preprocessor">#define SNMPERR_BAD_REPETITIONS         (-10)</span>
00437 <span class="preprocessor">#define SNMPERR_BAD_ASN1_BUILD          (-11)</span>
00438 <span class="preprocessor">#define SNMPERR_BAD_SENDTO              (-12)</span>
00439 <span class="preprocessor">#define SNMPERR_BAD_PARSE               (-13)</span>
00440 <span class="preprocessor">#define SNMPERR_BAD_VERSION             (-14)</span>
00441 <span class="preprocessor">#define SNMPERR_BAD_SRC_PARTY           (-15)</span>
00442 <span class="preprocessor">#define SNMPERR_BAD_DST_PARTY           (-16)</span>
00443 <span class="preprocessor">#define SNMPERR_BAD_CONTEXT             (-17)</span>
00444 <span class="preprocessor">#define SNMPERR_BAD_COMMUNITY           (-18)</span>
00445 <span class="preprocessor">#define SNMPERR_NOAUTH_DESPRIV          (-19)</span>
00446 <span class="preprocessor">#define SNMPERR_BAD_ACL                 (-20)</span>
00447 <span class="preprocessor">#define SNMPERR_BAD_PARTY               (-21)</span>
00448 <span class="preprocessor">#define SNMPERR_ABORT                   (-22)</span>
00449 <span class="preprocessor">#define SNMPERR_UNKNOWN_PDU             (-23)</span>
00450 <span class="preprocessor">#define SNMPERR_TIMEOUT                 (-24)</span>
00451 <span class="preprocessor">#define SNMPERR_BAD_RECVFROM            (-25)</span>
00452 <span class="preprocessor">#define SNMPERR_BAD_ENG_ID              (-26)</span>
00453 <span class="preprocessor">#define SNMPERR_BAD_SEC_NAME            (-27)</span>
00454 <span class="preprocessor">#define SNMPERR_BAD_SEC_LEVEL           (-28)</span>
00455 <span class="preprocessor">#define SNMPERR_ASN_PARSE_ERR           (-29)</span>
00456 <span class="preprocessor">#define SNMPERR_UNKNOWN_SEC_MODEL       (-30)</span>
00457 <span class="preprocessor">#define SNMPERR_INVALID_MSG             (-31)</span>
00458 <span class="preprocessor">#define SNMPERR_UNKNOWN_ENG_ID          (-32)</span>
00459 <span class="preprocessor">#define SNMPERR_UNKNOWN_USER_NAME       (-33)</span>
00460 <span class="preprocessor">#define SNMPERR_UNSUPPORTED_SEC_LEVEL   (-34)</span>
00461 <span class="preprocessor">#define SNMPERR_AUTHENTICATION_FAILURE  (-35)</span>
00462 <span class="preprocessor">#define SNMPERR_NOT_IN_TIME_WINDOW      (-36)</span>
00463 <span class="preprocessor">#define SNMPERR_DECRYPTION_ERR          (-37)</span>
00464 <span class="preprocessor">#define SNMPERR_SC_GENERAL_FAILURE      (-38)</span>
00465 <span class="preprocessor">#define SNMPERR_SC_NOT_CONFIGURED       (-39)</span>
00466 <span class="preprocessor">#define SNMPERR_KT_NOT_AVAILABLE        (-40)</span>
00467 <span class="preprocessor">#define SNMPERR_UNKNOWN_REPORT          (-41)</span>
00468 <span class="preprocessor">#define SNMPERR_USM_GENERICERROR                (-42)</span>
00469 <span class="preprocessor">#define SNMPERR_USM_UNKNOWNSECURITYNAME         (-43)</span>
00470 <span class="preprocessor">#define SNMPERR_USM_UNSUPPORTEDSECURITYLEVEL    (-44)</span>
00471 <span class="preprocessor">#define SNMPERR_USM_ENCRYPTIONERROR             (-45)</span>
00472 <span class="preprocessor">#define SNMPERR_USM_AUTHENTICATIONFAILURE       (-46)</span>
00473 <span class="preprocessor">#define SNMPERR_USM_PARSEERROR                  (-47)</span>
00474 <span class="preprocessor">#define SNMPERR_USM_UNKNOWNENGINEID             (-48)</span>
00475 <span class="preprocessor">#define SNMPERR_USM_NOTINTIMEWINDOW             (-49)</span>
00476 <span class="preprocessor">#define SNMPERR_USM_DECRYPTIONERROR             (-50)</span>
00477 <span class="preprocessor">#define SNMPERR_NOMIB                   (-51)</span>
00478 <span class="preprocessor">#define SNMPERR_RANGE                   (-52)</span>
00479 <span class="preprocessor">#define SNMPERR_MAX_SUBID               (-53)</span>
00480 <span class="preprocessor">#define SNMPERR_BAD_SUBID               (-54)</span>
00481 <span class="preprocessor">#define SNMPERR_LONG_OID                (-55)</span>
00482 <span class="preprocessor">#define SNMPERR_BAD_NAME                (-56)</span>
00483 <span class="preprocessor">#define SNMPERR_VALUE                   (-57)</span>
00484 <span class="preprocessor">#define SNMPERR_UNKNOWN_OBJID           (-58)</span>
00485 <span class="preprocessor">#define SNMPERR_NULL_PDU                (-59)</span>
00486 <span class="preprocessor">#define SNMPERR_NO_VARS                 (-60)</span>
00487 <span class="preprocessor">#define SNMPERR_VAR_TYPE                (-61)</span>
00488 <span class="preprocessor">#define SNMPERR_MALLOC                  (-62)</span>
00489 <span class="preprocessor">#define SNMPERR_KRB5                    (-63)</span>
00490 <span class="preprocessor">#define SNMPERR_PROTOCOL                (-64)</span>
00491 
00492 <span class="preprocessor">#define SNMPERR_MAX                     (-64)</span>
00493 
00494 <span class="preprocessor">#define non_repeaters   errstat</span>
00495 <span class="preprocessor">#define max_repetitions errindex</span>
00496 
00497 <span class="keyword">typedef</span> <span class="keyword">union </span>{
00498    <span class="keywordtype">long</span>           *integer;
00499    u_char         *string;
00500    oid            *objid;
00501    u_char         *bitstring;
00502    <span class="keyword">struct </span>counter64 *counter64;
00503 <span class="preprocessor">#ifdef OPAQUE_SPECIAL_TYPES</span>
00504    <span class="keywordtype">float</span>          *floatVal;
00505    <span class="keywordtype">double</span>         *doubleVal;
00506    <span class="comment">/*</span>
00507 <span class="comment">    * t_union *unionVal; </span>
00508 <span class="comment">    */</span>
00509 <span class="preprocessor">#endif                          </span><span class="comment">/* OPAQUE_SPECIAL_TYPES */</span>
00510 } netsnmp_vardata;
00511 
00512 
<a name="l00517" id="l00517"></a><a class="code" href="structvariable__list.html">00517</a> <span class=
"keyword">struct </span><a class="code" href="structvariable__list.html">variable_list</a> {
<a name="l00519" id="l00519"></a><a class="code" href="structvariable__list.html#o0">00519</a>    <span class=
"keyword">struct </span><a class="code" href="structvariable__list.html">variable_list</a> *next_variable;    
<a name="l00521" id="l00521"></a><a class="code" href="structvariable__list.html#o1">00521</a>    oid            *name;   
<a name="l00523" id="l00523"></a><a class="code" href=
"structvariable__list.html#o2">00523</a>    size_t          name_length;    
<a name="l00525" id="l00525"></a><a class="code" href="structvariable__list.html#o3">00525</a>    u_char          type;   
<a name="l00527" id="l00527"></a><a class="code" href="structvariable__list.html#o4">00527</a>     netsnmp_vardata val;
<a name="l00529" id="l00529"></a><a class="code" href="structvariable__list.html#o5">00529</a>    size_t          val_len;
<a name="l00531" id="l00531"></a><a class="code" href=
"structvariable__list.html#o6">00531</a>    oid             name_loc[MAX_OID_LEN];  
<a name="l00533" id="l00533"></a><a class="code" href="structvariable__list.html#o7">00533</a>    u_char          buf[40];
<a name="l00535" id="l00535"></a><a class="code" href="structvariable__list.html#o8">00535</a>    <span class=
"keywordtype">void</span>           *data;
00537    void            (*dataFreeHook)(<span class="keywordtype">void</span> *);    
00538    <span class="keywordtype">int</span>             index;
00539 };
00540 
00541 
00542 
00543     <span class="comment">/*</span>
00544 <span class="comment">     * netsnmp_session *snmp_open(session)</span>
00545 <span class="comment">     *      netsnmp_session *session;</span>
00546 <span class="comment">     *</span>
00547 <span class="comment">     * Sets up the session with the snmp_session information provided</span>
00548 <span class="comment">     * by the user.  Then opens and binds the necessary UDP port.</span>
00549 <span class="comment">     * A handle to the created session is returned (this is different than</span>
00550 <span class="comment">     * the pointer passed to snmp_open()).  On any error, NULL is returned</span>
00551 <span class="comment">     * and snmp_errno is set to the appropriate error code.</span>
00552 <span class="comment">     */</span>
00553     netsnmp_session *snmp_open(netsnmp_session *);
00554 
00555     <span class="comment">/*</span>
00556 <span class="comment">     * int snmp_close(session)</span>
00557 <span class="comment">     *     netsnmp_session *session;</span>
00558 <span class="comment">     *</span>
00559 <span class="comment">     * Close the input session.  Frees all data allocated for the session,</span>
00560 <span class="comment">     * dequeues any pending requests, and closes any sockets allocated for</span>
00561 <span class="comment">     * the session.  Returns 0 on error, 1 otherwise.</span>
00562 <span class="comment">     *</span>
00563 <span class="comment">     * snmp_close_sessions() does the same thing for all open sessions</span>
00564 <span class="comment">     */</span>
00565     <span class="keywordtype">int</span>             snmp_close(netsnmp_session *);
00566     <span class="keywordtype">int</span>             snmp_close_sessions(<span class="keywordtype">void</span>);
00567 
00568 
00569     <span class="comment">/*</span>
00570 <span class="comment">     * int snmp_send(session, pdu)</span>
00571 <span class="comment">     *     netsnmp_session *session;</span>
00572 <span class="comment">     *     netsnmp_pdu      *pdu;</span>
00573 <span class="comment">     *</span>
00574 <span class="comment">     * Sends the input pdu on the session after calling snmp_build to create</span>
00575 <span class="comment">     * a serialized packet.  If necessary, set some of the pdu data from the</span>
00576 <span class="comment">     * session defaults.  Add a request corresponding to this pdu to the list</span>
00577 <span class="comment">     * of outstanding requests on this session, then send the pdu.</span>
00578 <span class="comment">     * Returns the request id of the generated packet if applicable, otherwise 1.</span>
00579 <span class="comment">     * On any error, 0 is returned.</span>
00580 <span class="comment">     * The pdu is freed by snmp_send() unless a failure occured.</span>
00581 <span class="comment">     */</span>
00582     <span class="keywordtype">int</span>             snmp_send(netsnmp_session *, netsnmp_pdu *);
00583 
00584     <span class="comment">/*</span>
00585 <span class="comment">     * int snmp_async_send(session, pdu, callback, cb_data)</span>
00586 <span class="comment">     *     netsnmp_session *session;</span>
00587 <span class="comment">     *     netsnmp_pdu      *pdu;</span>
00588 <span class="comment">     *     netsnmp_callback callback;</span>
00589 <span class="comment">     *     void   *cb_data;</span>
00590 <span class="comment">     *</span>
00591 <span class="comment">     * Sends the input pdu on the session after calling snmp_build to create</span>
00592 <span class="comment">     * a serialized packet.  If necessary, set some of the pdu data from the</span>
00593 <span class="comment">     * session defaults.  Add a request corresponding to this pdu to the list</span>
00594 <span class="comment">     * of outstanding requests on this session and store callback and data,</span>
00595 <span class="comment">     * then send the pdu.</span>
00596 <span class="comment">     * Returns the request id of the generated packet if applicable, otherwise 1.</span>
00597 <span class="comment">     * On any error, 0 is returned.</span>
00598 <span class="comment">     * The pdu is freed by snmp_send() unless a failure occured.</span>
00599 <span class="comment">     */</span>
00600     <span class="keywordtype">int</span>             snmp_async_send(netsnmp_session *, netsnmp_pdu *,
00601                                     netsnmp_callback, <span class="keywordtype">void</span> *);
00602 
00603 
00604     <span class="comment">/*</span>
00605 <span class="comment">     * void snmp_read(fdset)</span>
00606 <span class="comment">     *     fd_set  *fdset;</span>
00607 <span class="comment">     *</span>
00608 <span class="comment">     * Checks to see if any of the fd's set in the fdset belong to</span>
00609 <span class="comment">     * snmp.  Each socket with it's fd set has a packet read from it</span>
00610 <span class="comment">     * and snmp_parse is called on the packet received.  The resulting pdu</span>
00611 <span class="comment">     * is passed to the callback routine for that session.  If the callback</span>
00612 <span class="comment">     * routine returns successfully, the pdu and it's request are deleted.</span>
00613 <span class="comment">     */</span>
00614     <span class="keywordtype">void</span>            snmp_read(fd_set *);
00615 
00616 
00617 
00618     <span class="comment">/*</span>
00619 <span class="comment">     * void</span>
00620 <span class="comment">     * snmp_free_pdu(pdu)</span>
00621 <span class="comment">     *     netsnmp_pdu *pdu;</span>
00622 <span class="comment">     *</span>
00623 <span class="comment">     * Frees the pdu and any malloc'd data associated with it.</span>
00624 <span class="comment">     */</span>
00625     <span class="keywordtype">void</span>            snmp_free_pdu(netsnmp_pdu *);
00626 
00627     <span class="keywordtype">void</span>            snmp_free_var(netsnmp_variable_list *);     <span class=
"comment">/* frees just this one */</span>
00628 
00629     <span class="keywordtype">void</span>            snmp_free_varbind(netsnmp_variable_list * var);     <span class=
"comment">/* frees all in list */</span>
00630 
00631     <span class="comment">/*</span>
00632 <span class="comment">     * int snmp_select_info(numfds, fdset, timeout, block)</span>
00633 <span class="comment">     * int *numfds;</span>
00634 <span class="comment">     * fd_set   *fdset;</span>
00635 <span class="comment">     * struct timeval *timeout;</span>
00636 <span class="comment">     * int *block;</span>
00637 <span class="comment">     *</span>
00638 <span class="comment">     * Returns info about what snmp requires from a select statement.</span>
00639 <span class="comment">     * numfds is the number of fds in the list that are significant.</span>
00640 <span class="comment">     * All file descriptors opened for SNMP are OR'd into the fdset.</span>
00641 <span class="comment">     * If activity occurs on any of these file descriptors, snmp_read</span>
00642 <span class="comment">     * should be called with that file descriptor set.</span>
00643 <span class="comment">     *</span>
00644 <span class="comment">     * The timeout is the latest time that SNMP can wait for a timeout.  The</span>
00645 <span class="comment">     * select should be done with the minimum time between timeout and any other</span>
00646 <span class="comment">     * timeouts necessary.  This should be checked upon each invocation of select.</span>
00647 <span class="comment">     * If a timeout is received, snmp_timeout should be called to check if the</span>
00648 <span class="comment">     * timeout was for SNMP.  (snmp_timeout is idempotent)</span>
00649 <span class="comment">     *</span>
00650 <span class="comment">     * Block is 1 if the select is requested to block indefinitely, rather than</span>
00651 <span class="comment">     * time out.  If block is input as 1, the timeout value will be treated as</span>
00652 <span class="comment">     * undefined, but it must be available for setting in snmp_select_info.  On</span>
00653 <span class="comment">     * return, if block is true, the value of timeout will be undefined.</span>
00654 <span class="comment">     *</span>
00655 <span class="comment">     * snmp_select_info returns the number of open sockets.  (i.e. The number</span>
00656 <span class="comment">     * of sessions open)</span>
00657 <span class="comment">     */</span>
00658     <span class="keywordtype">int</span>             snmp_select_info(<span class=
"keywordtype">int</span> *, fd_set *, <span class="keyword">struct</span> timeval *,
00659                                      <span class="keywordtype">int</span> *);
00660 
00661 
00662 
00663     <span class="comment">/*</span>
00664 <span class="comment">     * void snmp_timeout();</span>
00665 <span class="comment">     *</span>
00666 <span class="comment">     * snmp_timeout should be called whenever the timeout from snmp_select_info</span>
00667 <span class="comment">     * expires, but it is idempotent, so snmp_timeout can be polled (probably a</span>
00668 <span class="comment">     * cpu expensive proposition).  snmp_timeout checks to see if any of the</span>
00669 <span class="comment">     * sessions have an outstanding request that has timed out.  If it finds one</span>
00670 <span class="comment">     * (or more), and that pdu has more retries available, a new packet is formed</span>
00671 <span class="comment">     * from the pdu and is resent.  If there are no more retries available, the</span>
00672 <span class="comment">     * callback for the session is used to alert the user of the timeout.</span>
00673 <span class="comment">     */</span>
00674 
00675     <span class="keywordtype">void</span>            snmp_timeout(<span class="keywordtype">void</span>);
00676 
00677 
00678     <span class="comment">/*</span>
00679 <span class="comment">     * This routine must be supplied by the application:</span>
00680 <span class="comment">     *</span>
00681 <span class="comment">     * u_char *authenticator(pdu, length, community, community_len)</span>
00682 <span class="comment">     * u_char *pdu;         The rest of the PDU to be authenticated</span>
00683 <span class="comment">     * int *length;         The length of the PDU (updated by the authenticator)</span>
00684 <span class="comment">     * u_char *community;   The community name to authenticate under.</span>
00685 <span class="comment">     * int  community_len   The length of the community name.</span>
00686 <span class="comment">     *</span>
00687 <span class="comment">     * Returns the authenticated pdu, or NULL if authentication failed.</span>
00688 <span class="comment">     * If null authentication is used, the authenticator in snmp_session can be</span>
00689 <span class="comment">     * set to NULL(0).</span>
00690 <span class="comment">     */</span>
00691 
00692 
00693 
00694     <span class="comment">/*</span>
00695 <span class="comment">     * This routine must be supplied by the application:</span>
00696 <span class="comment">     *</span>
00697 <span class="comment">     * int callback(operation, session, reqid, pdu, magic)</span>
00698 <span class="comment">     * int operation;</span>
00699 <span class="comment">     * netsnmp_session *session;    The session authenticated under.</span>
00700 <span class="comment">     * int reqid;                       The request id of this pdu (0 for TRAP)</span>
00701 <span class="comment">     * netsnmp_pdu *pdu;        The pdu information.</span>
00702 <span class="comment">     * void *magic                      A link to the data for this routine.</span>
00703 <span class="comment">     *</span>
00704 <span class="comment">     * Returns 1 if request was successful, 0 if it should be kept pending.</span>
00705 <span class="comment">     * Any data in the pdu must be copied because it will be freed elsewhere.</span>
00706 <span class="comment">     * Operations are defined below:</span>
00707 <span class="comment">     */</span>
00708 
00709 <span class="preprocessor">#define NETSNMP_CALLBACK_OP_RECEIVED_MESSAGE    1</span>
00710 <span class="preprocessor">#define NETSNMP_CALLBACK_OP_TIMED_OUT           2</span>
00711 <span class="preprocessor">#define NETSNMP_CALLBACK_OP_SEND_FAILED         3</span>
00712 <span class="preprocessor">#define NETSNMP_CALLBACK_OP_CONNECT             4</span>
00713 <span class="preprocessor">#define NETSNMP_CALLBACK_OP_DISCONNECT          5</span>
00714 
00715     <span class="keywordtype">long</span>            snmp_get_next_msgid(<span class="keywordtype">void</span>);
00716     <span class="keywordtype">long</span>            snmp_get_next_reqid(<span class="keywordtype">void</span>);
00717     <span class="keywordtype">long</span>            snmp_get_next_sessid(<span class="keywordtype">void</span>);
00718     <span class="keywordtype">long</span>            snmp_get_next_transid(<span class="keywordtype">void</span>);
00719 
00720     <span class="keywordtype">int</span>             <a class="code" href=
"group__library.html#ga103">snmp_oid_compare</a>(<span class="keyword">const</span> oid *, size_t, <span class=
"keyword">const</span> oid *,
00721                                      size_t);
00722     <span class="keywordtype">int</span>             snmp_oid_ncompare(<span class=
"keyword">const</span> oid *, size_t, <span class="keyword">const</span> oid *,
00723                                       size_t, size_t);
00724     <span class="keywordtype">int</span>             <a class="code" href=
"group__library.html#ga105">snmp_oidtree_compare</a>(<span class="keyword">const</span> oid *, size_t, <span class=
"keyword">const</span> oid *,
00725                                          size_t);
00726     <span class="keywordtype">int</span>             <a class="code" href=
"group__library.html#ga104">netsnmp_oid_compare_ll</a>(<span class="keyword">const</span> oid * in_name1,
00727                                            size_t len1, <span class="keyword">const</span> oid * in_name2,
00728                                            size_t len2, size_t *offpt);
00729     <span class="keywordtype">int</span>             <a class="code" href=
"group__library.html#ga106">netsnmp_oid_equals</a>(<span class="keyword">const</span> oid *, size_t, <span class=
"keyword">const</span> oid *,
00730                                        size_t);
00731     <span class="keywordtype">int</span>             netsnmp_oid_tree_equals(<span class=
"keyword">const</span> oid *, size_t, <span class="keyword">const</span> oid *,
00732                                             size_t);
00733     <span class="keywordtype">int</span>             <a class="code" href=
"group__library.html#ga107">netsnmp_oid_is_subtree</a>(<span class="keyword">const</span> oid *, size_t, <span class=
"keyword">const</span> oid *,
00734                                            size_t);
00735     <span class="keywordtype">int</span>             <a class="code" href=
"group__library.html#ga108">netsnmp_oid_find_prefix</a>(<span class="keyword">const</span> oid * in_name1, size_t len1,
00736                                             <span class="keyword">const</span> oid * in_name2, size_t len2);
00737     <span class="keywordtype">void</span>            <a class="code" href=
"group__library.html#ga56">init_snmp</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *);
00738     u_char         *snmp_pdu_build(netsnmp_pdu *, u_char *, size_t *);
00739 <span class="preprocessor">#ifdef USE_REVERSE_ASNENCODING</span>
00740     u_char         *snmp_pdu_rbuild(netsnmp_pdu *, u_char *, size_t *);
00741 <span class="preprocessor">#endif</span>
00742     <span class="keywordtype">int</span>             snmpv3_parse(netsnmp_pdu *, u_char *, size_t *,
00743                                  u_char **, netsnmp_session *);
00744     <span class="keywordtype">int</span>             snmpv3_packet_build(netsnmp_session *,
00745                                         netsnmp_pdu *pdu, u_char * packet,
00746                                         size_t * out_length,
00747                                         u_char * pdu_data,
00748                                         size_t pdu_data_len);
00749     <span class="keywordtype">int</span>             snmpv3_packet_rbuild(netsnmp_session *,
00750                                          netsnmp_pdu *pdu, u_char * packet,
00751                                          size_t * out_length,
00752                                          u_char * pdu_data,
00753                                          size_t pdu_data_len);
00754     <span class="keywordtype">int</span>             snmpv3_make_report(netsnmp_pdu *pdu, <span class=
"keywordtype">int</span> error);
00755     <span class="keywordtype">int</span>             snmpv3_get_report_type(netsnmp_pdu *pdu);
00756     <span class="keywordtype">int</span>             snmp_pdu_parse(netsnmp_pdu *pdu, u_char * data,
00757                                    size_t * length);
00758     u_char         *snmpv3_scopedPDU_parse(netsnmp_pdu *pdu, u_char * cp,
00759                                            size_t * length);
00760     <span class="keywordtype">void</span>            snmp_store(<span class="keyword">const</span> <span class=
"keywordtype">char</span> *type);
00761     <span class="keywordtype">void</span>            <a class="code" href=
"group__library.html#ga58">snmp_shutdown</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *type);
00762     netsnmp_variable_list *snmp_pdu_add_variable(netsnmp_pdu *, <span class="keyword">const</span> oid *,
00763                                                  size_t, u_char, <span class="keyword">const</span> u_char *,
00764                                                  size_t);
00765     netsnmp_variable_list *snmp_varlist_add_variable(netsnmp_variable_list
00766                                                      ** varlist,
00767                                                      <span class="keyword">const</span> oid * name,
00768                                                      size_t name_length,
00769                                                      u_char type,
00770                                                      <span class="keyword">const</span> u_char * value,
00771                                                      size_t len);
00772     <span class="keywordtype">int</span>             snmp_add_var(netsnmp_pdu *, <span class=
"keyword">const</span> oid *, size_t, <span class="keywordtype">char</span>,
00773                                  <span class="keyword">const</span> <span class="keywordtype">char</span> *);
00774     oid            *snmp_duplicate_objid(<span class="keyword">const</span> oid * objToCopy, size_t);
00775     u_int           snmp_increment_statistic(<span class="keywordtype">int</span> which);
00776     u_int           snmp_increment_statistic_by(<span class="keywordtype">int</span> which, <span class=
"keywordtype">int</span> count);
00777     u_int           snmp_get_statistic(<span class="keywordtype">int</span> which);
00778     <span class="keywordtype">void</span>            snmp_init_statistics(<span class="keywordtype">void</span>);
00779     <span class="keywordtype">int</span>             create_user_from_session(netsnmp_session * session);
00780     <span class="keywordtype">int</span> snmp_get_fd_for_session(<span class="keyword">struct</span> <a class="code" href=
"structsnmp__session.html">snmp_session</a> *sessp);
00781 
00782     <span class="comment">/*</span>
00783 <span class="comment">     * New re-allocating reverse encoding functions.  </span>
00784 <span class="comment">     */</span>
00785 <span class="preprocessor">#ifdef USE_REVERSE_ASNENCODING</span>
00786 
00787     <span class="keywordtype">int</span>        snmpv3_packet_realloc_rbuild(u_char ** pkt, size_t * pkt_len,
00788                                      size_t * offset,
00789                                      netsnmp_session * session,
00790                                      netsnmp_pdu *pdu, u_char * pdu_data,
00791                                      size_t pdu_data_len);
00792 
00793     <span class="keywordtype">int</span>        snmp_pdu_realloc_rbuild(u_char ** pkt, size_t * pkt_len,
00794                                 size_t * offset, netsnmp_pdu *pdu);
00795 <span class="preprocessor">#endif</span>
00796 
00797 
00798 
00799     <span class="comment">/*</span>
00800 <span class="comment">     * Extended open; fpre_parse has changed.  </span>
00801 <span class="comment">     */</span>
00802 
00803     netsnmp_session *snmp_open_ex(netsnmp_session *,
00804                                   <span class="keywordtype">int</span> (*fpre_parse) (netsnmp_session *,
00805                                                      <span class="keyword">struct</span>
00806                                                      netsnmp_transport_s *,
00807                                                      <span class="keywordtype">void</span> *, <span class=
"keywordtype">int</span>),
00808                                   <span class="keywordtype">int</span> (*fparse) (netsnmp_session *,
00809                                                  netsnmp_pdu *, u_char *,
00810                                                  size_t),
00811                                   <span class="keywordtype">int</span> (*fpost_parse) (netsnmp_session *,
00812                                                       netsnmp_pdu *, <span class="keywordtype">int</span>),
00813                                   <span class="keywordtype">int</span> (*fbuild) (netsnmp_session *,
00814                                                  netsnmp_pdu *, u_char *,
00815                                                  size_t *),
00816                                   <span class="keywordtype">int</span> (*frbuild) (netsnmp_session *,
00817                                                   netsnmp_pdu *, u_char **,
00818                                                   size_t *, size_t *),
00819                                   <span class="keywordtype">int</span> (*fcheck) (u_char *, size_t));
00820 
00821     <span class="comment">/*</span>
00822 <span class="comment">     * provided for backwards compatability.  Don't use these functions.</span>
00823 <span class="comment">     * See snmp_debug.h and snmp_debug.c instead.</span>
00824 <span class="comment">     */</span>
00825 
00826     <span class="keywordtype">void</span>            snmp_set_do_debugging(<span class="keywordtype">int</span>);
00827     <span class="keywordtype">int</span>             snmp_get_do_debugging(<span class="keywordtype">void</span>);
00828 
00829 
00830     <span class="comment">/*</span>
00831 <span class="comment">     * snmp_error - return error data</span>
00832 <span class="comment">     * Inputs :  address of errno, address of snmp_errno, address of string</span>
00833 <span class="comment">     * Caller must free the string returned after use.</span>
00834 <span class="comment">     */</span>
00835     <span class="keywordtype">void</span>            snmp_error(netsnmp_session *, <span class=
"keywordtype">int</span> *, <span class="keywordtype">int</span> *, <span class="keywordtype">char</span> **);
00836     <span class="comment">/*</span>
00837 <span class="comment">     * single session API.</span>
00838 <span class="comment">     *</span>
00839 <span class="comment">     * These functions perform similar actions as snmp_XX functions,</span>
00840 <span class="comment">     * but operate on a single session only.</span>
00841 <span class="comment">     *</span>
00842 <span class="comment">     * Synopsis:</span>
00843 <span class="comment">     </span>
00844 <span class="comment">     void * sessp;</span>
00845 <span class="comment">     netsnmp_session session, *ss;</span>
00846 <span class="comment">     netsnmp_pdu *pdu, *response;</span>
00847 <span class="comment">     </span>
00848 <span class="comment">     snmp_sess_init(&amp;session);</span>
00849 <span class="comment">     session.retries = ...</span>
00850 <span class="comment">     session.remote_port = ...</span>
00851 <span class="comment">     sessp = snmp_sess_open(&amp;session);</span>
00852 <span class="comment">     ss = snmp_sess_session(sessp);</span>
00853 <span class="comment">     if (ss == NULL)</span>
00854 <span class="comment">     exit(1);</span>
00855 <span class="comment">     ...</span>
00856 <span class="comment">     if (ss-&gt;community) free(ss-&gt;community);</span>
00857 <span class="comment">     ss-&gt;community = strdup(gateway);</span>
00858 <span class="comment">     ss-&gt;community_len = strlen(gateway);</span>
00859 <span class="comment">     ...</span>
00860 <span class="comment">     snmp_sess_synch_response(sessp, pdu, &amp;response);</span>
00861 <span class="comment">     ...</span>
00862 <span class="comment">     snmp_sess_close(sessp);</span>
00863 <span class="comment">     </span>
00864 <span class="comment">     * See also:</span>
00865 <span class="comment">     * snmp_sess_synch_response, in snmp_client.h.</span>
00866 <span class="comment">     </span>
00867 <span class="comment">     * Notes:</span>
00868 <span class="comment">     *  1. Invoke snmp_sess_session after snmp_sess_open.</span>
00869 <span class="comment">     *  2. snmp_sess_session return value is an opaque pointer.</span>
00870 <span class="comment">     *  3. Do NOT free memory returned by snmp_sess_session.</span>
00871 <span class="comment">     *  4. Replace snmp_send(ss,pdu) with snmp_sess_send(sessp,pdu)</span>
00872 <span class="comment">     */</span>
00873 
00874     <span class="keywordtype">void</span>            snmp_sess_init(netsnmp_session *);
00875     <span class="keywordtype">void</span>           *snmp_sess_open(netsnmp_session *);
00876     <span class="keywordtype">void</span>           *snmp_sess_pointer(netsnmp_session *);
00877     netsnmp_session *snmp_sess_session(<span class="keywordtype">void</span> *);
00878 
00879     <span class="comment">/*</span>
00880 <span class="comment">     * Return the netsnmp_transport structure associated with the given opaque</span>
00881 <span class="comment">     * pointer.  </span>
00882 <span class="comment">     */</span>
00883 
00884     <span class="keyword">struct </span>netsnmp_transport_s *snmp_sess_transport(<span class="keywordtype">void</span> *);
00885     <span class="keywordtype">void</span>            snmp_sess_transport_set(<span class="keywordtype">void</span> *,
00886                                             <span class="keyword">struct</span> netsnmp_transport_s *);
00887 
00888     <span class="comment">/*</span>
00889 <span class="comment">     * EXPERIMENTAL API EXTENSIONS ------------------------------------------ </span>
00890 <span class="comment">     * </span>
00891 <span class="comment">     * snmp_sess_add_ex, snmp_sess_add, snmp_add </span>
00892 <span class="comment">     * </span>
00893 <span class="comment">     * Analogous to snmp_open family of functions, but taking an</span>
00894 <span class="comment">     * netsnmp_transport pointer as an extra argument.  Unlike snmp_open et</span>
00895 <span class="comment">     * al. it doesn't attempt to interpret the in_session-&gt;peername as a</span>
00896 <span class="comment">     * transport endpoint specifier, but instead uses the supplied transport.</span>
00897 <span class="comment">     * JBPN</span>
00898 <span class="comment">     * </span>
00899 <span class="comment">     */</span>
00900 
00901     <span class="keywordtype">void</span>           *snmp_sess_add_ex(netsnmp_session *,
00902                                      <span class="keyword">struct</span> netsnmp_transport_s *,
00903                                      <span class="keywordtype">int</span> (*fpre_parse) (netsnmp_session *,
00904                                                         <span class="keyword">struct</span>
00905                                                         netsnmp_transport_s
00906                                                         *, <span class="keywordtype">void</span> *, <span class=
"keywordtype">int</span>),
00907                                      <span class="keywordtype">int</span> (*fparse) (netsnmp_session *,
00908                                                     <span class="keyword">struct</span> <a class="code" href=
"structsnmp__pdu.html">snmp_pdu</a> *,
00909                                                     u_char *, size_t),
00910                                      <span class="keywordtype">int</span> (*fpost_parse) (netsnmp_session *,
00911                                                          <span class="keyword">struct</span> snmp_pdu *,
00912                                                          <span class="keywordtype">int</span>),
00913                                      <span class="keywordtype">int</span> (*fbuild) (netsnmp_session *,
00914                                                     <span class="keyword">struct</span> snmp_pdu *,
00915                                                     u_char *, size_t *),
00916                                      <span class="keywordtype">int</span> (*frbuild) (netsnmp_session *,
00917                                                      <span class="keyword">struct</span> snmp_pdu *,
00918                                                      u_char **, size_t *,
00919                                                      size_t *),
00920                                      <span class="keywordtype">int</span> (*fcheck) (u_char *, size_t),
00921                                      netsnmp_pdu *(*fcreate_pdu) (<span class="keyword">struct</span>
00922                                                                   netsnmp_transport_s
00923                                                                   *,
00924                                                                   <span class="keywordtype">void</span> *,
00925                                                                   size_t));
00926 
00927     <span class="keywordtype">void</span>           *snmp_sess_add(netsnmp_session *,
00928                                   <span class="keyword">struct</span> netsnmp_transport_s *,
00929                                   <span class="keywordtype">int</span> (*fpre_parse) (netsnmp_session *,
00930                                                      <span class="keyword">struct</span>
00931                                                      netsnmp_transport_s *,
00932                                                      <span class="keywordtype">void</span> *, <span class=
"keywordtype">int</span>),
00933                                   <span class="keywordtype">int</span> (*fpost_parse) (netsnmp_session *,
00934                                                       netsnmp_pdu *, <span class="keywordtype">int</span>));
00935 
00936     netsnmp_session *snmp_add(netsnmp_session *,
00937                               <span class="keyword">struct</span> netsnmp_transport_s *,
00938                               <span class="keywordtype">int</span> (*fpre_parse) (netsnmp_session *,
00939                                                  <span class="keyword">struct</span> netsnmp_transport_s
00940                                                  *, <span class="keywordtype">void</span> *, <span class=
"keywordtype">int</span>),
00941                               <span class="keywordtype">int</span> (*fpost_parse) (netsnmp_session *,
00942                                                   netsnmp_pdu *, <span class="keywordtype">int</span>));
00943     netsnmp_session *snmp_add_full(netsnmp_session * in_session,
00944                                    <span class="keyword">struct</span> netsnmp_transport_s *transport,
00945                                    <span class="keywordtype">int</span> (*fpre_parse) (netsnmp_session *,
00946                                                       <span class="keyword">struct</span>
00947                                                       netsnmp_transport_s
00948                                                       *, <span class="keywordtype">void</span> *, <span class=
"keywordtype">int</span>),
00949                                    <span class="keywordtype">int</span> (*fparse) (netsnmp_session *,
00950                                                   netsnmp_pdu *, u_char *,
00951                                                   size_t),
00952                                    <span class="keywordtype">int</span> (*fpost_parse) (netsnmp_session *,
00953                                                        netsnmp_pdu *, <span class="keywordtype">int</span>),
00954                                    <span class="keywordtype">int</span> (*fbuild) (netsnmp_session *,
00955                                                   netsnmp_pdu *, u_char *,
00956                                                   size_t *),
00957                                    <span class="keywordtype">int</span> (*frbuild) (netsnmp_session *,
00958                                                    netsnmp_pdu *,
00959                                                    u_char **, size_t *,
00960                                                    size_t *),
00961                                    <span class="keywordtype">int</span> (*fcheck) (u_char *, size_t),
00962                                    netsnmp_pdu *(*fcreate_pdu) (<span class="keyword">struct</span>
00963                                                                 netsnmp_transport_s
00964                                                                 *, <span class="keywordtype">void</span> *,
00965                                                                 size_t)
00966         );
00967 
00968     <span class="comment">/*</span>
00969 <span class="comment">     * use return value from snmp_sess_open as void * parameter </span>
00970 <span class="comment">     */</span>
00971 
00972     <span class="keywordtype">int</span>             snmp_sess_send(<span class=
"keywordtype">void</span> *, netsnmp_pdu *);
00973     <span class="keywordtype">int</span>             snmp_sess_async_send(<span class=
"keywordtype">void</span> *, netsnmp_pdu *,
00974                                          netsnmp_callback, <span class="keywordtype">void</span> *);
00975     <span class="keywordtype">int</span>             snmp_sess_select_info(<span class=
"keywordtype">void</span> *, <span class="keywordtype">int</span> *, fd_set *,
00976                                           <span class="keyword">struct</span> timeval *, <span class=
"keywordtype">int</span> *);
00977     <span class="keywordtype">int</span>             snmp_sess_read(<span class="keywordtype">void</span> *, fd_set *);
00978     <span class="keywordtype">void</span>            snmp_sess_timeout(<span class="keywordtype">void</span> *);
00979     <span class="keywordtype">int</span>             snmp_sess_close(<span class="keywordtype">void</span> *);
00980 
00981     <span class="keywordtype">void</span>            snmp_sess_error(<span class="keywordtype">void</span> *, <span class=
"keywordtype">int</span> *, <span class="keywordtype">int</span> *, <span class="keywordtype">char</span> **);
00982     <span class="keywordtype">void</span>            netsnmp_sess_log_error(<span class="keywordtype">int</span> priority,
00983                                            <span class="keyword">const</span> <span class=
"keywordtype">char</span> *prog_string,
00984                                            netsnmp_session * ss);
00985     <span class="keywordtype">void</span>            snmp_sess_perror(<span class="keyword">const</span> <span class=
"keywordtype">char</span> *prog_string,
00986                                      netsnmp_session * ss);
00987     <span class="keyword">const</span> <span class="keywordtype">char</span> *    snmp_pdu_type(<span class=
"keywordtype">int</span> type);
00988 
00989     <span class="comment">/*</span>
00990 <span class="comment">     * end single session API </span>
00991 <span class="comment">     */</span>
00992 
00993     <span class="comment">/*</span>
00994 <span class="comment">     * generic statistic counters </span>
00995 <span class="comment">     */</span>
00996 
00997     <span class="comment">/*</span>
00998 <span class="comment">     * snmpv3 statistics </span>
00999 <span class="comment">     */</span>
01000 
01001     <span class="comment">/*</span>
01002 <span class="comment">     * mpd stats </span>
01003 <span class="comment">     */</span>
01004 <span class="preprocessor">#define   STAT_SNMPUNKNOWNSECURITYMODELS     0</span>
01005 <span class="preprocessor">#define   STAT_SNMPINVALIDMSGS               1</span>
01006 <span class="preprocessor">#define   STAT_SNMPUNKNOWNPDUHANDLERS        2</span>
01007 <span class="preprocessor">#define   STAT_MPD_STATS_START               STAT_SNMPUNKNOWNSECURITYMODELS</span>
01008 <span class="preprocessor">#define   STAT_MPD_STATS_END                 STAT_SNMPUNKNOWNPDUHANDLERS</span>
01009 
01010     <span class="comment">/*</span>
01011 <span class="comment">     * usm stats </span>
01012 <span class="comment">     */</span>
01013 <span class="preprocessor">#define   STAT_USMSTATSUNSUPPORTEDSECLEVELS  3</span>
01014 <span class="preprocessor">#define   STAT_USMSTATSNOTINTIMEWINDOWS      4</span>
01015 <span class="preprocessor">#define   STAT_USMSTATSUNKNOWNUSERNAMES      5</span>
01016 <span class="preprocessor">#define   STAT_USMSTATSUNKNOWNENGINEIDS      6</span>
01017 <span class="preprocessor">#define   STAT_USMSTATSWRONGDIGESTS          7</span>
01018 <span class="preprocessor">#define   STAT_USMSTATSDECRYPTIONERRORS      8</span>
01019 <span class="preprocessor">#define   STAT_USM_STATS_START               STAT_USMSTATSUNSUPPORTEDSECLEVELS</span>
01020 <span class="preprocessor">#define   STAT_USM_STATS_END                 STAT_USMSTATSDECRYPTIONERRORS</span>
01021 
01022     <span class="comment">/*</span>
01023 <span class="comment">     * snmp counters </span>
01024 <span class="comment">     */</span>
01025 <span class="preprocessor">#define  STAT_SNMPINPKTS                     9</span>
01026 <span class="preprocessor">#define  STAT_SNMPOUTPKTS                    10</span>
01027 <span class="preprocessor">#define  STAT_SNMPINBADVERSIONS              11</span>
01028 <span class="preprocessor">#define  STAT_SNMPINBADCOMMUNITYNAMES        12</span>
01029 <span class="preprocessor">#define  STAT_SNMPINBADCOMMUNITYUSES         13</span>
01030 <span class="preprocessor">#define  STAT_SNMPINASNPARSEERRS             14</span>
01031     <span class="comment">/*</span>
01032 <span class="comment">     * #define  STAT_SNMPINBADTYPES              15 </span>
01033 <span class="comment">     */</span>
01034 <span class="preprocessor">#define  STAT_SNMPINTOOBIGS                  16</span>
01035 <span class="preprocessor">#define  STAT_SNMPINNOSUCHNAMES              17</span>
01036 <span class="preprocessor">#define  STAT_SNMPINBADVALUES                18</span>
01037 <span class="preprocessor">#define  STAT_SNMPINREADONLYS                19</span>
01038 <span class="preprocessor">#define  STAT_SNMPINGENERRS                  20</span>
01039 <span class="preprocessor">#define  STAT_SNMPINTOTALREQVARS             21</span>
01040 <span class="preprocessor">#define  STAT_SNMPINTOTALSETVARS             22</span>
01041 <span class="preprocessor">#define  STAT_SNMPINGETREQUESTS              23</span>
01042 <span class="preprocessor">#define  STAT_SNMPINGETNEXTS                 24</span>
01043 <span class="preprocessor">#define  STAT_SNMPINSETREQUESTS              25</span>
01044 <span class="preprocessor">#define  STAT_SNMPINGETRESPONSES             26</span>
01045 <span class="preprocessor">#define  STAT_SNMPINTRAPS                    27</span>
01046 <span class="preprocessor">#define  STAT_SNMPOUTTOOBIGS                 28</span>
01047 <span class="preprocessor">#define  STAT_SNMPOUTNOSUCHNAMES             29</span>
01048 <span class="preprocessor">#define  STAT_SNMPOUTBADVALUES               30</span>
01049     <span class="comment">/*</span>
01050 <span class="comment">     * #define  STAT_SNMPOUTREADONLYS            31 </span>
01051 <span class="comment">     */</span>
01052 <span class="preprocessor">#define  STAT_SNMPOUTGENERRS                 32</span>
01053 <span class="preprocessor">#define  STAT_SNMPOUTGETREQUESTS             33</span>
01054 <span class="preprocessor">#define  STAT_SNMPOUTGETNEXTS                34</span>
01055 <span class="preprocessor">#define  STAT_SNMPOUTSETREQUESTS             35</span>
01056 <span class="preprocessor">#define  STAT_SNMPOUTGETRESPONSES            36</span>
01057 <span class="preprocessor">#define  STAT_SNMPOUTTRAPS                   37</span>
01058     <span class="comment">/*</span>
01059 <span class="comment">     * AUTHTRAPENABLE                            38 </span>
01060 <span class="comment">     */</span>
01061 <span class="preprocessor">#define  STAT_SNMPSILENTDROPS                39</span>
01062 <span class="preprocessor">#define  STAT_SNMPPROXYDROPS                 40</span>
01063 <span class="preprocessor">#define  STAT_SNMP_STATS_START               STAT_SNMPINPKTS</span>
01064 <span class="preprocessor">#define  STAT_SNMP_STATS_END                 STAT_SNMPPROXYDROPS</span>
01065 
01066     <span class="comment">/*</span>
01067 <span class="comment">     * target mib counters </span>
01068 <span class="comment">     */</span>
01069 <span class="preprocessor">#define  STAT_SNMPUNAVAILABLECONTEXTS        41</span>
01070 <span class="preprocessor">#define  STAT_SNMPUNKNOWNCONTEXTS            42</span>
01071 <span class="preprocessor">#define  STAT_TARGET_STATS_START             STAT_SNMPUNAVAILABLECONTEXTS</span>
01072 <span class="preprocessor">#define  STAT_TARGET_STATS_END               STAT_SNMPUNKNOWNCONTEXTS</span>
01073 
01074 <span class="preprocessor">#define  MAX_STATS                           43</span>
01075 
01076 <span class="preprocessor">#ifdef __cplusplus</span>
01077 }
01078 <span class="preprocessor">#endif</span>
01079 <span class="preprocessor">#endif                          </span><span class="comment">/* SNMP_API_H */</span>
</pre>
  </div>
  <hr size="1" />

  <address style="align: right;">
    <small>Generated on Fri Dec 30 13:47:48 2005 for net-snmp by&nbsp; <a href="http://www.doxygen.org/index.html"><img src=
    "doxygen.png" alt="doxygen" align="middle" border="0" /></a> 1.3.9.1</small>
  </address>
<!-- CONTENT END -->
<!--#include virtual="/page-bottom.html" -->

