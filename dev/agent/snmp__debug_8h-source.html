<!--#set var="section" value="development" -->
<!--#include virtual="/page-top.html" -->
<!-- CONTENT START -->
  <!-- Generated by Doxygen 1.3.9.1 -->

  <div class="qindex">
    <a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class=
    "qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class=
    "qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a> | <a class=
    "qindex" href="examples.html">Examples</a>
  </div>

  <div class="nav">
    <a class="el" href="dir_000000.html">include</a>&nbsp;/&nbsp;<a class="el" href=
    "dir_000001.html">net-snmp</a>&nbsp;/&nbsp;<a class="el" href="dir_000006.html">library</a>
  </div>

  <h1>snmp_debug.h</h1>

  <div class="fragment">
    <pre class="fragment">
00001 <span class="preprocessor">#ifndef SNMP_DEBUG_H</span>
00002 <span class="preprocessor">#define SNMP_DEBUG_H</span>
00003 
00004 <span class="preprocessor">#ifdef __cplusplus</span>
00005 <span class="keyword">extern</span>          <span class="stringliteral">"C"</span> {
00006 <span class="preprocessor">#endif</span>
00007 
00008     <span class="comment">/*</span>
00009 <span class="comment">     * snmp_debug.h:</span>
00010 <span class="comment">     * </span>
00011 <span class="comment">     * - prototypes for snmp debugging routines.</span>
00012 <span class="comment">     * - easy to use macros to wrap around the functions.  This also provides</span>
00013 <span class="comment">     * the ability to remove debugging code easily from the applications at</span>
00014 <span class="comment">     * compile time.</span>
00015 <span class="comment">     */</span>
00016 
00017 
00018     <span class="comment">/*</span>
00019 <span class="comment">     * These functions should not be used, if at all possible.  Instead, use</span>
00020 <span class="comment">     * the macros below. </span>
00021 <span class="comment">     */</span>
00022 <span class="preprocessor">#if HAVE_STDARG_H</span>
00023     <span class="keywordtype">void</span>            debugmsg(<span class="keyword">const</span> <span class=
"keywordtype">char</span> *token, <span class="keyword">const</span> <span class="keywordtype">char</span> *format, ...);
00024     <span class="keywordtype">void</span>            debugmsgtoken(<span class="keyword">const</span> <span class=
"keywordtype">char</span> *token, <span class="keyword">const</span> <span class="keywordtype">char</span> *format,
00025                                   ...);
00026     <span class="keywordtype">void</span>            debug_combo_nc(<span class="keyword">const</span> <span class=
"keywordtype">char</span> *token, <span class="keyword">const</span> <span class="keywordtype">char</span> *format,
00027                                    ...);
00028 <span class="preprocessor">#else</span>
00029     <span class="keywordtype">void</span>            debugmsg(va_alist);
00030     <span class="keywordtype">void</span>            debugmsgtoken(va_alist);
00031     <span class="keywordtype">void</span>            debug_combo_nc(va_alist);
00032 <span class="preprocessor">#endif</span>
00033     <span class="keywordtype">void</span>            debugmsg_oid(<span class="keyword">const</span> <span class=
"keywordtype">char</span> *token, <span class="keyword">const</span> oid * theoid,
00034                                  size_t len);
00035     <span class="keywordtype">void</span>            debugmsg_suboid(<span class="keyword">const</span> <span class=
"keywordtype">char</span> *token, <span class="keyword">const</span> oid * theoid,
00036                                     size_t len);
00037     <span class="keywordtype">void</span>            debugmsg_var(<span class="keyword">const</span> <span class=
"keywordtype">char</span> *token,
00038                                  <a class="code" href="structvariable__list.html">netsnmp_variable_list</a> * var);
00039     <span class="keywordtype">void</span>            debugmsg_oidrange(<span class="keyword">const</span> <span class=
"keywordtype">char</span> *token,
00040                                       <span class="keyword">const</span> oid * theoid, size_t len,
00041                                       size_t var_subid, oid range_ubound);
00042     <span class="keywordtype">void</span>            debugmsg_hex(<span class="keyword">const</span> <span class=
"keywordtype">char</span> *token, u_char * thedata,
00043                                  size_t len);
00044     <span class="keywordtype">void</span>            debugmsg_hextli(<span class="keyword">const</span> <span class=
"keywordtype">char</span> *token, u_char * thedata,
00045                                     size_t len);
00046     <span class="keywordtype">void</span>            debug_indent_add(<span class="keywordtype">int</span> amount);
00047     <span class="keywordtype">char</span>           *debug_indent(<span class="keywordtype">void</span>);
00048 
00049     <span class="comment">/*</span>
00050 <span class="comment">     * Use these macros instead of the functions above to allow them to be</span>
00051 <span class="comment">     * re-defined at compile time to NOP for speed optimization.</span>
00052 <span class="comment">     * </span>
00053 <span class="comment">     * They need to be called enclosing all the arguments in a single set of ()s.</span>
00054 <span class="comment">     * Example:</span>
00055 <span class="comment">     * DEBUGMSGTL(("token", "debugging of something %s related\n", "snmp"));</span>
00056 <span class="comment">     * </span>
00057 <span class="comment">     * Usage:</span>
00058 <span class="comment">     * All of the functions take a "token" argument that helps determine when</span>
00059 <span class="comment">     * the output in question should be printed.  See the snmpcmd.1 manual page</span>
00060 <span class="comment">     * on the -D flag to turn on/off output for a given token on the command line.</span>
00061 <span class="comment">     * </span>
00062 <span class="comment">     * DEBUGMSG((token, format, ...)):      equivalent to printf(format, ...)</span>
00063 <span class="comment">     * (if "token" debugging output</span>
00064 <span class="comment">     * is requested by the user)</span>
00065 <span class="comment">     * </span>
00066 <span class="comment">     * DEBUGMSGT((token, format, ...)):     equivalent to DEBUGMSG, but prints</span>
00067 <span class="comment">     * "token: " at the beginning of the</span>
00068 <span class="comment">     * line for you.</span>
00069 <span class="comment">     * </span>
00070 <span class="comment">     * DEBUGTRACE                           Insert this token anywhere you want</span>
00071 <span class="comment">     * tracing output displayed when the</span>
00072 <span class="comment">     * "trace" debugging token is selected.</span>
00073 <span class="comment">     * </span>
00074 <span class="comment">     * DEBUGMSGL((token, format, ...)):     equivalent to DEBUGMSG, but includes</span>
00075 <span class="comment">     * DEBUGTRACE debugging line just before</span>
00076 <span class="comment">     * yours.</span>
00077 <span class="comment">     * </span>
00078 <span class="comment">     * DEBUGMSGTL((token, format, ...)):    Same as DEBUGMSGL and DEBUGMSGT</span>
00079 <span class="comment">     * combined.</span>
00080 <span class="comment">     * </span>
00081 <span class="comment">     * Important:</span>
00082 <span class="comment">     * It is considered best if you use DEBUGMSGTL() everywhere possible, as it</span>
00083 <span class="comment">     * gives the nicest format output and provides tracing support just before</span>
00084 <span class="comment">     * every debugging statement output.</span>
00085 <span class="comment">     * </span>
00086 <span class="comment">     * To print multiple pieces to a single line in one call, use:</span>
00087 <span class="comment">     * </span>
00088 <span class="comment">     * DEBUGMSGTL(("token", "line part 1"));</span>
00089 <span class="comment">     * DEBUGMSG  (("token", " and part 2\n"));</span>
00090 <span class="comment">     * </span>
00091 <span class="comment">     * to get:</span>
00092 <span class="comment">     * </span>
00093 <span class="comment">     * token: line part 1 and part 2</span>
00094 <span class="comment">     * </span>
00095 <span class="comment">     * as debugging output.</span>
00096 <span class="comment">     *</span>
00097 <span class="comment">     *</span>
00098 <span class="comment">     * Each of these macros also have a version with a suffix of '_NC'. The</span>
00099 <span class="comment">     * NC suffix stands for 'No Check', which means that no check will be</span>
00100 <span class="comment">     * performed to see if debug is enabled or if the token has been turned</span>
00101 <span class="comment">     * on. These NC versions are intended for use within a DEBUG_IF {} block,</span>
00102 <span class="comment">     * where the debug/token check has already been performed.</span>
00103 <span class="comment">     */</span>
00104 
00105 <span class="preprocessor">#ifndef SNMP_NO_DEBUGGING       </span><span class="comment">/* make sure we're wanted */</span>
00106 
00107     <span class="comment">/*</span>
00108 <span class="comment">     * define two macros : one macro with, one without,</span>
00109 <span class="comment">     *                     a test if debugging is enabled.</span>
00110 <span class="comment">     * </span>
00111 <span class="comment">     * Generally, use the macro with _DBG_IF_</span>
00112 <span class="comment">     */</span>
00113 
00114 <span class="comment">/******************* Start private macros ************************/</span>
00115 <span class="preprocessor">#define _DBG_IF_            snmp_get_do_debugging()</span>
00116 <span class=
"preprocessor">#define DEBUGIF(x)         if (_DBG_IF_ &amp;&amp; debug_is_token_registered(x) == SNMPERR_SUCCESS)</span>
00117 
00118 <span class="preprocessor">#define __DBGMSGT(x)     debugmsgtoken x,  debugmsg x</span>
00119 <span class="preprocessor">#define __DBGMSG_NC(x)   debugmsg x</span>
00120 <span class="preprocessor">#define __DBGMSGT_NC(x)  debug_combo_nc x</span>
00121 <span class="preprocessor">#define __DBGMSGL_NC(x)  __DBGTRACE; debugmsg x</span>
00122 <span class="preprocessor">#define __DBGMSGTL_NC(x) __DBGTRACE; debug_combo_nc x</span>
00123 
00124 <span class="preprocessor">#ifdef  HAVE_CPP_UNDERBAR_FUNCTION_DEFINED</span>
00125 <span class="preprocessor">#define __DBGTRACE       __DBGMSGT(("trace","%s(): %s, %d:\n",__FUNCTION__,\</span>
00126 <span class="preprocessor">                                 __FILE__,__LINE__))</span>
00127 <span class="preprocessor">#else</span>
00128 <span class="preprocessor">#define __DBGTRACE       __DBGMSGT(("trace"," %s, %d:\n", __FILE__,__LINE__))</span>
00129 <span class="preprocessor">#endif</span>
00130 
00131 <span class="preprocessor">#define __DBGMSGL(x)     __DBGTRACE, debugmsg x</span>
00132 <span class="preprocessor">#define __DBGMSGTL(x)    __DBGTRACE, debugmsgtoken x, debugmsg x</span>
00133 <span class="preprocessor">#define __DBGMSGOID(x)     debugmsg_oid x</span>
00134 <span class="preprocessor">#define __DBGMSGSUBOID(x)  debugmsg_suboid x</span>
00135 <span class="preprocessor">#define __DBGMSGVAR(x)     debugmsg_var x</span>
00136 <span class="preprocessor">#define __DBGMSGOIDRANGE(x) debugmsg_oidrange x</span>
00137 <span class="preprocessor">#define __DBGMSGHEX(x)     debugmsg_hex x</span>
00138 <span class="preprocessor">#define __DBGMSGHEXTLI(x)  debugmsg_hextli x</span>
00139 <span class="preprocessor">#define __DBGINDENT()      debug_indent()</span>
00140 <span class="preprocessor">#define __DBGINDENTADD(x)  debug_indent_add(x)</span>
00141 <span class="preprocessor">#define __DBGINDENTMORE()  debug_indent_add(2)</span>
00142 <span class="preprocessor">#define __DBGINDENTLESS()  debug_indent_add(-2)</span>
00143 <span class="preprocessor">#define __DBGPRINTINDENT(token) __DBGMSGTL((token, "%s", __DBGINDENT()))</span>
00144 
00145 <span class="preprocessor">#define __DBGDUMPHEADER(token,x) \</span>
00146 <span class="preprocessor">        __DBGPRINTINDENT("dumph_" token); \</span>
00147 <span class="preprocessor">        debugmsg("dumph_" token,x); \</span>
00148 <span class="preprocessor">        if (debug_is_token_registered("dumpx" token) == SNMPERR_SUCCESS ||    \</span>
00149 <span class="preprocessor">            debug_is_token_registered("dumpv" token) == SNMPERR_SUCCESS ||    \</span>
00150 <span class="preprocessor">            (debug_is_token_registered("dumpx_" token) != SNMPERR_SUCCESS &amp;&amp;  \</span>
00151 <span class="preprocessor">             debug_is_token_registered("dumpv_" token) != SNMPERR_SUCCESS)) { \</span>
00152 <span class="preprocessor">            debugmsg("dumph_" token,"\n"); \</span>
00153 <span class="preprocessor">        } else { \</span>
00154 <span class="preprocessor">            debugmsg("dumph_" token,"  "); \</span>
00155 <span class="preprocessor">        } \</span>
00156 <span class="preprocessor">        __DBGINDENTMORE()</span>
00157 
00158 <span class="preprocessor">#define __DBGDUMPSECTION(token,x) \</span>
00159 <span class="preprocessor">        __DBGPRINTINDENT("dumph_" token); \</span>
00160 <span class="preprocessor">        debugmsg("dumph_" token,x); \</span>
00161 <span class="preprocessor">        debugmsg("dumph_" token,"\n"); \</span>
00162 <span class="preprocessor">        __DBGINDENTMORE()</span>
00163 
00164 <span class="preprocessor">#define __DBGDUMPSETUP(token,buf,len) \</span>
00165 <span class="preprocessor">        debugmsg("dumpx" token, "dumpx_%s:%s", token, __DBGINDENT()); \</span>
00166 <span class="preprocessor">        __DBGMSGHEX(("dumpx_" token,buf,len)); \</span>
00167 <span class="preprocessor">        if (debug_is_token_registered("dumpv" token) == SNMPERR_SUCCESS || \</span>
00168 <span class="preprocessor">            debug_is_token_registered("dumpv_" token) != SNMPERR_SUCCESS) { \</span>
00169 <span class="preprocessor">            debugmsg("dumpx_" token,"\n"); \</span>
00170 <span class="preprocessor">        } else { \</span>
00171 <span class="preprocessor">            debugmsg("dumpx_" token,"  "); \</span>
00172 <span class="preprocessor">        } \</span>
00173 <span class="preprocessor">        debugmsg("dumpv" token, "dumpv_%s:%s", token, __DBGINDENT());</span>
00174 
00175 <span class="comment">/******************* End   private macros ************************/</span>
00176 <span class="comment">/*****************************************************************/</span>
00177 
00178 <span class="comment">/*****************************************************************/</span>
00179 <span class="comment">/********************Start public  macros ************************/</span>
00180 
00181 <span class="preprocessor">#define DEBUGMSG(x)        do {if (_DBG_IF_) {debugmsg x;} }while(0)</span>
00182 <span class="preprocessor">#define DEBUGMSGT(x)       do {if (_DBG_IF_) {__DBGMSGT(x);} }while(0)</span>
00183 <span class="preprocessor">#define DEBUGTRACE         do {if (_DBG_IF_) {__DBGTRACE;} }while(0)</span>
00184 <span class="preprocessor">#define DEBUGMSGL(x)       do {if (_DBG_IF_) {__DBGMSGL(x);} }while(0)</span>
00185 <span class="preprocessor">#define DEBUGMSGTL(x)      do {if (_DBG_IF_) {__DBGMSGTL(x);} }while(0)</span>
00186 <span class="preprocessor">#define DEBUGMSGOID(x)     do {if (_DBG_IF_) {__DBGMSGOID(x);} }while(0)</span>
00187 <span class="preprocessor">#define DEBUGMSGSUBOID(x)  do {if (_DBG_IF_) {__DBGMSGSUBOID(x);} }while(0)</span>
00188 <span class="preprocessor">#define DEBUGMSGVAR(x)     do {if (_DBG_IF_) {__DBGMSGVAR(x);} }while(0)</span>
00189 <span class="preprocessor">#define DEBUGMSGOIDRANGE(x) do {if (_DBG_IF_) {__DBGMSGOIDRANGE(x);} }while(0)</span>
00190 <span class="preprocessor">#define DEBUGMSGHEX(x)     do {if (_DBG_IF_) {__DBGMSGHEX(x);} }while(0)</span>
00191 <span class="preprocessor">#define DEBUGMSGHEXTLI(x)  do {if (_DBG_IF_) {__DBGMSGHEXTLI(x);} }while(0)</span>
00192 <span class="preprocessor">#define DEBUGINDENT()      do {if (_DBG_IF_) {__DBGINDENT();} }while(0)</span>
00193 <span class="preprocessor">#define DEBUGINDENTADD(x)  do {if (_DBG_IF_) {__DBGINDENTADD(x);} }while(0)</span>
00194 <span class="preprocessor">#define DEBUGINDENTMORE()  do {if (_DBG_IF_) {__DBGINDENTMORE();} }while(0)</span>
00195 <span class="preprocessor">#define DEBUGINDENTLESS()  do {if (_DBG_IF_) {__DBGINDENTLESS();} }while(0)</span>
00196 <span class="preprocessor">#define DEBUGPRINTINDENT(token) \</span>
00197 <span class="preprocessor">        do {if (_DBG_IF_) {__DBGPRINTINDENT(token);} }while(0)</span>
00198 
00199 
00200 <span class="preprocessor">#define DEBUGDUMPHEADER(token,x) \</span>
00201 <span class="preprocessor">        do {if (_DBG_IF_) {__DBGDUMPHEADER(token,x);} }while(0)</span>
00202 
00203 <span class="preprocessor">#define DEBUGDUMPSECTION(token,x) \</span>
00204 <span class="preprocessor">        do {if (_DBG_IF_) {__DBGDUMPSECTION(token,x);} }while(0)</span>
00205 
00206 <span class="preprocessor">#define DEBUGDUMPSETUP(token,buf,len) \</span>
00207 <span class="preprocessor">        do {if (_DBG_IF_) {__DBGDUMPSETUP(token,buf,len);} }while(0)</span>
00208 
00209 <span class="preprocessor">#define DEBUGMSG_NC(x)  do { __DBGMSG_NC(x); }while(0)</span>
00210 <span class="preprocessor">#define DEBUGMSGT_NC(x) do { __DBGMSGT_NC(x); }while(0)</span>
00211 
00212 <span class="preprocessor">#else                           </span><span class=
"comment">/* SNMP_NO_DEBUGGING := enable streamlining of the code */</span>
00213 
00214 <span class="preprocessor">#define DEBUGMSG(x)</span>
00215 <span class="preprocessor">#define DEBUGMSGT(x)</span>
00216 <span class="preprocessor">#define DEBUGTRACE</span>
00217 <span class="preprocessor">#define DEBUGMSGL(x)</span>
00218 <span class="preprocessor">#define DEBUGMSGTL(x)</span>
00219 <span class="preprocessor">#define DEBUGMSGOID(x)</span>
00220 <span class="preprocessor">#define DEBUGMSGSUBOID(x)</span>
00221 <span class="preprocessor">#define DEBUGMSGVAR(x)</span>
00222 <span class="preprocessor">#define DEBUGMSGOIDRANGE(x)</span>
00223 <span class="preprocessor">#define DEBUGMSGHEX(x)</span>
00224 <span class="preprocessor">#define DEBUGIF(x)        if(0)</span>
00225 <span class="preprocessor">#define DEBUGDUMP(t,b,l,p)</span>
00226 <span class="preprocessor">#define DEBUGINDENT()</span>
00227 <span class="preprocessor">#define DEBUGINDENTMORE()</span>
00228 <span class="preprocessor">#define DEBUGINDENTLESS()</span>
00229 <span class="preprocessor">#define DEBUGINDENTADD(x)</span>
00230 <span class="preprocessor">#define DEBUGMSGHEXTLI(x)</span>
00231 <span class="preprocessor">#define DEBUGPRINTINDENT(token)</span>
00232 <span class="preprocessor">#define DEBUGDUMPHEADER(token,x)</span>
00233 <span class="preprocessor">#define DEBUGDUMPSECTION(token,x)</span>
00234 <span class="preprocessor">#define DEBUGDUMPSETUP(token, buf, len)</span>
00235 
00236 <span class="preprocessor">#define DEBUGMSG_NC(x)</span>
00237 <span class="preprocessor">#define DEBUGMSGT_NC(x)</span>
00238 
00239 <span class="preprocessor">#endif</span>
00240 
00241 <span class="preprocessor">#define MAX_DEBUG_TOKENS 256</span>
00242 <span class="preprocessor">#define MAX_DEBUG_TOKEN_LEN 128</span>
00243 <span class="preprocessor">#define DEBUG_TOKEN_DELIMITER ","</span>
00244 <span class="preprocessor">#define DEBUG_ALWAYS_TOKEN "all"</span>
00245 
00246     <span class="comment">/*</span>
00247 <span class="comment">     * setup routines:</span>
00248 <span class="comment">     * </span>
00249 <span class="comment">     * debug_register_tokens(char *):     registers a list of tokens to</span>
00250 <span class="comment">     * print debugging output for.</span>
00251 <span class="comment">     * </span>
00252 <span class="comment">     * debug_is_token_registered(char *): returns SNMPERR_SUCCESS or SNMPERR_GENERR</span>
00253 <span class="comment">     * if a token has been registered or</span>
00254 <span class="comment">     * not (and debugging output is "on").</span>
00255 <span class="comment">     * snmp_debug_init(void):             registers .conf handlers.</span>
00256 <span class="comment">     */</span>
00257     <span class="keywordtype">void</span>            debug_register_tokens(<span class="keywordtype">char</span> *tokens);
00258     <span class="keywordtype">int</span>             debug_is_token_registered(<span class=
"keyword">const</span> <span class="keywordtype">char</span> *token);
00259     <span class="keywordtype">void</span>            snmp_debug_init(<span class="keywordtype">void</span>);
00260     <span class="keywordtype">void</span>            snmp_set_do_debugging(<span class="keywordtype">int</span>);
00261     <span class="keywordtype">int</span>             snmp_get_do_debugging(<span class="keywordtype">void</span>);
00262 
00263 <span class="comment">/*</span>
00264 <span class="comment"> * internal:</span>
00265 <span class="comment"> * You probably shouldn't be using this information unless the word</span>
00266 <span class="comment"> * "expert" applies to you.  I know it looks tempting.</span>
00267 <span class="comment"> */</span>
00268 <span class="keyword">typedef</span> <span class="keyword">struct </span>netsnmp_token_descr_s {
00269     <span class="keywordtype">char</span> *token_name;
00270     <span class="keywordtype">char</span>  enabled;
00271 } netsnmp_token_descr;
00272 
00273 <span class="keyword">extern</span> <span class="keywordtype">int</span>                 debug_num_tokens;
00274 <span class="keyword">extern</span> netsnmp_token_descr dbg_tokens[MAX_DEBUG_TOKENS];
00275     
00276 <span class="preprocessor">#ifdef __cplusplus</span>
00277 }
00278 <span class="preprocessor">#endif</span>
00279 <span class="preprocessor">#endif                          </span><span class="comment">/* SNMP_DEBUG_H */</span>
</pre>
  </div>
  <hr size="1" />

  <address style="align: right;">
    <small><!--#include virtual="/sfbutton.html" --><br />
    Generated on Thu Nov 25 17:51:41 2004 for net-snmp by&nbsp; <a href="http://www.doxygen.org/index.html"><img src=
    "doxygen.png" alt="doxygen" align="middle" border="0" /></a> 1.3.9.1</small>
  </address>
<!-- CONTENT END -->
<!--#include virtual="/page-bottom.html" -->

