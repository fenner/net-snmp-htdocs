<!--#set var="section" value="development" -->
<!--#include virtual="/page-top.html" -->
<!-- CONTENT START -->
  <!-- Generated by Doxygen 1.3.9.1 -->

  <div class="qindex">
    <a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class=
    "qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class=
    "qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a> | <a class=
    "qindex" href="examples.html">Examples</a>
  </div>

  <div class="nav">
    <a class="el" href="dir_000000.html">include</a>&nbsp;/&nbsp;<a class="el" href=
    "dir_000001.html">net-snmp</a>&nbsp;/&nbsp;<a class="el" href="dir_000006.html">library</a>
  </div>

  <h1>scapi.h</h1>

  <div class="fragment">
    <pre class="fragment">
00001 <span class="comment">/*</span>
00002 <span class="comment"> * scapi.h</span>
00003 <span class="comment"> */</span>
00004 
00005 <span class="preprocessor">#ifndef _SCAPI_H</span>
00006 <span class="preprocessor">#define _SCAPI_H</span>
00007 
00008 <span class="preprocessor">#ifdef __cplusplus</span>
00009 <span class="keyword">extern</span>          <span class="stringliteral">"C"</span> {
00010 <span class="preprocessor">#endif</span>
00011 
00012     <span class="comment">/*</span>
00013 <span class="comment">     * Authentication/privacy transform bitlengths.</span>
00014 <span class="comment">     */</span>
00015 <span class="preprocessor">#define SNMP_TRANS_AUTHLEN_HMACMD5      128</span>
00016 <span class="preprocessor">#define SNMP_TRANS_AUTHLEN_HMACSHA1     160</span>
00017 
00018 <span class="preprocessor">#define SNMP_TRANS_AUTHLEN_HMAC96       96</span>
00019 
00020 <span class="preprocessor">#define SNMP_TRANS_PRIVLEN_1DES         64</span>
00021 <span class="preprocessor">#define SNMP_TRANS_PRIVLEN_1DES_IV      64</span>
00022 
00023 <span class="preprocessor">#define SNMP_TRANS_PRIVLEN_AES          128</span>
00024 <span class="preprocessor">#define SNMP_TRANS_PRIVLEN_AES_IV       128</span>
00025 <span class="preprocessor">#define SNMP_TRANS_AES_PADSIZE          128  </span><span class=
"comment">/* backwards compat */</span>
00026 <span class="preprocessor">#define SNMP_TRANS_PRIVLEN_AES128       128  </span><span class=
"comment">/* backwards compat */</span>
00027 <span class="preprocessor">#define SNMP_TRANS_PRIVLEN_AES128_IV    128  </span><span class=
"comment">/* backwards compat */</span>
00028 <span class="preprocessor">#define SNMP_TRANS_AES_AES128_PADSIZE   128  </span><span class=
"comment">/* backwards compat */</span>
00029 
00030     <span class="comment">/*</span>
00031 <span class="comment">     * Prototypes.</span>
00032 <span class="comment">     */</span>
00033     <span class="keywordtype">int</span>             sc_get_properlength(<span class="keyword">const</span> oid * hashtype,
00034                                         u_int hashtype_len);
00035     <span class="keywordtype">int</span>             sc_get_proper_priv_length(<span class=
"keyword">const</span> oid * privtype,
00036                                               u_int privtype_len);
00037 
00038     <span class="keywordtype">int</span>             sc_init(<span class="keywordtype">void</span>);
00039     <span class="keywordtype">int</span>             sc_shutdown(<span class="keywordtype">int</span> majorID, <span class=
"keywordtype">int</span> minorID, <span class="keywordtype">void</span> *serverarg,
00040                                 <span class="keywordtype">void</span> *clientarg);
00041 
00042     <span class="keywordtype">int</span>             sc_random(u_char * buf, size_t * buflen);
00043 
00044     <span class="keywordtype">int</span>             sc_generate_keyed_hash(<span class=
"keyword">const</span> oid * authtype,
00045                                            size_t authtypelen,
00046                                            u_char * key, u_int keylen,
00047                                            u_char * message, u_int msglen,
00048                                            u_char * MAC, size_t * maclen);
00049 
00050     <span class="keywordtype">int</span>             sc_check_keyed_hash(<span class="keyword">const</span> oid * authtype,
00051                                         size_t authtypelen, u_char * key,
00052                                         u_int keylen, u_char * message,
00053                                         u_int msglen, u_char * MAC,
00054                                         u_int maclen);
00055 
00056     <span class="keywordtype">int</span>             sc_encrypt(<span class=
"keyword">const</span> oid * privtype, size_t privtypelen,
00057                                u_char * key, u_int keylen,
00058                                u_char * iv, u_int ivlen,
00059                                u_char * plaintext, u_int ptlen,
00060                                u_char * ciphertext, size_t * ctlen);
00061 
00062     <span class="keywordtype">int</span>             sc_decrypt(<span class=
"keyword">const</span> oid * privtype, size_t privtypelen,
00063                                u_char * key, u_int keylen,
00064                                u_char * iv, u_int ivlen,
00065                                u_char * ciphertext, u_int ctlen,
00066                                u_char * plaintext, size_t * ptlen);
00067 
00068     <span class="keywordtype">int</span>             sc_hash(<span class=
"keyword">const</span> oid * hashtype, size_t hashtypelen,
00069                             u_char * buf, size_t buf_len,
00070                             u_char * MAC, size_t * MAC_len);
00071 
00072     <span class="keywordtype">int</span>             sc_get_transform_type(oid * hashtype,
00073                                           u_int hashtype_len,
00074                                           <span class="keywordtype">int</span> (**hash_fn) (<span class=
"keyword">const</span> <span class="keywordtype">int</span> mode,
00075                                                            <span class="keywordtype">void</span> **context,
00076                                                            <span class="keyword">const</span> u_char *
00077                                                            data,
00078                                                            <span class="keyword">const</span> <span class=
"keywordtype">int</span>
00079                                                            data_len,
00080                                                            u_char **
00081                                                            digest,
00082                                                            size_t *
00083                                                            digest_len));
00084 
00085 
00086     <span class="comment">/*</span>
00087 <span class="comment">     * All functions devolve to the following block if we can't do cryptography</span>
00088 <span class="comment">     */</span>
00089 <span class="preprocessor">#define _SCAPI_NOT_CONFIGURED                                   \</span>
00090 <span class="preprocessor">{                                                               \</span>
00091 <span class="preprocessor">        snmp_log(LOG_ERR, "Encryption support not enabled.\n"); \</span>
00092 <span class="preprocessor">        DEBUGMSGTL(("scapi", "SCAPI not configured"));          \</span>
00093 <span class="preprocessor">        return SNMPERR_SC_NOT_CONFIGURED;                       \</span>
00094 <span class="preprocessor">}</span>
00095 
00096     <span class="comment">/*</span>
00097 <span class="comment">     * define a transform type if we're using the internal md5 support </span>
00098 <span class="comment">     */</span>
00099 <span class="preprocessor">#ifdef USE_INTERNAL_MD5</span>
00100 <span class="preprocessor">#define INTERNAL_MD5 1</span>
00101 <span class="preprocessor">#endif</span>
00102 
00103 <span class="preprocessor">#ifdef __cplusplus</span>
00104 }
00105 <span class="preprocessor">#endif</span>
00106 <span class="preprocessor">#endif                          </span><span class="comment">/* _SCAPI_H */</span>
</pre>
  </div>
  <hr size="1" />

  <address style="align: right;">
    <small><!--#include virtual="/sfbutton.html" --><br />
    Generated on Thu Nov 25 17:51:39 2004 for net-snmp by&nbsp; <a href="http://www.doxygen.org/index.html"><img src=
    "doxygen.png" alt="doxygen" align="middle" border="0" /></a> 1.3.9.1</small>
  </address>
<!-- CONTENT END -->
<!--#include virtual="/page-bottom.html" -->

